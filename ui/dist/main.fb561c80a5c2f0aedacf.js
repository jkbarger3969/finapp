(self.webpackChunkaccounting=self.webpackChunkaccounting||[]).push([[179],{24965:(e,n,t)=>{"use strict";var r=t(67294),a=t(73935),l=t(46829),o=t(75834),i=t(73727),u=t(71439),c=t(59713),d=t.n(c);const s=JSON.parse('{"possibleTypes":{"BudgetOwner":["Department","Business"],"DepartmentAncestor":["Department","Business"],"JournalEntrySource":["Person","Business","Department"],"PaymentMethodAuthorizedEntity":["Person","Business","Department"]}}');function m(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?m(Object(t),!0).forEach((function(n){d()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}const f=new u.h4(p(p({},s),{},{addTypename:!0}));var v=t(465),y=t(41072),E=t(13984),b=t(39188),h=new v.A({uri:"/graphql",credentials:"same-origin"}),g=new y.A({uri:"ws://".concat(window.location.host,"/graphql"),options:{reconnect:!0}});const O=l.ApolloLink.from([(0,E.q)((function(e){var n=e.graphQLErrors,t=e.networkError;n&&n.forEach((function(e){var n=e.message,t=e.locations,r=e.path;return console.error("[GraphQL error]: Message: ".concat(n,", Location: ").concat(t,", Path: ").concat(r))})),t&&console.log("[Network error]: ".concat(t))})),l.ApolloLink.split((function(e){var n=e.query,t=(0,b.p$)(n);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),g,h)]),Z=new u.fe({link:O,cache:f,resolvers:{}});var w,C,R,M,A,k,j,_,S,I=t(28655),D=t.n(I),F=t(47921),T=t(48926),x=t.n(T),P=t(319),$=t.n(P),N=t(63038),q=t.n(N),L=t(87757),U=t.n(L),B=t(26283),W=t.n(B),V=t(92077),J=t.n(V),G=t(40059),z=t(74221),Y=t(71336),Q=t(41396),K=t(76945),X=t(30387),H=t(43829),ee=t(28889),ne=t(99613),te=t(57394),re=t(88222),ae=t(22318),le=t(18334),oe=t(20907),ie=t(22455),ue=t(2279),ce=t(9259),de=t(18266),se=t(44119),me=t.n(se),pe=t(38779),fe=t(69119),ve=t(85628),ye=t.n(ve),Ee=(t(2536),t(98221)),be=t(57460),he=t(93162);function ge(){var e=D()(["\n  subscription JournalEntryUpdated_1 {\n    journalEntryUpdated {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return ge=function(){return e},e}function Oe(){var e=D()(["\n  subscription JournalEntryAdded_1 {\n    journalEntryAdded {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return Oe=function(){return e},e}function Ze(){var e=D()(['\n  query JournalEntries_1($where: JournalEntiresWhere!) {\n    journalEntries(where: $where)\n      @connection(key: "JournalEntries_1", filter: ["where"]) {\n      ...JournalEntry_1Fragment\n    }\n    fiscalYears {\n      __typename\n      id\n      name\n      begin\n      end\n    }\n  }\n  ',"\n"]);return Ze=function(){return e},e}function we(){var e=D()(["\n  fragment JournalEntry_1Fragment on JournalEntry {\n    __typename\n    id\n    date\n    dateOfRecord {\n      date\n      overrideFiscalYear\n    }\n    department {\n      __typename\n      id\n      name\n      ancestors {\n        __typename\n        ... on Business {\n          id\n          bizName: name\n        }\n        ... on Department {\n          id\n          deptName: name\n        }\n      }\n    }\n    type\n    category {\n      ...JournalEntryCategory_1Fragment\n    }\n    department {\n      ...JournalEntryDept_1Fragment\n    }\n    description\n    paymentMethod {\n      ...JournalEntryPayMethod_1Fragment\n    }\n    source {\n      __typename\n      ... on Person {\n        id\n        name {\n          first\n          last\n        }\n      }\n      ... on Business {\n        id\n        bizName: name\n      }\n      ... on Department {\n        id\n        deptName: name\n      }\n    }\n    total {\n      n\n      d\n      s\n    }\n    refunds {\n      ...JournalEntryRefund_1Fragment\n    }\n    items {\n      ...JournalEntryItem_1Fragment\n    }\n    deleted\n    lastUpdate\n    reconciled\n  }\n  ","\n  ","\n  ","\n  ","\n  ","\n"]);return we=function(){return e},e}function Ce(){var e=D()(["\n  fragment JournalEntryItem_1Fragment on JournalEntryItem {\n    __typename\n    id\n    category {\n      ...JournalEntryCategory_1Fragment\n    }\n    department {\n      ...JournalEntryDept_1Fragment\n    }\n    total {\n      n\n      d\n      s\n    }\n    units\n    description\n    lastUpdate\n    deleted\n  }\n  ","\n  ","\n"]);return Ce=function(){return e},e}function Re(){var e=D()(["\n  fragment JournalEntryRefund_1Fragment on JournalEntryRefund {\n    __typename\n    id\n    date\n    description\n    total {\n      n\n      d\n      s\n    }\n    paymentMethod {\n      ...JournalEntryPayMethod_1Fragment\n    }\n    reconciled\n    lastUpdate\n    deleted\n  }\n  ","\n"]);return Re=function(){return e},e}function Me(){var e=D()(["\n  fragment JournalEntryDept_1Fragment on Department {\n    __typename\n    id\n    name\n    ancestors {\n      __typename\n      ... on Business {\n        id\n        bizName: name\n      }\n      ... on Department {\n        id\n        deptName: name\n      }\n    }\n  }\n"]);return Me=function(){return e},e}function Ae(){var e=D()(["\n  fragment JournalEntryCategory_1Fragment on JournalEntryCategory {\n    __typename\n    id\n    type\n    name\n  }\n"]);return Ae=function(){return e},e}function ke(){var e=D()(["\n  fragment JournalEntryPayMethod_1Fragment on PaymentMethod {\n    __typename\n    id\n    name\n    parent {\n      __typename\n      id\n    }\n  }\n"]);return ke=function(){return e},e}!function(e){e.Business="BUSINESS",e.Department="DEPARTMENT"}(w||(w={})),function(e){e.Business="BUSINESS",e.Department="DEPARTMENT"}(C||(C={})),function(e){e.Credit="CREDIT",e.Debit="DEBIT"}(R||(R={})),function(e){e.Business="BUSINESS",e.Department="DEPARTMENT",e.Person="PERSON"}(M||(M={})),function(e){e.Pos="POS",e.Neg="NEG"}(A||(A={})),function(e){e.Asc="ASC",e.Desc="DESC"}(k||(k={})),function(e){e.Include="INCLUDE",e.Exclude="EXCLUDE"}(j||(j={})),function(e){e.CaseInsensitive="CaseInsensitive",e.Multiline="Multiline",e.Extended="Extended",e.DotAll="DotAll",e.I="I",e.M="M",e.X="X",e.S="S"}(_||(_={})),function(e){e.Public="PUBLIC",e.Private="PRIVATE"}(S||(S={}));var je=me()(ke()),_e=me()(Ae()),Se=me()(Me()),Ie=me()(Re(),je),De=me()(Ce(),_e,Se),Fe=me()(we(),je,Se,_e,Ie,De),Te=me()(Ze(),Fe),xe=(me()(Oe(),Fe),me()(ge(),Fe),"5dc46d0af74afb2c2805bd54"),Pe=t(51245),$e=t(43500),Ne=t(89956),qe=t(13088),Le=t(51990),Ue=t(71987),Be=t(98770),We=t(65150),Ve=t(23101),Je=t(72156),Ge=t(17215),ze=t(99945),Ye=t(94813),Qe=t(80836);const Ke={Add:(0,r.forwardRef)((function(e,n){return r.createElement(Pe.Z,Object.assign({},e,{ref:n}))})),Check:(0,r.forwardRef)((function(e,n){return r.createElement($e.Z,Object.assign({},e,{ref:n}))})),Clear:(0,r.forwardRef)((function(e,n){return r.createElement(Ne.Z,Object.assign({},e,{ref:n}))})),Delete:(0,r.forwardRef)((function(e,n){return r.createElement(qe.Z,Object.assign({},e,{ref:n}))})),DetailPanel:(0,r.forwardRef)((function(e,n){return r.createElement(Le.Z,Object.assign({},e,{ref:n}))})),Edit:(0,r.forwardRef)((function(e,n){return r.createElement(X.Z,Object.assign({},e,{ref:n}))})),Export:(0,r.forwardRef)((function(e,n){return r.createElement(Ue.Z,Object.assign({},e,{ref:n}))})),Filter:(0,r.forwardRef)((function(e,n){return r.createElement(Be.Z,Object.assign({},e,{ref:n}))})),FirstPage:(0,r.forwardRef)((function(e,n){return r.createElement(We.Z,Object.assign({},e,{ref:n}))})),LastPage:(0,r.forwardRef)((function(e,n){return r.createElement(Ve.Z,Object.assign({},e,{ref:n}))})),NextPage:(0,r.forwardRef)((function(e,n){return r.createElement(Le.Z,Object.assign({},e,{ref:n}))})),PreviousPage:(0,r.forwardRef)((function(e,n){return r.createElement(Je.Z,Object.assign({},e,{ref:n}))})),ResetSearch:(0,r.forwardRef)((function(e,n){return r.createElement(Ne.Z,Object.assign({},e,{ref:n}))})),Search:(0,r.forwardRef)((function(e,n){return r.createElement(Ge.Z,Object.assign({},e,{ref:n}))})),SortArrow:(0,r.forwardRef)((function(e,n){return r.createElement(ze.Z,Object.assign({},e,{ref:n}))})),ThirdStateCheck:(0,r.forwardRef)((function(e,n){return r.createElement(Ye.Z,Object.assign({},e,{ref:n}))})),ViewColumn:(0,r.forwardRef)((function(e,n){return r.createElement(Qe.Z,Object.assign({},e,{ref:n}))}))};var Xe=t(33984),He=t(8920),en=t(52663),nn=t(66083),tn=t(7212),rn=t(29525),an=t(41749),ln=t(66856),on=t(282),un=t(73430),cn=t(24673);function dn(){var e=D()(["\n  mutation AddEntryRefund(\n    $id: ID!\n    $fields: JournalEntryAddRefundFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n  ) {\n    journalEntryAddRefund(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n    ) {\n      id\n      __typename\n      refunds {\n        ...JournalEntryRefund_1Fragment\n      }\n    }\n  }\n  ","\n"]);return dn=function(){return e},e}var sn=me()(dn(),Ie);const mn=function(){var e=x()(U().mark((function e(n,t,r){var a,l,o,i,u,c;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0,d=r.paymentMethod.value[r.paymentMethod.value.length-1],o="string"==typeof d?{paymentMethod:"",paymentMethodAdd:{parent:r.paymentMethod.value[r.paymentMethod.value.length-2].id,refId:d,name:d,active:!1}}:{paymentMethod:d.id,paymentMethodAdd:null},i=o.paymentMethod,u=o.paymentMethodAdd,c={id:t,fields:{date:r.date.value,description:(null===(a=r.description)||void 0===a?void 0:a.trim())?r.description.trim():null,paymentMethod:i,total:r.total.value,reconciled:null!==(l=r.reconciled)&&void 0!==l?l:null},paymentMethodAdd:u},e.next=4,n.mutate({mutation:sn,variables:c});case 4:case"end":return e.stop()}var d}),e)})));return function(n,t,r){return e.apply(this,arguments)}}();var pn,fn=t(6479),vn=t.n(fn),yn=t(87827),En=t(63430),bn=t(39291),hn=t(12274),gn=t(83863),On=t(23855),Zn=t(37950),wn=function(e){return function(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return{inputValue:n,value:e.apply(void 0,[n].concat(r))}}};!function(e){e[e.NOTIFICATION=0]="NOTIFICATION",e[e.ERROR=1]="ERROR",e[e.FATAL_ERROR=2]="FATAL_ERROR"}(pn||(pn={}));var Cn=function(){var e=(0,Xe.u6)(),n=e.setStatus,t=e.status,a=(0,r.useCallback)((function(e){t?e&&!Object.keys(e).some((function(n){return e[n]!==t[n]}))||n(e):e&&n(e)}),[n,t]);return[null!=t?t:null,a]};function Rn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Mn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Rn(Object(t),!0).forEach((function(n){d()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Rn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var An={inputMode:"numeric"},kn={tabIndex:-1},jn=wn((function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];var r=n[0],a=n[1];return r&&(0,hn.Z)(r)?(0,gn.Z)(r):a||""}));const _n=function(e){var n,t,a,l=e.autoFocus,o=void 0!==l&&l,i=e.disabled,u=void 0!==i&&i,c=e.maxDate,d=void 0===c?new Date:c,s=e.minDate,m=e.variant,p=void 0===m?"filled":m,f=vn()(e,["variant"]),v=(0,Xe.u6)().isSubmitting,y=(0,r.useCallback)((function(e){var n=((null==e?void 0:e.value)||"").trim();if(!n)return"Date is Required";var t=(0,On.Z)(n);return(0,hn.Z)(t)?s&&t<s?"Cannot be before ".concat((0,pe.default)(s,"MM/dd/yyyy")):d<t?"Cannot be after ".concat((0,pe.default)(d,"MM/dd/yyyy")):void 0:"Invalid Date"}),[s,d]),E=(0,Xe.U$)({name:"date",validate:y}),b=q()(E,3),h=b[0],g=b[1],O=b[2],Z=null!==(t=null===(n=h.value)||void 0===n?void 0:n.inputValue)&&void 0!==t?t:null,w=g.error,C=g.touched,R=O.setValue,M=O.setTouched,A=null===(a=g.initialValue)||void 0===a?void 0:a.inputValue,k=(0,r.useMemo)((function(){return A&&(0,hn.Z)(A)?A:new Date}),[A]),j=(0,r.useMemo)((function(){return{autoFocus:o}}),[o]),_=(0,r.useRef)(!1),S=(0,r.useCallback)((function(){return setTimeout((function(){_.current||M(!0)}),0)}),[M,_]),I=(0,r.useCallback)((function(){return _.current=!0}),[_]),D=(0,r.useCallback)((function(){_.current=!1,S()}),[_,S]),F=(0,r.useCallback)((function(e,n){R(jn(e&&(0,hn.Z)(e)?(0,Zn.Z)([new Date,e]):e,n))}),[R]),T=Cn(),x=q()(T,1)[0],P=(0,r.useMemo)((function(){return Mn(Mn({},h),{},{disabled:v||u||(null==x?void 0:x.type)===pn.FATAL_ERROR,value:Z,error:C&&!!w,helperText:C?w:void 0,animateYearScrolling:!0,disableToolbar:!0,disableFuture:!0,inputVariant:p,variant:"inline",format:"MM/dd/yyyy",margin:"none",label:"Date",initialFocusedDate:k,autoOk:!0,InputProps:j,inputProps:An,placeholder:"mm/dd/yyyy",KeyboardButtonProps:kn,onBlur:S,onOpen:I,onClose:D,onChange:F})}),[Z,k,S,w,p,j,v,h,I,D,F,C,u,x]);return r.createElement(yn.M,{utils:bn.default},r.createElement(En.e,Object.assign({maxDate:d},f,P)))};var Sn=t(39803);const In=function(e){var n,t=e.autoFocus,a=void 0!==t&&t,l=e.disabled,o=void 0!==l&&l,i=e.variant,u=void 0===i?"filled":i,c=vn()(e,["autoFocus","disabled","variant"]),d=(0,Xe.U$)({name:"description"}),s=q()(d,3),m=s[0],p=s[2].setValue,f=(0,r.useCallback)((function(e){var n,t;p((null===(t=null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.value)||void 0===t?void 0:t.trimLeft())||null)}),[p]),v=(0,r.useMemo)((function(){return{type:"text",autoFocus:a}}),[a]),y=Cn(),E=q()(y,1)[0];return r.createElement(Sn.Z,Object.assign({},c,m,{disabled:o||(null==E?void 0:E.type)===pn.FATAL_ERROR,onChange:f,value:null!==(n=m.value)&&void 0!==n?n:"",variant:u,label:"Description",name:"description",InputProps:v}))};var Dn=t(7397),Fn=(t(50008),function(e){return{n:Math.abs(e.n),d:Math.abs(e.d),s:-1===e.s?A.Neg:A.Pos}}),Tn=function(e){return new(ye())({n:e.s===A.Neg?-Math.abs(e.n):Math.abs(e.n),d:Math.abs(e.d)})},xn={min:"0.00",step:"0.01"},Pn=wn((function(e){return"string"!=typeof e||e.trim()?Fn(new(ye())(e).round(2)):Fn(new(ye())(0))}));const $n=function(e){var n,t,a=e.autoFocus,l=void 0!==a&&a,o=e.disabled,i=void 0!==o&&o,u=e.variant,c=void 0===u?"filled":u,d=e.maxTotal,s=void 0===d?new(ye())(Number.MAX_SAFE_INTEGER):d,m=e.minTotal,p=void 0===m?new(ye())(0):m,f=vn()(e,["autoFocus","disabled","variant","maxTotal","minTotal"]),v=new(ye())(1,100).compare(p)>0?new(ye())(1,100):p,y=(0,r.useCallback)((function(e){var n,t;if(!e||null===(t=null===(n=e.inputValue)||void 0===n?void 0:n.trim())||void 0===t||!t)return"Total Required";var r=Tn(e.value);return Number.isNaN(Number.parseInt(e.inputValue))?"Invalid Number":r.compare(s)>0?"Cannot be greater than ".concat(J()(s.valueOf()).format("$0,0.00")):0===r.compare(new(ye())(0))?"Cannot be 0":r.compare(v)<0?"Cannot be less than ".concat(J()(v.valueOf()).format("$0,0.00")):void 0}),[v,s]),E=(0,Xe.U$)({name:"total",validate:y}),b=q()(E,3),h=b[0],g=b[1],O=b[2].setValue,Z=null!==(t=null===(n=h.value)||void 0===n?void 0:n.inputValue)&&void 0!==t?t:"",w=g.error,C=g.touched,R=(0,r.useMemo)((function(){return{type:"number",autoFocus:l,startAdornment:r.createElement(Dn.Z,{position:"start"},"$")}}),[l]),M=(0,r.useCallback)((function(e){var n,t;O(Pn((null===(t=null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.value)||void 0===t?void 0:t.toString())||""))}),[O]),A=(0,r.useMemo)((function(){var e=new(ye())(Number.MAX_SAFE_INTEGER),n=new(ye())(1,100);return C&&w?w:0!==s.compare(e)&&v.compare(n)>0?"Max ".concat(J()(s.valueOf()).format("$0,0.00")," & Min ").concat(J()(v.valueOf()).format("$0,0.00")):0!==s.compare(e)?"Max ".concat(J()(s.valueOf()).format("$0,0.00")):v.compare(n)>0?"Min ".concat(J()(v.valueOf()).format("$0,0.00")):""}),[C,w,s,v]),k=Cn(),j=q()(k,1)[0];return r.createElement(Sn.Z,Object.assign({},f,h,{disabled:i||(null==j?void 0:j.type)===pn.FATAL_ERROR,type:"number",value:Z,error:C&&!!w,helperText:A,placeholder:"0.00",label:"Total",name:"total",required:!0,variant:c,inputProps:xn,InputProps:R,onChange:M}))};var Nn=t(30553),qn=t(13258),Ln={type:"checkbox"};const Un=function(e){var n,t=e.label,a=e.disabled,l=void 0!==a&&a,o=vn()(e,["label","disabled"]),i=(0,Xe.U$)({name:"reconciled",type:"checkbox"}),u=q()(i,1)[0],c=null!==(n=u.value)&&void 0!==n&&n,d=Cn(),s=q()(d,1)[0];return t?r.createElement(Nn.Z,Object.assign({},o,u,{value:c,disabled:l||(null==s?void 0:s.type)===pn.FATAL_ERROR,label:"Reconcile",control:r.createElement(qn.Z,{inputProps:Ln})})):r.createElement(qn.Z,Object.assign({},o,u,{value:c,disabled:l||(null==s?void 0:s.type)===pn.FATAL_ERROR,inputProps:Ln}))};var Bn=t(71267);function Wn(){var e=D()(["\n  fragment PayMethodEntryOptFragment on PaymentMethod {\n    __typename\n    id\n    refId\n    name\n    active\n    parent {\n      __typename\n      id\n    }\n  }\n"]);return Wn=function(){return e},e}function Vn(){var e=D()(["\n  fragment SrcEntryBizOptFragment on Business {\n    __typename\n    id\n    name\n    vendor {\n      approved\n      vendorId\n    }\n    departments {\n      ...SrcEntryDeptOptFragment\n    }\n  }\n  ","\n"]);return Vn=function(){return e},e}function Jn(){var e=D()(["\n  fragment SrcEntryDeptOptFragment on Department {\n    __typename\n    id\n    name\n    parent {\n      ... on Business {\n        __typename\n        id\n      }\n      ... on Department {\n        __typename\n        id\n      }\n    }\n  }\n"]);return Jn=function(){return e},e}function Gn(){var e=D()(["\n  fragment SrcEntryPersonOptFragment on Person {\n    __typename\n    id\n    personName: name {\n      first\n      last\n    }\n  }\n"]);return Gn=function(){return e},e}function zn(){var e=D()(["\n  fragment CatEntryOptFragment on JournalEntryCategory {\n    __typename\n    id\n    name\n    type\n    parent {\n      __typename\n      id\n    }\n  }\n"]);return zn=function(){return e},e}function Yn(){var e=D()(["\n  fragment DeptEntryOptFragment on Department {\n    __typename\n    id\n    name\n    budgets {\n      id\n      __typename\n      fiscalYear {\n        __typename\n        id\n      }\n    }\n    parent {\n      __typename\n      ... on Business {\n        id\n      }\n      ... on Department {\n        id\n      }\n    }\n  }\n"]);return Yn=function(){return e},e}function Qn(){var e=D()(["\n  query FiscalYear($date: String) {\n    fiscalYears(where: { hasDate: { eq: $date } }) {\n      __typename\n      id\n    }\n  }\n"]);return Qn=function(){return e},e}var Kn=me()(Qn()),Xn=me()(Yn()),Hn=me()(zn()),et=me()(Gn()),nt=me()(Jn()),tt=me()(Vn(),nt),rt=me()(Wn()),at=t(486);function lt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ot(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?lt(Object(t),!0).forEach((function(n){d()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):lt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function it(){var e=D()(["\n  query PayMethodEntryOpts($where: PaymentMethodWhereInput!) {\n    paymentMethods(where: $where) {\n      ...PayMethodEntryOptFragment\n    }\n  }\n  ","\n"]);return it=function(){return e},e}var ut=me()(it(),rt),ct=function(e){var n,t,r=null!==(n=null==e?void 0:e.value)&&void 0!==n?n:[],a=r.length,l=r[a-1],o=r[a-2];if(void 0===l)return"Method Required";if("string"==typeof l){if((null==o?void 0:o.id)===xe&&!(null!==(t=l.match(/[0-9]/g))&&void 0!==t?t:[]).join(""))return"Check # Required"}else if(l.id===xe)return"Check # Required"},dt=function(e){return"string"==typeof e?e:e.name},st=function(e,n){var t=e.length-1;return e.map((function(a,l){var o,i,u=t===l,c=n({index:l}),d=c.key,s=vn()(c,["key"]),m=e[l-1],p="string"==typeof a;switch(null==m?void 0:m.id){case xe:o="CK-"+(p?a:a.name);break;default:o=dt(a)}if(u){if(!p)switch(a.id){case xe:i=r.createElement("span",null,"CK-")}}else i=r.createElement(Le.Z,{fontSize:"small"});return r.createElement(ee.Z,{key:d,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},r.createElement(Bn.Z,Object.assign({color:u?"primary":"default",variant:u?"default":"outlined",label:o,size:"medium"},s,{disabled:!u}))," ",i)}))};const mt=function(e){var n,t,a,o,i,u=e.disabled,c=void 0!==u&&u,d=vn()(e,["disabled"]),s=(0,r.useState)(!1),m=q()(s,2),p=m[0],f=m[1],v=(0,Xe.U$)({name:"paymentMethod",validate:ct}),y=q()(v,3),E=y[0],b=y[1],h=y[2],g=E.onBlur,O=null!==(t=null===(n=E.value)||void 0===n?void 0:n.value)&&void 0!==t?t:[],Z=null!==(o=null===(a=E.value)||void 0===a?void 0:a.inputValue)&&void 0!==o?o:"",w=b.error,C=b.touched,R=h.setValue,M=null!==(i=O[O.length-1])&&void 0!==i?i:null,A=(0,r.useMemo)((function(){return null===M?{where:{hasParent:!1}}:{where:{parent:{eq:M.id}}}}),[M]),k=Cn(),j=q()(k,2),_=j[0],S=j[1],I=(0,r.useCallback)((function(e){S({msg:e.message,type:pn.FATAL_ERROR})}),[S]),D=(0,l.useQuery)(ut,{skip:"string"==typeof M,variables:A,onError:I}),F=D.loading,T=D.error,x=D.data,P=(0,r.useMemo)((function(){return(null==x?void 0:x.paymentMethods)&&"string"!=typeof M&&(null==M?void 0:M.id)!==xe?x.paymentMethods:[]}),[x,M]),$=P.length>0,N=(0,r.useMemo)((function(){var e;return(null===(e=M)||void 0===e?void 0:e.id)===xe}),[M]),L=(0,r.useMemo)((function(){return!$&&!N}),[$,N]),U=(0,r.useMemo)((function(){var e;return"string"==typeof M||(null===(e=M)||void 0===e?void 0:e.id)===xe?"Check #":"Payment Method"}),[M]),B=(0,r.useMemo)((function(){var e;return(null===(e=M)||void 0===e?void 0:e.id)===xe?{type:"number"}:{}}),[M]),W=(0,r.useMemo)((function(){var e;return(null===(e=M)||void 0===e?void 0:e.id)===xe?{min:"0",step:"1"}:{}}),[M]),V=(0,r.useCallback)((function(e){var n,t;e.InputProps=ot(ot({},null!==(n=e.InputProps)&&void 0!==n?n:{}),B),e.inputProps=ot(ot({},null!==(t=e.inputProps)&&void 0!==t?t:{}),W);var a=T?T.message:C?w:void 0;return r.createElement(Sn.Z,Object.assign({},d,e,{variant:d.variant||"filled",error:C&&!!w||!!T,helperText:a,name:"paymentMethod",label:U}))}),[d,C,T,w,U,B,W]),J=(0,r.useCallback)((function(){return f(!0)}),[f]),G=(0,r.useCallback)((function(e){f(!1),e.persist(),setTimeout((function(){g(e)}),0)}),[f,g]),z=(0,r.useCallback)((function(e,n){R({inputValue:Z,value:n})}),[R,Z]),Y=(0,r.useCallback)((function(e,n){n=(n||"").trimStart(),L||R({inputValue:n,value:O})}),[R,O,L]),Q=(0,r.useMemo)((function(){return{value:O,disabled:!!T||F||(null==_?void 0:_.type)===pn.FATAL_ERROR||c,multiple:!0,options:P,renderInput:V,renderTags:st,freeSolo:N,getOptionLabel:dt,onChange:z,onInputChange:Y,inputValue:L?"":Z,onFocus:J,onBlur:G,open:p&&$&&(null==_?void 0:_.type)!==pn.FATAL_ERROR,loading:F,autoSelect:!0,name:"paymentMethod"}}),[P,O,V,N,z,Y,Z,L,J,G,p,$,F,T,c,_]);return r.createElement(at.ZP,Object.assign({},Q))};var pt=t(95477),ft=t(59114);const vt=function(e){var n=(0,He.Z)(),t=e.opacity,a=void 0===t?.62:t,l=vn()(e,["opacity"]);return r.createElement(ee.Z,Object.assign({},l,{overflow:"auto",position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",width:"100%",top:"0px",bottom:"0px",bgcolor:(0,ft.fade)(n.palette.background.paper,a)}))},yt=function(e){return r.createElement(vt,Object.assign({},e),r.createElement(pt.Z,null))};function Et(){var e=D()(["\n  fragment JournalEntry_2Fragment on JournalEntry {\n    __typename\n    id\n    date\n    type\n    total {\n      n\n      d\n      s\n    }\n    refunds {\n      id\n      __typename\n      deleted\n      total {\n        n\n        d\n        s\n      }\n    }\n  }\n"]);return Et=function(){return e},e}var bt=me()(Et());function ht(){var e=D()(["\n  query GetEntryRefundInfo_1($id: ID!) {\n    journalEntry(id: $id) {\n      ...JournalEntry_2Fragment\n    }\n  }\n  ","\n"]);return ht=function(){return e},e}var gt=me()(ht(),bt),Ot=Symbol(),Zt=function(e){var n,t,a,o,i=e.entryId,u=e.open,c=e.onClose,d=e.onExited,s=e.handleSubmit,m=(0,Xe.u6)(),p=m.resetForm,f=m.isSubmitting,v=m.isValid,y=Cn(),E=q()(y,2),b=E[0],h=E[1],g=(0,r.useCallback)((function(e){return h({msg:e.message,type:pn.FATAL_ERROR})}),[h]),O=(0,l.useQuery)(gt,{skip:!i,variables:{id:i},onError:g}),Z=O.loading,w=O.error,C=O.data,M=null===(n=null==C?void 0:C.journalEntry)||void 0===n?void 0:n.total,A=(null===(t=null==C?void 0:C.journalEntry)||void 0===t?void 0:t.refunds)||[],k=(0,r.useMemo)((function(){if(M){var e=A.reduce((function(e,n){var t=n.deleted,r=n.total;return t?e:e.add(Tn(r))}),new(ye())(0));return Tn(M).sub(e)}return new(ye())(Number.MAX_SAFE_INTEGER)}),[M,A]),j=null===(a=null==C?void 0:C.journalEntry)||void 0===a?void 0:a.date,_=(0,r.useMemo)((function(){return j?new Date(j):void 0}),[j]),S=(0,r.useCallback)((function(){d(),p(),h(null)}),[p,d,h]),I=(0,r.useMemo)((function(){return!b||b.type!==pn.FATAL_ERROR&&b.type!==pn.ERROR?[null,null]:[b.msg,b.type===pn.FATAL_ERROR]}),[b]),D=q()(I,2),F=D[0],T=D[1],x=null===(o=null==C?void 0:C.journalEntry)||void 0===o?void 0:o.type,P=(0,r.useMemo)((function(){var e=Z||w||(null!=x?x:Ot)===Ot?"Refund":"".concat(x===R.Credit?"Give":"Add"," Refund");return T?"Fatal Error":Z?"Loading ".concat(e,"..."):f?"Submitting ".concat(e):e}),[Z,w,x,T,f]),$=(0,He.Z)();return r.createElement(en.Z,{open:u,onClose:c,onExited:S,disableBackdropClick:f,disableEscapeKeyDown:f,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:s}},r.createElement(nn.Z,{style:F?{color:$.palette.error.main}:void 0},P),r.createElement(ee.Z,{position:"relative"},(Z||f)&&!F&&r.createElement(yt,{zIndex:"modal"}),!!F&&T&&r.createElement(vt,{opacity:.78,zIndex:"modal",padding:2},r.createElement(tn.Z,{color:"error"},F)),r.createElement(rn.Z,{dividers:!0},!!F&&!T&&r.createElement(tn.Z,{color:"error"},F),r.createElement(an.Z,{container:!0,spacing:2},r.createElement(an.Z,{item:!0,lg:4,sm:6,xs:12},r.createElement(_n,{minDate:_,disabled:Z||f,fullWidth:!0})),r.createElement(an.Z,{item:!0,lg:4,sm:6,xs:12},r.createElement(In,{disabled:Z||f,fullWidth:!0})),r.createElement(an.Z,{item:!0,lg:4,sm:6,xs:12},r.createElement(mt,{disabled:Z||f,fullWidth:!0})),r.createElement(an.Z,{item:!0,lg:4,sm:6,xs:12},r.createElement($n,{disabled:Z||f,fullWidth:!0,maxTotal:k})),r.createElement(an.Z,{item:!0,container:!0,justify:"center",alignItems:"flex-start",lg:4,md:6,sm:12},r.createElement(Un,{disabled:Z||f,label:!0}))))),r.createElement(ln.Z,null,!T&&r.createElement(on.Z,{disabled:Z||f||!v,type:"submit",startIcon:r.createElement(un.Z,null),color:"primary",variant:"contained"},"Add"),r.createElement(on.Z,{disabled:Z||f,color:T?"primary":"default",startIcon:!T&&r.createElement(cn.Z,null),onClick:c},T?"Ok":"Cancel")))};const wt=function(e){var n=e.entryId,t=e.open,a=e.onClose,o=e.onExited,i=(0,r.useMemo)((function(){return{}}),[]),u=(0,l.useApolloClient)(),c=(0,r.useCallback)(function(){var e=x()(U().mark((function e(t,r){var l;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r.setStatus(null),e.next=4,mn(u,n||"",t,r);case 4:a(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),r.setStatus({msg:null!==(l=e.t0.message)&&void 0!==l?l:"".concat(e.t0),type:pn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,t){return e.apply(this,arguments)}}(),[u,n,a]),d=(0,r.useCallback)((function(e){return r.createElement(Zt,{entryId:n,open:t,onClose:a,onExited:o,handleSubmit:e.handleSubmit})}),[n,t,a,o]);return r.createElement(Xe.J9,{initialValues:i,initialStatus:null,enableReinitialize:!0,onSubmit:c},d)};var Ct=t(96843);function Rt(){var e=D()(["\n  mutation UpdateRefund(\n    $id: ID!\n    $fields: JournalEntryUpdateRefundFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $paymentMethodUpdate: JournalEntryUpdatePaymentMethod\n  ) {\n    journalEntryUpdateRefund(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      paymentMethodUpdate: $paymentMethodUpdate\n    ) {\n      id\n      __typename\n      refunds {\n        ...JournalEntryRefund_1Fragment\n      }\n    }\n  }\n  ","\n"]);return Rt=function(){return e},e}var Mt=me()(Rt(),Ie);const At=function(){var e=x()(U().mark((function e(n,t,r,a){var l,o,i,u,c,d,s,m;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,Ct.Z)(t.date.inputValue,a.date.inputValue)?null:a.date.value,u=a.description!==t.description?null!==(o=null===(l=a.description)||void 0===l?void 0:l.trim())&&void 0!==o?o:"":null,c=0===Tn(a.total.value).compare(Tn(t.total.value))?null:a.total.value,d=a.reconciled===t.reconciled?null:a.reconciled,void 0,void 0,void 0,void 0,void 0,p=t.paymentMethod.value[t.paymentMethod.value.length-1],f=a.paymentMethod.value.slice(-2).reverse(),y=(v=q()(f,2))[0],E=v[1],s="string"==typeof y?p.parent&&p.parent.id===xe?{paymentMethod:null,paymentMethodAdd:null,paymentMethodUpdate:{id:p.id,fields:{active:null,refId:y,name:y}}}:{paymentMethod:null,paymentMethodAdd:{parent:E.id,refId:y,name:y,active:!1},paymentMethodUpdate:null}:y.id!==p.id?{paymentMethod:y.id,paymentMethodAdd:null,paymentMethodUpdate:null}:{paymentMethod:null,paymentMethodAdd:null,paymentMethodUpdate:null},m={id:r,fields:{date:i,description:u,total:c,reconciled:d,paymentMethod:s.paymentMethod},paymentMethodAdd:s.paymentMethodAdd,paymentMethodUpdate:s.paymentMethodUpdate},e.next=8,n.mutate({mutation:Mt,variables:m});case 8:case"end":return e.stop()}var p,f,v,y,E}),e)})));return function(n,t,r,a){return e.apply(this,arguments)}}();function kt(){var e=D()(["\n  query UpdateRefundIniState($entryId: ID!, $refundId: ID!) {\n    journalEntry(id: $entryId) {\n      ...JournalEntry_2Fragment\n    }\n    journalEntryRefund(id: $refundId) {\n      __typename\n      id\n      date\n      description\n      paymentMethod {\n        ...PayMethodEntryOptFragment\n        ancestors {\n          ...PayMethodEntryOptFragment\n        }\n      }\n      total {\n        n\n        d\n        s\n      }\n      reconciled\n    }\n  }\n  ","\n  ","\n"]);return kt=function(){return e},e}var jt=me()(kt(),bt,rt),_t=function(e){var n=e.refundId,t=e.open,a=e.onClose,l=e.onExited,o=e.journalEntry,i=e.loading,u=e.handleSubmit,c=(0,Xe.u6)(),d=c.resetForm,s=c.isSubmitting,m=c.isValid,p=Cn(),f=q()(p,2),v=f[0],y=f[1],E=null==o?void 0:o.total,b=(null==o?void 0:o.refunds)||[],h=(0,r.useMemo)((function(){if(E){var e=b.reduce((function(e,t){var r=t.id,a=t.deleted,l=t.total;return a||r===n?e:e.add(Tn(l))}),new(ye())(0));return Tn(E).sub(e)}return new(ye())(Number.MAX_SAFE_INTEGER)}),[E,b,n]),g=null==o?void 0:o.date,O=(0,r.useMemo)((function(){return g?new Date(g):void 0}),[g]),Z=(0,r.useCallback)((function(){l(),d(),y(null)}),[d,l,y]),w=(0,r.useMemo)((function(){return!v||v.type!==pn.FATAL_ERROR&&v.type!==pn.ERROR?[null,null]:[v.msg,v.type===pn.FATAL_ERROR]}),[v]),C=q()(w,2),R=C[0],M=C[1],A=(0,r.useMemo)((function(){var e="Refund Update";return M?"Fatal Error":i?"Loading ".concat(e,"..."):s?"Submitting ".concat(e):e}),[i,M,s]),k=(0,He.Z)();return r.createElement(en.Z,{open:t,onClose:a,onExited:Z,disableBackdropClick:s,disableEscapeKeyDown:s,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:u}},r.createElement(nn.Z,{style:R?{color:k.palette.error.main}:void 0},A),r.createElement(ee.Z,{position:"relative"},(i||s)&&!R&&r.createElement(yt,{zIndex:"modal"}),!!R&&M&&r.createElement(vt,{opacity:.78,zIndex:"modal",padding:2},r.createElement(tn.Z,{color:"error"},R)),r.createElement(rn.Z,{dividers:!0},!!R&&!M&&r.createElement(tn.Z,{color:"error"},R),r.createElement(an.Z,{container:!0,spacing:2},r.createElement(an.Z,{item:!0,lg:4,sm:6,xs:12},r.createElement(_n,{minDate:O,disabled:i||s||!!M,fullWidth:!0})),r.createElement(an.Z,{item:!0,lg:4,sm:6,xs:12},r.createElement(In,{disabled:i||s||!!M,fullWidth:!0})),r.createElement(an.Z,{item:!0,lg:4,sm:6,xs:12},r.createElement(mt,{disabled:i||s||!!M,fullWidth:!0})),r.createElement(an.Z,{item:!0,lg:4,sm:6,xs:12},r.createElement($n,{disabled:i||s||!!M,fullWidth:!0,maxTotal:h})),r.createElement(an.Z,{item:!0,container:!0,justify:"center",alignItems:"flex-start",lg:4,md:6,sm:12},r.createElement(Un,{disabled:i||s||!!M,label:!0}))))),r.createElement(ln.Z,null,!M&&r.createElement(on.Z,{disabled:i||s||!m,type:"submit",startIcon:r.createElement(un.Z,null),color:"primary",variant:"contained"},"Update"),r.createElement(on.Z,{disabled:i||s||!!M,color:M?"primary":"default",startIcon:!M&&r.createElement(cn.Z,null),onClick:a},M?"Ok":"Cancel")))};const St=function(e){var n=e.entryId,t=e.refundId,a=e.open,o=e.onClose,i=e.onExited,u=(0,l.useQuery)(jt,{skip:!n,variables:{entryId:n,refundId:t}}),c=u.loading,d=u.error,s=u.data,m=(0,r.useMemo)((function(){return d?{msg:d.message,type:pn.FATAL_ERROR}:null}),[d]),p=null==s?void 0:s.journalEntryRefund,f=(0,r.useMemo)((function(){var e,n,t,r,a;return p?{date:{inputValue:new Date(p.date),value:p.date},paymentMethod:(n=p.paymentMethod,t=n.ancestors,r=vn()(n,["ancestors"]),a=$()(t).sort((function(e,n){var t,r;return e.id===(null===(t=n.parent)||void 0===t?void 0:t.id)?-1:n.id===(null===(r=e.parent)||void 0===r?void 0:r.id)?1:0})),a.push(r),{inputValue:"",value:a}),total:{inputValue:Tn(p.total).round(2).toString(),value:p.total},reconciled:p.reconciled,description:null!==(e=p.description)&&void 0!==e?e:null}:{}}),[p]),v=(0,l.useApolloClient)(),y=(0,r.useCallback)(function(){var e=x()(U().mark((function e(n,r){var a;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=5;break}return r.setStatus({msg:'Failed to load initial values for refund "'.concat(t,'".'),type:pn.FATAL_ERROR}),e.abrupt("return");case 5:if(t){e.next=8;break}return r.setStatus({msg:"No refund ID.",type:pn.FATAL_ERROR}),e.abrupt("return");case 8:return e.prev=8,r.setStatus(null),e.next=12,At(v,f,t,n,r);case 12:o(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),r.setStatus({msg:null!==(a=null===e.t0||void 0===e.t0?void 0:e.t0.message)&&void 0!==a?a:"".concat(e.t0),type:pn.FATAL_ERROR});case 18:case"end":return e.stop()}}),e,null,[[8,15]])})));return function(n,t){return e.apply(this,arguments)}}(),[v,f,o,t]),E=(0,r.useCallback)((function(e){var l;return r.createElement(_t,{entryId:n,refundId:t,open:a,onClose:o,onExited:i,journalEntry:null!==(l=null==s?void 0:s.journalEntry)&&void 0!==l?l:null,loading:c,handleSubmit:e.handleSubmit})}),[s,n,c,o,i,a,t]);return r.createElement(Xe.J9,{initialValues:null!=f?f:{},initialStatus:m,enableReinitialize:!0,onSubmit:y},E)};var It=t(8769),Dt=t(41906);function Ft(){var e=D()(["\n  mutation AddEntry(\n    $fields: JournalEntryAddFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $personAdd: PersonAddFields\n    $businessAdd: BusinessAddFields\n  ) {\n    journalEntryAdd(\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      personAdd: $personAdd\n      businessAdd: $businessAdd\n    ) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return Ft=function(){return e},e}var Tt=me()(Ft(),Fe);const xt=function(){var e=x()(U().mark((function e(n,t){var r,a,l,o,i,u,c,d,s,m;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0,p=t.paymentMethod.value[t.paymentMethod.value.length-1],l="string"==typeof p?{paymentMethod:"",paymentMethodAdd:{parent:t.paymentMethod.value[t.paymentMethod.value.length-2].id,refId:p,name:p,active:!1}}:{paymentMethod:p.id,paymentMethodAdd:null},o=l.paymentMethod,i=l.paymentMethodAdd,u=function(){var e=t.source.value[0],n=t.source.value[t.source.value.length-1];if("string"==typeof n){if(e===M.Person){var r=(0,Dt.parseName)(n);return{source:{sourceType:M.Person,id:""},businessAdd:null,personAdd:{name:{first:r.firstName,last:r.lastName}}}}return{source:{sourceType:M.Business,id:""},businessAdd:{name:n},personAdd:null}}return{source:{sourceType:function(){switch(n.__typename){case"Business":return M.Business;case"Department":return M.Department;case"Person":return M.Person}}(),id:n.id},personAdd:null,businessAdd:null}}(),c=u.source,d=u.personAdd,s=u.businessAdd,m={fields:{date:t.date.value,dateOfRecord:null,department:t.department.id,type:t.type,category:t.category.value[t.category.value.length-1].id,description:(null===(r=t.description)||void 0===r?void 0:r.trim())||null,total:t.total.value,reconciled:null!==(a=t.reconciled)&&void 0!==a?a:null,paymentMethod:o,source:c},paymentMethodAdd:i,personAdd:d,businessAdd:s},e.next=5,n.mutate({mutation:Tt,variables:m});case 5:case"end":return e.stop()}var p}),e)})));return function(n,t){return e.apply(this,arguments)}}();function Pt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function $t(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Pt(Object(t),!0).forEach((function(n){d()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Pt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Nt(){var e=D()(["\n  query CatEntryOpts($where: JournalEntryCategoryWhereInput!) {\n    catOpts: journalEntryCategories(where: $where) {\n      ...CatEntryOptFragment\n    }\n  }\n  ","\n"]);return Nt=function(){return e},e}var qt=me()(Nt(),Hn),Lt=function(e){return e.name},Ut=function(e,n){var t=e.length-1;return e.map((function(e,a){var l=t===a,o=n({index:a}),i=o.key,u=vn()(o,["key"]);return r.createElement(ee.Z,{key:i,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},r.createElement(Bn.Z,Object.assign({color:l?"primary":"default",variant:l?"default":"outlined",label:e.name,size:"medium"},u,{disabled:!l}))," ",!l&&r.createElement(Le.Z,{fontSize:"small"}))}))},Bt=Symbol();const Wt=function(e){var n,t,a,o,i,u,c=(0,Xe.u6)(),d=e.disabled,s=void 0!==d&&d,m=e.required,p=e.entryType,f=vn()(e,["entryType"]),v=(null===(t=null===(n=c.values)||void 0===n?void 0:n.category)||void 0===t?void 0:t.value)||[],y=(null===(o=null===(a=c.values)||void 0===a?void 0:a.category)||void 0===o?void 0:o.inputValue.trimLeft())||"",E=null!==(u=null!=p?p:null===(i=c.values)||void 0===i?void 0:i.type)&&void 0!==u?u:null,b=v[v.length-1],h=(0,r.useMemo)((function(){return(null==b?void 0:b.id)?{where:{parent:{eq:b.id},type:{eq:E}}}:{where:{hasParent:!1,type:{eq:E}}}}),[b,E]),g=Cn(),O=q()(g,2),Z=O[0],w=O[1],C=(0,r.useCallback)((function(e){w({msg:e.message,type:pn.FATAL_ERROR})}),[w]),R=(0,l.useQuery)(qt,{skip:(null!=E?E:Bt)===Bt,variables:h,onCompleted:function(){return setTimeout((function(){return c.validateField("category")}),0)},onError:C}),M=R.loading,A=R.error,k=R.data,j=null==k?void 0:k.catOpts,_=(0,r.useMemo)((function(){return j||[]}),[j]),S=(0,r.useCallback)((function(e){var n=(null==e?void 0:e.value)||[];return n[n.length-1]?_.length>0?"Sub-category Required":void 0:m?"Category Required":void 0}),[_,m]),I=(0,Xe.U$)({name:"category",validate:S}),D=q()(I,3),F=D[0],T=D[1],x=D[2],P=F.onBlur,$=T.error,N=T.touched,L=x.setValue;(0,r.useEffect)((function(){b&&E!==b.type&&L({inputValue:"",value:[]})}),[E,b,L]);var U=(0,r.useMemo)((function(){return $&&N?$:(null!=E?E:Bt)===Bt?"Category requires entry type.":A?A.message:""}),[E,$,N,A]),B=(0,r.useMemo)((function(){return M||(null==Z?void 0:Z.type)===pn.FATAL_ERROR||(null!=E?E:Bt)===Bt||s||v.length>0&&0===_.length}),[s,E,Z,M,_.length,v.length]),W=(0,r.useCallback)((function(e){return r.createElement(Sn.Z,Object.assign({},f,{variant:f.variant||"filled"},e,{error:N&&!!$||!!A,disabled:B,helperText:U,name:"category",label:"Category"}))}),[f,N,$,A,B,U]),V=(0,r.useState)(!1),J=q()(V,2),G=J[0],z=J[1],Y=(0,r.useCallback)((function(){return z(!0)}),[z]),Q=(0,r.useCallback)((function(e){z(!1),e.persist(),setTimeout((function(){P(e)}),0)}),[z,P]),K=(0,r.useCallback)((function(e,n){L({inputValue:y,value:n})}),[L,y]),X=(0,r.useCallback)((function(e,n){n=(n||"").trimStart(),L({inputValue:n,value:v})}),[L,v]),H=(0,r.useMemo)((function(){return $t($t({},F),{},{open:G&&_.length>0,onFocus:Y,onBlur:Q,options:_,renderTags:Ut,forcePopupIcon:!1,disabled:B,value:v,renderInput:W,loading:M,autoSelect:!0,multiple:!0,getOptionLabel:Lt,onInputChange:X,inputValue:y,onChange:K,name:"category"})}),[F,G,_,Y,Q,M,B,v,W,X,y,K]);return r.createElement(at.ZP,Object.assign({},H))};function Vt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Jt(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Vt(Object(t),!0).forEach((function(n){d()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Vt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Gt(){var e=D()(["\n  query DeptEntryOpts($bizId: ID!) {\n    deptOpts: business(id: $bizId) {\n      __typename\n      id\n      departments {\n        ...DeptEntryOptFragment\n      }\n    }\n  }\n  ","\n"]);return Gt=function(){return e},e}var zt=me()(Gt(),Xn),Yt=function(e){return e.name},Qt=function(e,n){var t=e.length-1;return e.map((function(e,a){var l=t===a,o=n({index:a}),i=o.key,u=vn()(o,["key"]);return r.createElement(ee.Z,{key:i,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},r.createElement(Bn.Z,Object.assign({color:l?"primary":"default",variant:l?"default":"outlined",label:e.name,size:"medium"},u,{disabled:!l}))," ",!l&&r.createElement(Le.Z,{fontSize:"small"}))}))};const Kt=function(e){var n=e.disabled,t=void 0!==n&&n,a=e.required,o=e.fiscalYearId,i=vn()(e,["disabled","required","fiscalYearId"]),u="string"==typeof o,c=Cn(),d=q()(c,2),s=d[0],m=d[1],p=(0,r.useCallback)((function(e){m({msg:e.message,type:pn.FATAL_ERROR})}),[m]),f=(0,l.useQuery)(zt,{onError:p,variables:{bizId:"5dc4b09bcf96e166daaa0090"}}),v=f.loading,y=f.error,E=f.data,b=(null==E?void 0:E.deptOpts.departments)||[],h=(0,r.useState)(!1),g=q()(h,2),O=g[0],Z=g[1],w=(0,r.useState)(""),C=q()(w,2),R=C[0],M=C[1],A=(0,r.useCallback)((function(e){return e?u?e.budgets.every((function(e){return e.fiscalYear.id!==o}))?"Department has no budget.":void 0:b.some((function(n){var t=n.parent;return"Department"===t.__typename&&t.id===e.id}))?"Sub-department Required":void 0:a?"Department Required":void 0}),[b,a,u,o]),k=(0,Xe.U$)({name:"department",validate:A}),j=q()(k,3),_=j[0],S=j[1],I=j[2],D=_.value,F=_.onBlur,T=S.error,x=S.touched,P=I.setValue,$=(0,r.useMemo)((function(){return!!D&&!D.budgets.every((function(e){return e.fiscalYear.id!==o}))}),[D,o]),N=(0,r.useMemo)((function(){return new Map(b.reduce((function(e,n){return e.push([n.id,n]),e}),[]))}),[b]),L=(0,r.useMemo)((function(){if(!D)return[];for(var e=[D],n=D.parent,t=n.__typename,r=n.id;"Business"!==t&&N.has(r);){var a=N.get(r);e.unshift(a);var l=a.parent;t=l.__typename,r=l.id}return e}),[D,N]),U=(0,r.useMemo)((function(){var e,n=null===(e=L[L.length-1])||void 0===e?void 0:e.id;return b.filter((function(e){return n?e.parent.id===n:"Business"===e.parent.__typename}))}),[b,L]),B=(0,r.useMemo)((function(){return L.length>0&&0===U.length}),[L,U]),W=(0,r.useMemo)((function(){return T&&x?T:y?y.message:""===o?"Department requires a date.":""}),[T,x,y,o]),V=(0,r.useMemo)((function(){return v||B||(null==s?void 0:s.type)===pn.FATAL_ERROR||t||u&&!o}),[B,t,s,v,u,o]),J=(0,r.useCallback)((function(n){return r.createElement(Sn.Z,Object.assign({},i,{required:u?!$:!!e.required,variant:e.variant||"filled"},n,{error:x&&!!T,helperText:W,name:"department",label:"Department",disabled:V}))}),[e,x,T,W,i,V,u,$]),G=(0,r.useCallback)((function(){return Z(!0)}),[Z]),z=(0,r.useCallback)((function(e){Z(!1),F(e)}),[Z,F]),Y=(0,r.useCallback)((function(e,n){if(n)if(Array.isArray(n)){var t=n.length;P(0===t?null:n[t-1])}else P(n);else P(null)}),[P]),Q=(0,r.useCallback)((function(e,n){M((n||"").trimStart())}),[M]),K=(0,r.useMemo)((function(){return Jt(Jt({},_),{},{open:O&&U.length>0,onFocus:G,onBlur:z,options:U,renderTags:Qt,forcePopupIcon:!1,disabled:V,value:L,renderInput:J,loading:v,autoSelect:!1,multiple:!0,getOptionLabel:Yt,onChange:Y,onInputChange:Q,inputValue:B?"":R,name:"department"})}),[_,O,U,G,z,B,V,L,J,v,Y,Q,R]);return y?r.createElement("pre",null,JSON.stringify(y,null,2)):r.createElement(at.ZP,Object.assign({},K))};var Xt=t(36359);function Ht(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function er(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Ht(Object(t),!0).forEach((function(n){d()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ht(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function nr(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return tr(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?tr(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function tr(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function rr(){var e=D()(["\n  query SrcEntryOpts($name: String!, $isBiz: Boolean!) {\n    businesses(where: { name: { pattern: $name, options: I } })\n      @include(if: $isBiz) {\n      ...SrcEntryBizOptFragment\n    }\n    people(\n      where: {\n        or: [\n          { firstName: { pattern: $name, options: I } }\n          { lastName: { pattern: $name, options: I } }\n        ]\n      }\n    ) @skip(if: $isBiz) {\n      ...SrcEntryPersonOptFragment\n    }\n  }\n  ","\n  ","\n  ","\n"]);return rr=function(){return e},e}var ar=me()(rr(),et,tt,nt),lr=function(e){switch(e){case M.Business:case M.Department:case M.Person:break;default:return"string"==typeof e}return!1},or=function(e){switch(e){case M.Business:return"Vendor";case M.Department:return"Department";case M.Person:return"Person";default:if("string"==typeof e)return e}return"Person"===e.__typename?"".concat(e.personName.first," ").concat(e.personName.last):e.name},ir=function(e,n){var t=e.length-1;return e.map((function(e,a){var l=t===a,o=n({index:a}),i=o.key,u=vn()(o,["key"]);return lr(e)?e:r.createElement(ee.Z,{key:i,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},r.createElement(Bn.Z,Object.assign({color:l?"primary":"default",variant:l?"default":"outlined",label:or(e),size:"medium"},u,{disabled:!l}))," ",!l&&r.createElement(Le.Z,{fontSize:"small"}))}))},ur=function(e,n){var t=n.inputValue,r=new RegExp("(^|\\s)".concat(t),"i");return e.filter((function(e){return r.test(or(e))}))},cr=function(e){var n,t=(null==e?void 0:e.value)||[],r=null!==(n=t[0])&&void 0!==n?n:null,a=t.length>1?t[t.length-1]:null;if(null===r||null===a||""===a)return"Source Required";if(lr(a)&&r===M.Person){var l=(0,Dt.parseName)(a);if(!l.firstName.trim())return"First Name Required";if(!l.lastName.trim())return"Last Name Required"}};const dr=function(e){var n,t,a,o,i,u=e.disabled,c=void 0!==u&&u,d=(0,r.useState)(!1),s=q()(d,2),m=s[0],p=s[1],f=(0,Xe.U$)({name:"source",validate:cr}),v=q()(f,3),y=v[0],E=v[1],b=v[2],h=y.onBlur,g=null!==(t=null===(n=y.value)||void 0===n?void 0:n.value)&&void 0!==t?t:[],O=null!==(o=null===(a=y.value)||void 0===a?void 0:a.inputValue)&&void 0!==o?o:"",Z=E.error,w=E.touched,C=b.setValue,R=null!==(i=g[0])&&void 0!==i?i:null,A=g.length>1?g[g.length-1]:null,k=(0,r.useRef)(""),j=Cn(),_=q()(j,2),S=_[0],I=_[1],D=(0,r.useCallback)((function(e){I({msg:e.message,type:pn.FATAL_ERROR})}),[I]),F=(0,l.useQuery)(ar,{skip:!k.current&&!g[1],variables:{name:k.current,isBiz:R!==M.Person},onError:D}),T=F.loading,x=F.error,P=F.data,$=(0,r.useMemo)((function(){var e,n=new Map,t=nr((null==P?void 0:P.businesses)||[]);try{for(t.s();!(e=t.n()).done;){var r,a=nr(e.value.departments);try{for(a.s();!(r=a.n()).done;){var l=r.value;n.set(l.id,l)}}catch(e){a.e(e)}finally{a.f()}}}catch(e){t.e(e)}finally{t.f()}return n}),[P]),N=(0,r.useMemo)((function(){if(null===R)return[M.Business,M.Person];if(R===M.Person)return null===A&&(null==P?void 0:P.people)||[];if(!A)return(null==P?void 0:P.businesses)||[];if("string"==typeof A)return[];var e,n=[],t=nr($.values());try{for(t.s();!(e=t.n()).done;){var r=e.value;r.parent.__typename===A.__typename&&r.parent.id===A.id&&n.push(r)}}catch(e){t.e(e)}finally{t.f()}return n}),[R,P,$,A]),L=(0,r.useMemo)((function(){return null!==R&&null===A}),[R,A]),U=(0,r.useMemo)((function(){return g.length>0&&0===N.length&&!L}),[g,N,L]),B=(0,r.useMemo)((function(){return null===R?"Source Type":R===M.Person?"Person Name":1===g.length?"Vendor":2===g.length&&N.length>0?"Department":N.length>0?"Sub-Department":"Vendor"}),[g,N,R]),W=(0,r.useMemo)((function(){return c||U||(null==S?void 0:S.type)===pn.FATAL_ERROR}),[U,c,S]),V=(0,r.useCallback)((function(n){var t;return A&&"string"!=typeof A&&"Person"!==A.__typename&&0===N.length&&(n=er(er({},n),{},{inputProps:er(er({},(null==n?void 0:n.inputProps)||{}),{},{style:er(er({},(null===(t=null==n?void 0:n.inputProps)||void 0===t?void 0:t.style)||{}),{},{display:"none"})})})),r.createElement(Sn.Z,Object.assign({},e,{variant:e.variant||"filled"},n,{error:w&&!!Z,helperText:w?Z:void 0,name:"source",label:B,disabled:W}))}),[A,N.length,e,w,Z,B,W]),J=(0,r.useCallback)((function(){return p(!0)}),[p]),G=(0,r.useCallback)((function(e){p(!1),e.persist(),setTimeout((function(){return h(e)}),0)}),[p,h]),z=(0,r.useCallback)((function(e,n){var t=n.length-1,r=n[t];if(lr(r)){var a,l=[],o=nr(r.split(" "));try{for(o.s();!(a=o.n()).done;){var i=a.value;i&&(Xt.checkName(i)&&(i=Xt(i)),l.push(i))}}catch(e){o.e(e)}finally{o.f()}var u=l.join(" ").trim();n[t]=u.charAt(0).toUpperCase()+u.substring(1)}C({inputValue:O,value:n})}),[C,O]),Y=(0,r.useCallback)((function(e,n){n=(n||"").trimStart(),U||C({inputValue:n,value:g}),null!==R&&null===A&&n&&(k.current=n[0].toLowerCase())}),[C,R,A,g,U,k]),Q=(0,r.useMemo)((function(){return er(er({},y),{},{inputValue:U?"":O,open:m&&N.length>0,onFocus:J,onBlur:G,options:N,renderTags:ir,forcePopupIcon:!1,freeSolo:L,value:g,renderInput:V,loading:T,autoSelect:!0,multiple:!0,getOptionLabel:or,onInputChange:Y,onChange:z,filterOptions:ur,name:"source",disabled:W})}),[y,U,O,m,N,J,G,L,g,V,T,Y,z,W]);return x?r.createElement("pre",null,JSON.stringify(x,null,2)):r.createElement(at.ZP,Object.assign({},Q))};var sr=t(26663),mr=t(5391),pr=t(16954),fr=t(59203),vr=t(868),yr=t(64436),Er=t(30585);function br(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function hr(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?br(Object(t),!0).forEach((function(n){d()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):br(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var gr=Symbol(),Or=function(e){if((null!=e?e:gr)===gr)return"Type Required"};const Zr=function(e){var n=e.disabled,t=void 0!==n&&n,a=Cn(),l=q()(a,1)[0],o=e.label,i=void 0!==o&&o,u=(0,Xe.u6)().isSubmitting,c=(0,Xe.U$)({name:"type",validate:Or}),d=q()(c,3),s=d[0],m=d[1],p=d[2],f=m.error,v=m.touched,y=p.setValue,E=p.setTouched,b=(0,r.useMemo)((function(){return hr(hr({size:"small",exclusive:!0,disabled:u},s),{},{onChange:(e=x()(U().mark((function e(n,t){return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null!=t?t:gr)!==gr){e.next=2;break}return e.abrupt("return");case 2:return y(t),e.next=5,new Promise((function(e){return setTimeout(e,0)}));case 5:E(!0);case 6:case"end":return e.stop()}}),e)}))),function(n,t){return e.apply(this,arguments)})});var e}),[s,u,y,E]),h=u||t||(null==l?void 0:l.type)===pn.FATAL_ERROR,g=(0,r.useMemo)((function(){return r.createElement(ee.Z,{pl:1,clone:!0},r.createElement(sr.Z,Object.assign({},e,b),r.createElement(mr.Z,{disabled:h,value:R.Credit},r.createElement(vr.ZP,{arrow:!0,placement:"top",title:"Credit"},r.createElement(pr.Z,null))),r.createElement(mr.Z,{disabled:h,value:R.Debit},r.createElement(vr.ZP,{arrow:!0,placement:"top",title:"Debit"},r.createElement(fr.Z,null)))))}),[e,b,h]);return i?r.createElement(yr.Z,null,r.createElement(Nn.Z,Object.assign({},e,{labelPlacement:"boolean"==typeof i?void 0:i,control:g,label:"Type"})),v&&!!f&&r.createElement(Er.Z,{error:!0},f)):r.createElement(yr.Z,null,g,!!f&&r.createElement(Er.Z,{error:!0},f))};function wr(){var e=D()(["\n  query DeptIniValueForAddEntry($id: ID!) {\n    department(id: $id) {\n      ...DeptEntryOptFragment\n    }\n  }\n  ","\n"]);return wr=function(){return e},e}var Cr={item:!0,lg:4,sm:6,xs:12},Rr=me()(wr(),Xn),Mr=function(e){var n=e.open,t=e.onClose,a=e.loading,o=(0,Xe.u6)(),i=o.resetForm,u=o.isSubmitting,c=o.isValid,d=o.submitForm,s=o.values.date,m=Cn(),p=q()(m,2),f=p[0],v=p[1],y=(0,r.useCallback)((function(e){v({msg:e.message,type:pn.FATAL_ERROR})}),[v]),E=(0,l.useQuery)(Kn,{skip:!(null==s?void 0:s.inputValue),variables:{date:(null==s?void 0:s.value)||""},onError:y}).data,b=(0,r.useMemo)((function(){var e,n;return null!==(n=null===(e=null==E?void 0:E.fiscalYears[0])||void 0===e?void 0:e.id)&&void 0!==n?n:""}),[E]),h=(0,r.useMemo)((function(){return!f||f.type!==pn.FATAL_ERROR&&f.type!==pn.ERROR?[null,null]:[f.msg,f.type===pn.FATAL_ERROR]}),[f]),g=q()(h,2),O=g[0],Z=g[1],w=(0,r.useCallback)((function(){i(),v(null)}),[i,v]),C=(0,r.useMemo)((function(){return Z?"Fatal Error":u?"Submitting Add Entry...":a?"Loading Add Entry...":"Add Entry"}),[Z,u,a]),R=(0,He.Z)(),M=(0,r.useCallback)(x()(U().mark((function e(){var n;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v(null),e.next=4,d();case 4:t(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),v({msg:null!==(n=e.t0.message)&&void 0!==n?n:"".concat(e.t0),type:pn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[d,t,v]),A=(0,r.useCallback)(x()(U().mark((function e(){var n;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v(null),e.next=4,d();case 4:i(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),v({msg:null!==(n=e.t0.message)&&void 0!==n?n:"".concat(e.t0),type:pn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[d,i,v]),k=(0,r.useCallback)((function(e){return e.preventDefault()}),[]);return r.createElement(en.Z,{open:n,onClose:t,onExited:w,disableBackdropClick:u,disableEscapeKeyDown:u,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:k}},r.createElement(nn.Z,{style:O?{color:R.palette.error.main}:void 0},C),r.createElement(ee.Z,{position:"relative"},(u||a)&&!O&&r.createElement(yt,{zIndex:"modal"}),!!O&&Z&&r.createElement(vt,{opacity:.78,zIndex:"modal",padding:2},r.createElement(tn.Z,{color:"error"},O)),r.createElement(rn.Z,{dividers:!0},!!O&&!Z&&r.createElement(tn.Z,{color:"error"},O),r.createElement(an.Z,{container:!0,spacing:2},r.createElement(an.Z,Object.assign({},Cr,{justify:"center",container:!0}),r.createElement(Zr,{style:{margin:R.spacing(1)},label:"start",disabled:a||u||!!Z})),r.createElement(an.Z,Object.assign({},Cr),r.createElement(_n,{disabled:a||u||!!Z,fullWidth:!0})),r.createElement(an.Z,Object.assign({},Cr),r.createElement(dr,{disabled:a||u||!!Z,fullWidth:!0})),r.createElement(an.Z,Object.assign({},Cr),r.createElement(Wt,{disabled:a||u||!!Z,fullWidth:!0,required:!0})),r.createElement(an.Z,Object.assign({},Cr),r.createElement(Kt,{disabled:a||u||!!Z,fullWidth:!0,required:!0,fiscalYearId:b})),r.createElement(an.Z,Object.assign({},Cr),r.createElement(In,{disabled:a||u||!!Z,fullWidth:!0})),r.createElement(an.Z,Object.assign({},Cr),r.createElement(mt,{disabled:a||u||!!Z,fullWidth:!0})),r.createElement(an.Z,Object.assign({},Cr),r.createElement($n,{disabled:a||u||!!Z,fullWidth:!0})),r.createElement(an.Z,Object.assign({container:!0,justify:"center",alignItems:"flex-start"},Cr),r.createElement(Un,{disabled:a||u||!!Z,label:!0}))))),r.createElement(ln.Z,null,!Z&&r.createElement(r.Fragment,null,r.createElement(on.Z,{onClick:M,disabled:a||u||!c,type:"submit",startIcon:r.createElement(un.Z,null),color:"primary",variant:"contained"},"Add"),r.createElement(on.Z,{onClick:A,disabled:a||u||!c,type:"submit",startIcon:r.createElement(It.Z,null),variant:"outlined"},"Add & New")),r.createElement(on.Z,{disabled:u,color:Z?"primary":"default",startIcon:!Z&&r.createElement(cn.Z,null),onClick:t},Z?"Ok":"Cancel")))};const Ar=function(e){var n=e.open,t=e.onClose,a=e.deptId,o=(0,l.useQuery)(Rr,{skip:!a,variables:{id:a}}),i=o.loading,u=o.error,c=o.data,d=null==c?void 0:c.department,s=(0,r.useMemo)((function(){return d?{department:d}:{}}),[d]),m=(0,r.useMemo)((function(){return u?{msg:u.message,type:pn.FATAL_ERROR}:null}),[u]),p=(0,l.useApolloClient)(),f=(0,r.useCallback)((function(e,n){return xt(p,e,n)}),[p]),v=(0,r.useCallback)((function(){return r.createElement(Mr,{open:n,onClose:t,loading:i})}),[n,t,i]);return r.createElement(Xe.J9,{initialValues:s,initialStatus:m,enableReinitialize:!0,onSubmit:f},v)};function kr(){var e=D()(["\n  mutation UpdateEntry(\n    $id: ID!\n    $fields: JournalEntryUpdateFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $paymentMethodUpdate: JournalEntryUpdatePaymentMethod\n    $personAdd: PersonAddFields\n    $businessAdd: BusinessAddFields\n  ) {\n    journalEntryUpdate(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      paymentMethodUpdate: $paymentMethodUpdate\n      personAdd: $personAdd\n      businessAdd: $businessAdd\n    ) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return kr=function(){return e},e}var jr=Symbol(),_r=me()(kr(),Fe);const Sr=function(){var e=x()(U().mark((function e(n,t,r,a){var l,o,i,u,c,d,s,m,p,f,v,y,E,b,h,g,O,Z;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(){var e,n,r,l,o=null!==(n=null===(e=a.category.value[a.category.value.length-1])||void 0===e?void 0:e.id)&&void 0!==n?n:null;return o===(null!==(l=null===(r=t.category.value[t.category.value.length-1])||void 0===r?void 0:r.id)&&void 0!==l?l:null)?null:o}(),i=(0,Ct.Z)(t.date.inputValue,a.date.inputValue)?null:a.date.value,u=function(){var e,n,r,l,o,i,u,c,d,s,m,p,f,v,y,E,b,h,g,O={};return(0,Ct.Z)(null!==(r=null===(n=null===(e=null==t?void 0:t.dateOfRecord)||void 0===e?void 0:e.date)||void 0===n?void 0:n.inputValue)&&void 0!==r?r:0,null!==(i=null===(o=null===(l=null==a?void 0:a.dateOfRecord)||void 0===l?void 0:l.date)||void 0===o?void 0:o.inputValue)&&void 0!==i?i:0)||(O.date=null!==(d=null===(c=null===(u=null==a?void 0:a.dateOfRecord)||void 0===u?void 0:u.date)||void 0===c?void 0:c.value)&&void 0!==d?d:null),(null===(s=null==t?void 0:t.dateOfRecord)||void 0===s?void 0:s.overrideFiscalYear)!==(null===(m=null==a?void 0:a.dateOfRecord)||void 0===m?void 0:m.overrideFiscalYear)&&(O.overrideFiscalYear=null!==(f=null===(p=null==a?void 0:a.dateOfRecord)||void 0===p?void 0:p.overrideFiscalYear)&&void 0!==f?f:null),(null===(v=null==t?void 0:t.dateOfRecord)||void 0===v?void 0:v.clear)!==(null===(y=null==a?void 0:a.dateOfRecord)||void 0===y?void 0:y.clear)&&(O.clear=null!==(b=null===(E=null==a?void 0:a.dateOfRecord)||void 0===E?void 0:E.clear)&&void 0!==b?b:null),O.date||(null!==(h=O.clear)&&void 0!==h?h:jr)!==jr||(null!==(g=O.overrideFiscalYear)&&void 0!==g?g:jr)!==jr?O:null}(),c=a.department.id===t.department.id?null:a.department.id,d=(null===(l=a.description)||void 0===l?void 0:l.trim())&&a.description!==t.description?a.description.trim():null,s=0===Tn(a.total.value).compare(Tn(t.total.value))?null:a.total.value,m=a.type===t.type?null:a.type,p=a.reconciled===t.reconciled?null:a.reconciled,void 0,void 0,void 0,void 0,void 0,w=t.paymentMethod.value[t.paymentMethod.value.length-1],C=a.paymentMethod.value.slice(-2).reverse(),A=(R=q()(C,2))[0],k=R[1],f="string"==typeof A?w.parent&&w.parent.id===xe?{paymentMethod:null,paymentMethodAdd:null,paymentMethodUpdate:{id:w.id,fields:{active:null,refId:A,name:A}}}:{paymentMethod:null,paymentMethodAdd:{parent:k.id,refId:A,name:A,active:!1},paymentMethodUpdate:null}:A.id!==w.id?{paymentMethod:A.id,paymentMethodAdd:null,paymentMethodUpdate:null}:{paymentMethod:null,paymentMethodAdd:null,paymentMethodUpdate:null},v=f.paymentMethod,y=f.paymentMethodAdd,E=f.paymentMethodUpdate,b=function(){var e=a.source.value[0],n=a.source.value[a.source.value.length-1],r=t.source.value[0],l=t.source.value[t.source.value.length-1];if("string"==typeof n){if(e===M.Person){var o=(0,Dt.parseName)(n);return{source:{sourceType:M.Person,id:""},businessAdd:null,personAdd:{name:{first:o.firstName,last:o.lastName}}}}return{source:{sourceType:M.Business,id:""},businessAdd:{name:n},personAdd:null}}return e===r&&n.id===l.id?{source:null,businessAdd:null,personAdd:null}:{source:{sourceType:function(){switch(n.__typename){case"Business":return M.Business;case"Department":return M.Department;case"Person":return M.Person}}(),id:n.id},personAdd:null,businessAdd:null}}(),h=b.source,g=b.personAdd,O=b.businessAdd,Z={id:r,fields:{category:o,date:i,dateOfRecord:u,department:c,description:d,total:s,type:m,source:h,reconciled:p,paymentMethod:v},paymentMethodAdd:y,paymentMethodUpdate:E,personAdd:g,businessAdd:O},e.next=13,n.mutate({mutation:_r,variables:Z});case 13:case"end":return e.stop()}var w,C,R,A,k}),e)})));return function(n,t,r,a){return e.apply(this,arguments)}}();var Ir=t(9570);function Dr(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Fr(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Dr(Object(t),!0).forEach((function(n){d()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Dr(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Tr={inputMode:"numeric"},xr={tabIndex:-1},Pr=wn((function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];var r=n[0],a=n[1];return r&&(0,hn.Z)(r)?(0,gn.Z)(r):a||""})),$r=function(e){var n,t,a,l,o,i=e.autoFocus,u=void 0!==i&&i,c=e.disabled,d=void 0!==c&&c,s=e.maxDate,m=void 0===s?new Date:s,p=e.minDate,f=e.variant,v=void 0===f?"filled":f,y=vn()(e,["variant"]),E=(0,Xe.u6)().isSubmitting,b=(0,r.useCallback)((function(e){var n=((null==e?void 0:e.value)||"").trim();if(n){var t=(0,On.Z)(n);if(!(0,hn.Z)(t))return"Invalid Date";if(p&&t<p)return"Cannot be before ".concat((0,pe.default)(p,"MM/dd/yyyy"));if(m<t)return"Cannot be after ".concat((0,pe.default)(m,"MM/dd/yyyy"))}}),[p,m]),h=(0,Xe.U$)({name:"dateOfRecord",validate:b}),g=q()(h,3),O=g[0],Z=g[1],w=g[2],C=O.value,R=null!==(t=null===(n=null==C?void 0:C.date)||void 0===n?void 0:n.value)&&void 0!==t?t:null,M=Z.error,A=Z.touched,k=w.setValue,j=w.setTouched,_=null===(l=null===(a=Z.initialValue)||void 0===a?void 0:a.date)||void 0===l?void 0:l.inputValue,S=(0,r.useMemo)((function(){return _&&(0,hn.Z)(_)?_:new Date}),[_]),I=(0,r.useMemo)((function(){return{autoFocus:u}}),[u]),D=(0,r.useRef)(!1),F=(0,r.useCallback)((function(){return setTimeout((function(){D.current||j(!0)}),0)}),[j,D]),T=(0,r.useCallback)((function(){return D.current=!0}),[D]),x=(0,r.useCallback)((function(){D.current=!1,F()}),[D,F]),P=(0,r.useCallback)((function(e,n){k({date:Pr(e&&(0,hn.Z)(e)?(0,Zn.Z)([new Date,e]):e,n),clear:!e,overrideFiscalYear:!!e&&(null==C?void 0:C.overrideFiscalYear)})}),[k,C]),$=(0,r.useCallback)((function(e,n){k(Fr(Fr({},C),{},{overrideFiscalYear:n}))}),[C,k]),N=Cn(),L=q()(N,1)[0],U=(0,r.useMemo)((function(){return Fr(Fr({},O),{},{disabled:E||d||(null==L?void 0:L.type)===pn.FATAL_ERROR,value:R,error:A&&!!M,helperText:A?M:void 0,animateYearScrolling:!0,disableToolbar:!0,disableFuture:!0,inputVariant:v,variant:"inline",format:"MM/dd/yyyy",margin:"none",label:"Date of Record",initialFocusedDate:S,autoOk:!0,InputProps:I,inputProps:Tr,placeholder:"mm/dd/yyyy",KeyboardButtonProps:xr,onBlur:F,onOpen:T,onClose:x,onChange:P})}),[R,S,F,M,v,I,E,O,T,x,P,A,d,L]);return r.createElement(an.Z,{container:!0,direction:"row",justify:"center",alignItems:"center"},r.createElement(ee.Z,{flexGrow:"1",marginRight:1,clone:!0},r.createElement(an.Z,{item:!0},r.createElement(yn.M,{utils:bn.default},r.createElement(En.e,Object.assign({maxDate:m},y,U))))),r.createElement(an.Z,{item:!0},r.createElement(vr.ZP,{title:"Override fiscal year with date of record."},r.createElement(Nn.Z,{label:"As Year",disabled:!R||E||d||(null==L?void 0:L.type)===pn.FATAL_ERROR,control:r.createElement(Ir.Z,{checked:null!==(o=null==C?void 0:C.overrideFiscalYear)&&void 0!==o&&o,name:"overrideFiscalYear",onChange:$})}))))};function Nr(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return qr(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?qr(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function qr(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Lr(){var e=D()(["\n  query UpdateEntryIniState($id: ID!) {\n    journalEntry(id: $id) {\n      id\n      __typename\n      type\n      date\n      dateOfRecord {\n        date\n        overrideFiscalYear\n      }\n      department {\n        ...DeptEntryOptFragment\n      }\n      category {\n        ...CatEntryOptFragment\n        ancestors {\n          ...CatEntryOptFragment\n        }\n      }\n      source {\n        ...SrcEntryPersonOptFragment\n        ...SrcEntryBizOptFragment\n        ...SrcEntryDeptOptFragment\n        ... on Department {\n          ancestors {\n            ...SrcEntryDeptOptFragment\n            ...SrcEntryBizOptFragment\n          }\n        }\n      }\n      paymentMethod {\n        ...PayMethodEntryOptFragment\n        ancestors {\n          ...PayMethodEntryOptFragment\n        }\n      }\n      description\n      total {\n        n\n        d\n        s\n      }\n      refunds {\n        id\n        __typename\n        deleted\n        date\n        total {\n          n\n          d\n          s\n        }\n      }\n      reconciled\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n"]);return Lr=function(){return e},e}var Ur=me()(Lr(),Xn,Hn,et,tt,nt,rt),Br=new Date(864e13),Wr={item:!0,lg:4,sm:6,xs:12},Vr=function(e){var n=e.open,t=e.onClose,a=e.onExited,o=e.journalEntry,i=e.loading,u=e.handleSubmit,c=(0,Xe.u6)(),d=c.resetForm,s=c.isSubmitting,m=c.isValid,p=c.values,f=p.date,v=p.dateOfRecord,y=Cn(),E=q()(y,2),b=E[0],h=E[1],g=(0,r.useCallback)((function(e){h({msg:e.message,type:pn.FATAL_ERROR})}),[h]),O=(0,r.useMemo)((function(){var e,n,t;return(null==v?void 0:v.overrideFiscalYear)?null!==(n=null===(e=null==v?void 0:v.date)||void 0===e?void 0:e.value)&&void 0!==n?n:"":null!==(t=null==f?void 0:f.value)&&void 0!==t?t:""}),[f,v]),Z=(0,l.useQuery)(Kn,{skip:!O,variables:{date:O||""},returnPartialData:!0,onError:g}).data,w=(0,r.useMemo)((function(){var e,n,t;return null!==(t=null===(n=(null!==(e=null==Z?void 0:Z.fiscalYears)&&void 0!==e?e:[])[0])||void 0===n?void 0:n.id)&&void 0!==t?t:""}),[Z]),C=(null==o?void 0:o.refunds)||[],R=(0,r.useMemo)((function(){return C.reduce((function(e,n){var t=q()(e,2),r=t[0],a=t[1],l=n.deleted,o=n.total,i=n.date;return[l?r:r.add(Tn(o)),l?a:(0,Zn.Z)([a,new Date(i)])]}),[new(ye())(0),Br])}),[C]),M=q()(R,2),A=M[0],k=M[1],j=(0,r.useCallback)((function(){a(),d(),h(null)}),[d,a,h]),_=(0,r.useMemo)((function(){return!b||b.type!==pn.FATAL_ERROR&&b.type!==pn.ERROR?[null,null]:[b.msg,b.type===pn.FATAL_ERROR]}),[b]),S=q()(_,2),I=S[0],D=S[1],F=(0,r.useMemo)((function(){var e="Entry Update";return D?"Fatal Error":i?"Loading ".concat(e,"..."):s?"Submitting ".concat(e):e}),[i,D,s]),T=(0,He.Z)();return r.createElement(en.Z,{open:n,onClose:t,onExited:j,fullWidth:!0,disableBackdropClick:s,disableEscapeKeyDown:s,maxWidth:"lg",PaperProps:{component:"form",onSubmit:u}},r.createElement(nn.Z,{style:I?{color:T.palette.error.main}:void 0},F),r.createElement(ee.Z,{position:"relative"},(s||i)&&!I&&r.createElement(yt,{zIndex:"modal"}),!!I&&D&&r.createElement(vt,{opacity:.78,zIndex:"modal",padding:2},r.createElement(tn.Z,{color:"error"},I)),r.createElement(rn.Z,{dividers:!0},!!I&&!D&&r.createElement(tn.Z,{color:"error"},I),r.createElement(an.Z,{container:!0,spacing:2},r.createElement(an.Z,Object.assign({},Wr,{justify:"center",container:!0}),r.createElement(Zr,{style:{margin:T.spacing(1)},label:"start",disabled:s||i||!!D})),r.createElement(an.Z,Object.assign({},Wr),r.createElement(_n,{disabled:s||i||!!D,maxDate:k===Br?void 0:k,fullWidth:!0})),r.createElement(an.Z,Object.assign({},Wr),r.createElement($r,{disabled:s||i||!!D,fullWidth:!0})),r.createElement(an.Z,Object.assign({},Wr),r.createElement(dr,{disabled:s||i||!!D,fullWidth:!0})),r.createElement(an.Z,Object.assign({},Wr),r.createElement(Wt,{disabled:s||i||!!D,fullWidth:!0,required:!0})),r.createElement(an.Z,Object.assign({},Wr),r.createElement(Kt,{disabled:s||i||!!D,fullWidth:!0,required:!0,fiscalYearId:w})),r.createElement(an.Z,Object.assign({},Wr),r.createElement(In,{disabled:s||i||!!D,fullWidth:!0})),r.createElement(an.Z,Object.assign({},Wr),r.createElement(mt,{disabled:s||i||!!D,fullWidth:!0})),r.createElement(an.Z,Object.assign({},Wr),r.createElement($n,{disabled:s||i||!!D,minTotal:A,fullWidth:!0})),r.createElement(an.Z,Object.assign({container:!0,justify:"center",alignItems:"flex-start"},Wr),r.createElement(Un,{disabled:s||i||!!D,label:!0}))))),r.createElement(ln.Z,null,!D&&r.createElement(on.Z,{disabled:s||!m||i,type:"submit",startIcon:r.createElement(un.Z,null),color:"primary",variant:"contained"},"Update"),r.createElement(on.Z,{disabled:s,color:D?"primary":"default",startIcon:!D&&r.createElement(cn.Z,null),onClick:t},D?"Ok":"Cancel")))};const Jr=function(e){var n,t=e.entryId,a=e.open,o=e.onClose,i=e.onExited,u=(0,l.useQuery)(Ur,{skip:!t,variables:{id:t}}),c=u.loading,d=u.error,s=u.data,m=(0,r.useMemo)((function(){return d?{msg:d.message,type:pn.FATAL_ERROR}:null}),[d]),p=null==s?void 0:s.journalEntry,f=(0,r.useMemo)((function(){var e;if(!p)return{};var n={inputValue:new Date(p.date),value:p.date},t=p.dateOfRecord?{date:{inputValue:new Date(p.dateOfRecord.date),value:p.dateOfRecord.date},overrideFiscalYear:p.dateOfRecord.overrideFiscalYear,clear:!1}:null,r=function(){var e=p.category,n=e.ancestors,t=vn()(e,["ancestors"]),r=$()(n).sort((function(e,n){var t,r;return e.id===(null===(t=n.parent)||void 0===t?void 0:t.id)?-1:n.id===(null===(r=e.parent)||void 0===r?void 0:r.id)?1:0}));return r.push(t),{inputValue:"",value:r}}(),a=function(){var e=p.paymentMethod,n=e.ancestors,t=vn()(e,["ancestors"]),r=$()(n).sort((function(e,n){var t,r;return e.id===(null===(t=n.parent)||void 0===t?void 0:t.id)?-1:n.id===(null===(r=e.parent)||void 0===r?void 0:r.id)?1:0}));return r.push(t),{inputValue:"",value:r}}(),l={inputValue:Tn(p.total).round(2).toString(),value:p.total};return{date:n,dateOfRecord:t,category:r,paymentMethod:a,department:p.department,total:l,reconciled:p.reconciled,description:null!==(e=p.description)&&void 0!==e?e:null,type:p.type,source:function(){var e=[],n=null==p?void 0:p.source;switch(null==n?void 0:n.__typename){case"Person":e.push(M.Person,n);break;case"Business":e.push(M.Business,n);break;case"Department":e.push(M.Business);var t,r=[],a=Nr(n.ancestors);try{for(a.s();!(t=a.n()).done;){var l=t.value;"Business"===l.__typename?e.push(l):r.push(l.id)}}catch(e){a.e(e)}finally{a.f()}var o=e[1];if(r.length>0){var i,u=[],c=Nr(o.departments);try{for(c.s();!(i=c.n()).done;){var d=i.value;if(-1!==r.indexOf(d.id)&&u.push(d)===r.length)break}}catch(e){c.e(e)}finally{c.f()}u.sort((function(e,n){return e.id===n.parent.id||o.id||e.parent.id?-1:n.id===e.parent.id?1:0})),e.push.apply(e,u.concat([n]))}}return{inputValue:"",value:e}}()}}),[p]),v=(0,l.useApolloClient)(),y=(0,r.useCallback)(function(){var e=x()(U().mark((function e(n,r){var a;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r.setStatus(null),e.next=4,Sr(v,f,t,n,r);case 4:o(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),r.setStatus({msg:null!==(a=e.t0.message)&&void 0!==a?a:"".concat(e.t0),type:pn.ERROR});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,t){return e.apply(this,arguments)}}(),[v,f,t,o]),E=(0,r.useCallback)((function(e){return r.createElement(Vr,{open:a,onClose:o,onExited:i,loading:c,journalEntry:null!=p?p:null,handleSubmit:e.handleSubmit})}),[a,o,i,c,p]);return r.createElement(Xe.J9,{initialValues:f,initialStatus:m,journalEntry:null!==(n=null==s?void 0:s.journalEntry)&&void 0!==n?n:null,loading:c,onSubmit:y,enableReinitialize:!0},E)};function Gr(){var e=D()(["\n  mutation DeleteEntry($id: ID!) {\n    journalEntryDelete(id: $id) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return Gr=function(){return e},e}var zr=me()(Gr(),Fe);const Yr=function(e){var n=e.entryId,t=e.onClose,a=(0,l.useMutation)(zr),o=q()(a,2),i=o[0],u=o[1],c=u.loading,d=u.error,s=!!d,m=(0,r.useCallback)((function(){i({variables:{id:n}}).then((function(){return t()}))}),[n,i,t]),p=(0,r.useMemo)((function(){return s?"Error":c?"Deleting Entry...":"Delete Entry"}),[s,c]),f=(0,He.Z)();return r.createElement(en.Z,{open:!!n,maxWidth:"sm",fullWidth:!0,disableBackdropClick:c,disableEscapeKeyDown:c,onClose:t},r.createElement(nn.Z,{style:s?{color:f.palette.error.main}:void 0},p),r.createElement(ee.Z,{position:"relative"},c&&r.createElement(yt,{zIndex:"modal"}),r.createElement(rn.Z,null,s&&r.createElement(tn.Z,{color:"error"},null==d?void 0:d.message),!s&&r.createElement(tn.Z,null,"Are you sure you want to delete this entry?"))),r.createElement(ln.Z,null,!s&&r.createElement(on.Z,{disabled:c,onClick:m,startIcon:r.createElement(K.Z,null),color:"primary",variant:"contained"},"Delete"),r.createElement(on.Z,{disabled:c,startIcon:!s&&r.createElement(cn.Z,null),onClick:t},s?"Close":"Cancel")))};function Qr(){var e=D()(["\n  mutation DeleteRefund($id: ID!) {\n    journalEntryDeleteRefund(id: $id) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return Qr=function(){return e},e}var Kr=me()(Qr(),Fe);const Xr=function(e){var n=e.refundId,t=e.onClose,a=(0,l.useMutation)(Kr),o=q()(a,2),i=o[0],u=o[1],c=u.loading,d=u.error,s=!!d,m=(0,r.useCallback)((function(){i({variables:{id:n}}).then((function(){return t()}))}),[n,i,t]),p=(0,r.useMemo)((function(){return s?"Error":c?"Deleting Refund...":"Delete Refund"}),[s,c]),f=(0,He.Z)();return r.createElement(en.Z,{open:!!n,maxWidth:"sm",fullWidth:!0,disableBackdropClick:c,disableEscapeKeyDown:c,onClose:t},r.createElement(nn.Z,{style:s?{color:f.palette.error.main}:void 0},p),r.createElement(ee.Z,{position:"relative"},c&&r.createElement(yt,{zIndex:"modal"}),r.createElement(rn.Z,null,s&&r.createElement(tn.Z,{color:"error"},null==d?void 0:d.message),!s&&r.createElement(tn.Z,null,"Are you sure you want to delete this refund?"))),r.createElement(ln.Z,null,!s&&r.createElement(on.Z,{disabled:c,onClick:m,startIcon:r.createElement(K.Z,null),color:"primary",variant:"contained"},"Delete"),r.createElement(on.Z,{disabled:c,startIcon:!s&&r.createElement(cn.Z,null),onClick:t},s?"Close":"Cancel")))};var Hr=t(55517);function ea(){var e=D()(["\n  mutation AddEntryItem($id: ID!, $fields: JournalEntryAddItemFields!) {\n    journalEntryAddItem(id: $id, fields: $fields) {\n      journalEntry {\n        ...JournalEntry_1Fragment\n      }\n    }\n  }\n  ","\n"]);return ea=function(){return e},e}var na=me()(ea(),Fe);const ta=function(){var e=x()(U().mark((function e(n,t,r){var a,l,o,i,u;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=function(){var e,n,t,a=(null===(e=r.category)||void 0===e?void 0:e.value)||[];return null!==(t=null===(n=a[a.length-1])||void 0===n?void 0:n.id)&&void 0!==t?t:null}(),o=function(){var e;return(null===(e=r.department)||void 0===e?void 0:e.id)||null}(),i=r.units,u={id:t,fields:{units:i,category:l,department:o,description:(null===(a=r.description)||void 0===a?void 0:a.trim())||null,total:r.total.value}},e.next=6,n.mutate({mutation:na,variables:u});case 6:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}();var ra={min:"1",step:"1",type:"number"},aa=Symbol();const la=function(e){var n,t=e.autoFocus,a=void 0!==t&&t,l=e.disabled,o=void 0!==l&&l,i=e.variant,u=void 0===i?"filled":i,c=vn()(e,["autoFocus","disabled","variant"]),d=(0,r.useCallback)((function(e){return(null!=(e=e||null)?e:aa)===aa?"Units Required":0===e?"Cannot be 0":e<0?"Units must be 1 or greater":void 0}),[]),s=(0,Xe.U$)({name:"units",validate:d}),m=q()(s,3),p=m[0],f=m[1],v=m[2].setValue,y=null!==(n=p.value)&&void 0!==n?n:"",E=f.error,b=f.touched,h=Cn(),g=q()(h,1)[0],O=(0,r.useMemo)((function(){return{type:"number",autoFocus:a}}),[a]),Z=(0,r.useCallback)((function(e){var n,t=(null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.value)||0;v(Math.max("number"==typeof t?t:Number.parseInt(t),0))}),[v]);return r.createElement(Sn.Z,Object.assign({},c,p,{disabled:o||(null==g?void 0:g.type)===pn.FATAL_ERROR,type:"number",value:y,error:b&&!!E,helperText:b&&E?E:void 0,placeholder:"1",label:"Units",name:"units",required:!0,variant:u,inputProps:ra,InputProps:O,onChange:Z}))};function oa(){var e=D()(["\n  fragment JournalEntry_3Fragment on JournalEntry {\n    __typename\n    id\n    type\n    total {\n      n\n      d\n      s\n    }\n    date\n    items {\n      id\n      __typename\n      deleted\n      total {\n        n\n        d\n        s\n      }\n    }\n  }\n"]);return oa=function(){return e},e}var ia=me()(oa());function ua(){var e=D()(["\n  query GetEntryItemState_1($id: ID!) {\n    journalEntry(id: $id) {\n      ...JournalEntry_3Fragment\n    }\n  }\n  ","\n"]);return ua=function(){return e},e}var ca=me()(ua(),ia),da={item:!0,lg:4,sm:6,xs:12},sa=function(e){var n,t,a,o,i,u=e.entryId,c=e.open,d=e.onClose,s=e.onExited,m=(0,Xe.u6)(),p=m.resetForm,f=m.isSubmitting,v=m.isValid,y=m.submitForm,E=Cn(),b=q()(E,2),h=b[0],g=b[1],O=(0,r.useCallback)((function(e){return g({msg:e.message,type:pn.FATAL_ERROR})}),[g]),Z=(0,l.useQuery)(ca,{skip:!u,variables:{id:u},onError:O}),w=Z.loading,C=Z.data,R=(0,r.useCallback)((function(e){g({msg:e.message,type:pn.FATAL_ERROR})}),[g]),M=(null===(n=null==C?void 0:C.journalEntry)||void 0===n?void 0:n.date)||"",A=(0,l.useQuery)(Kn,{skip:!M,variables:{date:M},onError:R}).data,k=(0,r.useMemo)((function(){var e,n;return null!==(n=null===(e=null==A?void 0:A.fiscalYears[0])||void 0===e?void 0:e.id)&&void 0!==n?n:""}),[A]),j=null!==(a=null===(t=null==C?void 0:C.journalEntry)||void 0===t?void 0:t.type)&&void 0!==a?a:null,_=null===(o=null==C?void 0:C.journalEntry)||void 0===o?void 0:o.total,S=(null===(i=null==C?void 0:C.journalEntry)||void 0===i?void 0:i.items)||[],I=(0,r.useMemo)((function(){if(_){var e=S.reduce((function(e,n){var t=n.deleted,r=n.total;return t?e:e.add(Tn(r))}),new(ye())(0));return Tn(_).sub(e)}return new(ye())(Number.MAX_SAFE_INTEGER)}),[_,S]),D=(0,r.useCallback)((function(){s(),p(),g(null)}),[p,s,g]),F=(0,r.useMemo)((function(){return!h||h.type!==pn.FATAL_ERROR&&h.type!==pn.ERROR?[null,null]:[h.msg,h.type===pn.FATAL_ERROR]}),[h]),T=q()(F,2),P=T[0],$=T[1],N=(0,r.useMemo)((function(){var e="Add Item";return $?"Fatal Error":w?"Loading ".concat(e,"..."):f?"Submitting ".concat(e):e}),[w,$,f]),L=(0,He.Z)(),B=(0,r.useCallback)(x()(U().mark((function e(){var n;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g(null),e.next=4,y();case 4:d(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),g({msg:null!==(n=e.t0.message)&&void 0!==n?n:"".concat(e.t0),type:pn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[y,d,g]),W=(0,r.useCallback)(x()(U().mark((function e(){var n;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g(null),e.next=4,y();case 4:p(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),g({msg:null!==(n=e.t0.message)&&void 0!==n?n:"".concat(e.t0),type:pn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[y,p,g]),V=(0,r.useCallback)((function(e){return e.preventDefault()}),[]);return r.createElement(en.Z,{open:c,onClose:d,onExited:D,disableBackdropClick:f,disableEscapeKeyDown:f,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:V}},r.createElement(nn.Z,{style:P?{color:L.palette.error.main}:void 0},N),r.createElement(ee.Z,{position:"relative"},(w||f)&&!P&&r.createElement(yt,{zIndex:"modal"}),!!P&&$&&r.createElement(vt,{opacity:.78,zIndex:"modal",padding:2},r.createElement(tn.Z,{color:"error"},P)),r.createElement(rn.Z,{dividers:!0},!!P&&!$&&r.createElement(tn.Z,{color:"error"},P),r.createElement(an.Z,{container:!0,spacing:2},r.createElement(an.Z,Object.assign({},da),r.createElement($n,{disabled:w||f,fullWidth:!0,maxTotal:I})),r.createElement(an.Z,Object.assign({},da),r.createElement(la,{disabled:w||f,fullWidth:!0})),r.createElement(an.Z,Object.assign({},da),r.createElement(In,{disabled:w||f,fullWidth:!0})),r.createElement(an.Z,Object.assign({},da),r.createElement(Wt,{disabled:w||f||!!$,entryType:j,fullWidth:!0})),r.createElement(an.Z,Object.assign({},da),r.createElement(Kt,{disabled:w||f||!!$,fullWidth:!0,fiscalYearId:k}))))),r.createElement(ln.Z,null,!$&&r.createElement(r.Fragment,null,r.createElement(on.Z,{onClick:B,disabled:w||f||!v,type:"submit",startIcon:r.createElement(un.Z,null),color:"primary",variant:"contained"},"Add"),r.createElement(on.Z,{onClick:W,disabled:w||f||!v,type:"submit",startIcon:r.createElement(It.Z,null),variant:"outlined"},"Add & New")),r.createElement(on.Z,{disabled:w||f,color:$?"primary":"default",startIcon:!$&&r.createElement(cn.Z,null),onClick:d},$?"Ok":"Cancel")))};const ma=function(e){var n=e.entryId,t=e.open,a=e.onClose,o=e.onExited,i=(0,r.useMemo)((function(){return{}}),[]),u=(0,l.useApolloClient)(),c=(0,r.useCallback)((function(e,t){return ta(u,n||"",e,t)}),[u,n]),d=(0,r.useCallback)((function(e){return r.createElement(sa,{entryId:n,open:t,onClose:a,onExited:o,handleSubmit:e.handleSubmit})}),[n,t,a,o]);return r.createElement(Xe.J9,{initialValues:i,initialStatus:null,enableReinitialize:!0,onSubmit:c},d)};function pa(){var e=D()(["\n  mutation UpdateEntryItem($id: ID!, $fields: JournalEntryUpdateItemFields!) {\n    journalEntryUpdateItem(id: $id, fields: $fields) {\n      journalEntryItem {\n        ...JournalEntryItem_1Fragment\n      }\n    }\n  }\n  ","\n"]);return pa=function(){return e},e}var fa=me()(pa(),De);const va=function(){var e=x()(U().mark((function e(n,t,r,a){var l,o,i,u,c,d,s,m,p,f,v;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=a.description!==t.description&&(null===(l=a.description)||void 0===l?void 0:l.trim())||null,s=(null===(o=a.department)||void 0===o?void 0:o.id)===(null===(i=t.department)||void 0===i?void 0:i.id)?null:null!==(c=null===(u=a.department)||void 0===u?void 0:u.id)&&void 0!==c?c:null,m=function(){var e,n,r,l,o=null!==(n=null===(e=a.category.value[a.category.value.length-1])||void 0===e?void 0:e.id)&&void 0!==n?n:null;return o===(null!==(l=null===(r=t.category.value[t.category.value.length-1])||void 0===r?void 0:r.id)&&void 0!==l?l:null)?null:o}(),p=a.units===t.units?null:a.units,f=0===Tn(a.total.value).compare(Tn(t.total.value))?null:a.total.value,v={id:r,fields:{units:p,description:d,department:s,category:m,total:f}},e.next=8,n.mutate({mutation:fa,variables:v});case 8:case"end":return e.stop()}}),e)})));return function(n,t,r,a){return e.apply(this,arguments)}}();function ya(){var e=D()(["\n  query UpdateItemIniState($entryId: ID!, $itemId: ID!) {\n    journalEntry(id: $entryId) {\n      ...JournalEntry_3Fragment\n    }\n    journalEntryItem(id: $itemId) {\n      __typename\n      id\n      department {\n        ...DeptEntryOptFragment\n      }\n      category {\n        ...CatEntryOptFragment\n        ancestors {\n          ...CatEntryOptFragment\n        }\n      }\n      description\n      units\n      total {\n        n\n        d\n        s\n      }\n    }\n  }\n  ","\n  ","\n  ","\n"]);return ya=function(){return e},e}var Ea=me()(ya(),ia,Xn,Hn),ba={item:!0,lg:4,sm:6,xs:12},ha=function(e){var n,t=e.itemId,a=e.open,o=e.onClose,i=e.onExited,u=e.journalEntry,c=e.loading,d=e.handleSubmit,s=(0,Xe.u6)(),m=s.resetForm,p=s.isSubmitting,f=s.isValid,v=Cn(),y=q()(v,2),E=y[0],b=y[1],h=(0,r.useCallback)((function(e){b({msg:e.message,type:pn.FATAL_ERROR})}),[b]),g=(null==u?void 0:u.date)||"",O=(0,l.useQuery)(Kn,{skip:!g,variables:{date:g},onError:h}).data,Z=(0,r.useMemo)((function(){var e,n;return null!==(n=null===(e=null==O?void 0:O.fiscalYears[0])||void 0===e?void 0:e.id)&&void 0!==n?n:""}),[O]),w=null!==(n=null==u?void 0:u.type)&&void 0!==n?n:null,C=null==u?void 0:u.total,R=(null==u?void 0:u.items)||[],M=(0,r.useMemo)((function(){if(C){var e=R.reduce((function(e,n){var r=n.id,a=n.deleted,l=n.total;return a||r===t?e:e.add(Tn(l))}),new(ye())(0));return Tn(C).sub(e)}return new(ye())(Number.MAX_SAFE_INTEGER)}),[C,R,t]),A=(0,r.useCallback)((function(){i(),m(),b(null)}),[m,i,b]),k=(0,r.useMemo)((function(){return!E||E.type!==pn.FATAL_ERROR&&E.type!==pn.ERROR?[null,null]:[E.msg,E.type===pn.FATAL_ERROR]}),[E]),j=q()(k,2),_=j[0],S=j[1],I=(0,r.useMemo)((function(){var e="Item Update";return S?"Fatal Error":c?"Loading ".concat(e,"..."):p?"Submitting ".concat(e):e}),[c,S,p]),D=(0,He.Z)();return r.createElement(en.Z,{open:a,onClose:o,onExited:A,disableBackdropClick:p,disableEscapeKeyDown:p,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:d}},r.createElement(nn.Z,{style:_?{color:D.palette.error.main}:void 0},I),r.createElement(ee.Z,{position:"relative"},(c||p)&&!_&&r.createElement(yt,{zIndex:"modal"}),!!_&&S&&r.createElement(vt,{opacity:.78,zIndex:"modal",padding:2},r.createElement(tn.Z,{color:"error"},_)),r.createElement(rn.Z,{dividers:!0},!!_&&!S&&r.createElement(tn.Z,{color:"error"},_),r.createElement(an.Z,{container:!0,spacing:2},r.createElement(an.Z,Object.assign({},ba),r.createElement($n,{disabled:c||p,fullWidth:!0,maxTotal:M})),r.createElement(an.Z,Object.assign({},ba),r.createElement(la,{disabled:c||p,fullWidth:!0})),r.createElement(an.Z,Object.assign({},ba),r.createElement(In,{disabled:c||p,fullWidth:!0})),r.createElement(an.Z,Object.assign({},ba),r.createElement(Wt,{disabled:c||p||!!S,entryType:w,fullWidth:!0})),r.createElement(an.Z,Object.assign({},ba),r.createElement(Kt,{disabled:c||p||!!S,fullWidth:!0,fiscalYearId:Z}))))),r.createElement(ln.Z,null,!S&&r.createElement(on.Z,{disabled:c||p||!f,type:"submit",startIcon:r.createElement(un.Z,null),color:"primary",variant:"contained"},"Update"),r.createElement(on.Z,{disabled:c||p||!!S,color:S?"primary":"default",startIcon:!S&&r.createElement(cn.Z,null),onClick:o},S?"Ok":"Cancel")))};const ga=function(e){var n=e.entryId,t=e.itemId,a=e.open,o=e.onClose,i=e.onExited,u=(0,l.useQuery)(Ea,{skip:!n,variables:{entryId:n,itemId:t}}),c=u.loading,d=u.error,s=u.data,m=(0,r.useMemo)((function(){return d?{msg:d.message,type:pn.FATAL_ERROR}:null}),[d]),p=null==s?void 0:s.journalEntryItem,f=(0,r.useMemo)((function(){var e,n;if(!p)return{};var t={inputValue:Tn(p.total).round(2).toString(),value:p.total},r=function(){if(!p.category)return{inputValue:"",value:[]};var e=p.category,n=e.ancestors,t=vn()(e,["ancestors"]),r=$()(n).sort((function(e,n){var t,r;return e.id===(null===(t=n.parent)||void 0===t?void 0:t.id)?-1:n.id===(null===(r=e.parent)||void 0===r?void 0:r.id)?1:0}));return r.push(t),{inputValue:"",value:r}}(),a=null!==(e=p.department)&&void 0!==e?e:null,l=null!==(n=p.description)&&void 0!==n?n:null;return{total:t,units:p.units,category:r,department:a,description:l}}),[p]),v=(0,l.useApolloClient)(),y=(0,r.useCallback)(function(){var e=x()(U().mark((function e(n,r){var a;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=5;break}return r.setStatus({msg:'Failed to load initial values for item "'.concat(t,'".'),type:pn.FATAL_ERROR}),e.abrupt("return");case 5:if(t){e.next=8;break}return r.setStatus({msg:"No item ID.",type:pn.FATAL_ERROR}),e.abrupt("return");case 8:return e.prev=8,r.setStatus(null),e.next=12,va(v,f,t,n,r);case 12:o(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),r.setStatus({msg:null!==(a=null===e.t0||void 0===e.t0?void 0:e.t0.message)&&void 0!==a?a:"".concat(e.t0),type:pn.FATAL_ERROR});case 18:case"end":return e.stop()}}),e,null,[[8,15]])})));return function(n,t){return e.apply(this,arguments)}}(),[v,f,o,t]),E=(0,r.useCallback)((function(e){var l;return r.createElement(ha,{entryId:n,itemId:t,open:a,onClose:o,onExited:i,journalEntry:null!==(l=null==s?void 0:s.journalEntry)&&void 0!==l?l:null,loading:c,handleSubmit:e.handleSubmit})}),[s,n,c,o,i,a,t]);return r.createElement(Xe.J9,{initialValues:null!=f?f:{},initialStatus:m,enableReinitialize:!0,onSubmit:y},E)};function Oa(){var e=D()(["\n  mutation DeleteItem($id: ID!) {\n    journalEntryDeleteItem(id: $id) {\n      journalEntryItem {\n        id\n        __typename\n        deleted\n      }\n    }\n  }\n"]);return Oa=function(){return e},e}var Za=me()(Oa());const wa=function(e){var n=e.itemId,t=e.onClose,a=(0,l.useMutation)(Za),o=q()(a,2),i=o[0],u=o[1],c=u.loading,d=u.error,s=!!d,m=(0,r.useCallback)((function(){i({variables:{id:n}}).then((function(){return t()}))}),[n,i,t]),p=(0,r.useMemo)((function(){return s?"Error":c?"Deleting Item...":"Delete Item"}),[s,c]),f=(0,He.Z)();return r.createElement(en.Z,{open:!!n,maxWidth:"sm",fullWidth:!0,disableBackdropClick:c,disableEscapeKeyDown:c,onClose:t},r.createElement(nn.Z,{style:s?{color:f.palette.error.main}:void 0},p),r.createElement(ee.Z,{position:"relative"},c&&r.createElement(yt,{zIndex:"modal"}),r.createElement(rn.Z,null,s&&r.createElement(tn.Z,{color:"error"},null==d?void 0:d.message),!s&&r.createElement(tn.Z,null,"Are you sure you want to delete this item?"))),r.createElement(ln.Z,null,!s&&r.createElement(on.Z,{disabled:c,onClick:m,startIcon:r.createElement(K.Z,null),color:"primary",variant:"contained"},"Delete"),r.createElement(on.Z,{disabled:c,startIcon:!s&&r.createElement(cn.Z,null),onClick:t},s?"Close":"Cancel")))},Ca=function(e){var n,t,a=e.entry,l=a.items,o=a.category,i=a.description,u=a.department,c=a.id,d=(0,r.useState)(!1),s=q()(d,2),m=s[0],p=s[1],f=(0,r.useState)(null),v=q()(f,2),y=v[0],E=v[1],b=(0,r.useCallback)((function(){p(!1)}),[p]),h=(0,r.useCallback)((function(){E(null)}),[E]),g=(0,r.useState)(!1),O=q()(g,2),Z=O[0],w=O[1],C=(0,r.useState)(null),R=q()(C,2),M=R[0],A=R[1],k=(0,r.useState)(null),j=q()(k,2),_=j[0],S=j[1],I=(0,r.useCallback)((function(){S(null)}),[S]),D=(0,r.useCallback)((function(){w(!1)}),[w]),F=(0,r.useCallback)((function(){A(null)}),[A]),T=(0,r.useMemo)((function(){return[{icon:K.Z,tooltip:"Delete Item",onClick:function(e,n){return S(n.id)}},{icon:X.Z,tooltip:"Edit Item",onClick:function(e,n){w(!0),A({entryId:c,itemId:n.id})}},{icon:function(e){return r.createElement(H.Z,Object.assign({},e))},iconProps:{color:"secondary",fontSize:"large"},tooltip:"Add Item",isFreeAction:!0,onClick:function(){p(!0),E(c)}}]}),[c]),x=(0,r.useMemo)((function(){return[{field:"total",title:"Total",render:function(e){var n=e.total;return J()(Tn(n).valueOf()).format("$0,0.00")}},{field:"units",title:"Units"},{field:"description",title:"Description",render:function(e){var n;return(null===(n=e.description)||void 0===n?void 0:n.trim())||i}},{field:"category",title:"Category",render:function(e){var n,t,r=null!==(t=null===(n=e.category)||void 0===n?void 0:n.name)&&void 0!==t?t:o.name;return(0,G.I)(r)}},{field:"department",title:"Department",render:function(e){var n,t,r=null!==(t=null===(n=e.department)||void 0===n?void 0:n.name)&&void 0!==t?t:u.name;return(0,G.I)(r)}}]}),[o,i,u]),P=(0,r.useMemo)((function(){return{search:!1,emptyRowsWhenPaging:!1}}),[]),$=(0,r.useMemo)((function(){return l.filter((function(e){return!e.deleted}))}),[l]),N=(0,He.Z)(),L=(0,r.useMemo)((function(){return{boxShadow:N.shadows[0]}}),[N.shadows]),U=(0,r.useMemo)((function(){return{backgroundColor:N.palette.primary.main}}),[N.palette.primary.main]);return r.createElement(ee.Z,null,r.createElement(W(),{title:"Items",actions:T,options:P,columns:x,icons:Ke,data:$,style:L}),r.createElement(ma,{entryId:y,open:m,onClose:b,onExited:h}),r.createElement(ga,{entryId:null!==(n=null==M?void 0:M.entryId)&&void 0!==n?n:null,itemId:null!==(t=null==M?void 0:M.itemId)&&void 0!==t?t:null,open:Z,onClose:D,onExited:F}),r.createElement(wa,{itemId:_,onClose:I}),r.createElement(Hr.Z,{style:U}))};var Ra=t(110),Ma=t(85639);const Aa=function(e){var n=e.setFilter,t=(0,r.useState)("None"),a=q()(t,2),l=a[0],o=a[1],i=(0,r.useCallback)((function(e){var t=e.target.value;switch(t){case"Reconciled":n({reconciled:{$eq:!0}});break;case"Unreconciled":n({reconciled:{$eq:!1}});break;case"None":n({})}o(t)}),[n,o]);return r.createElement(vr.ZP,{title:"None"===l?"No Filter":l},r.createElement(Ra.Z,{startAdornment:r.createElement(Dn.Z,{disablePointerEvents:!0,position:"start"},r.createElement(Be.Z,null)),onChange:i,fullWidth:!0,value:"None"===l?"":l},r.createElement(Ma.Z,{value:"None"},"None"),r.createElement(Ma.Z,{value:"Reconciled"},"Reconciled"),r.createElement(Ma.Z,{value:"Unreconciled"},"Unreconciled")))};var ka=t(95757),ja=t(38799);function _a(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}const Sa=function(e){var n=e.setFilter,t=e.options,a=(0,r.useState)([]),l=q()(a,2),o=l[0],i=l[1],u=(0,r.useMemo)((function(){var e,n=[],a=new Map,l=function(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return _a(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_a(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}(t);try{for(l.s();!(e=l.n()).done;){var i=e.value;a.set(i.id,i.name),n.push(r.createElement(Ma.Z,{key:i.id,value:i.id},r.createElement(qn.Z,{checked:o.includes(i.id)}),r.createElement(ka.Z,{primary:i.name})))}}catch(e){l.e(e)}finally{l.f()}return[n,a]}),[t,o]),c=q()(u,2),d=c[0],s=c[1],m=(0,r.useCallback)((function(e){return e.map((function(e){var n;return null!==(n=s.get(e))&&void 0!==n?n:""})).join(", ")}),[s]),p=(0,r.useCallback)((function(e){var t=e.target.value||[];0===t.length?n({}):n({"category.id":{$in:t}}),i(t)}),[n]);return r.createElement(vr.ZP,{title:0===o.length?"No Filter":m(o)},r.createElement(ee.Z,{maxWidth:250},r.createElement(Ra.Z,{startAdornment:r.createElement(Dn.Z,{disablePointerEvents:!0,position:"start"},r.createElement(Be.Z,null)),fullWidth:!0,multiple:!0,value:o,onChange:p,input:r.createElement(ja.Z,null),renderValue:m},d)))};function Ia(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}const Da=function(e){var n=e.setFilter,t=e.options,a=(0,r.useState)([]),l=q()(a,2),o=l[0],i=l[1],u=(0,r.useMemo)((function(){var e,n=[],a=new Map,l=function(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return Ia(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ia(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}(t);try{for(l.s();!(e=l.n()).done;){var i=e.value;a.set(i.id,i.name),n.push(r.createElement(Ma.Z,{key:i.id,value:i.id},r.createElement(qn.Z,{checked:o.includes(i.id)}),r.createElement(ka.Z,{primary:i.name})))}}catch(e){l.e(e)}finally{l.f()}return[n,a]}),[t,o]),c=q()(u,2),d=c[0],s=c[1],m=(0,r.useCallback)((function(e){return e.map((function(e){var n;return null!==(n=s.get(e))&&void 0!==n?n:""})).join(", ")}),[s]),p=(0,r.useCallback)((function(e){var t=e.target.value||[];0===t.length?n({}):n({$or:[{"paymentMethod.id":{$in:t}},{"paymentMethod.parent.id":{$in:t}}]}),i(t)}),[n]);return r.createElement(vr.ZP,{title:0===o.length?"No Filter":m(o)},r.createElement(ee.Z,{maxWidth:250},r.createElement(Ra.Z,{startAdornment:r.createElement(Dn.Z,{disablePointerEvents:!0,position:"start"},r.createElement(Be.Z,null)),fullWidth:!0,multiple:!0,value:o,onChange:p,input:r.createElement(ja.Z,null),renderValue:m},d)))};function Fa(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}const Ta=function(e){var n=e.setFilter,t=e.options,a=(0,r.useState)([]),l=q()(a,2),o=l[0],i=l[1],u=(0,r.useMemo)((function(){var e,n=[],a=new Map,l=function(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return Fa(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Fa(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}(t);try{for(l.s();!(e=l.n()).done;){var i=e.value;a.set(i.id,i.name),n.push(r.createElement(Ma.Z,{key:i.id,value:i.id},r.createElement(qn.Z,{checked:o.includes(i.id)}),r.createElement(ka.Z,{primary:i.name})))}}catch(e){l.e(e)}finally{l.f()}return[n,a]}),[t,o]),c=q()(u,2),d=c[0],s=c[1],m=(0,r.useCallback)((function(e){return e.map((function(e){var n;return null!==(n=s.get(e))&&void 0!==n?n:""})).join(", ")}),[s]),p=(0,r.useCallback)((function(e){var t=e.target.value||[];0===t.length?n({}):n({"department.id":{$in:t}}),i(t)}),[n]);return r.createElement(vr.ZP,{title:0===o.length?"No Filter":m(o)},r.createElement(ee.Z,{maxWidth:250},r.createElement(Ra.Z,{startAdornment:r.createElement(Dn.Z,{disablePointerEvents:!0,position:"start"},r.createElement(Be.Z,null)),fullWidth:!0,multiple:!0,value:o,onChange:p,input:r.createElement(ja.Z,null),renderValue:m},d)))};function xa(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}const Pa=function(e){var n=e.setFilter,t=e.options,a=(0,r.useState)([]),l=q()(a,2),o=l[0],i=l[1],u=(0,r.useMemo)((function(){var e,n,a,l,i=[],u=new Map,c=function(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return xa(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?xa(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}(t);try{for(c.s();!(e=c.n()).done;)void 0,void 0,void 0,n=e.value,a=function(){switch(n.__typename){case"Person":return"".concat(n.name.first," ").concat(n.name.last);case"Business":return n.bizName;case"Department":return n.deptName}}(),l="".concat(n.__typename,"-").concat(n.id),u.set(l,a),i.push(r.createElement(Ma.Z,{key:l,value:l},r.createElement(qn.Z,{checked:o.includes(l)}),r.createElement(ka.Z,{primary:a})))}catch(e){c.e(e)}finally{c.f()}return[i,u]}),[t,o]),c=q()(u,2),d=c[0],s=c[1],m=(0,r.useCallback)((function(e){return e.map((function(e){var n;return null!==(n=s.get(e))&&void 0!==n?n:""})).join(", ")}),[s]),p=(0,r.useCallback)((function(e){var t=e.target.value||[];0===t.length?n({}):n({$or:t.map((function(e){var n=e.split("-"),t=q()(n,2),r=t[0];return{"source.id":t[1],"source.__typename":r}}))}),i(t)}),[n]);return r.createElement(vr.ZP,{title:0===o.length?"No Filter":m(o)},r.createElement(ee.Z,{maxWidth:250},r.createElement(Ra.Z,{startAdornment:r.createElement(Dn.Z,{disablePointerEvents:!0,position:"start"},r.createElement(Be.Z,null)),fullWidth:!0,multiple:!0,value:o,onChange:p,input:r.createElement(ja.Z,null),renderValue:m},d)))};var $a,Na=t(17812),qa=t(52387),La=t(10313),Ua=t(13189),Ba=t(56543),Wa=t(21448),Va=t(67705),Ja=t(24579),Ga=t(77349),za=t(7069);function Ya(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}!function(e){e[e.None=1]="None",e[e.Equal=2]="Equal",e[e.GreaterThan=3]="GreaterThan",e[e.LessThan=4]="LessThan",e[e.GreaterThanOrEqual=5]="GreaterThanOrEqual",e[e.LessThanOrEqual=6]="LessThanOrEqual"}($a||($a={}));var Qa=function(e,n){if(!e)return[void 0,void 0,[$a.None]];switch(n){case $a.None:case $a.Equal:return[void 0,void 0,[$a.None]];case $a.GreaterThan:case $a.GreaterThanOrEqual:return[(0,Ga.Z)(e,1),void 0,[$a.None,$a.LessThan,$a.LessThanOrEqual]];case $a.LessThan:case $a.LessThanOrEqual:return[void 0,(0,za.Z)(e,1),[$a.None,$a.GreaterThan,$a.GreaterThanOrEqual]]}},Ka=new Date(864e13),Xa=new Date(-864e13);const Ha=function(e){var n=e.setFilter,t=(0,r.useState)(""),a=q()(t,2),l=a[0],o=a[1],i=(0,r.useState)($a.Equal),u=q()(i,2),c=u[0],s=u[1],m=(0,r.useState)(null),p=q()(m,2),f=p[0],v=p[1],y=(0,r.useState)($a.None),E=q()(y,2),b=E[0],h=E[1],g=(0,r.useState)(null),O=q()(g,2),Z=O[0],w=O[1],C=(0,r.useMemo)((function(){return Qa(f,c)}),[f,c]),R=q()(C,3),M=R[0],A=R[1],k=R[2],j=(0,r.useCallback)((function(e){if(0===e.length)return o(""),void n({});var t,r,a,l,i,u,c,s,m=[],p=[],f=function(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return Ya(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ya(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}(e);try{for(f.s();!(t=f.n()).done;)void 0,void 0,void 0,void 0,void 0,void 0,void 0,r=t.value,a=r.op,l=r.date,i=function(){switch(a){case $a.Equal:return["$eq","="];case $a.GreaterThan:return["$gt",">"];case $a.GreaterThanOrEqual:return["$gte",">="];case $a.LessThan:return["$lt","<"];case $a.LessThanOrEqual:return["$lte","<="];case $a.None:return["",""]}}(),c=(u=q()(i,2))[0],s=u[1],m.push({date:d()({},c,(0,fe.Z)(l))}),p.push("".concat(s,"[").concat((0,pe.default)(l,"d/M/yy"),"]"))}catch(e){f.e(e)}finally{f.f()}o(p.join(" & ")),n({$and:m})}),[n]),_=(0,r.useCallback)((function(e){var n,t=null!==(n=e.target.value)&&void 0!==n?n:$a.Equal;s(t);var r=Qa(f,t),a=q()(r,3)[2].includes(b);if(a||(h($a.None),w(null)),f){var l=[{op:t,date:f}];a&&b!==$a.None&&b!==$a.Equal&&Z&&l.push({op:b,date:Z}),j(l)}}),[f,Z,b,j]),S=(0,r.useCallback)((function(e){var n,t=null!==(n=e.target.value)&&void 0!==n?n:$a.None;h(t),t===$a.None?(w(null),j(f?[{op:c,date:f}]:[])):Z&&j([{op:c,date:f},{op:t,date:Z}])}),[f,Z,c,j]),I=(0,r.useCallback)((function(e){if(!e||(0,hn.Z)(e))if(v(e),e){var n=[{op:c,date:e}];if(Z){var t=Qa(e,c),r=q()(t,2),a=r[0],l=r[1];b!==$a.None&&b!==$a.Equal&&a&&Z>=a||l&&Z<=l?n.push({op:b,date:Z}):(h($a.None),w(null))}j(n)}else j([]),h($a.None),w(null)}),[Z,c,b,j]),D=(0,r.useCallback)((function(e){e&&!(0,hn.Z)(e)||(w(e),e?j([{op:c,date:f},{op:b,date:e}]):(j(f?[{op:c,date:f}]:[]),w(null)))}),[f,c,b,j]),F=(0,r.useCallback)((function(e){e.stopPropagation(),s($a.Equal),v(null),h($a.None),w(null),j([])}),[j]),T=(0,r.useMemo)((function(){return{startAdornment:r.createElement(Dn.Z,{disablePointerEvents:!0,position:"start"},r.createElement(Be.Z,null)),endAdornment:f?r.createElement(Dn.Z,{position:"end"},r.createElement(Na.Z,{onClick:F},r.createElement(Ne.Z,null))):r.createElement(Dn.Z,{disablePointerEvents:!0,position:"end"},r.createElement(La.Z,null))}}),[f,F]),x=(0,r.useState)(null),P=q()(x,2),$=P[0],N=P[1],L=(0,r.useCallback)((function(e){N(e.currentTarget)}),[]),U=(0,r.useCallback)((function(){N(null)}),[]);return r.createElement(ee.Z,null,r.createElement(vr.ZP,{title:l||"No Filter"},r.createElement(ee.Z,{maxWidth:250},r.createElement(Sn.Z,{fullWidth:!0,value:l,InputProps:T,onClick:L}))),r.createElement(qa.ZP,{onClose:U,open:!!$,anchorEl:$},r.createElement(ee.Z,{maxWidth:350,margin:2,clone:!0},r.createElement(an.Z,{container:!0,spacing:2},r.createElement(an.Z,{xs:12,item:!0},r.createElement(ee.Z,{marginTop:1},r.createElement(Ra.Z,{value:c,onChange:_},r.createElement(Ma.Z,{value:$a.Equal},r.createElement(Ua.Z,null)),r.createElement(Ma.Z,{value:$a.GreaterThan},r.createElement(Ba.Z,null)),r.createElement(Ma.Z,{value:$a.LessThan},r.createElement(Wa.Z,null)),r.createElement(Ma.Z,{value:$a.GreaterThanOrEqual},r.createElement(Va.Z,null)),r.createElement(Ma.Z,{value:$a.LessThanOrEqual},r.createElement(Ja.Z,null)))),r.createElement(yn.M,{utils:bn.default},r.createElement(En.e,{onChange:I,value:f,format:"MM/dd/yyyy",placeholder:"mm/dd/yyyy",margin:"none",label:"Date",animateYearScrolling:!0,disableToolbar:!0,autoOk:!0,variant:"inline"}))),!!f&&c!==$a.Equal&&r.createElement(an.Z,{xs:12,item:!0},r.createElement(ee.Z,{marginTop:1},r.createElement(Ra.Z,{value:b,onChange:S},r.createElement(Ma.Z,{value:$a.None},"None"),r.createElement(Ma.Z,{style:{display:"None"},value:$a.Equal},r.createElement(Ua.Z,null)),r.createElement(Ma.Z,{style:k.includes($a.GreaterThan)?void 0:{display:"none"},disabled:!k.includes($a.GreaterThan),value:$a.GreaterThan},r.createElement(Ba.Z,null)),r.createElement(Ma.Z,{style:k.includes($a.LessThan)?void 0:{display:"none"},disabled:!k.includes($a.LessThan),value:$a.LessThan},r.createElement(Wa.Z,null)),r.createElement(Ma.Z,{style:k.includes($a.GreaterThanOrEqual)?void 0:{display:"none"},disabled:!k.includes($a.GreaterThanOrEqual),value:$a.GreaterThanOrEqual},r.createElement(Va.Z,null)),r.createElement(Ma.Z,{style:k.includes($a.LessThanOrEqual)?void 0:{display:"none"},disabled:!k.includes($a.LessThanOrEqual),value:$a.LessThanOrEqual},r.createElement(Ja.Z,null)))),r.createElement(yn.M,{utils:bn.default},r.createElement(En.e,{disabled:b===$a.None,minDate:M||Xa,maxDate:A||Ka,onChange:D,value:Z,format:"MM/dd/yyyy",placeholder:"mm/dd/yyyy",margin:"none",label:"Date",animateYearScrolling:!0,disableToolbar:!0,autoOk:!0,variant:"inline"})))))))};function el(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var nl;!function(e){e[e.None=1]="None",e[e.Equal=2]="Equal",e[e.GreaterThan=3]="GreaterThan",e[e.LessThan=4]="LessThan",e[e.GreaterThanOrEqual=5]="GreaterThanOrEqual",e[e.LessThanOrEqual=6]="LessThanOrEqual"}(nl||(nl={}));var tl=function(e,n){if(!e)return[void 0,void 0,[nl.None]];switch(n){case nl.None:case nl.Equal:return[void 0,void 0,[nl.None]];case nl.GreaterThan:case nl.GreaterThanOrEqual:return[e.add(new(ye())({n:1,d:100})),void 0,[nl.None,nl.LessThan,nl.LessThanOrEqual]];case nl.LessThan:case nl.LessThanOrEqual:return[void 0,e.sub(new(ye())({n:1,d:100})),[nl.None,nl.GreaterThan,nl.GreaterThanOrEqual]]}},rl={type:"number",startAdornment:r.createElement(Dn.Z,{position:"start"},"$")};const al=function(e){var n=e.setFilter,t=(0,r.useState)(""),a=q()(t,2),l=a[0],o=a[1],i=(0,r.useState)(nl.Equal),u=q()(i,2),c=u[0],s=u[1],m=(0,r.useState)(""),p=q()(m,2),f=p[0],v=p[1],y=(0,r.useState)(nl.None),E=q()(y,2),b=E[0],h=E[1],g=(0,r.useState)(""),O=q()(g,2),Z=O[0],w=O[1],C=(0,r.useMemo)((function(){return tl(f?new(ye())(f):null,c)}),[f,c]),R=q()(C,3),M=R[0],A=R[1],k=R[2],j=(0,r.useMemo)((function(){return{min:M?M.toString():"0.00",max:A?A.toString():void 0,step:"0.01"}}),[M,A]),_=(0,r.useCallback)((function(e){if(0===e.length)return o(""),void n({});var t,r,a,l,i,u,c,s,m=[],p=[],f=function(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return el(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?el(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}(e);try{for(f.s();!(t=f.n()).done;)void 0,void 0,void 0,void 0,void 0,void 0,void 0,r=t.value,a=r.op,l=r.total,i=function(){switch(a){case nl.Equal:return["$eq","="];case nl.GreaterThan:return["$gt",">"];case nl.GreaterThanOrEqual:return["$gte",">="];case nl.LessThan:return["$lt","<"];case nl.LessThanOrEqual:return["$lte","<="];case nl.None:return["",""]}}(),c=(u=q()(i,2))[0],s=u[1],m.push({total:d()({},c,l)}),p.push("".concat(s,"[").concat(l,"]"))}catch(e){f.e(e)}finally{f.f()}o(p.join(" & ")),n({$and:m})}),[n]),S=(0,r.useCallback)((function(e){var n,t=null!==(n=e.target.value)&&void 0!==n?n:nl.Equal;s(t);var r=tl(f?new(ye())(f):null,t),a=q()(r,3)[2].includes(b);if(a||(h(nl.None),w("")),f){var l=[{op:t,total:new(ye())(f).valueOf()}];if(a&&b!==nl.None&&b!==nl.Equal&&Z){var o=new(ye())(Z);l.push({op:b,total:o.valueOf()})}_(l)}}),[f,Z,b,_]),I=(0,r.useCallback)((function(e){var n,t=null!==(n=e.target.value)&&void 0!==n?n:nl.None;if(h(t),t===nl.None)if(w(""),f){var r=new(ye())(f);_([{op:c,total:r.valueOf()}])}else _([]);else if(Z){var a=new(ye())(f),l=new(ye())(Z);_([{op:c,total:a.valueOf()},{op:t,total:l.valueOf()}])}}),[f,Z,c,_]),D=(0,r.useCallback)((function(e){var n=e.target.value.trim();if(n){var t=new(ye())(n).round(2);o(t.toString()),v(n);var r=[{op:c,total:t.valueOf()}];if(Z){var a=tl(t,c),l=q()(a,2),i=l[0],u=l[1],d=new(ye())(Z);b!==nl.None&&b!==nl.Equal&&i&&d.compare(i)>=0||u&&d.compare(u)<=0?r.push({op:b,total:d.valueOf()}):(h(nl.None),w(""))}_(r)}else o(n),_([]),h(nl.None),w("")}),[c,Z,_,b]),F=(0,r.useCallback)((function(e){var n=e.target.value.trim();if(n){var t=new(ye())(f),r=new(ye())(n).round(2);w(n),_([{op:c,total:t.valueOf()},{op:b,total:r.valueOf()}])}else{if(f){var a=new(ye())(f);_([{op:c,total:a.valueOf()}])}else _([]);w("")}}),[f,c,b,_]),T=(0,r.useCallback)((function(e){e.stopPropagation(),s(nl.Equal),v(""),h(nl.None),w(""),_([])}),[_]),x=(0,r.useMemo)((function(){return{startAdornment:r.createElement(Dn.Z,{disablePointerEvents:!0,position:"start"},r.createElement(Be.Z,null)),endAdornment:f?r.createElement(Dn.Z,{position:"end"},r.createElement(Na.Z,{onClick:T},r.createElement(Ne.Z,null))):r.createElement(Dn.Z,{disablePointerEvents:!0,position:"end"},r.createElement(La.Z,null))}}),[f,T]),P=(0,r.useState)(null),$=q()(P,2),N=$[0],L=$[1],U=(0,r.useCallback)((function(e){L(e.currentTarget)}),[]),B=(0,r.useCallback)((function(){L(null)}),[]);return r.createElement(ee.Z,null,r.createElement(vr.ZP,{title:l||"No Filter"},r.createElement(ee.Z,{maxWidth:250},r.createElement(Sn.Z,{fullWidth:!0,value:l,InputProps:x,onClick:U}))),r.createElement(qa.ZP,{onClose:B,open:!!N,anchorEl:N},r.createElement(ee.Z,{maxWidth:350,margin:2,clone:!0},r.createElement(an.Z,{container:!0,spacing:2},r.createElement(an.Z,{xs:12,item:!0},r.createElement(Ra.Z,{value:c,onChange:S},r.createElement(Ma.Z,{value:nl.Equal},r.createElement(Ua.Z,null)),r.createElement(Ma.Z,{value:nl.GreaterThan},r.createElement(Ba.Z,null)),r.createElement(Ma.Z,{value:nl.LessThan},r.createElement(Wa.Z,null)),r.createElement(Ma.Z,{value:nl.GreaterThanOrEqual},r.createElement(Va.Z,null)),r.createElement(Ma.Z,{value:nl.LessThanOrEqual},r.createElement(Ja.Z,null))),r.createElement(ee.Z,{marginTop:2},r.createElement(Sn.Z,{placeholder:"0.00",label:"Total",type:"number",inputProps:j,InputProps:rl,value:f,onChange:D}))),!!f&&c!==nl.Equal&&r.createElement(an.Z,{xs:12,item:!0},r.createElement(Ra.Z,{value:b,onChange:I},r.createElement(Ma.Z,{value:nl.None},"None"),r.createElement(Ma.Z,{style:{display:"None"},value:nl.Equal},r.createElement(Ua.Z,null)),r.createElement(Ma.Z,{style:k.includes(nl.GreaterThan)?void 0:{display:"none"},disabled:!k.includes(nl.GreaterThan),value:nl.GreaterThan},r.createElement(Ba.Z,null)),r.createElement(Ma.Z,{style:k.includes(nl.LessThan)?void 0:{display:"none"},disabled:!k.includes(nl.LessThan),value:nl.LessThan},r.createElement(Wa.Z,null)),r.createElement(Ma.Z,{style:k.includes(nl.GreaterThanOrEqual)?void 0:{display:"none"},disabled:!k.includes(nl.GreaterThanOrEqual),value:nl.GreaterThanOrEqual},r.createElement(Va.Z,null)),r.createElement(Ma.Z,{style:k.includes(nl.LessThanOrEqual)?void 0:{display:"none"},disabled:!k.includes(nl.LessThanOrEqual),value:nl.LessThanOrEqual},r.createElement(Ja.Z,null))),r.createElement(ee.Z,{marginTop:2},r.createElement(Sn.Z,{disabled:b===nl.None,placeholder:"0.00",label:"Total",type:"number",inputProps:j,InputProps:rl,value:Z,onChange:F})))))))};var ll,ol=t(77424);function il(){var e=D()(["\n  mutation ReconcileRefund($id: ID!) {\n    journalEntryUpdateRefund(id: $id, fields: { reconciled: true }) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return il=function(){return e},e}function ul(){var e=D()(["\n  mutation ReconcileEntry($id: ID!) {\n    journalEntryUpdate(id: $id, fields: { reconciled: true }) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return ul=function(){return e},e}function cl(){var e=D()(["\n  subscription OnEntryUpsert_1 {\n    journalEntryUpserted {\n      ...JournalEntry_1Fragment\n      department {\n        ancestors {\n          ... on Department {\n            __typename\n            id\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return cl=function(){return e},e}function dl(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function sl(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?dl(Object(t),!0).forEach((function(n){d()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):dl(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function ml(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return pl(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?pl(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function pl(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}(0,ol.addOperators)(ol.OperatorType.EXPRESSION,(function(e){return{$expressionCb:function(n,t,r){return t(n,r,e)}}})),(0,ol.addOperators)(ol.OperatorType.QUERY,(function(e){return{$queryCb:function(n,t,r,a){return r(n,t,a,e)}}})),function(e){e[e.View=0]="View",e[e.Reconcile=1]="Reconcile"}(ll||(ll={}));var fl=U().mark((function e(n){var t,r,a,l,o,i,u;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=ml(n),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=27;break}return a=r.value,e.next=7,a;case 7:l=a.type===R.Credit?R.Debit:R.Credit,o=ml(a.refunds),e.prev=9,o.s();case 11:if((i=o.n()).done){e.next=17;break}return u=i.value,e.next=15,sl(sl(sl({},a),u),{},{type:l,description:u.description||a.description,refunds:a.id});case 15:e.next=11;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(9),o.e(e.t0);case 22:return e.prev=22,o.f(),e.finish(22);case 25:e.next=3;break;case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(1),t.e(e.t1);case 32:return e.prev=32,t.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,null,[[1,29,32,35],[9,19,22,25]])})),vl=(Symbol(),me()(cl(),Fe)),yl=me()(ul(),Fe),El=me()(il(),Fe);const bl=function(e){var n,t,a=e.journalTitle,o=void 0===a?null:a,i=e.deptId,u=void 0===i?null:i,c=e.fiscalYearId,d=void 0===c?null:c,s=e.mode,m=(0,r.useState)(!1),p=q()(m,2),f=p[0],v=p[1],y=(0,r.useCallback)((function(){v(!1)}),[v]),E=(0,r.useState)(!1),b=q()(E,2),h=b[0],g=b[1],O=(0,r.useState)(null),Z=q()(O,2),w=Z[0],C=Z[1],M=(0,r.useCallback)((function(){g(!1)}),[g]),A=(0,r.useCallback)((function(){C(null)}),[C]),k=(0,r.useState)(null),j=q()(k,2),_=j[0],S=j[1],I=(0,r.useCallback)((function(){S(null)}),[S]),D=(0,r.useState)(!1),F=q()(D,2),T=F[0],P=F[1],N=(0,r.useState)(null),L=q()(N,2),V=L[0],se=L[1],me=(0,r.useCallback)((function(){P(!1)}),[P]),ve=(0,r.useCallback)((function(){se(null)}),[se]),ge=(0,r.useState)(!1),Oe=q()(ge,2),Ze=Oe[0],we=Oe[1],Ce=(0,r.useState)(null),Re=q()(Ce,2),Me=Re[0],Ae=Re[1],ke=(0,r.useCallback)((function(){we(!1)}),[we]),je=(0,r.useCallback)((function(){Ae(null)}),[Ae]),_e=(0,r.useState)(null),Se=q()(_e,2),Ie=Se[0],De=Se[1],Fe=(0,r.useCallback)((function(){De(null)}),[De]),Pe=(0,l.useMutation)(yl),$e=q()(Pe,2),Ne=$e[0],qe=$e[1].loading,Le=(0,l.useMutation)(El),Ue=q()(Le,2),Be=Ue[0],We=Ue[1].loading,Ve=(0,r.useMemo)((function(){return u&&d?{where:{department:{eq:{id:u,matchDescendants:!0}},fiscalYear:{eq:d}}}:u?{where:{department:{eq:{id:u,matchDescendants:!0}}}}:d?{where:{fiscalYear:{eq:d}}}:void 0}),[u,d]),Je=(0,l.useQuery)(Te,{variables:Ve,fetchPolicy:"cache-and-network"}),Ge=Je.loading,ze=Je.error,Ye=Je.data,Qe=Je.subscribeToMore,Xe=Ge&&!(null==Ye?void 0:Ye.journalEntries),He=(0,r.useMemo)((function(){var e;return null!==(e=((null==Ye?void 0:Ye.fiscalYears)||[]).find((function(e){return e.id===d})))&&void 0!==e?e:null}),[d,Ye]);(0,r.useEffect)((function(){return Qe({document:vl,updateQuery:function(e,n){var t,r=n.subscriptionData;if(!r.data)return e;var a=r.data.journalEntryUpserted,l=a.department.ancestors;if(u&&a.department.id!==u&&l.every((function(e){return"Department"===e.__typename&&e.id!==u}))){var o=e.journalEntries.filter((function(e){return e.id!==a.id}));return Object.assign({},e,{journalEntries:o})}if(He){var i=(null===(t=a.dateOfRecord)||void 0===t?void 0:t.overrideFiscalYear)?new Date(a.dateOfRecord.date):new Date(a.date);if(i<new Date(He.begin)||i>=new Date(He.end)){var c=e.journalEntries.filter((function(e){return e.id!==a.id}));return Object.assign({},e,{journalEntries:c})}}return e.journalEntries.some((function(e){return e.id===a.id}))?e:Object.assign({},e,{journalEntries:[a].concat($()(e.journalEntries))})}})}),[u,He,Qe]);var en=(null==Ye?void 0:Ye.journalEntries)||[],nn=(0,r.useMemo)((function(){var e,n={category:new Map,paymentMethod:new Map,source:new Map,department:new Map},t=[],r=ml(fl(en));try{for(r.s();!(e=r.n()).done;){var a=e.value;a.deleted||s===ll.Reconcile&&a.reconciled||(n.category.set(a.category.id,a.category),n.department.set(a.department.id,a.department),n.paymentMethod.set(a.paymentMethod.id,a.paymentMethod),n.source.set("".concat(a.source.__typename,"-").concat(a.source.id),a.source),t.push(a))}}catch(e){r.e(e)}finally{r.f()}return[t,{category:$()(n.category.values()),department:$()(n.department.values()),paymentMethod:$()(n.paymentMethod.values()).filter((function(e){var n;return"5dc46d0af74afb2c2805bd54"!==(null===(n=e.parent)||void 0===n?void 0:n.id)})),source:$()(n.source.values())}]}),[en,s]),tn=q()(nn,2),rn=tn[0],an=tn[1],ln=(0,r.useMemo)((function(){return[{field:"reconciled",title:"Reconciled",render:function(e){return e.reconciled?r.createElement(Y.Z,null):null},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return r.createElement(Aa,{setFilter:function(e){var r,a;return t(null!==(a=null===(r=n.tableData)||void 0===r?void 0:r.id)&&void 0!==a?a:"0",e)}})},hidden:s===ll.Reconcile,filtering:!0},{field:"total",title:"Total",render:function(e){var n=e.total;return J()(Tn(n).valueOf()).format("$0,0.00")},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return r.createElement(al,{setFilter:function(e){var r,a;t(null!==(a=null===(r=n.tableData)||void 0===r?void 0:r.id)&&void 0!==a?a:"1",e)}})}},{field:"date",title:"Date",render:function(e){var n=e.date;return(0,pe.default)(new Date(n),"MMM dd, yyyy")},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return r.createElement(Ha,{setFilter:function(e){var r,a;t(null!==(a=null===(r=n.tableData)||void 0===r?void 0:r.id)&&void 0!==a?a:"2",e)}})},defaultSort:"desc"},{field:"dateOfRecord",title:"Date Of record",render:function(e){var n=e.date,t=e.dateOfRecord;return(0,pe.default)(new Date((null==t?void 0:t.date)||n),"MMM dd, yyyy")},searchable:!1,filtering:!1,sorting:!1},{field:"category",title:"Category",render:function(e,n){var t="group"===n?e.name:e.category.name;return(0,G.I)(t)},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return r.createElement(Sa,{options:an.category,setFilter:function(e){var r,a;return t(null!==(a=null===(r=n.tableData)||void 0===r?void 0:r.id)&&void 0!==a?a:"3",e)}})}},{field:"source",title:"Source",render:function(e){var n=e.source;switch(n.__typename){case"Person":return"".concat(n.name.first," ").concat(n.name.last);case"Business":return n.bizName;case"Department":return n.deptName}},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return r.createElement(Pa,{options:an.source,setFilter:function(e){var r,a;return t(null!==(a=null===(r=n.tableData)||void 0===r?void 0:r.id)&&void 0!==a?a:"4",e)}})}},{field:"paymentMethod",title:"Payment Method",render:function(e){var n,t=e.paymentMethod;return(null===(n=t.parent)||void 0===n?void 0:n.id)===xe?"CK-".concat(t.name):t.name},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return r.createElement(Da,{options:an.paymentMethod,setFilter:function(e){var r,a;return t(null!==(a=null===(r=n.tableData)||void 0===r?void 0:r.id)&&void 0!==a?a:"5",e)}})}},{field:"description",title:"Description",render:function(e){return e.description},searchable:!1,filtering:!1,sorting:!1},{field:"department",title:"Department",render:function(e){var n=e.department;return(0,G.I)(n.name)},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return r.createElement(Ta,{options:an.department,setFilter:function(e){var r,a;return t(null!==(a=null===(r=n.tableData)||void 0===r?void 0:r.id)&&void 0!==a?a:"5",e)}})}}]}),[an.category,an.department,an.paymentMethod,an.source,s]),on=(0,r.useMemo)((function(){return{toolbar:{searchTooltip:r.createElement(ee.Z,{fontSize:12,component:"span"},'[abc] | [efg] = "abc" OR "efg"',r.createElement("br",null),'\'[abc] = EXACTLY "abc"',r.createElement("br",null),'![abc] = NOT "abc"',r.createElement("br",null),'^[abc] = STARTS WITH "abc"',r.createElement("br",null),'!^[abc] = DOES NOT START WITH "abc"',r.createElement("br",null),'[abc]$ = ENDS WITH "abc"',r.createElement("br",null),'![abc]$ = DOES NOT END WITH "abc"'),nRowsSelected:"Reconcile {0} Entry(s)"}}}),[]),un=(0,r.useState)(0),cn=q()(un,2),dn=cn[0],sn=cn[1],mn=(0,r.useMemo)((function(){return{rowStyle:function(e){var n={};return n.color=e.type===R.Credit?le.Z[900]:oe.Z[900],n},maxBodyHeight:"calc(100vh - 53px - 64px)",headerStyle:{position:"sticky",top:0},pageSize:25,pageSizeOptions:dn?[25,50,100,dn]:[25,50,100],showTitle:!!o,selection:s===ll.Reconcile,showSelectAllCheckbox:!1,debounceInterval:500,emptyRowsWhenPaging:!1,columnsButton:!0,filtering:!0,sorting:!0,thirdSortClick:!1,exportAllData:!0,exportButton:!0,exportFileName:o||"lsccBudgetTracking",exportCsv:function(e,n){var t=be.unparse(n.reduce((function(n,t){return n.push(e.reduce((function(e,n){var r=n.field,a=n.title,l=n.render;switch(r){case"reconciled":case"date":e[a||r]=t[r];break;default:e[a||r]=l?l(t,"row"):t[r]}return e}),{})),n}),[]));(0,he.saveAs)(new Blob([t],{type:"text/plain;charset=utf-8"}),"".concat(o||"budgetTracking",".csv"))}}}),[o,s,dn]),pn=(0,r.useMemo)((function(){return s===ll.Reconcile?[{icon:function(e){return r.createElement(Q.Z,Object.assign({},e))},tooltip:"Reconcile Selected",position:"toolbarOnSelect",iconProps:{color:"secondary",fontSize:"large"},onClick:(e=x()(U().mark((function e(n,t){return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all((Array.isArray(t)?t:[t]).map(function(){var e=x()(U().mark((function e(n){return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.reconciled){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,"JournalEntryRefund"!==n.__typename){e.next=8;break}return e.next=6,Be({variables:{id:n.id}});case 6:e.next=10;break;case 8:return e.next=10,Ne({variables:{id:n.id}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)}))),function(n,t){return e.apply(this,arguments)})}]:[function(e){var n=function(){switch(e.__typename){case"JournalEntry":return{tooltip:"Delete Entry",onClick:function(e,n){return S(n.id)}};case"JournalEntryRefund":return{tooltip:"Delete Refund",onClick:function(e,n){return De(n.id)}}}}(),t=n.tooltip,r=n.onClick;return{icon:K.Z,tooltip:t,onClick:r}},function(e){var n=function(){switch(e.__typename){case"JournalEntry":return{tooltip:"Edit Entry",onClick:function(e,n){g(!0),C(n.id)}};case"JournalEntryRefund":return{tooltip:"Edit Refund",onClick:function(e,n){we(!0),Ae({entryId:n.refunds,refundId:n.id})}}}}(),t=n.tooltip,r=n.onClick;return{icon:X.Z,tooltip:t,onClick:r}},function(e){if("JournalEntry"!==e.__typename)return null;var n=e.type===R.Credit;return{icon:function(e){return n?r.createElement(ie.Z,Object.assign({},e)):r.createElement(ue.Z,Object.assign({},e))},tooltip:n?"Give Refund":"Add Refund",iconProps:{style:{color:n?oe.Z[900]:le.Z[900]}},onClick:function(e,n){P(!0),se(n.id)}}},{icon:function(e){return r.createElement(H.Z,Object.assign({},e))},iconProps:{color:"secondary",fontSize:"large"},tooltip:"Add Entry",isFreeAction:!0,onClick:function(){v(!0)}}];var e}),[s,Be,Ne,De,S]),fn=(0,r.useMemo)((function(){return new Map}),[]),vn=(0,r.useMemo)((function(){return{Body:ze?function(e){return r.createElement(ne.Z,Object.assign({},e),r.createElement(te.Z,null,r.createElement(re.Z,{colSpan:ln.length+(Array.isArray(pn)&&pn.length>0?1:0),align:"left"},r.createElement(ae.Z,{align:"center",color:"error",variant:"h4"},"Error Loading Entries"),r.createElement(ae.Z,{variant:"body1"},ze.message))))}:function(e){return r.createElement(B.MTableBody,Object.assign({},e))},Row:function(e){var n=sl(sl({},e),{},{onToggleDetailPanel:function(n,t){fn.has(e.data.id)?fn.delete(e.data.id):fn.set(e.data.id,t);for(var r=arguments.length,a=new Array(r>2?r-2:0),l=2;l<r;l++)a[l-2]=arguments[l];return e.onToggleDetailPanel.apply(e,[n,t].concat(a))}});return r.createElement(B.MTableBodyRow,Object.assign({},n))}}}),[ze,ln.length,pn,fn]),yn=(0,r.useMemo)((function(){return[function(e){var n="JournalEntry"===e.__typename,t=!!n&&e.items.length>0;return{icon:function(e){return n?t?r.createElement(ce.Z,Object.assign({},e)):r.createElement(de.Z,Object.assign({},e)):null},openIcon:function(e){return t?r.createElement(ce.Z,Object.assign({},e,{color:"primary"})):r.createElement(de.Z,Object.assign({},e,{color:"primary"}))},disabled:!n,tooltip:n?"Itemize":void 0,render:function(e){return"JournalEntry"!==e.__typename?null:r.createElement(Ca,{entry:e})}}}]}),[]),En=(0,r.useState)(new(ye())(0)),bn=q()(En,2),hn=bn[0],gn=bn[1],On=(0,r.useMemo)((function(){var e=(null==He?void 0:He.name)?"".concat(null==He?void 0:He.name," "):"",n=hn.compare(new(ye())(0)),t=r.createElement(ee.Z,{color:0===n?void 0:n>0?le.Z[900]:oe.Z[900],component:"span"},J()(hn.valueOf()).format("$0,0.00"));return o?r.createElement(ae.Z,{variant:"h6"},"".concat(e).concat(o,": "),t):r.createElement(ae.Z,{variant:"h6"},e,t)}),[He,hn,o]),Zn=(0,r.useRef)(null),wn=(0,r.useCallback)(function(){var e=x()(U().mark((function e(n){var t,r,a,l,o,i,c,d,s,m,p,f,v,y,E,b,h,g,O,Z,w,C,M;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.filters,a=n.page,l=n.pageSize,o=n.orderBy,i=n.orderDirection,c=null===(t=n.search)||void 0===t?void 0:t.trim(),d=c?new z.Z(rn,{keys:["date","total","description","department","category","paymentMethod","source"],threshold:.4,useExtendedSearch:!0,getFn:function(e,n){return(Array.isArray(n)?n:[n]).reduce((function(n,t){var r;switch(t){case"date":var a=new Date(e.date);n.push(e.date,(0,pe.default)(a,"M/d/yy"),(0,pe.default)(a,"MM/d/yy"),(0,pe.default)(a,"M/d/yyyy"),(0,pe.default)(a,"MM/d/yyyy"),(0,pe.default)(a,"MMM dd, yyyy"));break;case"total":var l=Tn(e.total).valueOf();n.push(J()(l).format("$0,0.00"),l.toFixed(2));break;case"description":n.push((null===(r=e.description)||void 0===r?void 0:r.trim())||"");break;case"department":n.push(e.department.name);break;case"category":n.push(e.category.name);break;case"paymentMethod":n.push(e.paymentMethod.name);break;case"source":switch(e.source.__typename){case"Person":n.push(e.source.name.first,e.source.name.last);break;case"Business":n.push(e.source.bizName);break;case"Department":n.push(e.source.deptName)}}return n}),[])}}).search(c).map((function(e){return e.item})):rn,s=[],m={$and:[]},r.length>0){p=m.$and,f=ml(r);try{for(f.s();!(v=f.n()).done;)y=v.value,Object.keys(y.value).length>0&&p.push(y.value)}catch(e){f.e(e)}finally{f.f()}}if(m.$and.length>0&&s.push({$addFields:{_dateStr_:"$date",date:{$expressionCb:function(e){return(0,fe.Z)(new Date(e.date))}},_totalRational_:"$total",total:{$expressionCb:function(e){return Tn(e.total).valueOf()}}}},{$match:m},{$addFields:{date:"$_dateStr_",total:"$_totalRational_"}},{$project:{_dateStr_:!1,_totalRational_:!1}}),E={data:[],raw:[]},!o){e.next=29;break}b=o.field,e.t0=b,e.next="date"===e.t0?13:"total"===e.t0?15:"reconciled"===e.t0?17:"department"===e.t0?19:"category"===e.t0?21:"paymentMethod"===e.t0?23:"source"===e.t0?25:27;break;case 13:return E.data.push({$addFields:{_sortBy_:{$toDate:"$date"}}}),e.abrupt("break",28);case 15:return E.data.push({$addFields:{_sortBy_:{$expressionCb:function(e){return Tn(e.total).valueOf()}}}}),e.abrupt("break",28);case 17:return E.data.push({$addFields:{_sortBy_:"$reconciled"}}),e.abrupt("break",28);case 19:return E.data.push({$addFields:{_sortBy_:"$department.name"}}),e.abrupt("break",28);case 21:return E.data.push({$addFields:{_sortBy_:"$category.name"}}),e.abrupt("break",28);case 23:return E.data.push({$addFields:{_sortBy_:"$paymentMethod.name"}}),e.abrupt("break",28);case 25:return E.data.push({$addFields:{_sortBy_:{$cond:{if:{$eq:[{$ifNull:["$source.name.first",null]},null]},then:"$source.name",else:{$concat:["$source.name.first"," ","$source.name.last"]}}}}}),e.abrupt("break",28);case 27:E.data.push({$addFields:{_sortBy_:{$toDate:"$date"}}});case 28:E.data.push({$sort:{_sortBy_:"asc"===i?1:-1}},{$project:{_sortBy_:!1}});case 29:return E.data.push({$skip:a*l},{$limit:l}),s.push({$facet:E}),h=new Ee.Aggregator(s).run(d),g=q()(h,1),O=g[0],Z=O.data.map((function(e){return fn.has(e.id)?sl(sl({},e),{},{tableData:{showDetailPanel:fn.get(e.id)}}):e})),w=O.raw,function(){var e=new Map(fn);fn.clear();var n,t=ml(w);try{for(t.s();!(n=t.n()).done;){var r=n.value.id;e.has(r)&&fn.set(r,e.get(r))}}catch(e){t.e(e)}finally{t.f()}}(),C=w.length,M=function(){var e,n=new(ye())(0),t=ml(w);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(!r.deleted){var a=Tn(r.total);if(u){var l,o=ml(r.items);try{for(o.s();!(l=o.n()).done;){var i=l.value;i.deleted||!i.department||i.department.id===u||i.department.ancestors.some((function(e){return"Department"===e.__typename&&e.id===u}))||(a=a.sub(Tn(i.total)))}}catch(e){o.e(e)}finally{o.f()}}n=r.type===R.Credit?n.add(a):n.sub(a)}}}catch(e){t.e(e)}finally{t.f()}return n}(),0!==hn.compare(M)&&gn(M),sn(C),e.abrupt("return",{data:Z,page:a,totalCount:C});case 40:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[hn,u,rn,fn,sn]);return(0,r.useEffect)((function(){Zn.current&&Zn.current.onQueryChange(null)}),[Zn,rn]),r.createElement(r.Fragment,null,r.createElement(W(),{icons:Ke,isLoading:Xe||qe||We,columns:ln,data:wn,options:mn,localization:on,actions:pn,components:vn,title:On,detailPanel:yn,tableRef:Zn}),r.createElement(Ar,{deptId:u,open:f,onClose:y}),r.createElement(Jr,{entryId:w,open:h,onClose:M,onExited:A}),r.createElement(Yr,{entryId:_,onClose:I}),r.createElement(wt,{entryId:V,open:T,onClose:me,onExited:ve}),r.createElement(St,{entryId:null!==(n=null==Me?void 0:Me.entryId)&&void 0!==n?n:null,refundId:null!==(t=null==Me?void 0:Me.refundId)&&void 0!==t?t:null,open:Ze,onClose:ke,onExited:je}),r.createElement(Xr,{refundId:Ie,onClose:Fe}))};var hl=t(43832),gl=t(63957),Ol=t(99805),Zl=t(64122),wl=t(11939),Cl=t(18463),Rl=t(94697),Ml=t(79912),Al=t(59546),kl=t(88105),jl=t(96394);function _l(){var e=D()(["\n  subscription JournalEntryUpdated_2 {\n    journalEntryUpdated {\n      ...GetReportDataEntry_1Fragment\n    }\n  }\n  ","\n"]);return _l=function(){return e},e}function Sl(){var e=D()(["\n  subscription JournalEntryAdded_2 {\n    journalEntryAdded {\n      ...GetReportDataEntry_1Fragment\n    }\n  }\n  ","\n"]);return Sl=function(){return e},e}function Il(){var e=D()(["\n  query GetReportData($deptId:ID!, $where:JournalEntiresWhere!) {\n    department(id:$deptId) {\n      ...GetReportDataDept_1Fragment\n      descendants {\n        ...GetReportDataDept_1Fragment\n      }\n    }\n    journalEntries(where:$where) {\n      ...GetReportDataEntry_1Fragment\n    }\n    fiscalYears {\n      __typename\n      id\n      name\n      begin\n      end\n    }\n  }\n  ",",\n  ","\n"]);return Il=function(){return e},e}function Dl(){var e=D()(["\n  fragment GetReportDataEntry_1Fragment on JournalEntry {\n    id\n    __typename\n    category {\n      __typename\n      id\n      name\n    }\n    type\n    total {\n      n\n      d\n      s\n    }\n    fiscalYear {\n      __typename\n      id\n    }\n    department {\n      __typename\n      id\n      ancestors {\n        __typename\n        ... on Business {\n          id\n        }\n        ... on Department {\n          id\n        }\n      }\n    }\n    refunds {\n      __typename\n      id\n      total {\n        n\n        d\n        s\n      }\n      deleted\n      lastUpdate\n    }\n    items {\n      __typename\n      id\n      total {\n        n\n        d\n        s\n      }\n      department {\n        __typename\n        id\n      }\n      deleted\n    }\n    lastUpdate\n    deleted\n  }\n"]);return Dl=function(){return e},e}function Fl(){var e=D()(["\n  fragment GetReportDataDept_1Fragment on Department {\n    __typename\n    id\n    name\n    budgets {\n      id\n      __typename\n      amount {\n        n\n        d\n        s\n      }\n      fiscalYear {\n        __typename\n        id\n      }\n    }\n  }\n"]);return Fl=function(){return e},e}var Tl=me()(Fl()),xl=me()(Dl()),Pl=me()(Il(),Tl,xl);function $l(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return Nl(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Nl(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Nl(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function ql(){var e=D()(["\n  subscription OnEntryUpsert_2 {\n    journalEntryUpserted {\n      ...GetReportDataEntry_1Fragment\n      department {\n        ancestors {\n          ... on Department {\n            __typename\n            id\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return ql=function(){return e},e}function Ll(){var e=D()(["\n  query DeptForUpsertAdd($id: ID!) {\n    department(id: $id) {\n      ...DeptEntryOptFragment\n    }\n  }\n  ","\n"]);return Ll=function(){return e},e}me()(Sl(),xl),me()(_l(),xl);var Ul=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:800;return e<.75?le.Z[n]:e<.9?Al.Z[n]:oe.Z[n]},Bl=function(e){var n=e.spentPercentage,t=e.height;return r.createElement(ee.Z,{height:t,bgcolor:Ul(n),display:"flex",justifyContent:"flex-start"},r.createElement(ee.Z,{height:"100%",width:"".concat(100*n,"%"),bgcolor:kl.Z[400]}))},Wl=(me()(Ll(),Xn),me()(ql(),xl));const Vl=function(e){var n,t=e.deptId,a=(0,r.useState)(!1),o=q()(a,2),u=o[0],c=o[1],d=(0,r.useCallback)((function(){c(!1)}),[c]),s=(0,r.useMemo)((function(){return{deptId:t,where:{department:{eq:{id:t,matchDescendants:!0}},deleted:!1}}}),[t]),m=(0,l.useQuery)(Pl,{variables:s,fetchPolicy:"cache-and-network"}),p=m.loading,f=m.error,v=m.data,y=m.subscribeToMore,E=p&&!(null==v?void 0:v.journalEntries);(0,r.useEffect)((function(){return y({document:Wl,updateQuery:function(e,n){var r=n.subscriptionData;if(!r.data)return e;var a=r.data.journalEntryUpserted,l=a.department.ancestors;if(t&&a.department.id!==t&&l.every((function(e){return"Department"===e.__typename&&e.id!==t}))){var o=e.journalEntries.filter((function(e){return e.id!==a.id}));return o.length===e.journalEntries.length?e:Object.assign({},e,{journalEntries:o})}return e.journalEntries.some((function(e){return e.id===a.id}))?e:Object.assign({},e,{journalEntries:[a].concat($()(e.journalEntries))})}})}),[t,y]);var b=(0,r.useState)(new Date((new Date).toDateString())),h=q()(b,2),g=h[0],O=h[1],Z=(0,r.useMemo)((function(){var e,n=$l((null==v?void 0:v.fiscalYears)||[]);try{for(n.s();!(e=n.n()).done;){var t=e.value;if(g>=new Date(t.begin)&&g<new Date(t.end))return t}}catch(e){n.e(e)}finally{n.f()}return null}),[g,v]),w=(0,r.useMemo)((function(){return((null==v?void 0:v.journalEntries)||[]).filter((function(e){return!e.deleted&&(null==Z?void 0:Z.id)===e.fiscalYear.id}))}),[v,Z]),C=(null===(n=null==v?void 0:v.department)||void 0===n?void 0:n.name)||"";(0,r.useEffect)((function(){document.title=C}),[C]);var M=(null==v?void 0:v.department)||null,A=(0,r.useMemo)((function(){var e,n=new Map,t=new(ye())(0),r=new(ye())(0),a=[];M&&function(){var r=new Set;a.push.apply(a,[M].concat($()(M.descendants)));var l,o=$l(a);try{for(o.s();!(l=o.n()).done;){var i=l.value,u=null!==(e=i.budgets.find((function(e){return e.fiscalYear.id===(null==Z?void 0:Z.id)&&!r.has(e.id)})))&&void 0!==e?e:null,c=null;if(u){var d=u.amount;r.add(u.id),c=Tn(d),t=t.add(c)}n.set(i.id,{name:i.name,spent:new(ye())(0),budget:c})}}catch(e){o.e(e)}finally{o.f()}}();var l,o=$l(w);try{for(o.s();!(l=o.n()).done;){var i=l.value;if(!i.deleted){var u,c=n.get(i.department.id),d=Tn(i.total),s=$l(i.refunds);try{for(s.s();!(u=s.n()).done;){var m=u.value;m.deleted||(d=d.sub(Tn(m.total)))}}catch(e){s.e(e)}finally{s.f()}if(M){var p,f=$l(i.items);try{var v=function(){var e=p.value;if(e.deleted||!e.department||a.some((function(n){var t;return n.id===(null===(t=e.department)||void 0===t?void 0:t.id)})))return"continue";d=d.sub(Tn(e.total))};for(f.s();!(p=f.n()).done;)v()}catch(e){f.e(e)}finally{f.f()}}i.type===R.Credit?(r=r.sub(d),c.spent=c.spent.sub(d)):(r=r.add(d),c.spent=c.spent.add(d))}}}catch(e){o.e(e)}finally{o.f()}return{totalRemaining:J()(t.sub(r).valueOf()).format("$0,0.00"),budget:J()(t.valueOf()).format("$0,0.00"),spentToBudgetRatio:0===t.n?1:r.div(t).valueOf(),deptReports:n,uBudget:t}}),[w,M]),k=A.totalRemaining,j=A.budget,_=A.spentToBudgetRatio,S=A.deptReports,I=A.uBudget,D=(0,r.useMemo)((function(){var e,n=[],t=$l(S);try{var a=function(){var t=q()(e.value,2),a=t[0],l=t[1],o=l.budget,i=l.spent,u=l.name;if(a===(null==M?void 0:M.id)&&(!o||o.equals(I)))return"continue";var c=r.createElement(an.Z,{key:a,item:!0,xs:12,md:4,lg:3},r.createElement(Cl.Z,null,r.createElement(Rl.Z,{titleTypographyProps:{noWrap:!0},title:u}),r.createElement(Ml.Z,null,function(){if(null===o||0===o.n)return r.createElement(ee.Z,{color:i.compare(new(ye())(0))>0?oe.Z[900]:le.Z[900],clone:!0},r.createElement(ae.Z,{variant:"h6"},"Spent: ".concat(J()(i.abs().valueOf()).format("$0,0.00"))));var e=o.sub(i),n=i.div(o).valueOf();return r.createElement(r.Fragment,null,r.createElement(ee.Z,{color:Ul(n,900),clone:!0},r.createElement(ae.Z,{variant:"h6"},"".concat(J()(e.valueOf()).format("$0,0.00")," Remaining"))),r.createElement(ae.Z,{variant:"body1"},"of ".concat(J()(o.valueOf()).format("$0,0.00"))),r.createElement(Bl,{spentPercentage:n,height:5}))}())));n.push(c)};for(t.s();!(e=t.n()).done;)a()}catch(e){t.e(e)}finally{t.f()}return n}),[S,M,I]),F=(0,r.useCallback)((function(){return c(!0)}),[c]),T=(0,r.useMemo)((function(){return console.log("data?.fiscalYears",null==v?void 0:v.fiscalYears),r.createElement(ee.Z,{minWidth:120,clone:!0},r.createElement(yr.Z,{variant:"outlined"},r.createElement(jl.Z,null,"Fiscal Year"),r.createElement(Ra.Z,{label:"Fiscal Year<",variant:"outlined",value:(null==Z?void 0:Z.id)||"",onChange:function(e){var n=e.target.value;if(n){var t,r=$l((null==v?void 0:v.fiscalYears)||[]);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a.id===n)return void O(new Date(a.begin))}}catch(e){r.e(e)}finally{r.f()}}}},$()((null==v?void 0:v.fiscalYears)||[]).sort((function(e,n){return new Date(e.begin).getTime()-new Date(n.begin).getTime()})).map((function(e){return r.createElement(Ma.Z,{key:e.id,value:e.id},e.name)})))))}),[v,O,Z]);return E?r.createElement("p",null,"Loading..."):f?(console.error(f),r.createElement("p",null,f.message)):r.createElement(ee.Z,{display:"flex",flexDirection:"column",overflow:"hidden",clone:!0},r.createElement(hl.Z,null,r.createElement(ee.Z,{padding:8},r.createElement(an.Z,{container:!0,alignItems:"center",justify:"center",spacing:4},r.createElement(an.Z,{item:!0},r.createElement(on.Z,{variant:"contained",color:"secondary",startIcon:r.createElement(gl.Z,null),onClick:F},"New Entry")),r.createElement(an.Z,{item:!0},r.createElement(on.Z,{disabled:!Z,component:i.rU,to:"/journal/".concat(t,"/").concat((null==Z?void 0:Z.id)||"","/reconcile"),variant:"contained",startIcon:r.createElement(Ol.Z,null)},"Reconcile")),r.createElement(an.Z,{item:!0},r.createElement(on.Z,{variant:"contained",startIcon:r.createElement(wl.Z,null)},"Reports")),r.createElement(an.Z,{item:!0},r.createElement(on.Z,{disabled:!Z,component:i.rU,to:"/journal/".concat(t,"/").concat((null==Z?void 0:Z.id)||""),variant:"contained",startIcon:r.createElement(Zl.Z,null)},"Journal")),r.createElement(an.Z,{item:!0},T))),r.createElement(ee.Z,{flexGrow:1,overflow:"auto"},r.createElement(an.Z,{justify:"center",container:!0,spacing:2},r.createElement(an.Z,{item:!0,xs:12},r.createElement(ae.Z,{align:"center",variant:"h3"},C),r.createElement(ee.Z,{color:Ul(_.valueOf())},r.createElement(ae.Z,{align:"center",variant:"h4"},"".concat(k," Remaining"))),r.createElement(ae.Z,{align:"center",variant:"subtitle1"},"of ".concat(j)),r.createElement(Bl,{spentPercentage:_.valueOf(),height:10})),D)),r.createElement(Ar,{deptId:t,open:u,onClose:d})))};function Jl(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return Gl(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Gl(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Gl(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function zl(){var e=D()(["\n  query DeptsForNav_1 {\n    departments {\n      __typename\n      id\n      name\n      parent {\n        __typename\n        ... on Business {\n          id\n        }\n        ... on Department {\n          id\n        }\n      }\n      virtualRoot\n    }\n  }\n"]);return zl=function(){return e},e}var Yl=me()(zl());const Ql=function(e){var n=(0,l.useQuery)(Yl),t=n.loading,a=n.error,o=n.data,u=(0,r.useState)(""),c=q()(u,2),d=c[0],s=c[1],m=(null==o?void 0:o.departments)||[],p=(0,r.useMemo)((function(){var e,n=[],t=new Set,r=Jl(m);try{for(r.s();!(e=r.n()).done;){var a=e.value;"Business"===a.parent.__typename&&n.push(a),a.virtualRoot&&t.add(a.id)}}catch(e){r.e(e)}finally{r.f()}return{rootDepts:n,virtualRoots:t}}),[m]),f=p.rootDepts,v=p.virtualRoots,y=(0,r.useMemo)((function(){var e=[];if(d&&v.has(d)){var n,t=Jl(m);try{for(t.s();!(n=t.n()).done;){var r=n.value;r.parent.id===d&&e.push(r)}}catch(e){t.e(e)}finally{t.f()}}return e}),[v,d,m]);(0,r.useEffect)((function(){document.title="Select Department"}));var E=(0,r.useCallback)((function(e){var n;s((null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.value)||"")}),[s]);if(t)return r.createElement("p",null,"Loading...");if(a)return r.createElement("p",null,a.message);var b=y.length>0;return r.createElement(ee.Z,{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",clone:!0},r.createElement(hl.Z,{style:{display:"flex"}},r.createElement(ee.Z,{padding:4,clone:!0},r.createElement(ae.Z,{align:"center",color:"primary",variant:"h3"},"Select Department")),r.createElement(ee.Z,{minWidth:"250px !important",clone:!0},r.createElement(yr.Z,{variant:"filled"},r.createElement(jl.Z,null,"Department"),r.createElement(Ra.Z,{value:d,onChange:E,autoWidth:!0},f.map((function(e){var n=e.virtualRoot?{value:e.id,children:e.name}:{component:i.rU,to:"/department/".concat(e.id),value:e.id,children:e.name};return r.createElement(Ma.Z,Object.assign({key:e.id},n))}))))),b&&r.createElement(ee.Z,{pt:2},r.createElement(ee.Z,{pt:2,minWidth:"250px !important",clone:!0},r.createElement(yr.Z,{variant:"filled"},r.createElement(jl.Z,null,"Sub Department"),r.createElement(Ra.Z,{autoWidth:!0},y.map((function(e){var n={component:i.rU,to:"/department/".concat(e.id),value:e.id,children:e.name};return r.createElement(Ma.Z,Object.assign({key:e.id},n))}))))))))};function Kl(){var e=D()(["\n  query DepartmentName_1($id: ID!) {\n    department(id: $id) {\n      id\n      __typename\n      name\n    }\n  }\n"]);return Kl=function(){return e},e}var Xl=function(){var e=(0,F.UO)().id;return e?r.createElement(Vl,{deptId:e}):r.createElement("div",null,"Error: No Dept ID!")},Hl=me()(Kl()),eo=function(){var e,n=(0,F.UO)(),t=n.id,a=n.year,o=(0,l.useQuery)(Hl,{variables:{id:t}}).data,i=(null===(e=null==o?void 0:o.department)||void 0===e?void 0:e.name)?o.department.name:void 0;return r.createElement(bl,{mode:ll.View,deptId:t,fiscalYearId:a,journalTitle:i})},no=function(){var e,n=(0,F.UO)(),t=n.id,a=n.year,o=(0,l.useQuery)(Hl,{variables:{id:t}}).data,i=(null===(e=null==o?void 0:o.department)||void 0===e?void 0:e.name)?"Reconcile ".concat(o.department.name):"Reconcile";return r.createElement(bl,{mode:ll.Reconcile,deptId:t,fiscalYearId:a,journalTitle:i})};const to=function(){return r.createElement(F.rs,null,r.createElement(F.AW,{exact:!0,path:"/",component:Ql}),r.createElement(F.AW,{exact:!0,path:"/department/:id",component:Xl}),r.createElement(F.AW,{exact:!0,path:"/journal",component:bl}),r.createElement(F.AW,{exact:!0,path:"/journal/:id/:year",component:eo}),r.createElement(F.AW,{exact:!0,path:"/journal/:id/:year/reconcile",component:no}))};a.render(r.createElement((function(){return r.createElement(r.Fragment,null,r.createElement(o.ZP,null),r.createElement(l.ApolloProvider,{client:Z},r.createElement(i.VK,null,r.createElement(to,null))))}),null),document.getElementById("root"))}},0,[[24965,666,939]]]);
//# sourceMappingURL=main.fb561c80a5c2f0aedacf.js.map