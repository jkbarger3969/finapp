(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{397:function(e){e.exports=JSON.parse('{"__schema":{"types":[{"kind":"UNION","name":"BudgetOwner","possibleTypes":[{"name":"Department"},{"name":"Business"}]},{"kind":"UNION","name":"DepartmentAncestor","possibleTypes":[{"name":"Department"},{"name":"Business"}]},{"kind":"UNION","name":"PaymentMethodAuthorizedEntity","possibleTypes":[{"name":"Person"},{"name":"Business"},{"name":"Department"}]},{"kind":"UNION","name":"JournalEntrySource","possibleTypes":[{"name":"Person"},{"name":"Business"},{"name":"Department"}]}]}}')},5771:function(e,n,t){"use strict";t.r(n);var a,r,l,o,i,u,c,d,s,m=t(0),p=t.n(m),f=t(33),v=t.n(f),b=t(75),y=t(5809),E=t(119),h=t(133),g=t(303),O=t(397),j=new g.b({introspectionQueryResultData:O}),w=new g.a({fragmentMatcher:j,addTypename:!0}),C={},M=t(420),R=t(399),A=t(62),k=t(401),_=t(157),S=new M.a({uri:"/graphql",credentials:"same-origin"}),I=new R.a({uri:"ws://".concat(window.location.host,"/graphql"),options:{reconnect:!0}}),D=A.a.from([Object(k.a)((function(e){var n=e.graphQLErrors,t=e.networkError;n&&n.forEach((function(e){var n=e.message,t=e.locations,a=e.path;return console.error("[GraphQL error]: Message: ".concat(n,", Location: ").concat(t,", Path: ").concat(a))})),t&&console.log("[Network error]: ".concat(t))})),A.a.split((function(e){var n=e.query,t=Object(_.a)(n);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),I,S)]),T=new h.a({link:D,cache:w,resolvers:C}),x=t(17),F=t.n(x),P=t(132),$=t(40),N=t.n($),q=t(53),L=t.n(q),B=t(10),U=t.n(B),W=t(20),J=t.n(W),V=t(42),G=t.n(V),z=t(172),Y=t.n(z),K=t(25),X=t(63),Q=t.n(X),H=t(5844),Z=t(409),ee=t(5840),ne=t(5841),te=t(5836),ae=t(5819),re=t(5837),le=t(289),oe=t(362),ie=t(363),ue=t(359),ce=t(64),de=t(166),se=t(163),me=t(41),pe=t(18),fe=t.n(pe),ve=t(419),be=t(173),ye=t(23),Ee=t.n(ye),he=(t(5770),t(170)),ge=t(410),Oe=t(411);function je(){var e=F()(["\n  subscription JournalEntryUpdated_1 {\n    journalEntryUpdated {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return je=function(){return e},e}function we(){var e=F()(["\n  subscription JournalEntryAdded_1 {\n    journalEntryAdded {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return we=function(){return e},e}function Ce(){var e=F()(['\n  query JournalEntries_1($where: JournalEntiresWhereInput!) {\n    journalEntries(where: $where)\n      @connection(key: "JournalEntries_1", filter: ["where"]) {\n      ...JournalEntry_1Fragment\n    }\n    fiscalYears {\n      __typename\n      id\n      name\n      begin\n      end\n    }\n  }\n  ',"\n"]);return Ce=function(){return e},e}function Me(){var e=F()(["\n  fragment JournalEntry_1Fragment on JournalEntry {\n    __typename\n    id\n    date\n    department {\n      __typename\n      id\n      name\n      ancestors {\n        __typename\n        ... on Business {\n          id\n          bizName: name\n        }\n        ... on Department {\n          id\n          deptName: name\n        }\n      }\n    }\n    type\n    category {\n      ...JournalEntryCategory_1Fragment\n    }\n    department {\n      ...JournalEntryDept_1Fragment\n    }\n    description\n    paymentMethod {\n      ...JournalEntryPayMethod_1Fragment\n    }\n    source {\n      __typename\n      ... on Person {\n        id\n        name {\n          first\n          last\n        }\n      }\n      ... on Business {\n        id\n        bizName: name\n      }\n      ... on Department {\n        id\n        deptName: name\n      }\n    }\n    total {\n      n\n      d\n      s\n    }\n    refunds {\n      ...JournalEntryRefund_1Fragment\n    }\n    items {\n      ...JournalEntryItem_1Fragment\n    }\n    deleted\n    lastUpdate\n    reconciled\n  }\n  ","\n  ","\n  ","\n  ","\n  ","\n"]);return Me=function(){return e},e}function Re(){var e=F()(["\n  fragment JournalEntryItem_1Fragment on JournalEntryItem {\n    __typename\n    id\n    category {\n      ...JournalEntryCategory_1Fragment\n    }\n    department {\n      ...JournalEntryDept_1Fragment\n    }\n    total {\n      n\n      d\n      s\n    }\n    units\n    description\n    lastUpdate\n    deleted\n  }\n  ","\n  ","\n"]);return Re=function(){return e},e}function Ae(){var e=F()(["\n  fragment JournalEntryRefund_1Fragment on JournalEntryRefund {\n    __typename\n    id\n    date\n    description\n    total {\n      n\n      d\n      s\n    }\n    paymentMethod {\n      ...JournalEntryPayMethod_1Fragment\n    }\n    reconciled\n    lastUpdate\n    deleted\n  }\n  ","\n"]);return Ae=function(){return e},e}function ke(){var e=F()(["\n  fragment JournalEntryDept_1Fragment on Department {\n    __typename\n    id\n    name\n    ancestors {\n      __typename\n      ... on Business {\n        id\n        bizName: name\n      }\n      ... on Department {\n        id\n        deptName: name\n      }\n    }\n  }\n"]);return ke=function(){return e},e}function _e(){var e=F()(["\n  fragment JournalEntryCategory_1Fragment on JournalEntryCategory {\n    __typename\n    id\n    type\n    name\n  }\n"]);return _e=function(){return e},e}function Se(){var e=F()(["\n  fragment JournalEntryPayMethod_1Fragment on PaymentMethod {\n    __typename\n    id\n    name\n    parent {\n      __typename\n      id\n    }\n  }\n"]);return Se=function(){return e},e}!function(e){e.Business="BUSINESS",e.Department="DEPARTMENT"}(a||(a={})),function(e){e.Public="PUBLIC",e.Private="PRIVATE"}(r||(r={})),function(e){e.Business="BUSINESS",e.Department="DEPARTMENT"}(l||(l={})),function(e){e.Include="INCLUDE",e.Exclude="EXCLUDE"}(o||(o={})),function(e){e.Business="BUSINESS",e.Department="DEPARTMENT",e.Person="PERSON"}(i||(i={})),function(e){e.Credit="CREDIT",e.Debit="DEBIT"}(u||(u={})),function(e){e.Pos="POS",e.Neg="NEG"}(c||(c={})),function(e){e.CaseInsensitive="CaseInsensitive",e.Multiline="Multiline",e.Extended="Extended",e.DotAll="DotAll",e.I="I",e.M="M",e.X="X",e.S="S"}(d||(d={})),function(e){e.Asc="ASC",e.Desc="DESC"}(s||(s={}));var Ie=fe()(Se()),De=fe()(_e()),Te=fe()(ke()),xe=fe()(Ae(),Ie),Fe=fe()(Re(),De,Te),Pe=fe()(Me(),Ie,Te,De,xe,Fe),$e=fe()(Ce(),Pe),Ne=(fe()(we(),Pe),fe()(je(),Pe),"5dc46d0af74afb2c2805bd54"),qe=t(5814),Le=t(5815),Be=t(5816),Ue=t(5817),We=t(5818),Je=t(5820),Ve=t(5821),Ge=t(5822),ze=t(5823),Ye=t(5824),Ke=t(5825),Xe=t(5826),Qe=t(5827),He=t(5828),Ze={Add:Object(m.forwardRef)((function(e,n){return p.a.createElement(qe.a,Object.assign({},e,{ref:n}))})),Check:Object(m.forwardRef)((function(e,n){return p.a.createElement(Le.a,Object.assign({},e,{ref:n}))})),Clear:Object(m.forwardRef)((function(e,n){return p.a.createElement(Be.a,Object.assign({},e,{ref:n}))})),Delete:Object(m.forwardRef)((function(e,n){return p.a.createElement(Ue.a,Object.assign({},e,{ref:n}))})),DetailPanel:Object(m.forwardRef)((function(e,n){return p.a.createElement(We.a,Object.assign({},e,{ref:n}))})),Edit:Object(m.forwardRef)((function(e,n){return p.a.createElement(ae.a,Object.assign({},e,{ref:n}))})),Export:Object(m.forwardRef)((function(e,n){return p.a.createElement(Je.a,Object.assign({},e,{ref:n}))})),Filter:Object(m.forwardRef)((function(e,n){return p.a.createElement(Ve.a,Object.assign({},e,{ref:n}))})),FirstPage:Object(m.forwardRef)((function(e,n){return p.a.createElement(Ge.a,Object.assign({},e,{ref:n}))})),LastPage:Object(m.forwardRef)((function(e,n){return p.a.createElement(ze.a,Object.assign({},e,{ref:n}))})),NextPage:Object(m.forwardRef)((function(e,n){return p.a.createElement(We.a,Object.assign({},e,{ref:n}))})),PreviousPage:Object(m.forwardRef)((function(e,n){return p.a.createElement(Ye.a,Object.assign({},e,{ref:n}))})),ResetSearch:Object(m.forwardRef)((function(e,n){return p.a.createElement(Be.a,Object.assign({},e,{ref:n}))})),Search:Object(m.forwardRef)((function(e,n){return p.a.createElement(Ke.a,Object.assign({},e,{ref:n}))})),SortArrow:Object(m.forwardRef)((function(e,n){return p.a.createElement(Xe.a,Object.assign({},e,{ref:n}))})),ThirdStateCheck:Object(m.forwardRef)((function(e,n){return p.a.createElement(Qe.a,Object.assign({},e,{ref:n}))})),ViewColumn:Object(m.forwardRef)((function(e,n){return p.a.createElement(He.a,Object.assign({},e,{ref:n}))}))},en=t(27),nn=t(34),tn=t(5785),an=t(5811),rn=t(5810),ln=t(5787),on=t(5802),un=t(5788),cn=t(148),dn=t(5832),sn=t(5833);function mn(){var e=F()(["\n  mutation AddEntryRefund(\n    $id: ID!\n    $fields: JournalEntryAddRefundFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n  ) {\n    journalEntryAddRefund(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n    ) {\n      id\n      __typename\n      refunds {\n        ...JournalEntryRefund_1Fragment\n      }\n    }\n  }\n  ","\n"]);return mn=function(){return e},e}var pn,fn=fe()(mn(),xe),vn=function(){var e=N()(J.a.mark((function e(n,t,a){var r,l,o,i,u,c;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=void 0,d=a.paymentMethod.value[a.paymentMethod.value.length-1],o="string"==typeof d?{paymentMethod:"",paymentMethodAdd:{parent:a.paymentMethod.value[a.paymentMethod.value.length-2].id,refId:d,name:d,active:!1}}:{paymentMethod:d.id,paymentMethodAdd:null},i=o.paymentMethod,u=o.paymentMethodAdd,c={id:t,fields:{date:a.date.value,description:(null===(r=a.description)||void 0===r?void 0:r.trim())?a.description.trim():null,paymentMethod:i,total:a.total.value,reconciled:null!==(l=a.reconciled)&&void 0!==l?l:null},paymentMethodAdd:u},e.next=4,n.mutate({mutation:fn,variables:c});case 4:case"end":return e.stop()}var d}),e)})));return function(n,t,a){return e.apply(this,arguments)}}(),bn=t(32),yn=t.n(bn),En=t(45),hn=t(287),gn=t(142),On=t(168),jn=t(5829),wn=t(5830),Cn=t(5831),Mn=function(e){return function(n){for(var t=arguments.length,a=new Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];return{inputValue:n,value:e.apply(void 0,[n].concat(a))}}};!function(e){e[e.NOTIFICATION=0]="NOTIFICATION",e[e.ERROR=1]="ERROR",e[e.FATAL_ERROR=2]="FATAL_ERROR"}(pn||(pn={}));var Rn=function(){var e=Object(en.c)(),n=e.setStatus,t=e.status,a=Object(m.useCallback)((function(e){t?e&&!Object.keys(e).some((function(n){return e[n]!==t[n]}))||n(e):e&&n(e)}),[n,t]);return[null!=t?t:null,a]};function An(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function kn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?An(Object(t),!0).forEach((function(n){G()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):An(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var _n={inputMode:"numeric"},Sn={tabIndex:-1},In=Mn((function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];var a=n[0],r=n[1];return a&&Object(On.a)(a)?Object(jn.a)(a):r||""})),Dn=function(e){var n,t,a,r=e.autoFocus,l=void 0!==r&&r,o=e.disabled,i=void 0!==o&&o,u=e.maxDate,c=void 0===u?new Date:u,d=e.minDate,s=e.variant,f=void 0===s?"filled":s,v=yn()(e,["variant"]),b=Object(en.c)().isSubmitting,y=Object(m.useCallback)((function(e){var n=((null==e?void 0:e.value)||"").trim();if(!n)return"Date is Required";var t=Object(wn.a)(n);return Object(On.a)(t)?d&&t<d?"Cannot be before ".concat(Object(ve.a)(d,"MM/dd/yyyy")):c<t?"Cannot be after ".concat(Object(ve.a)(c,"MM/dd/yyyy")):void 0:"Invalid Date"}),[d,c]),E=Object(en.b)({name:"date",validate:y}),h=U()(E,3),g=h[0],O=h[1],j=h[2],w=null!==(t=null===(n=g.value)||void 0===n?void 0:n.inputValue)&&void 0!==t?t:null,C=O.error,M=O.touched,R=j.setValue,A=j.setTouched,k=null===(a=O.initialValue)||void 0===a?void 0:a.inputValue,_=Object(m.useMemo)((function(){return k&&Object(On.a)(k)?k:new Date}),[k]),S=Object(m.useMemo)((function(){return{autoFocus:l}}),[l]),I=Object(m.useRef)(!1),D=Object(m.useCallback)((function(){return setTimeout((function(){I.current||A(!0)}),0)}),[A,I]),T=Object(m.useCallback)((function(){return I.current=!0}),[I]),x=Object(m.useCallback)((function(){I.current=!1,D()}),[I,D]),F=Object(m.useCallback)((function(e,n){R(In(e&&Object(On.a)(e)?Object(Cn.a)([new Date,e]):e,n))}),[R]),P=Rn(),$=U()(P,1)[0],N=Object(m.useMemo)((function(){return kn(kn({},g),{},{disabled:b||i||(null==$?void 0:$.type)===pn.FATAL_ERROR,value:w,error:M&&!!C,helperText:M?C:void 0,animateYearScrolling:!0,disableToolbar:!0,disableFuture:!0,inputVariant:f,variant:"inline",format:"MM/dd/yyyy",margin:"none",label:"Date",initialFocusedDate:_,autoOk:!0,InputProps:S,inputProps:_n,placeholder:"mm/dd/yyyy",KeyboardButtonProps:Sn,onBlur:D,onOpen:T,onClose:x,onChange:F})}),[w,_,D,C,f,S,b,g,T,x,F,M,i,$]);return p.a.createElement(En.a,{utils:gn.default},p.a.createElement(hn.b,Object.assign({maxDate:c},v,N)))},Tn=t(247),xn=function(e){var n,t=e.autoFocus,a=void 0!==t&&t,r=e.disabled,l=void 0!==r&&r,o=e.variant,i=void 0===o?"filled":o,u=yn()(e,["autoFocus","disabled","variant"]),c=Object(en.b)({name:"description"}),d=U()(c,3),s=d[0],f=d[2].setValue,v=Object(m.useCallback)((function(e){var n,t;f((null===(t=null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.value)||void 0===t?void 0:t.trimLeft())||null)}),[f]),b=Object(m.useMemo)((function(){return{type:"text",autoFocus:a}}),[a]),y=Rn(),E=U()(y,1)[0];return p.a.createElement(Tn.a,Object.assign({},u,s,{disabled:l||(null==E?void 0:E.type)===pn.FATAL_ERROR,onChange:v,value:null!==(n=s.value)&&void 0!==n?n:"",variant:i,label:"Description",name:"description",InputProps:b}))},Fn=t(295),Pn=(t(292),function(e){return{n:Math.abs(e.n),d:Math.abs(e.d),s:-1===e.s?c.Neg:c.Pos}}),$n=function(e){return new Ee.a({n:e.s===c.Neg?-Math.abs(e.n):Math.abs(e.n),d:Math.abs(e.d)})},Nn={min:"0.00",step:"0.01"},qn=Mn((function(e){return"string"!=typeof e||e.trim()?Pn(new Ee.a(e).round(2)):Pn(new Ee.a(0))})),Ln=function(e){var n,t,a=e.autoFocus,r=void 0!==a&&a,l=e.disabled,o=void 0!==l&&l,i=e.variant,u=void 0===i?"filled":i,c=e.maxTotal,d=void 0===c?new Ee.a(Number.MAX_SAFE_INTEGER):c,s=e.minTotal,f=void 0===s?new Ee.a(0):s,v=yn()(e,["autoFocus","disabled","variant","maxTotal","minTotal"]),b=new Ee.a(1,100).compare(f)>0?new Ee.a(1,100):f,y=Object(m.useCallback)((function(e){var n,t;if(!e||null===(t=null===(n=e.inputValue)||void 0===n?void 0:n.trim())||void 0===t||!t)return"Total Required";var a=$n(e.value);return Number.isNaN(Number.parseInt(e.inputValue))?"Invalid Number":a.compare(d)>0?"Cannot be greater than ".concat(Q()(d.valueOf()).format("$0,0.00")):0===a.compare(new Ee.a(0))?"Cannot be 0":a.compare(b)<0?"Cannot be less than ".concat(Q()(b.valueOf()).format("$0,0.00")):void 0}),[b,d]),E=Object(en.b)({name:"total",validate:y}),h=U()(E,3),g=h[0],O=h[1],j=h[2].setValue,w=null!==(t=null===(n=g.value)||void 0===n?void 0:n.inputValue)&&void 0!==t?t:"",C=O.error,M=O.touched,R=Object(m.useMemo)((function(){return{type:"number",autoFocus:r,startAdornment:p.a.createElement(Fn.a,{position:"start"},"$")}}),[r]),A=Object(m.useCallback)((function(e){var n,t;j(qn((null===(t=null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.value)||void 0===t?void 0:t.toString())||""))}),[j]),k=Object(m.useMemo)((function(){var e=new Ee.a(Number.MAX_SAFE_INTEGER),n=new Ee.a(1,100);return M&&C?C:0!==d.compare(e)&&b.compare(n)>0?"Max ".concat(Q()(d.valueOf()).format("$0,0.00")," & Min ").concat(Q()(b.valueOf()).format("$0,0.00")):0!==d.compare(e)?"Max ".concat(Q()(d.valueOf()).format("$0,0.00")):b.compare(n)>0?"Min ".concat(Q()(b.valueOf()).format("$0,0.00")):""}),[M,C,d,b]),_=Rn(),S=U()(_,1)[0];return p.a.createElement(Tn.a,Object.assign({},v,g,{disabled:o||(null==S?void 0:S.type)===pn.FATAL_ERROR,type:"number",value:w,error:M&&!!C,helperText:k,placeholder:"0.00",label:"Total",name:"total",required:!0,variant:u,inputProps:Nn,InputProps:R,onChange:A}))},Bn=t(377),Un=t(392),Wn={type:"checkbox"},Jn=function(e){var n,t=e.label,a=e.disabled,r=void 0!==a&&a,l=yn()(e,["label","disabled"]),o=Object(en.b)({name:"reconciled",type:"checkbox"}),i=U()(o,1)[0],u=null!==(n=i.value)&&void 0!==n&&n,c=Rn(),d=U()(c,1)[0];return t?p.a.createElement(Bn.a,Object.assign({},l,i,{value:u,disabled:r||(null==d?void 0:d.type)===pn.FATAL_ERROR,label:"Reconcile",control:p.a.createElement(Un.a,{inputProps:Wn})})):p.a.createElement(Un.a,Object.assign({},l,i,{value:u,disabled:r||(null==d?void 0:d.type)===pn.FATAL_ERROR,inputProps:Wn}))},Vn=t(395);function Gn(){var e=F()(["\n  fragment PayMethodEntryOptFragment on PaymentMethod {\n    __typename\n    id\n    refId\n    name\n    active\n    parent {\n      __typename\n      id\n    }\n  }\n"]);return Gn=function(){return e},e}function zn(){var e=F()(["\n  fragment SrcEntryBizOptFragment on Business {\n    __typename\n    id\n    name\n    vendor {\n      approved\n      vendorId\n    }\n    departments {\n      ...SrcEntryDeptOptFragment\n    }\n  }\n  ","\n"]);return zn=function(){return e},e}function Yn(){var e=F()(["\n  fragment SrcEntryDeptOptFragment on Department {\n    __typename\n    id\n    name\n    parent {\n      ... on Business {\n        __typename\n        id\n      }\n      ... on Department {\n        __typename\n        id\n      }\n    }\n  }\n"]);return Yn=function(){return e},e}function Kn(){var e=F()(["\n  fragment SrcEntryPersonOptFragment on Person {\n    __typename\n    id\n    personName: name {\n      first\n      last\n    }\n  }\n"]);return Kn=function(){return e},e}function Xn(){var e=F()(["\n  fragment CatEntryOptFragment on JournalEntryCategory {\n    __typename\n    id\n    name\n    type\n    parent {\n      __typename\n      id\n    }\n  }\n"]);return Xn=function(){return e},e}function Qn(){var e=F()(["\n  fragment DeptEntryOptFragment on Department {\n    __typename\n    id\n    name\n    budgets {\n      id\n      __typename\n      fiscalYear {\n        __typename\n        id\n      }\n    }\n    parent {\n      __typename\n      ... on Business {\n        id\n      }\n      ... on Department {\n        id\n      }\n    }\n  }\n"]);return Qn=function(){return e},e}function Hn(){var e=F()(["\n  query FiscalYear($date: String) {\n    fiscalYears(where: { hasDate: { eq: $date } }) {\n      __typename\n      id\n    }\n  }\n"]);return Hn=function(){return e},e}var Zn=fe()(Hn()),et=fe()(Qn()),nt=fe()(Xn()),tt=fe()(Kn()),at=fe()(Yn()),rt=fe()(zn(),at),lt=fe()(Gn()),ot=t(5843);function it(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function ut(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?it(Object(t),!0).forEach((function(n){G()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):it(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function ct(){var e=F()(["\n  query PayMethodEntryOpts($where: PaymentMethodWhereInput!) {\n    paymentMethods(where: $where) {\n      ...PayMethodEntryOptFragment\n    }\n  }\n  ","\n"]);return ct=function(){return e},e}var dt=fe()(ct(),lt),st=function(e){var n,t,a=null!==(n=null==e?void 0:e.value)&&void 0!==n?n:[],r=a.length,l=a[r-1],o=a[r-2];if(void 0===l)return"Method Required";if("string"==typeof l){if((null==o?void 0:o.id)===Ne&&!(null!==(t=l.match(/[0-9]/g))&&void 0!==t?t:[]).join(""))return"Check # Required"}else if(l.id===Ne)return"Check # Required"},mt=function(e){return"string"==typeof e?e:e.name},pt=function(e,n){var t=e.length-1;return e.map((function(a,r){var l,o,i=t===r,u=n({index:r}),c=u.key,d=yn()(u,["key"]),s=e[r-1],m="string"==typeof a;switch(null==s?void 0:s.id){case Ne:l="CK-"+(m?a:a.name);break;default:l=mt(a)}if(i){if(!m)switch(a.id){case Ne:o=p.a.createElement("span",null,"CK-")}}else o=p.a.createElement(We.a,{fontSize:"small"});return p.a.createElement(le.a,{key:c,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},p.a.createElement(Vn.a,Object.assign({color:i?"primary":"default",variant:i?"default":"outlined",label:l,size:"medium"},d,{disabled:!i}))," ",o)}))},ft=function(e){var n,t,a,r,l,o=e.disabled,i=void 0!==o&&o,u=yn()(e,["disabled"]),c=Object(m.useState)(!1),d=U()(c,2),s=d[0],f=d[1],v=Object(en.b)({name:"paymentMethod",validate:st}),b=U()(v,3),y=b[0],E=b[1],h=b[2],g=y.onBlur,O=null!==(t=null===(n=y.value)||void 0===n?void 0:n.value)&&void 0!==t?t:[],j=null!==(r=null===(a=y.value)||void 0===a?void 0:a.inputValue)&&void 0!==r?r:"",w=E.error,C=E.touched,M=h.setValue,R=null!==(l=O[O.length-1])&&void 0!==l?l:null,A=Object(m.useMemo)((function(){return null===R?{where:{hasParent:!1}}:{where:{parent:{eq:R.id}}}}),[R]),k=Rn(),_=U()(k,2),S=_[0],I=_[1],D=Object(m.useCallback)((function(e){I({msg:e.message,type:pn.FATAL_ERROR})}),[I]),T=Object(K.c)(dt,{skip:"string"==typeof R,variables:A,onError:D}),x=T.loading,F=T.error,P=T.data,$=Object(m.useMemo)((function(){return(null==P?void 0:P.paymentMethods)&&"string"!=typeof R&&(null==R?void 0:R.id)!==Ne?P.paymentMethods:[]}),[P,R]),N=$.length>0,q=Object(m.useMemo)((function(){var e;return(null===(e=R)||void 0===e?void 0:e.id)===Ne}),[R]),L=Object(m.useMemo)((function(){return!N&&!q}),[N,q]),B=Object(m.useMemo)((function(){var e;return"string"==typeof R||(null===(e=R)||void 0===e?void 0:e.id)===Ne?"Check #":"Payment Method"}),[R]),W=Object(m.useMemo)((function(){var e;return(null===(e=R)||void 0===e?void 0:e.id)===Ne?{type:"number"}:{}}),[R]),J=Object(m.useMemo)((function(){var e;return(null===(e=R)||void 0===e?void 0:e.id)===Ne?{min:"0",step:"1"}:{}}),[R]),V=Object(m.useCallback)((function(e){var n,t;e.InputProps=ut(ut({},null!==(n=e.InputProps)&&void 0!==n?n:{}),W),e.inputProps=ut(ut({},null!==(t=e.inputProps)&&void 0!==t?t:{}),J);var a=F?F.message:C?w:void 0;return p.a.createElement(Tn.a,Object.assign({},u,e,{variant:u.variant||"filled",error:C&&!!w||!!F,helperText:a,name:"paymentMethod",label:B}))}),[u,C,F,w,B,W,J]),G=Object(m.useCallback)((function(){return f(!0)}),[f]),z=Object(m.useCallback)((function(e){f(!1),e.persist(),setTimeout((function(){g(e)}),0)}),[f,g]),Y=Object(m.useCallback)((function(e,n){M({inputValue:j,value:n})}),[M,j]),X=Object(m.useCallback)((function(e,n){n=(n||"").trimStart(),L||M({inputValue:n,value:O})}),[M,O,L]),Q=Object(m.useMemo)((function(){return{value:O,disabled:!!F||x||(null==S?void 0:S.type)===pn.FATAL_ERROR||i,multiple:!0,options:$,renderInput:V,renderTags:pt,freeSolo:q,getOptionLabel:mt,onChange:Y,onInputChange:X,inputValue:L?"":j,onFocus:G,onBlur:z,open:s&&N&&(null==S?void 0:S.type)!==pn.FATAL_ERROR,loading:x,autoSelect:!0,name:"paymentMethod"}}),[$,O,V,q,Y,X,j,L,G,z,s,N,x,F,i,S]);return p.a.createElement(ot.a,Object.assign({},Q))},vt=t(356),bt=t(187),yt=function(e){var n=Object(nn.a)(),t=e.opacity,a=void 0===t?.62:t,r=yn()(e,["opacity"]);return p.a.createElement(le.a,Object.assign({},r,{overflow:"auto",position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",width:"100%",top:"0px",bottom:"0px",bgcolor:Object(bt.fade)(n.palette.background.paper,a)}))},Et=function(e){return p.a.createElement(yt,Object.assign({},e),p.a.createElement(vt.a,null))};function ht(){var e=F()(["\n  fragment JournalEntry_2Fragment on JournalEntry {\n    __typename\n    id\n    date\n    type\n    total {\n      n\n      d\n      s\n    }\n    refunds {\n      id\n      __typename\n      deleted\n      total {\n        n\n        d\n        s\n      }\n    }\n  }\n"]);return ht=function(){return e},e}var gt=fe()(ht());function Ot(){var e=F()(["\n  query GetEntryRefundInfo_1($id: ID!) {\n    journalEntry(id: $id) {\n      ...JournalEntry_2Fragment\n    }\n  }\n  ","\n"]);return Ot=function(){return e},e}var jt=fe()(Ot(),gt),wt=Symbol(),Ct=function(e){var n,t,a,r,l=e.entryId,o=e.open,i=e.onClose,c=e.onExited,d=e.handleSubmit,s=Object(en.c)(),f=s.resetForm,v=s.isSubmitting,b=s.isValid,y=Rn(),E=U()(y,2),h=E[0],g=E[1],O=Object(m.useCallback)((function(e){return g({msg:e.message,type:pn.FATAL_ERROR})}),[g]),j=Object(K.c)(jt,{skip:!l,variables:{id:l},onError:O}),w=j.loading,C=j.error,M=j.data,R=null===(n=null==M?void 0:M.journalEntry)||void 0===n?void 0:n.total,A=(null===(t=null==M?void 0:M.journalEntry)||void 0===t?void 0:t.refunds)||[],k=Object(m.useMemo)((function(){if(R){var e=A.reduce((function(e,n){var t=n.deleted,a=n.total;return t?e:e.add($n(a))}),new Ee.a(0));return $n(R).sub(e)}return new Ee.a(Number.MAX_SAFE_INTEGER)}),[R,A]),_=null===(a=null==M?void 0:M.journalEntry)||void 0===a?void 0:a.date,S=Object(m.useMemo)((function(){return _?new Date(_):void 0}),[_]),I=Object(m.useCallback)((function(){c(),f(),g(null)}),[f,c,g]),D=Object(m.useMemo)((function(){return!h||h.type!==pn.FATAL_ERROR&&h.type!==pn.ERROR?[null,null]:[h.msg,h.type===pn.FATAL_ERROR]}),[h]),T=U()(D,2),x=T[0],F=T[1],P=null===(r=null==M?void 0:M.journalEntry)||void 0===r?void 0:r.type,$=Object(m.useMemo)((function(){var e=w||C||(null!=P?P:wt)===wt?"Refund":"".concat(P===u.Credit?"Give":"Add"," Refund");return F?"Fatal Error":w?"Loading ".concat(e,"..."):v?"Submitting ".concat(e):e}),[w,C,P,F,v]),N=Object(nn.a)();return p.a.createElement(tn.a,{open:o,onClose:i,onExited:I,disableBackdropClick:v,disableEscapeKeyDown:v,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:d}},p.a.createElement(an.a,{style:x?{color:N.palette.error.main}:void 0},$),p.a.createElement(le.a,{position:"relative"},(w||v)&&!x&&p.a.createElement(Et,{zIndex:"modal"}),!!x&&F&&p.a.createElement(yt,{opacity:.78,zIndex:"modal",padding:2},p.a.createElement(rn.a,{color:"error"},x)),p.a.createElement(ln.a,{dividers:!0},!!x&&!F&&p.a.createElement(rn.a,{color:"error"},x),p.a.createElement(on.a,{container:!0,spacing:2},p.a.createElement(on.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(Dn,{minDate:S,disabled:w||v,fullWidth:!0})),p.a.createElement(on.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(xn,{disabled:w||v,fullWidth:!0})),p.a.createElement(on.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(ft,{disabled:w||v,fullWidth:!0})),p.a.createElement(on.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(Ln,{disabled:w||v,fullWidth:!0,maxTotal:k})),p.a.createElement(on.a,{item:!0,container:!0,justify:"center",alignItems:"flex-start",lg:4,md:6,sm:12},p.a.createElement(Jn,{disabled:w||v,label:!0}))))),p.a.createElement(un.a,null,!F&&p.a.createElement(cn.a,{disabled:w||v||!b,type:"submit",startIcon:p.a.createElement(dn.a,null),color:"primary",variant:"contained"},"Add"),p.a.createElement(cn.a,{disabled:w||v,color:F?"primary":"default",startIcon:!F&&p.a.createElement(sn.a,null),onClick:i},F?"Ok":"Cancel")))},Mt=function(e){var n=e.entryId,t=e.open,a=e.onClose,r=e.onExited,l=Object(m.useMemo)((function(){return{}}),[]),o=Object(K.a)(),i=Object(m.useCallback)(function(){var e=N()(J.a.mark((function e(t,r){var l;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r.setStatus(null),e.next=4,vn(o,n||"",t,r);case 4:a(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),r.setStatus({msg:null!==(l=e.t0.message)&&void 0!==l?l:"".concat(e.t0),type:pn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,t){return e.apply(this,arguments)}}(),[o,n,a]),u=Object(m.useCallback)((function(e){return p.a.createElement(Ct,{entryId:n,open:t,onClose:a,onExited:r,handleSubmit:e.handleSubmit})}),[n,t,a,r]);return p.a.createElement(en.a,{initialValues:l,initialStatus:null,enableReinitialize:!0,onSubmit:i},u)},Rt=t(407);function At(){var e=F()(["\n  mutation UpdateRefund(\n    $id: ID!\n    $fields: JournalEntryUpdateRefundFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $paymentMethodUpdate: JournalEntryUpdatePaymentMethod\n  ) {\n    journalEntryUpdateRefund(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      paymentMethodUpdate: $paymentMethodUpdate\n    ) {\n      id\n      __typename\n      refunds {\n        ...JournalEntryRefund_1Fragment\n      }\n    }\n  }\n  ","\n"]);return At=function(){return e},e}var kt=fe()(At(),xe),_t=function(){var e=N()(J.a.mark((function e(n,t,a,r){var l,o,i,u,c,d,s,m;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(Rt.a)(t.date.inputValue,r.date.inputValue)?null:r.date.value,u=r.description!==t.description?null!==(o=null===(l=r.description)||void 0===l?void 0:l.trim())&&void 0!==o?o:"":null,c=0===$n(r.total.value).compare($n(t.total.value))?null:r.total.value,d=r.reconciled===t.reconciled?null:r.reconciled,p=void 0,f=void 0,v=void 0,b=void 0,y=void 0,p=t.paymentMethod.value[t.paymentMethod.value.length-1],f=r.paymentMethod.value.slice(-2).reverse(),v=U()(f,2),b=v[0],y=v[1],s="string"==typeof b?p.parent&&p.parent.id===Ne?{paymentMethod:null,paymentMethodAdd:null,paymentMethodUpdate:{id:p.id,fields:{active:null,refId:b,name:b}}}:{paymentMethod:null,paymentMethodAdd:{parent:y.id,refId:b,name:b,active:!1},paymentMethodUpdate:null}:b.id!==p.id?{paymentMethod:b.id,paymentMethodAdd:null,paymentMethodUpdate:null}:{paymentMethod:null,paymentMethodAdd:null,paymentMethodUpdate:null},m={id:a,fields:{date:i,description:u,total:c,reconciled:d,paymentMethod:s.paymentMethod},paymentMethodAdd:s.paymentMethodAdd,paymentMethodUpdate:s.paymentMethodUpdate},e.next=8,n.mutate({mutation:kt,variables:m});case 8:case"end":return e.stop()}var p,f,v,b,y}),e)})));return function(n,t,a,r){return e.apply(this,arguments)}}();function St(){var e=F()(["\n  query UpdateRefundIniState($entryId: ID!, $refundId: ID!) {\n    journalEntry(id: $entryId) {\n      ...JournalEntry_2Fragment\n    }\n    journalEntryRefund(id: $refundId) {\n      __typename\n      id\n      date\n      description\n      paymentMethod {\n        ...PayMethodEntryOptFragment\n        ancestors {\n          ...PayMethodEntryOptFragment\n        }\n      }\n      total {\n        n\n        d\n        s\n      }\n      reconciled\n    }\n  }\n  ","\n  ","\n"]);return St=function(){return e},e}var It=fe()(St(),gt,lt),Dt=function(e){var n=e.refundId,t=e.open,a=e.onClose,r=e.onExited,l=e.journalEntry,o=e.loading,i=e.handleSubmit,u=Object(en.c)(),c=u.resetForm,d=u.isSubmitting,s=u.isValid,f=Rn(),v=U()(f,2),b=v[0],y=v[1],E=null==l?void 0:l.total,h=(null==l?void 0:l.refunds)||[],g=Object(m.useMemo)((function(){if(E){var e=h.reduce((function(e,t){var a=t.id,r=t.deleted,l=t.total;return r||a===n?e:e.add($n(l))}),new Ee.a(0));return $n(E).sub(e)}return new Ee.a(Number.MAX_SAFE_INTEGER)}),[E,h,n]),O=null==l?void 0:l.date,j=Object(m.useMemo)((function(){return O?new Date(O):void 0}),[O]),w=Object(m.useCallback)((function(){r(),c(),y(null)}),[c,r,y]),C=Object(m.useMemo)((function(){return!b||b.type!==pn.FATAL_ERROR&&b.type!==pn.ERROR?[null,null]:[b.msg,b.type===pn.FATAL_ERROR]}),[b]),M=U()(C,2),R=M[0],A=M[1],k=Object(m.useMemo)((function(){var e="Refund Update";return A?"Fatal Error":o?"Loading ".concat(e,"..."):d?"Submitting ".concat(e):e}),[o,A,d]),_=Object(nn.a)();return p.a.createElement(tn.a,{open:t,onClose:a,onExited:w,disableBackdropClick:d,disableEscapeKeyDown:d,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:i}},p.a.createElement(an.a,{style:R?{color:_.palette.error.main}:void 0},k),p.a.createElement(le.a,{position:"relative"},(o||d)&&!R&&p.a.createElement(Et,{zIndex:"modal"}),!!R&&A&&p.a.createElement(yt,{opacity:.78,zIndex:"modal",padding:2},p.a.createElement(rn.a,{color:"error"},R)),p.a.createElement(ln.a,{dividers:!0},!!R&&!A&&p.a.createElement(rn.a,{color:"error"},R),p.a.createElement(on.a,{container:!0,spacing:2},p.a.createElement(on.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(Dn,{minDate:j,disabled:o||d||!!A,fullWidth:!0})),p.a.createElement(on.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(xn,{disabled:o||d||!!A,fullWidth:!0})),p.a.createElement(on.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(ft,{disabled:o||d||!!A,fullWidth:!0})),p.a.createElement(on.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(Ln,{disabled:o||d||!!A,fullWidth:!0,maxTotal:g})),p.a.createElement(on.a,{item:!0,container:!0,justify:"center",alignItems:"flex-start",lg:4,md:6,sm:12},p.a.createElement(Jn,{disabled:o||d||!!A,label:!0}))))),p.a.createElement(un.a,null,!A&&p.a.createElement(cn.a,{disabled:o||d||!s,type:"submit",startIcon:p.a.createElement(dn.a,null),color:"primary",variant:"contained"},"Update"),p.a.createElement(cn.a,{disabled:o||d||!!A,color:A?"primary":"default",startIcon:!A&&p.a.createElement(sn.a,null),onClick:a},A?"Ok":"Cancel")))},Tt=function(e){var n=e.entryId,t=e.refundId,a=e.open,r=e.onClose,l=e.onExited,o=Object(K.c)(It,{skip:!n,variables:{entryId:n,refundId:t}}),i=o.loading,u=o.error,c=o.data,d=Object(m.useMemo)((function(){return u?{msg:u.message,type:pn.FATAL_ERROR}:null}),[u]),s=null==c?void 0:c.journalEntryRefund,f=Object(m.useMemo)((function(){var e;return s?{date:{inputValue:new Date(s.date),value:s.date},paymentMethod:function(){var e=s.paymentMethod,n=e.ancestors,t=yn()(e,["ancestors"]),a=L()(n).sort((function(e,n){var t,a;return e.id===(null===(t=n.parent)||void 0===t?void 0:t.id)?-1:n.id===(null===(a=e.parent)||void 0===a?void 0:a.id)?1:0}));return a.push(t),{inputValue:"",value:a}}(),total:{inputValue:$n(s.total).round(2).toString(),value:s.total},reconciled:s.reconciled,description:null!==(e=s.description)&&void 0!==e?e:null}:{}}),[s]),v=Object(K.a)(),b=Object(m.useCallback)(function(){var e=N()(J.a.mark((function e(n,a){var l;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=5;break}return a.setStatus({msg:'Failed to load initial values for refund "'.concat(t,'".'),type:pn.FATAL_ERROR}),e.abrupt("return");case 5:if(t){e.next=8;break}return a.setStatus({msg:"No refund ID.",type:pn.FATAL_ERROR}),e.abrupt("return");case 8:return e.prev=8,a.setStatus(null),e.next=12,_t(v,f,t,n,a);case 12:r(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),a.setStatus({msg:null!==(l=null===e.t0||void 0===e.t0?void 0:e.t0.message)&&void 0!==l?l:"".concat(e.t0),type:pn.FATAL_ERROR});case 18:case"end":return e.stop()}}),e,null,[[8,15]])})));return function(n,t){return e.apply(this,arguments)}}(),[v,f,r,t]),y=Object(m.useCallback)((function(e){var o;return p.a.createElement(Dt,{entryId:n,refundId:t,open:a,onClose:r,onExited:l,journalEntry:null!==(o=null==c?void 0:c.journalEntry)&&void 0!==o?o:null,loading:i,handleSubmit:e.handleSubmit})}),[c,n,i,r,l,a,t]);return p.a.createElement(en.a,{initialValues:null!=f?f:{},initialStatus:d,enableReinitialize:!0,onSubmit:b},y)},xt=t(5835),Ft=t(171);function Pt(){var e=F()(["\n  mutation AddEntry(\n    $fields: JournalEntryAddFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $personAdd: PersonAddFields\n    $businessAdd: BusinessAddFields\n  ) {\n    journalEntryAdd(\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      personAdd: $personAdd\n      businessAdd: $businessAdd\n    ) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return Pt=function(){return e},e}var $t=fe()(Pt(),Pe),Nt=function(){var e=N()(J.a.mark((function e(n,t){var a,r,l,o,u,c,d,s,m,p;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=void 0,f=t.paymentMethod.value[t.paymentMethod.value.length-1],l="string"==typeof f?{paymentMethod:"",paymentMethodAdd:{parent:t.paymentMethod.value[t.paymentMethod.value.length-2].id,refId:f,name:f,active:!1}}:{paymentMethod:f.id,paymentMethodAdd:null},o=l.paymentMethod,u=l.paymentMethodAdd,c=function(){var e=t.source.value[0],n=t.source.value[t.source.value.length-1];if("string"==typeof n){if(e===i.Person){var a=Object(Ft.parseName)(n);return{source:{sourceType:i.Person,id:""},businessAdd:null,personAdd:{name:{first:a.firstName,last:a.lastName}}}}return{source:{sourceType:i.Business,id:""},businessAdd:{name:n},personAdd:null}}return{source:{sourceType:function(){switch(n.__typename){case"Business":return i.Business;case"Department":return i.Department;case"Person":return i.Person}}(),id:n.id},personAdd:null,businessAdd:null}}(),d=c.source,s=c.personAdd,m=c.businessAdd,p={fields:{date:t.date.value,department:t.department.id,type:t.type,category:t.category.value[t.category.value.length-1].id,description:(null===(a=t.description)||void 0===a?void 0:a.trim())||null,total:t.total.value,reconciled:null!==(r=t.reconciled)&&void 0!==r?r:null,paymentMethod:o,source:d},paymentMethodAdd:u,personAdd:s,businessAdd:m},e.next=5,n.mutate({mutation:$t,variables:p});case 5:case"end":return e.stop()}var f}),e)})));return function(n,t){return e.apply(this,arguments)}}();function qt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Lt(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?qt(Object(t),!0).forEach((function(n){G()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):qt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Bt(){var e=F()(["\n  query CatEntryOpts($where: JournalEntryCategoryWhereInput!) {\n    catOpts: journalEntryCategories(where: $where) {\n      ...CatEntryOptFragment\n    }\n  }\n  ","\n"]);return Bt=function(){return e},e}var Ut=fe()(Bt(),nt),Wt=function(e){return e.name},Jt=function(e,n){var t=e.length-1;return e.map((function(e,a){var r=t===a,l=n({index:a}),o=l.key,i=yn()(l,["key"]);return p.a.createElement(le.a,{key:o,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},p.a.createElement(Vn.a,Object.assign({color:r?"primary":"default",variant:r?"default":"outlined",label:e.name,size:"medium"},i,{disabled:!r}))," ",!r&&p.a.createElement(We.a,{fontSize:"small"}))}))},Vt=Symbol(),Gt=function(e){var n,t,a,r,l,o,i=Object(en.c)(),u=e.disabled,c=void 0!==u&&u,d=e.required,s=e.entryType,f=yn()(e,["entryType"]),v=(null===(t=null===(n=i.values)||void 0===n?void 0:n.category)||void 0===t?void 0:t.value)||[],b=(null===(r=null===(a=i.values)||void 0===a?void 0:a.category)||void 0===r?void 0:r.inputValue.trimLeft())||"",y=null!==(o=null!=s?s:null===(l=i.values)||void 0===l?void 0:l.type)&&void 0!==o?o:null,E=v[v.length-1],h=Object(m.useMemo)((function(){return(null==E?void 0:E.id)?{where:{parent:{eq:E.id},type:{eq:y}}}:{where:{hasParent:!1,type:{eq:y}}}}),[E,y]),g=Rn(),O=U()(g,2),j=O[0],w=O[1],C=Object(m.useCallback)((function(e){w({msg:e.message,type:pn.FATAL_ERROR})}),[w]),M=Object(K.c)(Ut,{skip:(null!=y?y:Vt)===Vt,variables:h,onCompleted:function(){return setTimeout((function(){return i.validateField("category")}),0)},onError:C}),R=M.loading,A=M.error,k=M.data,_=null==k?void 0:k.catOpts,S=Object(m.useMemo)((function(){return _||[]}),[_]),I=Object(m.useCallback)((function(e){var n=(null==e?void 0:e.value)||[];return n[n.length-1]||null?S.length>0?"Sub-category Required":void 0:d?"Category Required":void 0}),[S,d]),D=Object(en.b)({name:"category",validate:I}),T=U()(D,3),x=T[0],F=T[1],P=T[2],$=x.onBlur,N=F.error,q=F.touched,L=P.setValue;Object(m.useEffect)((function(){E&&y!==E.type&&L({inputValue:"",value:[]})}),[y,E,L]);var B=Object(m.useMemo)((function(){return N&&q?N:(null!=y?y:Vt)===Vt?"Category requires entry type.":A?A.message:""}),[y,N,q,A]),W=Object(m.useMemo)((function(){return R||(null==j?void 0:j.type)===pn.FATAL_ERROR||(null!=y?y:Vt)===Vt||c||v.length>0&&0===S.length}),[c,y,j,R,S.length,v.length]),J=Object(m.useCallback)((function(e){return p.a.createElement(Tn.a,Object.assign({},f,{variant:f.variant||"filled"},e,{error:q&&!!N||!!A,disabled:W,helperText:B,name:"category",label:"Category"}))}),[f,q,N,A,W,B]),V=Object(m.useState)(!1),G=U()(V,2),z=G[0],Y=G[1],X=Object(m.useCallback)((function(){return Y(!0)}),[Y]),Q=Object(m.useCallback)((function(e){Y(!1),e.persist(),setTimeout((function(){$(e)}),0)}),[Y,$]),H=Object(m.useCallback)((function(e,n){L({inputValue:b,value:n})}),[L,b]),Z=Object(m.useCallback)((function(e,n){n=(n||"").trimStart(),L({inputValue:n,value:v})}),[L,v]),ee=Object(m.useMemo)((function(){return Lt(Lt({},x),{},{open:z&&S.length>0,onFocus:X,onBlur:Q,options:S,renderTags:Jt,forcePopupIcon:!1,disabled:W,value:v,renderInput:J,loading:R,autoSelect:!0,multiple:!0,getOptionLabel:Wt,onInputChange:Z,inputValue:b,onChange:H,name:"category"})}),[x,z,S,X,Q,R,W,v,J,Z,b,H]);return p.a.createElement(ot.a,Object.assign({},ee))};function zt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Yt(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?zt(Object(t),!0).forEach((function(n){G()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):zt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Kt(){var e=F()(["\n  query DeptEntryOpts($bizId: ID!) {\n    deptOpts: business(id: $bizId) {\n      __typename\n      id\n      departments {\n        ...DeptEntryOptFragment\n      }\n    }\n  }\n  ","\n"]);return Kt=function(){return e},e}var Xt=fe()(Kt(),et),Qt=function(e){return e.name},Ht=function(e,n){var t=e.length-1;return e.map((function(e,a){var r=t===a,l=n({index:a}),o=l.key,i=yn()(l,["key"]);return p.a.createElement(le.a,{key:o,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},p.a.createElement(Vn.a,Object.assign({color:r?"primary":"default",variant:r?"default":"outlined",label:e.name,size:"medium"},i,{disabled:!r}))," ",!r&&p.a.createElement(We.a,{fontSize:"small"}))}))},Zt=function(e){var n=e.disabled,t=void 0!==n&&n,a=e.required,r=e.fiscalYearId,l="string"==typeof r,o=Rn(),i=U()(o,2),u=i[0],c=i[1],d=Object(m.useCallback)((function(e){c({msg:e.message,type:pn.FATAL_ERROR})}),[c]),s=Object(K.c)(Xt,{onError:d,variables:{bizId:"5dc4b09bcf96e166daaa0090"}}),f=s.loading,v=s.error,b=s.data,y=(null==b?void 0:b.deptOpts.departments)||[],E=Object(m.useState)(!1),h=U()(E,2),g=h[0],O=h[1],j=Object(m.useState)(""),w=U()(j,2),C=w[0],M=w[1],R=Object(m.useCallback)((function(e){return e?l?e.budgets.every((function(e){return e.fiscalYear.id!==r}))?"Department has no budget.":void 0:y.some((function(n){var t=n.parent;return"Department"===t.__typename&&t.id===e.id}))?"Sub-department Required":void 0:a?"Department Required":void 0}),[y,a,l,r]),A=Object(en.b)({name:"department",validate:R}),k=U()(A,3),_=k[0],S=k[1],I=k[2],D=_.value,T=_.onBlur,x=S.error,F=S.touched,P=I.setValue,$=Object(m.useMemo)((function(){return!!D&&!D.budgets.every((function(e){return e.fiscalYear.id!==r}))}),[D]),N=Object(m.useMemo)((function(){return new Map(y.reduce((function(e,n){return e.push([n.id,n]),e}),[]))}),[y]),q=Object(m.useMemo)((function(){if(!D)return[];for(var e=[D],n=D.parent,t=n.__typename,a=n.id;"Business"!==t&&N.has(a);){var r=N.get(a);e.unshift(r);var l=r.parent;t=l.__typename,a=l.id}return e}),[D,N]),L=Object(m.useMemo)((function(){var e,n=null===(e=q[q.length-1])||void 0===e?void 0:e.id;return y.filter((function(e){return n?e.parent.id===n:"Business"===e.parent.__typename}))}),[y,q]),B=Object(m.useMemo)((function(){return q.length>0&&0===L.length}),[q,L]),W=Object(m.useMemo)((function(){return x&&F?x:v?v.message:""===r?"Department requires a date.":""}),[x,F,v]),J=Object(m.useMemo)((function(){return f||B||(null==u?void 0:u.type)===pn.FATAL_ERROR||t||l&&!r}),[B,t,u,f,l,r]),V=Object(m.useCallback)((function(n){return p.a.createElement(Tn.a,Object.assign({},e,{required:l?!$:!!e.required,variant:e.variant||"filled"},n,{error:F&&!!x,helperText:W,name:"department",label:"Department",disabled:J}))}),[e,F,x,W,J,l,$]),G=Object(m.useCallback)((function(){return O(!0)}),[O]),z=Object(m.useCallback)((function(e){O(!1),T(e)}),[O,T]),Y=Object(m.useCallback)((function(e,n){if(n)if(Array.isArray(n)){var t=n.length;P(0===t?null:n[t-1])}else P(n);else P(null)}),[P]),X=Object(m.useCallback)((function(e,n){M((n||"").trimStart())}),[M]),Q=Object(m.useMemo)((function(){return Yt(Yt({},_),{},{open:g&&L.length>0,onFocus:G,onBlur:z,options:L,renderTags:Ht,forcePopupIcon:!1,disabled:J,value:q,renderInput:V,loading:f,autoSelect:!1,multiple:!0,getOptionLabel:Qt,onChange:Y,onInputChange:X,inputValue:B?"":C,name:"department"})}),[_,g,L,G,z,B,J,q,V,f,Y,X,C]);return v?p.a.createElement("pre",null,JSON.stringify(v,null,2)):p.a.createElement(ot.a,Object.assign({},Q))},ea=t(300);function na(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function ta(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?na(Object(t),!0).forEach((function(n){G()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):na(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function aa(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return ra(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ra(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function ra(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function la(){var e=F()(["\n  query SrcEntryOpts($name: String!, $isBiz: Boolean!) {\n    businesses(where: { name: { pattern: $name, options: I } })\n      @include(if: $isBiz) {\n      ...SrcEntryBizOptFragment\n    }\n    people(\n      where: {\n        or: [\n          { firstName: { pattern: $name, options: I } }\n          { lastName: { pattern: $name, options: I } }\n        ]\n      }\n    ) @skip(if: $isBiz) {\n      ...SrcEntryPersonOptFragment\n    }\n  }\n  ","\n  ","\n  ","\n"]);return la=function(){return e},e}var oa=fe()(la(),tt,rt,at),ia=function(e){switch(e){case i.Business:case i.Department:case i.Person:break;default:return"string"==typeof e}return!1},ua=function(e){switch(e){case i.Business:return"Vendor";case i.Department:return"Department";case i.Person:return"Person";default:if("string"==typeof e)return e}return"Person"===e.__typename?"".concat(e.personName.first," ").concat(e.personName.last):e.name},ca=function(e,n){var t=e.length-1;return e.map((function(e,a){var r=t===a,l=n({index:a}),o=l.key,i=yn()(l,["key"]);return ia(e)?e:p.a.createElement(le.a,{key:o,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},p.a.createElement(Vn.a,Object.assign({color:r?"primary":"default",variant:r?"default":"outlined",label:ua(e),size:"medium"},i,{disabled:!r}))," ",!r&&p.a.createElement(We.a,{fontSize:"small"}))}))},da=function(e,n){var t=n.inputValue,a=new RegExp("(^|\\s)".concat(t),"i");return e.filter((function(e){return a.test(ua(e))}))},sa=function(e){var n,t=(null==e?void 0:e.value)||[],a=null!==(n=t[0])&&void 0!==n?n:null,r=t.length>1?t[t.length-1]:null;if(null===a||null===r||""===r)return"Source Required";if(ia(r)&&a===i.Person){var l=Object(Ft.parseName)(r);if(!l.firstName.trim())return"First Name Required";if(!l.lastName.trim())return"Last Name Required"}},ma=function(e){var n,t,a,r,l,o=e.disabled,u=void 0!==o&&o,c=Object(m.useState)(!1),d=U()(c,2),s=d[0],f=d[1],v=Object(en.b)({name:"source",validate:sa}),b=U()(v,3),y=b[0],E=b[1],h=b[2],g=y.onBlur,O=null!==(t=null===(n=y.value)||void 0===n?void 0:n.value)&&void 0!==t?t:[],j=null!==(r=null===(a=y.value)||void 0===a?void 0:a.inputValue)&&void 0!==r?r:"",w=E.error,C=E.touched,M=h.setValue,R=null!==(l=O[0])&&void 0!==l?l:null,A=O.length>1?O[O.length-1]:null,k=Object(m.useRef)(""),_=Rn(),S=U()(_,2),I=S[0],D=S[1],T=Object(m.useCallback)((function(e){D({msg:e.message,type:pn.FATAL_ERROR})}),[D]),x=Object(K.c)(oa,{skip:!k.current&&!O[1],variables:{name:k.current,isBiz:R!==i.Person},onError:T}),F=x.loading,P=x.error,$=x.data,N=Object(m.useMemo)((function(){var e,n=new Map,t=aa((null==$?void 0:$.businesses)||[]);try{for(t.s();!(e=t.n()).done;){var a,r=aa(e.value.departments);try{for(r.s();!(a=r.n()).done;){var l=a.value;n.set(l.id,l)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){t.e(e)}finally{t.f()}return n}),[$]),q=Object(m.useMemo)((function(){if(null===R)return[i.Business,i.Person];if(R===i.Person)return null===A&&(null==$?void 0:$.people)||[];if(!A)return(null==$?void 0:$.businesses)||[];if("string"==typeof A)return[];var e,n=[],t=aa(N.values());try{for(t.s();!(e=t.n()).done;){var a=e.value;a.parent.__typename===A.__typename&&a.parent.id===A.id&&n.push(a)}}catch(e){t.e(e)}finally{t.f()}return n}),[R,$,N,A]),L=Object(m.useMemo)((function(){return null!==R&&null===A}),[R,A]),B=Object(m.useMemo)((function(){return O.length>0&&0===q.length&&!L}),[O,q,L]),W=Object(m.useMemo)((function(){return null===R?"Source Type":R===i.Person?"Person Name":1===O.length?"Vendor":2===O.length&&q.length>0?"Department":q.length>0?"Sub-Department":"Vendor"}),[O,q,R]),J=Object(m.useMemo)((function(){return u||B||(null==I?void 0:I.type)===pn.FATAL_ERROR}),[B,u,I]),V=Object(m.useCallback)((function(n){var t;return A&&"string"!=typeof A&&"Person"!==A.__typename&&0===q.length&&(n=ta(ta({},n),{},{inputProps:ta(ta({},(null==n?void 0:n.inputProps)||{}),{},{style:ta(ta({},(null===(t=null==n?void 0:n.inputProps)||void 0===t?void 0:t.style)||{}),{},{display:"none"})})})),p.a.createElement(Tn.a,Object.assign({},e,{variant:e.variant||"filled"},n,{error:C&&!!w,helperText:C?w:void 0,name:"source",label:W,disabled:J}))}),[A,q.length,e,C,w,W,J]),G=Object(m.useCallback)((function(){return f(!0)}),[f]),z=Object(m.useCallback)((function(e){f(!1),e.persist(),setTimeout((function(){return g(e)}),0)}),[f,g]),Y=Object(m.useCallback)((function(e,n){var t=n.length-1,a=n[t];if(ia(a)){var r,l=[],o=aa(a.split(" "));try{for(o.s();!(r=o.n()).done;){var i=r.value;i&&(ea.checkName(i)&&(i=ea(i)),l.push(i))}}catch(e){o.e(e)}finally{o.f()}var u=l.join(" ").trim();n[t]=u.charAt(0).toUpperCase()+u.substring(1)}M({inputValue:j,value:n})}),[M,j]),X=Object(m.useCallback)((function(e,n){n=(n||"").trimStart(),B||M({inputValue:n,value:O}),null!==R&&null===A&&n&&(k.current=n[0].toLowerCase())}),[M,R,A,O,B,k]),Q=Object(m.useMemo)((function(){return ta(ta({},y),{},{inputValue:B?"":j,open:s&&q.length>0,onFocus:G,onBlur:z,options:q,renderTags:ca,forcePopupIcon:!1,freeSolo:L,value:O,renderInput:V,loading:F,autoSelect:!0,multiple:!0,getOptionLabel:ua,onInputChange:X,onChange:Y,filterOptions:da,name:"source",disabled:J})}),[y,B,j,s,q,G,z,L,O,V,F,X,Y,J]);return P?p.a.createElement("pre",null,JSON.stringify(P,null,2)):p.a.createElement(ot.a,Object.assign({},Q))},pa=t(5846),fa=t(5834),va=t(361),ba=t(293),ya=t(5783);function Ea(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function ha(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Ea(Object(t),!0).forEach((function(n){G()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ea(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ga=Symbol(),Oa=function(e){if((null!=e?e:ga)===ga)return"Type Required"},ja=function(e){var n=e.disabled,t=void 0!==n&&n,a=Rn(),r=U()(a,1)[0],l=e.label,o=void 0!==l&&l,i=Object(en.c)().isSubmitting,c=Object(en.b)({name:"type",validate:Oa}),d=U()(c,3),s=d[0],f=d[1],v=d[2],b=f.error,y=f.touched,E=v.setValue,h=v.setTouched,g=Object(m.useMemo)((function(){return ha(ha({size:"small",exclusive:!0,disabled:i},s),{},{onChange:(e=N()(J.a.mark((function e(n,t){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null!=t?t:ga)!==ga){e.next=2;break}return e.abrupt("return");case 2:return E(t),e.next=5,new Promise((function(e){return setTimeout(e,0)}));case 5:h(!0);case 6:case"end":return e.stop()}}),e)}))),function(n,t){return e.apply(this,arguments)})});var e}),[s,i,E,h]),O=i||t||(null==r?void 0:r.type)===pn.FATAL_ERROR,j=Object(m.useMemo)((function(){return p.a.createElement(le.a,{pl:1,clone:!0},p.a.createElement(pa.a,Object.assign({},e,g),p.a.createElement(fa.a,{disabled:O,value:u.Credit},p.a.createElement(va.a,{arrow:!0,placement:"top",title:"Credit"},p.a.createElement(me.b,null))),p.a.createElement(fa.a,{disabled:O,value:u.Debit},p.a.createElement(va.a,{arrow:!0,placement:"top",title:"Debit"},p.a.createElement(me.a,null)))))}),[e,g,O]);return o?p.a.createElement(ba.a,null,p.a.createElement(Bn.a,Object.assign({},e,{labelPlacement:"boolean"==typeof o?void 0:o,control:j,label:"Type"})),y&&!!b&&p.a.createElement(ya.a,{error:!0},b)):p.a.createElement(ba.a,null,j,!!b&&p.a.createElement(ya.a,{error:!0},b))};function wa(){var e=F()(["\n  query DeptIniValueForAddEntry($id: ID!) {\n    department(id: $id) {\n      ...DeptEntryOptFragment\n    }\n  }\n  ","\n"]);return wa=function(){return e},e}var Ca={item:!0,lg:4,sm:6,xs:12},Ma=fe()(wa(),et),Ra=function(e){var n=e.open,t=e.onClose,a=e.loading,r=Object(en.c)(),l=r.resetForm,o=r.isSubmitting,i=r.isValid,u=r.submitForm,c=r.values.date,d=Rn(),s=U()(d,2),f=s[0],v=s[1],b=Object(m.useCallback)((function(e){v({msg:e.message,type:pn.FATAL_ERROR})}),[v]),y=Object(K.c)(Zn,{skip:!(null==c?void 0:c.inputValue),variables:{date:(null==c?void 0:c.value)||""},onError:b}).data,E=Object(m.useMemo)((function(){var e,n;return null!==(n=null===(e=null==y?void 0:y.fiscalYears[0])||void 0===e?void 0:e.id)&&void 0!==n?n:""}),[y]),h=Object(m.useMemo)((function(){return!f||f.type!==pn.FATAL_ERROR&&f.type!==pn.ERROR?[null,null]:[f.msg,f.type===pn.FATAL_ERROR]}),[f]),g=U()(h,2),O=g[0],j=g[1],w=Object(m.useCallback)((function(){l(),v(null)}),[l,v]),C=Object(m.useMemo)((function(){return j?"Fatal Error":o?"Submitting Add Entry...":a?"Loading Add Entry...":"Add Entry"}),[j,o,a]),M=Object(nn.a)(),R=Object(m.useCallback)(N()(J.a.mark((function e(){var n;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v(null),e.next=4,u();case 4:t(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),v({msg:null!==(n=e.t0.message)&&void 0!==n?n:"".concat(e.t0),type:pn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[u,t,v]),A=Object(m.useCallback)(N()(J.a.mark((function e(){var n;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v(null),e.next=4,u();case 4:l(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),v({msg:null!==(n=e.t0.message)&&void 0!==n?n:"".concat(e.t0),type:pn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[u,l,v]),k=Object(m.useCallback)((function(e){return e.preventDefault()}),[]);return p.a.createElement(tn.a,{open:n,onClose:t,onExited:w,disableBackdropClick:o,disableEscapeKeyDown:o,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:k}},p.a.createElement(an.a,{style:O?{color:M.palette.error.main}:void 0},C),p.a.createElement(le.a,{position:"relative"},(o||a)&&!O&&p.a.createElement(Et,{zIndex:"modal"}),!!O&&j&&p.a.createElement(yt,{opacity:.78,zIndex:"modal",padding:2},p.a.createElement(rn.a,{color:"error"},O)),p.a.createElement(ln.a,{dividers:!0},!!O&&!j&&p.a.createElement(rn.a,{color:"error"},O),p.a.createElement(on.a,{container:!0,spacing:2},p.a.createElement(on.a,Object.assign({},Ca,{justify:"center",container:!0}),p.a.createElement(ja,{style:{margin:M.spacing(1)},label:"start",disabled:a||o||!!j})),p.a.createElement(on.a,Object.assign({},Ca),p.a.createElement(Dn,{disabled:a||o||!!j,fullWidth:!0})),p.a.createElement(on.a,Object.assign({},Ca),p.a.createElement(ma,{disabled:a||o||!!j,fullWidth:!0})),p.a.createElement(on.a,Object.assign({},Ca),p.a.createElement(Gt,{disabled:a||o||!!j,fullWidth:!0,required:!0})),p.a.createElement(on.a,Object.assign({},Ca),p.a.createElement(Zt,{disabled:a||o||!!j,fullWidth:!0,required:!0,fiscalYearId:E})),p.a.createElement(on.a,Object.assign({},Ca),p.a.createElement(xn,{disabled:a||o||!!j,fullWidth:!0})),p.a.createElement(on.a,Object.assign({},Ca),p.a.createElement(ft,{disabled:a||o||!!j,fullWidth:!0})),p.a.createElement(on.a,Object.assign({},Ca),p.a.createElement(Ln,{disabled:a||o||!!j,fullWidth:!0})),p.a.createElement(on.a,Object.assign({container:!0,justify:"center",alignItems:"flex-start"},Ca),p.a.createElement(Jn,{disabled:a||o||!!j,label:!0}))))),p.a.createElement(un.a,null,!j&&p.a.createElement(p.a.Fragment,null,p.a.createElement(cn.a,{onClick:R,disabled:a||o||!i,type:"submit",startIcon:p.a.createElement(dn.a,null),color:"primary",variant:"contained"},"Add"),p.a.createElement(cn.a,{onClick:A,disabled:a||o||!i,type:"submit",startIcon:p.a.createElement(xt.a,null),variant:"outlined"},"Add & New")),p.a.createElement(cn.a,{disabled:o,color:j?"primary":"default",startIcon:!j&&p.a.createElement(sn.a,null),onClick:t},j?"Ok":"Cancel")))},Aa=function(e){var n=e.open,t=e.onClose,a=e.deptId,r=Object(K.c)(Ma,{skip:!a,variables:{id:a}}),l=r.loading,o=r.error,i=r.data,u=null==i?void 0:i.department,c=Object(m.useMemo)((function(){return u?{department:u}:{}}),[u]),d=Object(m.useMemo)((function(){return o?{msg:o.message,type:pn.FATAL_ERROR}:null}),[o]),s=Object(K.a)(),f=Object(m.useCallback)((function(e,n){return Nt(s,e,n)}),[s]),v=Object(m.useCallback)((function(){return p.a.createElement(Ra,{open:n,onClose:t,loading:l})}),[n,t,l]);return p.a.createElement(en.a,{initialValues:c,initialStatus:d,enableReinitialize:!0,onSubmit:f},v)};function ka(){var e=F()(["\n  mutation UpdateEntry(\n    $id: ID!\n    $fields: JournalEntryUpdateFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $paymentMethodUpdate: JournalEntryUpdatePaymentMethod\n    $personAdd: PersonAddFields\n    $businessAdd: BusinessAddFields\n  ) {\n    journalEntryUpdate(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      paymentMethodUpdate: $paymentMethodUpdate\n      personAdd: $personAdd\n      businessAdd: $businessAdd\n    ) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return ka=function(){return e},e}var _a=fe()(ka(),Pe),Sa=function(){var e=N()(J.a.mark((function e(n,t,a,r){var l,o,u,c,d,s,m,p,f,v,b,y,E,h,g,O,j;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(){var e,n,a,l,o=null!==(n=null===(e=r.category.value[r.category.value.length-1])||void 0===e?void 0:e.id)&&void 0!==n?n:null;return o===(null!==(l=null===(a=t.category.value[t.category.value.length-1])||void 0===a?void 0:a.id)&&void 0!==l?l:null)?null:o}(),u=Object(Rt.a)(t.date.inputValue,r.date.inputValue)?null:r.date.value,c=r.department.id===t.department.id?null:r.department.id,d=(null===(l=r.description)||void 0===l?void 0:l.trim())&&r.description!==t.description?r.description.trim():null,s=0===$n(r.total.value).compare($n(t.total.value))?null:r.total.value,m=r.type===t.type?null:r.type,p=r.reconciled===t.reconciled?null:r.reconciled,w=void 0,C=void 0,M=void 0,R=void 0,A=void 0,w=t.paymentMethod.value[t.paymentMethod.value.length-1],C=r.paymentMethod.value.slice(-2).reverse(),M=U()(C,2),R=M[0],A=M[1],f="string"==typeof R?w.parent&&w.parent.id===Ne?{paymentMethod:null,paymentMethodAdd:null,paymentMethodUpdate:{id:w.id,fields:{active:null,refId:R,name:R}}}:{paymentMethod:null,paymentMethodAdd:{parent:A.id,refId:R,name:R,active:!1},paymentMethodUpdate:null}:R.id!==w.id?{paymentMethod:R.id,paymentMethodAdd:null,paymentMethodUpdate:null}:{paymentMethod:null,paymentMethodAdd:null,paymentMethodUpdate:null},v=f.paymentMethod,b=f.paymentMethodAdd,y=f.paymentMethodUpdate,E=function(){var e=r.source.value[0],n=r.source.value[r.source.value.length-1],a=t.source.value[0],l=t.source.value[t.source.value.length-1];if("string"==typeof n){if(e===i.Person){var o=Object(Ft.parseName)(n);return{source:{sourceType:i.Person,id:""},businessAdd:null,personAdd:{name:{first:o.firstName,last:o.lastName}}}}return{source:{sourceType:i.Business,id:""},businessAdd:{name:n},personAdd:null}}return e===a&&n.id===l.id?{source:null,businessAdd:null,personAdd:null}:{source:{sourceType:function(){switch(n.__typename){case"Business":return i.Business;case"Department":return i.Department;case"Person":return i.Person}}(),id:n.id},personAdd:null,businessAdd:null}}(),h=E.source,g=E.personAdd,O=E.businessAdd,j={id:a,fields:{category:o,date:u,department:c,description:d,total:s,type:m,source:h,reconciled:p,paymentMethod:v},paymentMethodAdd:b,paymentMethodUpdate:y,personAdd:g,businessAdd:O},console.log(j),e.next=13,n.mutate({mutation:_a,variables:j});case 13:case"end":return e.stop()}var w,C,M,R,A}),e)})));return function(n,t,a,r){return e.apply(this,arguments)}}();function Ia(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return Da(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Da(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Da(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function Ta(){var e=F()(["\n  query UpdateEntryIniState($id: ID!) {\n    journalEntry(id: $id) {\n      id\n      __typename\n      type\n      date\n      department {\n        ...DeptEntryOptFragment\n      }\n      category {\n        ...CatEntryOptFragment\n        ancestors {\n          ...CatEntryOptFragment\n        }\n      }\n      source {\n        ...SrcEntryPersonOptFragment\n        ...SrcEntryBizOptFragment\n        ...SrcEntryDeptOptFragment\n        ... on Department {\n          ancestors {\n            ...SrcEntryDeptOptFragment\n            ...SrcEntryBizOptFragment\n          }\n        }\n      }\n      paymentMethod {\n        ...PayMethodEntryOptFragment\n        ancestors {\n          ...PayMethodEntryOptFragment\n        }\n      }\n      description\n      total {\n        n\n        d\n        s\n      }\n      refunds {\n        id\n        __typename\n        deleted\n        date\n        total {\n          n\n          d\n          s\n        }\n      }\n      reconciled\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n"]);return Ta=function(){return e},e}var xa=fe()(Ta(),et,nt,tt,rt,at,lt),Fa=new Date(864e13),Pa={item:!0,lg:4,sm:6,xs:12},$a=function(e){var n=e.open,t=e.onClose,a=e.onExited,r=e.journalEntry,l=e.loading,o=e.handleSubmit,i=Object(en.c)(),u=i.resetForm,c=i.isSubmitting,d=i.isValid,s=i.values.date,f=Rn(),v=U()(f,2),b=v[0],y=v[1],E=Object(m.useCallback)((function(e){y({msg:e.message,type:pn.FATAL_ERROR})}),[y]),h=Object(K.c)(Zn,{skip:!(null==s?void 0:s.inputValue),variables:{date:(null==s?void 0:s.value)||""},onError:E}).data,g=Object(m.useMemo)((function(){var e,n;return null!==(n=null===(e=null==h?void 0:h.fiscalYears[0])||void 0===e?void 0:e.id)&&void 0!==n?n:""}),[h]),O=(null==r?void 0:r.refunds)||[],j=Object(m.useMemo)((function(){return O.reduce((function(e,n){var t=U()(e,2),a=t[0],r=t[1],l=n.deleted,o=n.total,i=n.date;return[l?a:a.add($n(o)),l?r:Object(Cn.a)([r,new Date(i)])]}),[new Ee.a(0),Fa])}),[O]),w=U()(j,2),C=w[0],M=w[1],R=Object(m.useCallback)((function(){a(),u(),y(null)}),[u,a,y]),A=Object(m.useMemo)((function(){return!b||b.type!==pn.FATAL_ERROR&&b.type!==pn.ERROR?[null,null]:[b.msg,b.type===pn.FATAL_ERROR]}),[b]),k=U()(A,2),_=k[0],S=k[1],I=Object(m.useMemo)((function(){var e="Entry Update";return S?"Fatal Error":l?"Loading ".concat(e,"..."):c?"Submitting ".concat(e):e}),[l,S,c]),D=Object(nn.a)();return p.a.createElement(tn.a,{open:n,onClose:t,onExited:R,fullWidth:!0,disableBackdropClick:c,disableEscapeKeyDown:c,maxWidth:"lg",PaperProps:{component:"form",onSubmit:o}},p.a.createElement(an.a,{style:_?{color:D.palette.error.main}:void 0},I),p.a.createElement(le.a,{position:"relative"},(c||l)&&!_&&p.a.createElement(Et,{zIndex:"modal"}),!!_&&S&&p.a.createElement(yt,{opacity:.78,zIndex:"modal",padding:2},p.a.createElement(rn.a,{color:"error"},_)),p.a.createElement(ln.a,{dividers:!0},!!_&&!S&&p.a.createElement(rn.a,{color:"error"},_),p.a.createElement(on.a,{container:!0,spacing:2},p.a.createElement(on.a,Object.assign({},Pa,{justify:"center",container:!0}),p.a.createElement(ja,{style:{margin:D.spacing(1)},label:"start",disabled:c||l||!!S})),p.a.createElement(on.a,Object.assign({},Pa),p.a.createElement(Dn,{disabled:c||l||!!S,maxDate:M===Fa?void 0:M,fullWidth:!0})),p.a.createElement(on.a,Object.assign({},Pa),p.a.createElement(ma,{disabled:c||l||!!S,fullWidth:!0})),p.a.createElement(on.a,Object.assign({},Pa),p.a.createElement(Gt,{disabled:c||l||!!S,fullWidth:!0,required:!0})),p.a.createElement(on.a,Object.assign({},Pa),p.a.createElement(Zt,{disabled:c||l||!!S,fullWidth:!0,required:!0,fiscalYearId:g})),p.a.createElement(on.a,Object.assign({},Pa),p.a.createElement(xn,{disabled:c||l||!!S,fullWidth:!0})),p.a.createElement(on.a,Object.assign({},Pa),p.a.createElement(ft,{disabled:c||l||!!S,fullWidth:!0})),p.a.createElement(on.a,Object.assign({},Pa),p.a.createElement(Ln,{disabled:c||l||!!S,minTotal:C,fullWidth:!0})),p.a.createElement(on.a,Object.assign({container:!0,justify:"center",alignItems:"flex-start"},Pa),p.a.createElement(Jn,{disabled:c||l||!!S,label:!0}))))),p.a.createElement(un.a,null,!S&&p.a.createElement(cn.a,{disabled:c||!d||l,type:"submit",startIcon:p.a.createElement(dn.a,null),color:"primary",variant:"contained"},"Update"),p.a.createElement(cn.a,{disabled:c,color:S?"primary":"default",startIcon:!S&&p.a.createElement(sn.a,null),onClick:t},S?"Ok":"Cancel")))},Na=function(e){var n,t=e.entryId,a=e.open,r=e.onClose,l=e.onExited,o=Object(K.c)(xa,{skip:!t,variables:{id:t}}),u=o.loading,c=o.error,d=o.data;c&&(console.log(t,xa),console.error(c));var s=Object(m.useMemo)((function(){return c?{msg:c.message,type:pn.FATAL_ERROR}:null}),[c]),f=null==d?void 0:d.journalEntry,v=Object(m.useMemo)((function(){var e;if(!f)return{};var n={inputValue:new Date(f.date),value:f.date},t=function(){var e=f.category,n=e.ancestors,t=yn()(e,["ancestors"]),a=L()(n).sort((function(e,n){var t,a;return e.id===(null===(t=n.parent)||void 0===t?void 0:t.id)?-1:n.id===(null===(a=e.parent)||void 0===a?void 0:a.id)?1:0}));return a.push(t),{inputValue:"",value:a}}(),a=function(){var e=f.paymentMethod,n=e.ancestors,t=yn()(e,["ancestors"]),a=L()(n).sort((function(e,n){var t,a;return e.id===(null===(t=n.parent)||void 0===t?void 0:t.id)?-1:n.id===(null===(a=e.parent)||void 0===a?void 0:a.id)?1:0}));return a.push(t),{inputValue:"",value:a}}(),r={inputValue:$n(f.total).round(2).toString(),value:f.total};return{date:n,category:t,paymentMethod:a,department:f.department,total:r,reconciled:f.reconciled,description:null!==(e=f.description)&&void 0!==e?e:null,type:f.type,source:function(){var e=[],n=null==f?void 0:f.source;switch(null==n?void 0:n.__typename){case"Person":e.push(i.Person,n);break;case"Business":e.push(i.Business,n);break;case"Department":e.push(i.Business);var t,a=[],r=Ia(n.ancestors);try{for(r.s();!(t=r.n()).done;){var l=t.value;"Business"===l.__typename?e.push(l):a.push(l.id)}}catch(e){r.e(e)}finally{r.f()}var o=e[1];if(a.length>0){var u,c=[],d=Ia(o.departments);try{for(d.s();!(u=d.n()).done;){var s=u.value;if(-1!==a.indexOf(s.id)&&c.push(s)===a.length)break}}catch(e){d.e(e)}finally{d.f()}c.sort((function(e,n){return e.id===n.parent.id||o.id||e.parent.id?-1:n.id===e.parent.id?1:0})),e.push.apply(e,c.concat([n]))}}return{inputValue:"",value:e}}()}}),[f]),b=Object(K.a)(),y=Object(m.useCallback)(function(){var e=N()(J.a.mark((function e(n,a){var l;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setStatus(null),e.next=4,Sa(b,v,t,n,a);case 4:r(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),a.setStatus({msg:null!==(l=e.t0.message)&&void 0!==l?l:"".concat(e.t0),type:pn.ERROR});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,t){return e.apply(this,arguments)}}(),[b,v,t,r]),E=Object(m.useCallback)((function(e){return p.a.createElement($a,{open:a,onClose:r,onExited:l,loading:u,journalEntry:null!=f?f:null,handleSubmit:e.handleSubmit})}),[a,r,l,u,f]);return p.a.createElement(en.a,{initialValues:v,initialStatus:s,journalEntry:null!==(n=null==d?void 0:d.journalEntry)&&void 0!==n?n:null,loading:u,onSubmit:y,enableReinitialize:!0},E)};function qa(){var e=F()(["\n  mutation DeleteEntry($id: ID!) {\n    journalEntryDelete(id: $id) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return qa=function(){return e},e}var La=fe()(qa(),Pe),Ba=function(e){var n=e.entryId,t=e.onClose,a=Object(K.b)(La),r=U()(a,2),l=r[0],o=r[1],i=o.loading,u=o.error,c=!!u,d=Object(m.useCallback)((function(){l({variables:{id:n}}).then((function(){return t()}))}),[n,l,t]),s=Object(m.useMemo)((function(){return c?"Error":i?"Deleting Entry...":"Delete Entry"}),[c,i]),f=Object(nn.a)();return p.a.createElement(tn.a,{open:!!n,maxWidth:"sm",fullWidth:!0,disableBackdropClick:i,disableEscapeKeyDown:i,onClose:t},p.a.createElement(an.a,{style:c?{color:f.palette.error.main}:void 0},s),p.a.createElement(le.a,{position:"relative"},i&&p.a.createElement(Et,{zIndex:"modal"}),p.a.createElement(ln.a,null,c&&p.a.createElement(rn.a,{color:"error"},null==u?void 0:u.message),!c&&p.a.createElement(rn.a,null,"Are you sure you want to delete this entry?"))),p.a.createElement(un.a,null,!c&&p.a.createElement(cn.a,{disabled:i,onClick:d,startIcon:p.a.createElement(te.a,null),color:"primary",variant:"contained"},"Delete"),p.a.createElement(cn.a,{disabled:i,startIcon:!c&&p.a.createElement(sn.a,null),onClick:t},c?"Close":"Cancel")))};function Ua(){var e=F()(["\n  mutation DeleteRefund($id: ID!) {\n    journalEntryDeleteRefund(id: $id) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return Ua=function(){return e},e}var Wa=fe()(Ua(),Pe),Ja=function(e){var n=e.refundId,t=e.onClose,a=Object(K.b)(Wa),r=U()(a,2),l=r[0],o=r[1],i=o.loading,u=o.error,c=!!u,d=Object(m.useCallback)((function(){l({variables:{id:n}}).then((function(){return t()}))}),[n,l,t]),s=Object(m.useMemo)((function(){return c?"Error":i?"Deleting Refund...":"Delete Refund"}),[c,i]),f=Object(nn.a)();return p.a.createElement(tn.a,{open:!!n,maxWidth:"sm",fullWidth:!0,disableBackdropClick:i,disableEscapeKeyDown:i,onClose:t},p.a.createElement(an.a,{style:c?{color:f.palette.error.main}:void 0},s),p.a.createElement(le.a,{position:"relative"},i&&p.a.createElement(Et,{zIndex:"modal"}),p.a.createElement(ln.a,null,c&&p.a.createElement(rn.a,{color:"error"},null==u?void 0:u.message),!c&&p.a.createElement(rn.a,null,"Are you sure you want to delete this refund?"))),p.a.createElement(un.a,null,!c&&p.a.createElement(cn.a,{disabled:i,onClick:d,startIcon:p.a.createElement(te.a,null),color:"primary",variant:"contained"},"Delete"),p.a.createElement(cn.a,{disabled:i,startIcon:!c&&p.a.createElement(sn.a,null),onClick:t},c?"Close":"Cancel")))},Va=t(5812);function Ga(){var e=F()(["\n  mutation AddEntryItem($id: ID!, $fields: JournalEntryAddItemFields!) {\n    journalEntryAddItem(id: $id, fields: $fields) {\n      journalEntry {\n        ...JournalEntry_1Fragment\n      }\n    }\n  }\n  ","\n"]);return Ga=function(){return e},e}var za=fe()(Ga(),Pe),Ya=function(){var e=N()(J.a.mark((function e(n,t,a){var r,l,o,i,u;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=function(){var e,n,t,r=(null===(e=a.category)||void 0===e?void 0:e.value)||[];return null!==(t=null===(n=r[r.length-1])||void 0===n?void 0:n.id)&&void 0!==t?t:null}(),o=function(){var e;return(null===(e=a.department)||void 0===e?void 0:e.id)||null}(),i=a.units,u={id:t,fields:{units:i,category:l,department:o,description:(null===(r=a.description)||void 0===r?void 0:r.trim())||null,total:a.total.value}},e.next=6,n.mutate({mutation:za,variables:u});case 6:case"end":return e.stop()}}),e)})));return function(n,t,a){return e.apply(this,arguments)}}(),Ka={min:"1",step:"1",type:"number"},Xa=Symbol(),Qa=function(e){var n,t=e.autoFocus,a=void 0!==t&&t,r=e.disabled,l=void 0!==r&&r,o=e.variant,i=void 0===o?"filled":o,u=yn()(e,["autoFocus","disabled","variant"]),c=Object(m.useCallback)((function(e){return(null!=(e=e||null)?e:Xa)===Xa?"Units Required":0===e?"Cannot be 0":e<0?"Units must be 1 or greater":void 0}),[]),d=Object(en.b)({name:"units",validate:c}),s=U()(d,3),f=s[0],v=s[1],b=s[2].setValue,y=null!==(n=f.value)&&void 0!==n?n:"",E=v.error,h=v.touched,g=Rn(),O=U()(g,1)[0],j=Object(m.useMemo)((function(){return{type:"number",autoFocus:a}}),[a]),w=Object(m.useCallback)((function(e){var n,t=(null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.value)||0;b(Math.max("number"==typeof t?t:Number.parseInt(t),0))}),[b]);return p.a.createElement(Tn.a,Object.assign({},u,f,{disabled:l||(null==O?void 0:O.type)===pn.FATAL_ERROR,type:"number",value:y,error:h&&!!E,helperText:h&&E?E:void 0,placeholder:"1",label:"Units",name:"units",required:!0,variant:i,inputProps:Ka,InputProps:j,onChange:w}))};function Ha(){var e=F()(["\n  fragment JournalEntry_3Fragment on JournalEntry {\n    __typename\n    id\n    type\n    total {\n      n\n      d\n      s\n    }\n    date\n    items {\n      id\n      __typename\n      deleted\n      total {\n        n\n        d\n        s\n      }\n    }\n  }\n"]);return Ha=function(){return e},e}var Za=fe()(Ha());function er(){var e=F()(["\n  query GetEntryItemState_1($id: ID!) {\n    journalEntry(id: $id) {\n      ...JournalEntry_3Fragment\n    }\n  }\n  ","\n"]);return er=function(){return e},e}var nr=fe()(er(),Za),tr={item:!0,lg:4,sm:6,xs:12},ar=function(e){var n,t,a,r,l,o=e.entryId,i=e.open,u=e.onClose,c=e.onExited,d=Object(en.c)(),s=d.resetForm,f=d.isSubmitting,v=d.isValid,b=d.submitForm,y=Rn(),E=U()(y,2),h=E[0],g=E[1],O=Object(m.useCallback)((function(e){return g({msg:e.message,type:pn.FATAL_ERROR})}),[g]),j=Object(K.c)(nr,{skip:!o,variables:{id:o},onError:O}),w=j.loading,C=j.data,M=Object(m.useCallback)((function(e){g({msg:e.message,type:pn.FATAL_ERROR})}),[g]),R=(null===(n=null==C?void 0:C.journalEntry)||void 0===n?void 0:n.date)||"",A=Object(K.c)(Zn,{skip:!R,variables:{date:R},onError:M}).data,k=Object(m.useMemo)((function(){var e,n;return null!==(n=null===(e=null==A?void 0:A.fiscalYears[0])||void 0===e?void 0:e.id)&&void 0!==n?n:""}),[A]),_=null!==(a=null===(t=null==C?void 0:C.journalEntry)||void 0===t?void 0:t.type)&&void 0!==a?a:null,S=null===(r=null==C?void 0:C.journalEntry)||void 0===r?void 0:r.total,I=(null===(l=null==C?void 0:C.journalEntry)||void 0===l?void 0:l.items)||[],D=Object(m.useMemo)((function(){if(S){var e=I.reduce((function(e,n){var t=n.deleted,a=n.total;return t?e:e.add($n(a))}),new Ee.a(0));return $n(S).sub(e)}return new Ee.a(Number.MAX_SAFE_INTEGER)}),[S,I]),T=Object(m.useCallback)((function(){c(),s(),g(null)}),[s,c,g]),x=Object(m.useMemo)((function(){return!h||h.type!==pn.FATAL_ERROR&&h.type!==pn.ERROR?[null,null]:[h.msg,h.type===pn.FATAL_ERROR]}),[h]),F=U()(x,2),P=F[0],$=F[1],q=Object(m.useMemo)((function(){return $?"Fatal Error":w?"Loading ".concat("Add Item","..."):f?"Submitting ".concat("Add Item"):"Add Item"}),[w,$,f]),L=Object(nn.a)(),B=Object(m.useCallback)(N()(J.a.mark((function e(){var n;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g(null),e.next=4,b();case 4:u(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),g({msg:null!==(n=e.t0.message)&&void 0!==n?n:"".concat(e.t0),type:pn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[b,u,g]),W=Object(m.useCallback)(N()(J.a.mark((function e(){var n;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g(null),e.next=4,b();case 4:s(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),g({msg:null!==(n=e.t0.message)&&void 0!==n?n:"".concat(e.t0),type:pn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[b,s,g]),V=Object(m.useCallback)((function(e){return e.preventDefault()}),[]);return p.a.createElement(tn.a,{open:i,onClose:u,onExited:T,disableBackdropClick:f,disableEscapeKeyDown:f,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:V}},p.a.createElement(an.a,{style:P?{color:L.palette.error.main}:void 0},q),p.a.createElement(le.a,{position:"relative"},(w||f)&&!P&&p.a.createElement(Et,{zIndex:"modal"}),!!P&&$&&p.a.createElement(yt,{opacity:.78,zIndex:"modal",padding:2},p.a.createElement(rn.a,{color:"error"},P)),p.a.createElement(ln.a,{dividers:!0},!!P&&!$&&p.a.createElement(rn.a,{color:"error"},P),p.a.createElement(on.a,{container:!0,spacing:2},p.a.createElement(on.a,Object.assign({},tr),p.a.createElement(Ln,{disabled:w||f,fullWidth:!0,maxTotal:D})),p.a.createElement(on.a,Object.assign({},tr),p.a.createElement(Qa,{disabled:w||f,fullWidth:!0})),p.a.createElement(on.a,Object.assign({},tr),p.a.createElement(xn,{disabled:w||f,fullWidth:!0})),p.a.createElement(on.a,Object.assign({},tr),p.a.createElement(Gt,{disabled:w||f||!!$,entryType:_,fullWidth:!0})),p.a.createElement(on.a,Object.assign({},tr),p.a.createElement(Zt,{disabled:w||f||!!$,fullWidth:!0,fiscalYearId:k}))))),p.a.createElement(un.a,null,!$&&p.a.createElement(p.a.Fragment,null,p.a.createElement(cn.a,{onClick:B,disabled:w||f||!v,type:"submit",startIcon:p.a.createElement(dn.a,null),color:"primary",variant:"contained"},"Add"),p.a.createElement(cn.a,{onClick:W,disabled:w||f||!v,type:"submit",startIcon:p.a.createElement(xt.a,null),variant:"outlined"},"Add & New")),p.a.createElement(cn.a,{disabled:w||f,color:$?"primary":"default",startIcon:!$&&p.a.createElement(sn.a,null),onClick:u},$?"Ok":"Cancel")))},rr=function(e){var n=e.entryId,t=e.open,a=e.onClose,r=e.onExited,l=Object(m.useMemo)((function(){return{}}),[]),o=Object(K.a)(),i=Object(m.useCallback)((function(e,t){return Ya(o,n||"",e,t)}),[o,n]),u=Object(m.useCallback)((function(e){return p.a.createElement(ar,{entryId:n,open:t,onClose:a,onExited:r,handleSubmit:e.handleSubmit})}),[n,t,a,r]);return p.a.createElement(en.a,{initialValues:l,initialStatus:null,enableReinitialize:!0,onSubmit:i},u)};function lr(){var e=F()(["\n  mutation UpdateEntryItem($id: ID!, $fields: JournalEntryUpdateItemFields!) {\n    journalEntryUpdateItem(id: $id, fields: $fields) {\n      journalEntryItem {\n        ...JournalEntryItem_1Fragment\n      }\n    }\n  }\n  ","\n"]);return lr=function(){return e},e}var or=fe()(lr(),Fe),ir=function(){var e=N()(J.a.mark((function e(n,t,a,r){var l,o,i,u,c,d,s,m,p,f,v;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=r.description!==t.description&&(null===(l=r.description)||void 0===l?void 0:l.trim())||null,s=(null===(o=r.department)||void 0===o?void 0:o.id)===(null===(i=t.department)||void 0===i?void 0:i.id)?null:null!==(c=null===(u=r.department)||void 0===u?void 0:u.id)&&void 0!==c?c:null,m=function(){var e,n,a,l,o=null!==(n=null===(e=r.category.value[r.category.value.length-1])||void 0===e?void 0:e.id)&&void 0!==n?n:null;return o===(null!==(l=null===(a=t.category.value[t.category.value.length-1])||void 0===a?void 0:a.id)&&void 0!==l?l:null)?null:o}(),p=r.units===t.units?null:r.units,f=0===$n(r.total.value).compare($n(t.total.value))?null:r.total.value,v={id:a,fields:{units:p,description:d,department:s,category:m,total:f}},e.next=8,n.mutate({mutation:or,variables:v});case 8:case"end":return e.stop()}}),e)})));return function(n,t,a,r){return e.apply(this,arguments)}}();function ur(){var e=F()(["\n  query UpdateItemIniState($entryId: ID!, $itemId: ID!) {\n    journalEntry(id: $entryId) {\n      ...JournalEntry_3Fragment\n    }\n    journalEntryItem(id: $itemId) {\n      __typename\n      id\n      department {\n        ...DeptEntryOptFragment\n      }\n      category {\n        ...CatEntryOptFragment\n        ancestors {\n          ...CatEntryOptFragment\n        }\n      }\n      description\n      units\n      total {\n        n\n        d\n        s\n      }\n    }\n  }\n  ","\n  ","\n  ","\n"]);return ur=function(){return e},e}var cr=fe()(ur(),Za,et,nt),dr={item:!0,lg:4,sm:6,xs:12},sr=function(e){var n,t=e.itemId,a=e.open,r=e.onClose,l=e.onExited,o=e.journalEntry,i=e.loading,u=e.handleSubmit,c=Object(en.c)(),d=c.resetForm,s=c.isSubmitting,f=c.isValid,v=Rn(),b=U()(v,2),y=b[0],E=b[1],h=Object(m.useCallback)((function(e){E({msg:e.message,type:pn.FATAL_ERROR})}),[E]),g=(null==o?void 0:o.date)||"",O=Object(K.c)(Zn,{skip:!g,variables:{date:g},onError:h}).data,j=Object(m.useMemo)((function(){var e,n;return null!==(n=null===(e=null==O?void 0:O.fiscalYears[0])||void 0===e?void 0:e.id)&&void 0!==n?n:""}),[O]),w=null!==(n=null==o?void 0:o.type)&&void 0!==n?n:null,C=null==o?void 0:o.total,M=(null==o?void 0:o.items)||[],R=Object(m.useMemo)((function(){if(C){var e=M.reduce((function(e,n){var a=n.id,r=n.deleted,l=n.total;return r||a===t?e:e.add($n(l))}),new Ee.a(0));return $n(C).sub(e)}return new Ee.a(Number.MAX_SAFE_INTEGER)}),[C,M,t]),A=Object(m.useCallback)((function(){l(),d(),E(null)}),[d,l,E]),k=Object(m.useMemo)((function(){return!y||y.type!==pn.FATAL_ERROR&&y.type!==pn.ERROR?[null,null]:[y.msg,y.type===pn.FATAL_ERROR]}),[y]),_=U()(k,2),S=_[0],I=_[1],D=Object(m.useMemo)((function(){var e="Item Update";return I?"Fatal Error":i?"Loading ".concat(e,"..."):s?"Submitting ".concat(e):e}),[i,I,s]),T=Object(nn.a)();return p.a.createElement(tn.a,{open:a,onClose:r,onExited:A,disableBackdropClick:s,disableEscapeKeyDown:s,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:u}},p.a.createElement(an.a,{style:S?{color:T.palette.error.main}:void 0},D),p.a.createElement(le.a,{position:"relative"},(i||s)&&!S&&p.a.createElement(Et,{zIndex:"modal"}),!!S&&I&&p.a.createElement(yt,{opacity:.78,zIndex:"modal",padding:2},p.a.createElement(rn.a,{color:"error"},S)),p.a.createElement(ln.a,{dividers:!0},!!S&&!I&&p.a.createElement(rn.a,{color:"error"},S),p.a.createElement(on.a,{container:!0,spacing:2},p.a.createElement(on.a,Object.assign({},dr),p.a.createElement(Ln,{disabled:i||s,fullWidth:!0,maxTotal:R})),p.a.createElement(on.a,Object.assign({},dr),p.a.createElement(Qa,{disabled:i||s,fullWidth:!0})),p.a.createElement(on.a,Object.assign({},dr),p.a.createElement(xn,{disabled:i||s,fullWidth:!0})),p.a.createElement(on.a,Object.assign({},dr),p.a.createElement(Gt,{disabled:i||s||!!I,entryType:w,fullWidth:!0})),p.a.createElement(on.a,Object.assign({},dr),p.a.createElement(Zt,{disabled:i||s||!!I,fullWidth:!0,fiscalYearId:j}))))),p.a.createElement(un.a,null,!I&&p.a.createElement(cn.a,{disabled:i||s||!f,type:"submit",startIcon:p.a.createElement(dn.a,null),color:"primary",variant:"contained"},"Update"),p.a.createElement(cn.a,{disabled:i||s||!!I,color:I?"primary":"default",startIcon:!I&&p.a.createElement(sn.a,null),onClick:r},I?"Ok":"Cancel")))},mr=function(e){var n=e.entryId,t=e.itemId,a=e.open,r=e.onClose,l=e.onExited,o=Object(K.c)(cr,{skip:!n,variables:{entryId:n,itemId:t}}),i=o.loading,u=o.error,c=o.data,d=Object(m.useMemo)((function(){return u?{msg:u.message,type:pn.FATAL_ERROR}:null}),[u]),s=null==c?void 0:c.journalEntryItem,f=Object(m.useMemo)((function(){var e,n;if(!s)return{};var t={inputValue:$n(s.total).round(2).toString(),value:s.total},a=function(){if(!s.category)return{inputValue:"",value:[]};var e=s.category,n=e.ancestors,t=yn()(e,["ancestors"]),a=L()(n).sort((function(e,n){var t,a;return e.id===(null===(t=n.parent)||void 0===t?void 0:t.id)?-1:n.id===(null===(a=e.parent)||void 0===a?void 0:a.id)?1:0}));return a.push(t),{inputValue:"",value:a}}(),r=null!==(e=s.department)&&void 0!==e?e:null,l=null!==(n=s.description)&&void 0!==n?n:null;return{total:t,units:s.units,category:a,department:r,description:l}}),[s]),v=Object(K.a)(),b=Object(m.useCallback)(function(){var e=N()(J.a.mark((function e(n,a){var l;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=5;break}return a.setStatus({msg:'Failed to load initial values for item "'.concat(t,'".'),type:pn.FATAL_ERROR}),e.abrupt("return");case 5:if(t){e.next=8;break}return a.setStatus({msg:"No item ID.",type:pn.FATAL_ERROR}),e.abrupt("return");case 8:return e.prev=8,a.setStatus(null),e.next=12,ir(v,f,t,n,a);case 12:r(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),a.setStatus({msg:null!==(l=null===e.t0||void 0===e.t0?void 0:e.t0.message)&&void 0!==l?l:"".concat(e.t0),type:pn.FATAL_ERROR});case 18:case"end":return e.stop()}}),e,null,[[8,15]])})));return function(n,t){return e.apply(this,arguments)}}(),[v,f,r,t]),y=Object(m.useCallback)((function(e){var o;return p.a.createElement(sr,{entryId:n,itemId:t,open:a,onClose:r,onExited:l,journalEntry:null!==(o=null==c?void 0:c.journalEntry)&&void 0!==o?o:null,loading:i,handleSubmit:e.handleSubmit})}),[c,n,i,r,l,a,t]);return p.a.createElement(en.a,{initialValues:null!=f?f:{},initialStatus:d,enableReinitialize:!0,onSubmit:b},y)};function pr(){var e=F()(["\n  mutation DeleteItem($id: ID!) {\n    journalEntryDeleteItem(id: $id) {\n      journalEntryItem {\n        id\n        __typename\n        deleted\n      }\n    }\n  }\n"]);return pr=function(){return e},e}var fr=fe()(pr()),vr=function(e){var n=e.itemId,t=e.onClose,a=Object(K.b)(fr),r=U()(a,2),l=r[0],o=r[1],i=o.loading,u=o.error,c=!!u,d=Object(m.useCallback)((function(){l({variables:{id:n}}).then((function(){return t()}))}),[n,l,t]),s=Object(m.useMemo)((function(){return c?"Error":i?"Deleting Item...":"Delete Item"}),[c,i]),f=Object(nn.a)();return p.a.createElement(tn.a,{open:!!n,maxWidth:"sm",fullWidth:!0,disableBackdropClick:i,disableEscapeKeyDown:i,onClose:t},p.a.createElement(an.a,{style:c?{color:f.palette.error.main}:void 0},s),p.a.createElement(le.a,{position:"relative"},i&&p.a.createElement(Et,{zIndex:"modal"}),p.a.createElement(ln.a,null,c&&p.a.createElement(rn.a,{color:"error"},null==u?void 0:u.message),!c&&p.a.createElement(rn.a,null,"Are you sure you want to delete this item?"))),p.a.createElement(un.a,null,!c&&p.a.createElement(cn.a,{disabled:i,onClick:d,startIcon:p.a.createElement(te.a,null),color:"primary",variant:"contained"},"Delete"),p.a.createElement(cn.a,{disabled:i,startIcon:!c&&p.a.createElement(sn.a,null),onClick:t},c?"Close":"Cancel")))},br=function(e){var n,t,a=e.entry,r=a.items,l=a.category,o=a.description,i=a.department,u=a.id,c=Object(m.useState)(!1),d=U()(c,2),s=d[0],f=d[1],v=Object(m.useState)(null),b=U()(v,2),y=b[0],E=b[1],h=Object(m.useCallback)((function(){f(!1)}),[f]),g=Object(m.useCallback)((function(){E(null)}),[E]),O=Object(m.useState)(!1),j=U()(O,2),w=j[0],C=j[1],M=Object(m.useState)(null),R=U()(M,2),A=R[0],k=R[1],_=Object(m.useState)(null),S=U()(_,2),I=S[0],D=S[1],T=Object(m.useCallback)((function(){D(null)}),[D]),x=Object(m.useCallback)((function(){C(!1)}),[C]),F=Object(m.useCallback)((function(){k(null)}),[k]),P=Object(m.useMemo)((function(){return[{icon:te.a,tooltip:"Delete Item",onClick:function(e,n){return D(n.id)}},{icon:ae.a,tooltip:"Edit Item",onClick:function(e,n){C(!0),k({entryId:u,itemId:n.id})}},{icon:function(e){return p.a.createElement(re.a,Object.assign({},e))},iconProps:{color:"secondary",fontSize:"large"},tooltip:"Add Item",isFreeAction:!0,onClick:function(){f(!0),E(u)}}]}),[u]),$=Object(m.useMemo)((function(){return[{field:"total",title:"Total",render:function(e){var n=e.total;return Q()($n(n).valueOf()).format("$0,0.00")}},{field:"units",title:"Units"},{field:"description",title:"Description",render:function(e){var n;return(null===(n=e.description)||void 0===n?void 0:n.trim())||o}},{field:"category",title:"Category",render:function(e){var n,t,a=null!==(t=null===(n=e.category)||void 0===n?void 0:n.name)&&void 0!==t?t:l.name;return Object(H.a)(a)}},{field:"department",title:"Department",render:function(e){var n,t,a=null!==(t=null===(n=e.department)||void 0===n?void 0:n.name)&&void 0!==t?t:i.name;return Object(H.a)(a)}}]}),[l,o,i]),N=Object(m.useMemo)((function(){return{search:!1,emptyRowsWhenPaging:!1}}),[]),q=Object(m.useMemo)((function(){return r.filter((function(e){return!e.deleted}))}),[r]),L=Object(nn.a)(),B=Object(m.useMemo)((function(){return{boxShadow:L.shadows[0]}}),[L.shadows]),W=Object(m.useMemo)((function(){return{backgroundColor:L.palette.primary.main}}),[L.palette.primary.main]);return p.a.createElement(le.a,null,p.a.createElement(Y.a,{title:"Items",actions:P,options:N,columns:$,icons:Ze,data:q,style:B}),p.a.createElement(rr,{entryId:y,open:s,onClose:h,onExited:g}),p.a.createElement(mr,{entryId:null!==(n=null==A?void 0:A.entryId)&&void 0!==n?n:null,itemId:null!==(t=null==A?void 0:A.itemId)&&void 0!==t?t:null,open:w,onClose:x,onExited:F}),p.a.createElement(vr,{itemId:I,onClose:T}),p.a.createElement(Va.a,{style:W}))},yr=t(296),Er=t(360),hr=function(e){var n=e.setFilter,t=Object(m.useState)("None"),a=U()(t,2),r=a[0],l=a[1],o=Object(m.useCallback)((function(e){var t=e.target.value;switch(t){case"Reconciled":n({reconciled:{$eq:!0}});break;case"Unreconciled":n({reconciled:{$eq:!1}});break;case"None":n({})}l(t)}),[n,l]);return p.a.createElement(va.a,{title:"None"===r?"No Filter":r},p.a.createElement(yr.a,{startAdornment:p.a.createElement(Fn.a,{disablePointerEvents:!0,position:"start"},p.a.createElement(Ve.a,null)),onChange:o,fullWidth:!0,value:"None"===r?"":r},p.a.createElement(Er.a,{value:"None"},"None"),p.a.createElement(Er.a,{value:"Reconciled"},"Reconciled"),p.a.createElement(Er.a,{value:"Unreconciled"},"Unreconciled")))},gr=t(375),Or=t(240);function jr(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return wr(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return wr(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function wr(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var Cr=function(e){var n=e.setFilter,t=e.options,a=Object(m.useState)([]),r=U()(a,2),l=r[0],o=r[1],i=Object(m.useMemo)((function(){var e,n=[],a=new Map,r=jr(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;a.set(o.id,o.name),n.push(p.a.createElement(Er.a,{key:o.id,value:o.id},p.a.createElement(Un.a,{checked:l.includes(o.id)}),p.a.createElement(gr.a,{primary:o.name})))}}catch(e){r.e(e)}finally{r.f()}return[n,a]}),[t,l]),u=U()(i,2),c=u[0],d=u[1],s=Object(m.useCallback)((function(e){return e.map((function(e){var n;return null!==(n=d.get(e))&&void 0!==n?n:""})).join(", ")}),[d]),f=Object(m.useCallback)((function(e){var t=e.target.value||[];0===t.length?n({}):n({"category.id":{$in:t}}),o(t)}),[n]);return p.a.createElement(va.a,{title:0===l.length?"No Filter":s(l)},p.a.createElement(le.a,{maxWidth:250},p.a.createElement(yr.a,{startAdornment:p.a.createElement(Fn.a,{disablePointerEvents:!0,position:"start"},p.a.createElement(Ve.a,null)),fullWidth:!0,multiple:!0,value:l,onChange:f,input:p.a.createElement(Or.a,null),renderValue:s},c)))};function Mr(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return Rr(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Rr(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Rr(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var Ar=function(e){var n=e.setFilter,t=e.options,a=Object(m.useState)([]),r=U()(a,2),l=r[0],o=r[1],i=Object(m.useMemo)((function(){var e,n=[],a=new Map,r=Mr(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;a.set(o.id,o.name),n.push(p.a.createElement(Er.a,{key:o.id,value:o.id},p.a.createElement(Un.a,{checked:l.includes(o.id)}),p.a.createElement(gr.a,{primary:o.name})))}}catch(e){r.e(e)}finally{r.f()}return[n,a]}),[t,l]),u=U()(i,2),c=u[0],d=u[1],s=Object(m.useCallback)((function(e){return e.map((function(e){var n;return null!==(n=d.get(e))&&void 0!==n?n:""})).join(", ")}),[d]),f=Object(m.useCallback)((function(e){var t=e.target.value||[];0===t.length?n({}):n({$or:[{"paymentMethod.id":{$in:t}},{"paymentMethod.parent.id":{$in:t}}]}),o(t)}),[n]);return p.a.createElement(va.a,{title:0===l.length?"No Filter":s(l)},p.a.createElement(le.a,{maxWidth:250},p.a.createElement(yr.a,{startAdornment:p.a.createElement(Fn.a,{disablePointerEvents:!0,position:"start"},p.a.createElement(Ve.a,null)),fullWidth:!0,multiple:!0,value:l,onChange:f,input:p.a.createElement(Or.a,null),renderValue:s},c)))};function kr(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return _r(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _r(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function _r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var Sr=function(e){var n=e.setFilter,t=e.options,a=Object(m.useState)([]),r=U()(a,2),l=r[0],o=r[1],i=Object(m.useMemo)((function(){var e,n=[],a=new Map,r=kr(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;a.set(o.id,o.name),n.push(p.a.createElement(Er.a,{key:o.id,value:o.id},p.a.createElement(Un.a,{checked:l.includes(o.id)}),p.a.createElement(gr.a,{primary:o.name})))}}catch(e){r.e(e)}finally{r.f()}return[n,a]}),[t,l]),u=U()(i,2),c=u[0],d=u[1],s=Object(m.useCallback)((function(e){return e.map((function(e){var n;return null!==(n=d.get(e))&&void 0!==n?n:""})).join(", ")}),[d]),f=Object(m.useCallback)((function(e){var t=e.target.value||[];0===t.length?n({}):n({"department.id":{$in:t}}),o(t)}),[n]);return p.a.createElement(va.a,{title:0===l.length?"No Filter":s(l)},p.a.createElement(le.a,{maxWidth:250},p.a.createElement(yr.a,{startAdornment:p.a.createElement(Fn.a,{disablePointerEvents:!0,position:"start"},p.a.createElement(Ve.a,null)),fullWidth:!0,multiple:!0,value:l,onChange:f,input:p.a.createElement(Or.a,null),renderValue:s},c)))};function Ir(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return Dr(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Dr(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Dr(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var Tr,xr=function(e){var n=e.setFilter,t=e.options,a=Object(m.useState)([]),r=U()(a,2),l=r[0],o=r[1],i=Object(m.useMemo)((function(){var e,n,a,r,o=[],i=new Map,u=Ir(t);try{for(u.s();!(e=u.n()).done;)n=void 0,a=void 0,r=void 0,n=e.value,a=function(){switch(n.__typename){case"Person":return"".concat(n.name.first," ").concat(n.name.last);case"Business":return n.bizName;case"Department":return n.deptName}}(),r="".concat(n.__typename,"-").concat(n.id),i.set(r,a),o.push(p.a.createElement(Er.a,{key:r,value:r},p.a.createElement(Un.a,{checked:l.includes(r)}),p.a.createElement(gr.a,{primary:a})))}catch(e){u.e(e)}finally{u.f()}return[o,i]}),[t,l]),u=U()(i,2),c=u[0],d=u[1],s=Object(m.useCallback)((function(e){return e.map((function(e){var n;return null!==(n=d.get(e))&&void 0!==n?n:""})).join(", ")}),[d]),f=Object(m.useCallback)((function(e){var t=e.target.value||[];0===t.length?n({}):n({$or:t.map((function(e){var n=e.split("-"),t=U()(n,2),a=t[0];return{"source.id":t[1],"source.__typename":a}}))}),o(t)}),[n]);return p.a.createElement(va.a,{title:0===l.length?"No Filter":s(l)},p.a.createElement(le.a,{maxWidth:250},p.a.createElement(yr.a,{startAdornment:p.a.createElement(Fn.a,{disablePointerEvents:!0,position:"start"},p.a.createElement(Ve.a,null)),fullWidth:!0,multiple:!0,value:l,onChange:f,input:p.a.createElement(Or.a,null),renderValue:s},c)))},Fr=t(193),Pr=t(423),$r=t(5839),Nr=t(194),qr=t(5838);function Lr(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return Br(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Br(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Br(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}!function(e){e[e.None=1]="None",e[e.Equal=2]="Equal",e[e.GreaterThan=3]="GreaterThan",e[e.LessThan=4]="LessThan",e[e.GreaterThanOrEqual=5]="GreaterThanOrEqual",e[e.LessThanOrEqual=6]="LessThanOrEqual"}(Tr||(Tr={}));var Ur,Wr=function(e,n){if(!e)return[void 0,void 0,[Tr.None]];switch(n){case Tr.None:case Tr.Equal:return[void 0,void 0,[Tr.None]];case Tr.GreaterThan:case Tr.GreaterThanOrEqual:return[Object(Nr.a)(e,1),void 0,[Tr.None,Tr.LessThan,Tr.LessThanOrEqual]];case Tr.LessThan:case Tr.LessThanOrEqual:return[void 0,Object(qr.a)(e,1),[Tr.None,Tr.GreaterThan,Tr.GreaterThanOrEqual]]}},Jr=new Date(864e13),Vr=new Date(-864e13),Gr=function(e){var n=e.setFilter,t=Object(m.useState)(""),a=U()(t,2),r=a[0],l=a[1],o=Object(m.useState)(Tr.Equal),i=U()(o,2),u=i[0],c=i[1],d=Object(m.useState)(null),s=U()(d,2),f=s[0],v=s[1],b=Object(m.useState)(Tr.None),y=U()(b,2),E=y[0],h=y[1],g=Object(m.useState)(null),O=U()(g,2),j=O[0],w=O[1],C=Object(m.useMemo)((function(){return Wr(f,u)}),[f,u]),M=U()(C,3),R=M[0],A=M[1],k=M[2],_=Object(m.useCallback)((function(e){if(0===e.length)return l(""),void n({});var t,a,r,o,i,u,c,d,s=[],m=[],p=Lr(e);try{for(p.s();!(t=p.n()).done;)a=void 0,r=void 0,o=void 0,i=void 0,u=void 0,c=void 0,d=void 0,a=t.value,r=a.op,o=a.date,i=function(){switch(r){case Tr.Equal:return["$eq","="];case Tr.GreaterThan:return["$gt",">"];case Tr.GreaterThanOrEqual:return["$gte",">="];case Tr.LessThan:return["$lt","<"];case Tr.LessThanOrEqual:return["$lte","<="];case Tr.None:return["",""]}}(),u=U()(i,2),c=u[0],d=u[1],s.push({date:G()({},c,Object(be.a)(o))}),m.push("".concat(d,"[").concat(Object(ve.a)(o,"d/M/yy"),"]"))}catch(e){p.e(e)}finally{p.f()}l(m.join(" & ")),n({$and:s})}),[n]),S=Object(m.useCallback)((function(e){var n,t=null!==(n=e.target.value)&&void 0!==n?n:Tr.Equal;c(t);var a=Wr(f,t),r=U()(a,3)[2].includes(E);if(r||(h(Tr.None),w(null)),f){var l=[{op:t,date:f}];r&&E!==Tr.None&&E!==Tr.Equal&&j&&l.push({op:E,date:j}),_(l)}}),[f,j,E,_]),I=Object(m.useCallback)((function(e){var n,t=null!==(n=e.target.value)&&void 0!==n?n:Tr.None;h(t),t===Tr.None?(w(null),_(f?[{op:u,date:f}]:[])):j&&_([{op:u,date:f},{op:t,date:j}])}),[f,j,u,_]),D=Object(m.useCallback)((function(e){if(!e||Object(On.a)(e))if(v(e),e){var n=[{op:u,date:e}];if(j){var t=Wr(e,u),a=U()(t,2),r=a[0],l=a[1];E!==Tr.None&&E!==Tr.Equal&&r&&j>=r||l&&j<=l?n.push({op:E,date:j}):(h(Tr.None),w(null))}_(n)}else _([]),h(Tr.None),w(null)}),[j,u,E,_]),T=Object(m.useCallback)((function(e){e&&!Object(On.a)(e)||(w(e),e?_([{op:u,date:f},{op:E,date:e}]):(_(f?[{op:u,date:f}]:[]),w(null)))}),[f,u,E,_]),x=Object(m.useCallback)((function(e){e.stopPropagation(),c(Tr.Equal),v(null),h(Tr.None),w(null),_([])}),[_]),F=Object(m.useMemo)((function(){return{startAdornment:p.a.createElement(Fn.a,{disablePointerEvents:!0,position:"start"},p.a.createElement(Ve.a,null)),endAdornment:f?p.a.createElement(Fn.a,{position:"end"},p.a.createElement(Fr.a,{onClick:x},p.a.createElement(Be.a,null))):p.a.createElement(Fn.a,{disablePointerEvents:!0,position:"end"},p.a.createElement($r.a,null))}}),[f,x]),P=Object(m.useState)(null),$=U()(P,2),N=$[0],q=$[1],L=Object(m.useCallback)((function(e){q(e.currentTarget)}),[]),B=Object(m.useCallback)((function(){q(null)}),[]);return p.a.createElement(le.a,null,p.a.createElement(va.a,{title:r||"No Filter"},p.a.createElement(le.a,{maxWidth:250},p.a.createElement(Tn.a,{fullWidth:!0,value:r,InputProps:F,onClick:L}))),p.a.createElement(Pr.a,{onClose:B,open:!!N,anchorEl:N},p.a.createElement(le.a,{maxWidth:350,margin:2,clone:!0},p.a.createElement(on.a,{container:!0,spacing:2},p.a.createElement(on.a,{xs:12,item:!0},p.a.createElement(le.a,{marginTop:1},p.a.createElement(yr.a,{value:u,onChange:S},p.a.createElement(Er.a,{value:Tr.Equal},p.a.createElement(me.e,null)),p.a.createElement(Er.a,{value:Tr.GreaterThan},p.a.createElement(me.h,null)),p.a.createElement(Er.a,{value:Tr.LessThan},p.a.createElement(me.j,null)),p.a.createElement(Er.a,{value:Tr.GreaterThanOrEqual},p.a.createElement(me.i,null)),p.a.createElement(Er.a,{value:Tr.LessThanOrEqual},p.a.createElement(me.k,null)))),p.a.createElement(En.a,{utils:gn.default},p.a.createElement(hn.b,{onChange:D,value:f,format:"MM/dd/yyyy",placeholder:"mm/dd/yyyy",margin:"none",label:"Date",animateYearScrolling:!0,disableToolbar:!0,autoOk:!0,variant:"inline"}))),!!f&&u!==Tr.Equal&&p.a.createElement(on.a,{xs:12,item:!0},p.a.createElement(le.a,{marginTop:1},p.a.createElement(yr.a,{value:E,onChange:I},p.a.createElement(Er.a,{value:Tr.None},"None"),p.a.createElement(Er.a,{style:{display:"None"},value:Tr.Equal},p.a.createElement(me.e,null)),p.a.createElement(Er.a,{style:k.includes(Tr.GreaterThan)?void 0:{display:"none"},disabled:!k.includes(Tr.GreaterThan),value:Tr.GreaterThan},p.a.createElement(me.h,null)),p.a.createElement(Er.a,{style:k.includes(Tr.LessThan)?void 0:{display:"none"},disabled:!k.includes(Tr.LessThan),value:Tr.LessThan},p.a.createElement(me.j,null)),p.a.createElement(Er.a,{style:k.includes(Tr.GreaterThanOrEqual)?void 0:{display:"none"},disabled:!k.includes(Tr.GreaterThanOrEqual),value:Tr.GreaterThanOrEqual},p.a.createElement(me.i,null)),p.a.createElement(Er.a,{style:k.includes(Tr.LessThanOrEqual)?void 0:{display:"none"},disabled:!k.includes(Tr.LessThanOrEqual),value:Tr.LessThanOrEqual},p.a.createElement(me.k,null)))),p.a.createElement(En.a,{utils:gn.default},p.a.createElement(hn.b,{disabled:E===Tr.None,minDate:R||Vr,maxDate:A||Jr,onChange:T,value:j,format:"MM/dd/yyyy",placeholder:"mm/dd/yyyy",margin:"none",label:"Date",animateYearScrolling:!0,disableToolbar:!0,autoOk:!0,variant:"inline"})))))))};function zr(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return Yr(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Yr(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Yr(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}!function(e){e[e.None=1]="None",e[e.Equal=2]="Equal",e[e.GreaterThan=3]="GreaterThan",e[e.LessThan=4]="LessThan",e[e.GreaterThanOrEqual=5]="GreaterThanOrEqual",e[e.LessThanOrEqual=6]="LessThanOrEqual"}(Ur||(Ur={}));var Kr,Xr=function(e,n){if(!e)return[void 0,void 0,[Ur.None]];switch(n){case Ur.None:case Ur.Equal:return[void 0,void 0,[Ur.None]];case Ur.GreaterThan:case Ur.GreaterThanOrEqual:return[e.add(new Ee.a({n:1,d:100})),void 0,[Ur.None,Ur.LessThan,Ur.LessThanOrEqual]];case Ur.LessThan:case Ur.LessThanOrEqual:return[void 0,e.sub(new Ee.a({n:1,d:100})),[Ur.None,Ur.GreaterThan,Ur.GreaterThanOrEqual]]}},Qr={type:"number",startAdornment:p.a.createElement(Fn.a,{position:"start"},"$")},Hr=function(e){var n=e.setFilter,t=Object(m.useState)(""),a=U()(t,2),r=a[0],l=a[1],o=Object(m.useState)(Ur.Equal),i=U()(o,2),u=i[0],c=i[1],d=Object(m.useState)(""),s=U()(d,2),f=s[0],v=s[1],b=Object(m.useState)(Ur.None),y=U()(b,2),E=y[0],h=y[1],g=Object(m.useState)(""),O=U()(g,2),j=O[0],w=O[1],C=Object(m.useMemo)((function(){return Xr(f?new Ee.a(f):null,u)}),[f,u]),M=U()(C,3),R=M[0],A=M[1],k=M[2],_=Object(m.useMemo)((function(){return{min:R?R.toString():"0.00",max:A?A.toString():void 0,step:"0.01"}}),[R,A]),S=Object(m.useCallback)((function(e){if(0===e.length)return l(""),void n({});var t,a,r,o,i,u,c,d,s=[],m=[],p=zr(e);try{for(p.s();!(t=p.n()).done;)a=void 0,r=void 0,o=void 0,i=void 0,u=void 0,c=void 0,d=void 0,a=t.value,r=a.op,o=a.total,i=function(){switch(r){case Ur.Equal:return["$eq","="];case Ur.GreaterThan:return["$gt",">"];case Ur.GreaterThanOrEqual:return["$gte",">="];case Ur.LessThan:return["$lt","<"];case Ur.LessThanOrEqual:return["$lte","<="];case Ur.None:return["",""]}}(),u=U()(i,2),c=u[0],d=u[1],s.push({total:G()({},c,o)}),m.push("".concat(d,"[").concat(o,"]"))}catch(e){p.e(e)}finally{p.f()}l(m.join(" & ")),n({$and:s})}),[n]),I=Object(m.useCallback)((function(e){var n,t=null!==(n=e.target.value)&&void 0!==n?n:Ur.Equal;c(t);var a=Xr(f?new Ee.a(f):null,t),r=U()(a,3)[2].includes(E);if(r||(h(Ur.None),w("")),f){var l=[{op:t,total:new Ee.a(f).valueOf()}];if(r&&E!==Ur.None&&E!==Ur.Equal&&j){var o=new Ee.a(j);l.push({op:E,total:o.valueOf()})}S(l)}}),[f,j,E,S]),D=Object(m.useCallback)((function(e){var n,t=null!==(n=e.target.value)&&void 0!==n?n:Ur.None;if(h(t),t===Ur.None)if(w(""),f){var a=new Ee.a(f);S([{op:u,total:a.valueOf()}])}else S([]);else if(j){var r=new Ee.a(f),l=new Ee.a(j);S([{op:u,total:r.valueOf()},{op:t,total:l.valueOf()}])}}),[f,j,u,S]),T=Object(m.useCallback)((function(e){var n=e.target.value.trim();if(n){var t=new Ee.a(n).round(2);l(t.toString()),v(n);var a=[{op:u,total:t.valueOf()}];if(j){var r=Xr(t,u),o=U()(r,2),i=o[0],c=o[1],d=new Ee.a(j);E!==Ur.None&&E!==Ur.Equal&&i&&d.compare(i)>=0||c&&d.compare(c)<=0?a.push({op:E,total:d.valueOf()}):(h(Ur.None),w(""))}S(a)}else l(n),S([]),h(Ur.None),w("")}),[u,j,S,E]),x=Object(m.useCallback)((function(e){var n=e.target.value.trim();if(n){var t=new Ee.a(f),a=new Ee.a(n).round(2);w(n),S([{op:u,total:t.valueOf()},{op:E,total:a.valueOf()}])}else{if(f){var r=new Ee.a(f);S([{op:u,total:r.valueOf()}])}else S([]);w("")}}),[f,u,E,S]),F=Object(m.useCallback)((function(e){e.stopPropagation(),c(Ur.Equal),v(""),h(Ur.None),w(""),S([])}),[S]),P=Object(m.useMemo)((function(){return{startAdornment:p.a.createElement(Fn.a,{disablePointerEvents:!0,position:"start"},p.a.createElement(Ve.a,null)),endAdornment:f?p.a.createElement(Fn.a,{position:"end"},p.a.createElement(Fr.a,{onClick:F},p.a.createElement(Be.a,null))):p.a.createElement(Fn.a,{disablePointerEvents:!0,position:"end"},p.a.createElement($r.a,null))}}),[f,F]),$=Object(m.useState)(null),N=U()($,2),q=N[0],L=N[1],B=Object(m.useCallback)((function(e){L(e.currentTarget)}),[]),W=Object(m.useCallback)((function(){L(null)}),[]);return p.a.createElement(le.a,null,p.a.createElement(va.a,{title:r||"No Filter"},p.a.createElement(le.a,{maxWidth:250},p.a.createElement(Tn.a,{fullWidth:!0,value:r,InputProps:P,onClick:B}))),p.a.createElement(Pr.a,{onClose:W,open:!!q,anchorEl:q},p.a.createElement(le.a,{maxWidth:350,margin:2,clone:!0},p.a.createElement(on.a,{container:!0,spacing:2},p.a.createElement(on.a,{xs:12,item:!0},p.a.createElement(yr.a,{value:u,onChange:I},p.a.createElement(Er.a,{value:Ur.Equal},p.a.createElement(me.e,null)),p.a.createElement(Er.a,{value:Ur.GreaterThan},p.a.createElement(me.h,null)),p.a.createElement(Er.a,{value:Ur.LessThan},p.a.createElement(me.j,null)),p.a.createElement(Er.a,{value:Ur.GreaterThanOrEqual},p.a.createElement(me.i,null)),p.a.createElement(Er.a,{value:Ur.LessThanOrEqual},p.a.createElement(me.k,null))),p.a.createElement(le.a,{marginTop:2},p.a.createElement(Tn.a,{placeholder:"0.00",label:"Total",type:"number",inputProps:_,InputProps:Qr,value:f,onChange:T}))),!!f&&u!==Ur.Equal&&p.a.createElement(on.a,{xs:12,item:!0},p.a.createElement(yr.a,{value:E,onChange:D},p.a.createElement(Er.a,{value:Ur.None},"None"),p.a.createElement(Er.a,{style:{display:"None"},value:Ur.Equal},p.a.createElement(me.e,null)),p.a.createElement(Er.a,{style:k.includes(Ur.GreaterThan)?void 0:{display:"none"},disabled:!k.includes(Ur.GreaterThan),value:Ur.GreaterThan},p.a.createElement(me.h,null)),p.a.createElement(Er.a,{style:k.includes(Ur.LessThan)?void 0:{display:"none"},disabled:!k.includes(Ur.LessThan),value:Ur.LessThan},p.a.createElement(me.j,null)),p.a.createElement(Er.a,{style:k.includes(Ur.GreaterThanOrEqual)?void 0:{display:"none"},disabled:!k.includes(Ur.GreaterThanOrEqual),value:Ur.GreaterThanOrEqual},p.a.createElement(me.i,null)),p.a.createElement(Er.a,{style:k.includes(Ur.LessThanOrEqual)?void 0:{display:"none"},disabled:!k.includes(Ur.LessThanOrEqual),value:Ur.LessThanOrEqual},p.a.createElement(me.k,null))),p.a.createElement(le.a,{marginTop:2},p.a.createElement(Tn.a,{disabled:E===Ur.None,placeholder:"0.00",label:"Total",type:"number",inputProps:_,InputProps:Qr,value:j,onChange:x})))))))},Zr=t(8);function el(){var e=F()(["\n  mutation ReconcileRefund($id: ID!) {\n    journalEntryUpdateRefund(id: $id, fields: { reconciled: true }) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return el=function(){return e},e}function nl(){var e=F()(["\n  mutation ReconcileEntry($id: ID!) {\n    journalEntryUpdate(id: $id, fields: { reconciled: true }) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return nl=function(){return e},e}function tl(){var e=F()(["\n  subscription OnEntryUpsert_1 {\n    journalEntryUpserted {\n      ...JournalEntry_1Fragment\n      department {\n        ancestors {\n          ... on Department {\n            __typename\n            id\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return tl=function(){return e},e}function al(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function rl(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?al(Object(t),!0).forEach((function(n){G()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):al(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function ll(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return ol(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ol(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function ol(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}Object(Zr.b)(Zr.a.EXPRESSION,(function(e){return{$expressionCb:function(n,t,a){return t(n,a,e)}}})),Object(Zr.b)(Zr.a.QUERY,(function(e){return{$queryCb:function(n,t,a,r){return a(n,t,r,e)}}})),function(e){e[e.View=0]="View",e[e.Reconcile=1]="Reconcile"}(Kr||(Kr={}));var il=J.a.mark((function e(n){var t,a,r,l,o,i,c;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=ll(n),e.prev=1,t.s();case 3:if((a=t.n()).done){e.next=27;break}return r=a.value,e.next=7,r;case 7:l=r.type===u.Credit?u.Debit:u.Credit,o=ll(r.refunds),e.prev=9,o.s();case 11:if((i=o.n()).done){e.next=17;break}return c=i.value,e.next=15,rl(rl(rl({},r),c),{},{type:l,description:c.description||r.description,refunds:r.id});case 15:e.next=11;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(9),o.e(e.t0);case 22:return e.prev=22,o.f(),e.finish(22);case 25:e.next=3;break;case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(1),t.e(e.t1);case 32:return e.prev=32,t.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,null,[[1,29,32,35],[9,19,22,25]])})),ul=(Symbol(),fe()(tl(),Pe)),cl=fe()(nl(),Pe),dl=fe()(el(),Pe),sl=function(e){var n,t,a=e.journalTitle,r=void 0===a?null:a,l=e.deptId,o=void 0===l?null:l,i=e.fiscalYearId,c=void 0===i?null:i,d=e.mode,s=Object(m.useState)(!1),f=U()(s,2),v=f[0],b=f[1],y=Object(m.useCallback)((function(){b(!1)}),[b]),E=Object(m.useState)(!1),h=U()(E,2),g=h[0],O=h[1],j=Object(m.useState)(null),w=U()(j,2),C=w[0],M=w[1],R=Object(m.useCallback)((function(){O(!1)}),[O]),A=Object(m.useCallback)((function(){M(null)}),[M]),k=Object(m.useState)(null),_=U()(k,2),S=_[0],I=_[1],D=Object(m.useCallback)((function(){I(null)}),[I]),T=Object(m.useState)(!1),x=U()(T,2),F=x[0],P=x[1],$=Object(m.useState)(null),q=U()($,2),B=q[0],W=q[1],V=Object(m.useCallback)((function(){P(!1)}),[P]),G=Object(m.useCallback)((function(){W(null)}),[W]),X=Object(m.useState)(!1),pe=U()(X,2),fe=pe[0],ye=pe[1],je=Object(m.useState)(null),we=U()(je,2),Ce=we[0],Me=we[1],Re=Object(m.useCallback)((function(){ye(!1)}),[ye]),Ae=Object(m.useCallback)((function(){Me(null)}),[Me]),ke=Object(m.useState)(null),_e=U()(ke,2),Se=_e[0],Ie=_e[1],De=Object(m.useCallback)((function(){Ie(null)}),[Ie]),Te=Object(K.b)(cl),xe=U()(Te,2),Fe=xe[0],Pe=xe[1].loading,qe=Object(K.b)(dl),Le=U()(qe,2),Be=Le[0],Ue=Le[1].loading,We=Object(m.useMemo)((function(){return o&&c?{where:{department:{eq:{id:o,matchDescendants:!0}},fiscalYear:{eq:c}}}:o?{where:{department:{eq:{id:o,matchDescendants:!0}}}}:c?{where:{fiscalYear:{eq:c}}}:void 0}),[o,c]),Je=Object(K.c)($e,{variables:We,fetchPolicy:"cache-and-network"}),Ve=Je.loading,Ge=Je.error,ze=Je.data,Ye=Je.subscribeToMore,Ke=Ve&&!(null==ze?void 0:ze.journalEntries),Xe=Object(m.useMemo)((function(){var e;return null!==(e=((null==ze?void 0:ze.fiscalYears)||[]).find((function(e){return e.id===c})))&&void 0!==e?e:null}),[c,ze]);Object(m.useEffect)((function(){return Ye({document:ul,updateQuery:function(e,n){var t=n.subscriptionData;if(!t.data)return e;var a=t.data.journalEntryUpserted,r=a.department.ancestors;if(o&&a.department.id!==o&&r.every((function(e){return"Department"===e.__typename&&e.id!==o}))){var l=e.journalEntries.filter((function(e){return e.id!==a.id}));return Object.assign({},e,{journalEntries:l})}if(Xe){var i=new Date(a.date);if(i<new Date(Xe.begin)||i>=new Date(Xe.end)){var u=e.journalEntries.filter((function(e){return e.id!==a.id}));return Object.assign({},e,{journalEntries:u})}}return e.journalEntries.some((function(e){return e.id===a.id}))?e:Object.assign({},e,{journalEntries:[a].concat(L()(e.journalEntries))})}})}),[o,Xe,Ye]);var Qe=(null==ze?void 0:ze.journalEntries)||[],He=Object(m.useMemo)((function(){var e,n={category:new Map,paymentMethod:new Map,source:new Map,department:new Map},t=[],a=ll(il(Qe));try{for(a.s();!(e=a.n()).done;){var r=e.value;r.deleted||d===Kr.Reconcile&&r.reconciled||(n.category.set(r.category.id,r.category),n.department.set(r.department.id,r.department),n.paymentMethod.set(r.paymentMethod.id,r.paymentMethod),n.source.set("".concat(r.source.__typename,"-").concat(r.source.id),r.source),t.push(r))}}catch(e){a.e(e)}finally{a.f()}return[t,{category:L()(n.category.values()),department:L()(n.department.values()),paymentMethod:L()(n.paymentMethod.values()).filter((function(e){var n;return"5dc46d0af74afb2c2805bd54"!==(null===(n=e.parent)||void 0===n?void 0:n.id)})),source:L()(n.source.values())}]}),[Qe,d]),en=U()(He,2),nn=en[0],tn=en[1],an=Object(m.useMemo)((function(){return[{field:"reconciled",title:"Reconciled",render:function(e){return e.reconciled?p.a.createElement(ee.a,null):null},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return p.a.createElement(hr,{setFilter:function(e){var a,r;return t(null!==(r=null===(a=n.tableData)||void 0===a?void 0:a.id)&&void 0!==r?r:"0",e)}})},hidden:d===Kr.Reconcile,filtering:!0},{field:"total",title:"Total",render:function(e){var n=e.total;return Q()($n(n).valueOf()).format("$0,0.00")},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return p.a.createElement(Hr,{setFilter:function(e){var a,r;t(null!==(r=null===(a=n.tableData)||void 0===a?void 0:a.id)&&void 0!==r?r:"1",e)}})}},{field:"date",title:"Date",render:function(e){var n=e.date;return Object(ve.a)(new Date(n),"MMM dd, yyyy")},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return p.a.createElement(Gr,{setFilter:function(e){var a,r;t(null!==(r=null===(a=n.tableData)||void 0===a?void 0:a.id)&&void 0!==r?r:"2",e)}})},defaultSort:"desc"},{field:"category",title:"Category",render:function(e,n){var t="group"===n?e.name:e.category.name;return Object(H.a)(t)},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return p.a.createElement(Cr,{options:tn.category,setFilter:function(e){var a,r;return t(null!==(r=null===(a=n.tableData)||void 0===a?void 0:a.id)&&void 0!==r?r:"3",e)}})}},{field:"source",title:"Source",render:function(e){var n=e.source;switch(n.__typename){case"Person":return"".concat(n.name.first," ").concat(n.name.last);case"Business":return n.bizName;case"Department":return n.deptName}},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return p.a.createElement(xr,{options:tn.source,setFilter:function(e){var a,r;return t(null!==(r=null===(a=n.tableData)||void 0===a?void 0:a.id)&&void 0!==r?r:"4",e)}})}},{field:"paymentMethod",title:"Payment Method",render:function(e){var n,t=e.paymentMethod;return(null===(n=t.parent)||void 0===n?void 0:n.id)===Ne?"CK-".concat(t.name):t.name},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return p.a.createElement(Ar,{options:tn.paymentMethod,setFilter:function(e){var a,r;return t(null!==(r=null===(a=n.tableData)||void 0===a?void 0:a.id)&&void 0!==r?r:"5",e)}})}},{field:"description",title:"Description",render:function(e){return e.description},searchable:!1,filtering:!1,sorting:!1},{field:"department",title:"Department",render:function(e){var n=e.department;return Object(H.a)(n.name)},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return p.a.createElement(Sr,{options:tn.department,setFilter:function(e){var a,r;return t(null!==(r=null===(a=n.tableData)||void 0===a?void 0:a.id)&&void 0!==r?r:"5",e)}})}}]}),[tn.category,tn.department,tn.paymentMethod,tn.source,d]),rn=Object(m.useMemo)((function(){return{toolbar:{searchTooltip:p.a.createElement(le.a,{fontSize:12,component:"span"},'[abc] | [efg] = "abc" OR "efg"',p.a.createElement("br",null),'\'[abc] = EXACTLY "abc"',p.a.createElement("br",null),'![abc] = NOT "abc"',p.a.createElement("br",null),'^[abc] = STARTS WITH "abc"',p.a.createElement("br",null),'!^[abc] = DOES NOT START WITH "abc"',p.a.createElement("br",null),'[abc]$ = ENDS WITH "abc"',p.a.createElement("br",null),'![abc]$ = DOES NOT END WITH "abc"'),nRowsSelected:"Reconcile {0} Entry(s)"}}}),[]),ln=Object(m.useState)(0),on=U()(ln,2),un=on[0],cn=on[1],dn=Object(m.useMemo)((function(){return{rowStyle:function(e){var n={};return n.color=e.type===u.Credit?de.a[900]:se.a[900],n},maxBodyHeight:"calc(100vh - 53px - 64px)",headerStyle:{position:"sticky",top:0},pageSize:25,pageSizeOptions:un?[25,50,100,un]:[25,50,100],showTitle:!!r,selection:d===Kr.Reconcile,showSelectAllCheckbox:!1,debounceInterval:500,emptyRowsWhenPaging:!1,columnsButton:!0,filtering:!0,sorting:!0,thirdSortClick:!1,exportAllData:!0,exportButton:!0,exportFileName:r||"lsccBudgetTracking",exportCsv:function(e,n){var t=ge.unparse(n.reduce((function(n,t){return n.push(e.reduce((function(e,n){var a=n.field,r=n.title,l=n.render;switch(a){case"reconciled":case"date":e[r||a]=t[a];break;default:e[r||a]=l?l(t,"row"):t[a]}return e}),{})),n}),[]));Object(Oe.saveAs)(new Blob([t],{type:"text/plain;charset=utf-8"}),"".concat(r||"budgetTracking",".csv"))}}}),[r,d,un]),sn=Object(m.useMemo)((function(){return d===Kr.Reconcile?[{icon:function(e){return p.a.createElement(ne.a,Object.assign({},e))},tooltip:"Reconcile Selected",position:"toolbarOnSelect",iconProps:{color:"secondary",fontSize:"large"},onClick:(e=N()(J.a.mark((function e(n,t){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all((Array.isArray(t)?t:[t]).map(function(){var e=N()(J.a.mark((function e(n){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.reconciled){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,"JournalEntryRefund"!==n.__typename){e.next=8;break}return e.next=6,Be({variables:{id:n.id}});case 6:e.next=10;break;case 8:return e.next=10,Fe({variables:{id:n.id}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)}))),function(n,t){return e.apply(this,arguments)})}]:[function(e){var n=function(){switch(e.__typename){case"JournalEntry":return{tooltip:"Delete Entry",onClick:function(e,n){return I(n.id)}};case"JournalEntryRefund":return{tooltip:"Delete Refund",onClick:function(e,n){return Ie(n.id)}}}}(),t=n.tooltip,a=n.onClick;return{icon:te.a,tooltip:t,onClick:a}},function(e){var n=function(){switch(e.__typename){case"JournalEntry":return{tooltip:"Edit Entry",onClick:function(e,n){O(!0),M(n.id)}};case"JournalEntryRefund":return{tooltip:"Edit Refund",onClick:function(e,n){ye(!0),Me({entryId:n.refunds,refundId:n.id})}}}}(),t=n.tooltip,a=n.onClick;return{icon:ae.a,tooltip:t,onClick:a}},function(e){if("JournalEntry"!==e.__typename)return null;var n=e.type===u.Credit;return{icon:function(e){return n?p.a.createElement(me.d,Object.assign({},e)):p.a.createElement(me.c,Object.assign({},e))},tooltip:n?"Give Refund":"Add Refund",iconProps:{style:{color:n?se.a[900]:de.a[900]}},onClick:function(e,n){P(!0),W(n.id)}}},{icon:function(e){return p.a.createElement(re.a,Object.assign({},e))},iconProps:{color:"secondary",fontSize:"large"},tooltip:"Add Entry",isFreeAction:!0,onClick:function(){b(!0)}}];var e}),[d,Be,Fe,Ie,I]),mn=Object(m.useMemo)((function(){return new Map}),[]),pn=Object(m.useMemo)((function(){return{Body:Ge?function(e){return p.a.createElement(oe.a,Object.assign({},e),p.a.createElement(ie.a,null,p.a.createElement(ue.a,{colSpan:an.length+(Array.isArray(sn)&&sn.length>0?1:0),align:"left"},p.a.createElement(ce.a,{align:"center",color:"error",variant:"h4"},"Error Loading Entries"),p.a.createElement(ce.a,{variant:"body1"},Ge.message))))}:function(e){return p.a.createElement(z.MTableBody,Object.assign({},e))},Row:function(e){var n=rl(rl({},e),{},{onToggleDetailPanel:function(n,t){mn.has(e.data.id)?mn.delete(e.data.id):mn.set(e.data.id,t);for(var a=arguments.length,r=new Array(a>2?a-2:0),l=2;l<a;l++)r[l-2]=arguments[l];return e.onToggleDetailPanel.apply(e,[n,t].concat(r))}});return p.a.createElement(z.MTableBodyRow,Object.assign({},n))}}}),[Ge,an.length,sn,mn]),fn=Object(m.useMemo)((function(){return[function(e){var n="JournalEntry"===e.__typename,t=!!n&&e.items.length>0;return{icon:function(e){return n?t?p.a.createElement(me.f,Object.assign({},e)):p.a.createElement(me.g,Object.assign({},e)):null},openIcon:function(e){return t?p.a.createElement(me.f,Object.assign({},e,{color:"primary"})):p.a.createElement(me.g,Object.assign({},e,{color:"primary"}))},disabled:!n,tooltip:n?"Itemize":void 0,render:function(e){return"JournalEntry"!==e.__typename?null:p.a.createElement(br,{entry:e})}}}]}),[]),vn=Object(m.useState)(new Ee.a(0)),bn=U()(vn,2),yn=bn[0],En=bn[1],hn=Object(m.useMemo)((function(){var e=(null==Xe?void 0:Xe.name)?"".concat(null==Xe?void 0:Xe.name," "):"",n=yn.compare(new Ee.a(0)),t=p.a.createElement(le.a,{color:0===n?void 0:n>0?de.a[900]:se.a[900],component:"span"},Q()(yn.valueOf()).format("$0,0.00"));return r?p.a.createElement(ce.a,{variant:"h6"},"".concat(e).concat(r,": "),t):p.a.createElement(ce.a,{variant:"h6"},e,t)}),[Xe,yn,r]),gn=Object(m.useRef)(null),On=Object(m.useCallback)(function(){var e=N()(J.a.mark((function e(n){var t,a,r,l,i,c,d,s,m,p,f,v,b,y,E,h,g,O,j,w,C,M,R;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.filters,r=n.page,l=n.pageSize,i=n.orderBy,c=n.orderDirection,d=null===(t=n.search)||void 0===t?void 0:t.trim(),s=d?new Z.a(nn,{keys:["date","total","description","department","category","paymentMethod","source"],threshold:.4,useExtendedSearch:!0,getFn:function(e,n){var t;switch(n){case"date":var a=new Date(e.date);return[e.date,Object(ve.a)(a,"M/d/yy"),Object(ve.a)(a,"MM/d/yy"),Object(ve.a)(a,"M/d/yyyy"),Object(ve.a)(a,"MM/d/yyyy"),Object(ve.a)(a,"MMM dd, yyyy")];case"total":var r=$n(e.total).valueOf();return[Q()(r).format("$0,0.00"),r.toFixed(2)];case"description":return(null===(t=e.description)||void 0===t?void 0:t.trim())||"";case"department":return e.department.name;case"category":return e.category.name;case"paymentMethod":return e.paymentMethod.name;case"source":switch(e.source.__typename){case"Person":return[e.source.name.first,e.source.name.last];case"Business":return e.source.bizName;case"Department":return e.source.deptName}break;default:return""}}}).search(d).map((function(e){return e.item})):nn,m=[],p={$and:[]},a.length>0){f=p.$and,v=ll(a);try{for(v.s();!(b=v.n()).done;)y=b.value,Object.keys(y.value).length>0&&f.push(y.value)}catch(e){v.e(e)}finally{v.f()}}if(p.$and.length>0&&m.push({$addFields:{_dateStr_:"$date",date:{$expressionCb:function(e){return Object(be.a)(new Date(e.date))}},_totalRational_:"$total",total:{$expressionCb:function(e){return $n(e.total).valueOf()}}}},{$match:p},{$addFields:{date:"$_dateStr_",total:"$_totalRational_"}},{$project:{_dateStr_:!1,_totalRational_:!1}}),E={data:[],raw:[]},!i){e.next=29;break}h=i.field,e.t0=h,e.next="date"===e.t0?13:"total"===e.t0?15:"reconciled"===e.t0?17:"department"===e.t0?19:"category"===e.t0?21:"paymentMethod"===e.t0?23:"source"===e.t0?25:27;break;case 13:return E.data.push({$addFields:{_sortBy_:{$toDate:"$date"}}}),e.abrupt("break",28);case 15:return E.data.push({$addFields:{_sortBy_:{$expressionCb:function(e){return $n(e.total).valueOf()}}}}),e.abrupt("break",28);case 17:return E.data.push({$addFields:{_sortBy_:"$reconciled"}}),e.abrupt("break",28);case 19:return E.data.push({$addFields:{_sortBy_:"$department.name"}}),e.abrupt("break",28);case 21:return E.data.push({$addFields:{_sortBy_:"$category.name"}}),e.abrupt("break",28);case 23:return E.data.push({$addFields:{_sortBy_:"$paymentMethod.name"}}),e.abrupt("break",28);case 25:return E.data.push({$addFields:{_sortBy_:{$cond:{if:{$eq:[{$ifNull:["$source.name.first",null]},null]},then:"$source.name",else:{$concat:["$source.name.first"," ","$source.name.last"]}}}}}),e.abrupt("break",28);case 27:E.data.push({$addFields:{_sortBy_:{$toDate:"$date"}}});case 28:E.data.push({$sort:{_sortBy_:"asc"===c?1:-1}},{$project:{_sortBy_:!1}});case 29:return E.data.push({$skip:r*l},{$limit:l}),m.push({$facet:E}),g=new he.a(m).run(s),O=U()(g,1),j=O[0],w=j.data.map((function(e){return mn.has(e.id)?rl(rl({},e),{},{tableData:{showDetailPanel:mn.get(e.id)}}):e})),C=j.raw,function(){var e=new Map(mn);mn.clear();var n,t=ll(C);try{for(t.s();!(n=t.n()).done;){var a=n.value.id;e.has(a)&&mn.set(a,e.get(a))}}catch(e){t.e(e)}finally{t.f()}}(),M=C.length,R=function(){var e,n=new Ee.a(0),t=ll(C);try{for(t.s();!(e=t.n()).done;){var a=e.value;if(!a.deleted){var r=$n(a.total);if(o){var l,i=ll(a.items);try{for(i.s();!(l=i.n()).done;){var c=l.value;c.deleted||!c.department||c.department.id===o||c.department.ancestors.some((function(e){return"Department"===e.__typename&&e.id===o}))||(r=r.sub($n(c.total)))}}catch(e){i.e(e)}finally{i.f()}}n=a.type===u.Credit?n.add(r):n.sub(r)}}}catch(e){t.e(e)}finally{t.f()}return n}(),0!==yn.compare(R)&&En(R),cn(M),e.abrupt("return",{data:w,page:r,totalCount:M});case 40:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[yn,o,nn,mn,cn]);return Object(m.useEffect)((function(){gn.current&&gn.current.onQueryChange(null)}),[gn,nn]),p.a.createElement(p.a.Fragment,null,p.a.createElement(Y.a,{icons:Ze,isLoading:Ke||Pe||Ue,columns:an,data:On,options:dn,localization:rn,actions:sn,components:pn,title:hn,detailPanel:fn,tableRef:gn}),p.a.createElement(Aa,{deptId:o,open:v,onClose:y}),p.a.createElement(Na,{entryId:C,open:g,onClose:R,onExited:A}),p.a.createElement(Ba,{entryId:S,onClose:D}),p.a.createElement(Mt,{entryId:B,open:F,onClose:V,onExited:G}),p.a.createElement(Tt,{entryId:null!==(n=null==Ce?void 0:Ce.entryId)&&void 0!==n?n:null,refundId:null!==(t=null==Ce?void 0:Ce.refundId)&&void 0!==t?t:null,open:fe,onClose:Re,onExited:Ae}),p.a.createElement(Ja,{refundId:Se,onClose:De}))},ml=t(5808),pl=t(414),fl=t.n(pl),vl=t(416),bl=t.n(vl),yl=t(418),El=t.n(yl),hl=t(417),gl=t.n(hl),Ol=t(5805),jl=t(5807),wl=t(5806),Cl=t(164),Ml=t(160),Rl=t(294);function Al(){var e=F()(["\n  subscription JournalEntryUpdated_2 {\n    journalEntryUpdated {\n      ...GetReportDataEntry_1Fragment\n    }\n  }\n  ","\n"]);return Al=function(){return e},e}function kl(){var e=F()(["\n  subscription JournalEntryAdded_2 {\n    journalEntryAdded {\n      ...GetReportDataEntry_1Fragment\n    }\n  }\n  ","\n"]);return kl=function(){return e},e}function _l(){var e=F()(["\n  query GetReportData($deptId:ID!, $where:JournalEntiresWhereInput!) {\n    department(id:$deptId) {\n      ...GetReportDataDept_1Fragment\n      descendants {\n        ...GetReportDataDept_1Fragment\n      }\n    }\n    journalEntries(where:$where) {\n      ...GetReportDataEntry_1Fragment\n    }\n    fiscalYears {\n      __typename\n      id\n      name\n      begin\n      end\n    }\n  }\n  ",",\n  ","\n"]);return _l=function(){return e},e}function Sl(){var e=F()(["\n  fragment GetReportDataEntry_1Fragment on JournalEntry {\n    id\n    __typename\n    category {\n      __typename\n      id\n      name\n    }\n    type\n    total {\n      n\n      d\n      s\n    }\n    fiscalYear {\n      __typename\n      id\n    }\n    department {\n      __typename\n      id\n      ancestors {\n        __typename\n        ... on Business {\n          id\n        }\n        ... on Department {\n          id\n        }\n      }\n    }\n    refunds {\n      __typename\n      id\n      total {\n        n\n        d\n        s\n      }\n      deleted\n      lastUpdate\n    }\n    items {\n      __typename\n      id\n      total {\n        n\n        d\n        s\n      }\n      department {\n        __typename\n        id\n      }\n      deleted\n    }\n    lastUpdate\n    deleted\n  }\n"]);return Sl=function(){return e},e}function Il(){var e=F()(["\n  fragment GetReportDataDept_1Fragment on Department {\n    __typename\n    id\n    name\n    budgets {\n      id\n      __typename\n      amount {\n        n\n        d\n        s\n      }\n      fiscalYear {\n        __typename\n        id\n      }\n    }\n  }\n"]);return Il=function(){return e},e}var Dl=fe()(Il()),Tl=fe()(Sl()),xl=fe()(_l(),Dl,Tl);fe()(kl(),Tl),fe()(Al(),Tl);function Fl(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return Pl(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Pl(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Pl(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function $l(){var e=F()(["\n  subscription OnEntryUpsert_2 {\n    journalEntryUpserted {\n      ...GetReportDataEntry_1Fragment\n      department {\n        ancestors {\n          ... on Department {\n            __typename\n            id\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return $l=function(){return e},e}function Nl(){var e=F()(["\n  query DeptForUpsertAdd($id: ID!) {\n    department(id: $id) {\n      ...DeptEntryOptFragment\n    }\n  }\n  ","\n"]);return Nl=function(){return e},e}var ql=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:800;return e<.75?de.a[n]:e<.9?Cl.a[n]:se.a[n]},Ll=function(e){var n=e.spentPercentage,t=e.height;return p.a.createElement(le.a,{height:t,bgcolor:ql(n),display:"flex",justifyContent:"flex-start"},p.a.createElement(le.a,{height:"100%",width:"".concat(100*n,"%"),bgcolor:Ml.a[400]}))},Bl=(fe()(Nl(),et),fe()($l(),Tl)),Ul=function(e){var n,t=e.deptId,a=Object(m.useState)(!1),r=U()(a,2),l=r[0],o=r[1],i=Object(m.useCallback)((function(){o(!1)}),[o]),c=Object(m.useMemo)((function(){return{deptId:t,where:{department:{eq:{id:t,matchDescendants:!0}},deleted:!1}}}),[t]),d=Object(K.c)(xl,{variables:c,fetchPolicy:"cache-and-network"}),s=d.loading,f=d.error,v=d.data,b=d.subscribeToMore,y=s&&!(null==v?void 0:v.journalEntries);Object(m.useEffect)((function(){return b({document:Bl,updateQuery:function(e,n){var a=n.subscriptionData;if(!a.data)return e;var r=a.data.journalEntryUpserted,l=r.department.ancestors;if(t&&r.department.id!==t&&l.every((function(e){return"Department"===e.__typename&&e.id!==t}))){var o=e.journalEntries.filter((function(e){return e.id!==r.id}));return o.length===e.journalEntries.length?e:Object.assign({},e,{journalEntries:o})}return e.journalEntries.some((function(e){return e.id===r.id}))?e:Object.assign({},e,{journalEntries:[r].concat(L()(e.journalEntries))})}})}),[t,b]);var h=Object(m.useState)(new Date((new Date).toDateString())),g=U()(h,2),O=g[0],j=g[1],w=Object(m.useMemo)((function(){var e,n=Fl((null==v?void 0:v.fiscalYears)||[]);try{for(n.s();!(e=n.n()).done;){var t=e.value;if(O>=new Date(t.begin)&&O<new Date(t.end))return t}}catch(e){n.e(e)}finally{n.f()}return null}),[O,v]),C=Object(m.useMemo)((function(){return((null==v?void 0:v.journalEntries)||[]).filter((function(e){return!e.deleted&&(null==w?void 0:w.id)===e.fiscalYear.id}))}),[v,w]),M=(null===(n=null==v?void 0:v.department)||void 0===n?void 0:n.name)||"";Object(m.useEffect)((function(){document.title=M}),[M]);var R=(null==v?void 0:v.department)||null,A=Object(m.useMemo)((function(){var e,n=new Map,t=new Ee.a(0),a=new Ee.a(0),r=[];R&&function(){var a=new Set;r.push.apply(r,[R].concat(L()(R.descendants)));var l,o=Fl(r);try{for(o.s();!(l=o.n()).done;){var i=l.value,u=null!==(e=i.budgets.find((function(e){return e.fiscalYear.id===(null==w?void 0:w.id)&&!a.has(e.id)})))&&void 0!==e?e:null,c=null;if(u){var d=u.amount;a.add(u.id),c=$n(d),t=t.add(c)}n.set(i.id,{name:i.name,spent:new Ee.a(0),budget:c})}}catch(e){o.e(e)}finally{o.f()}}();var l,o=Fl(C);try{for(o.s();!(l=o.n()).done;){var i=l.value;if(!i.deleted){var c,d=n.get(i.department.id),s=$n(i.total),m=Fl(i.refunds);try{for(m.s();!(c=m.n()).done;){var p=c.value;p.deleted||(s=s.sub($n(p.total)))}}catch(e){m.e(e)}finally{m.f()}if(R){var f,v=Fl(i.items);try{var b=function(){var e=f.value;if(e.deleted||!e.department||r.some((function(n){var t;return n.id===(null===(t=e.department)||void 0===t?void 0:t.id)})))return"continue";s=s.sub($n(e.total))};for(v.s();!(f=v.n()).done;)b()}catch(e){v.e(e)}finally{v.f()}}i.type===u.Credit?(a=a.sub(s),d.spent=d.spent.sub(s)):(a=a.add(s),d.spent=d.spent.add(s))}}}catch(e){o.e(e)}finally{o.f()}return{totalRemaining:Q()(t.sub(a).valueOf()).format("$0,0.00"),budget:Q()(t.valueOf()).format("$0,0.00"),spentToBudgetRatio:0===t.n?1:a.div(t).valueOf(),deptReports:n,uBudget:t}}),[C,R]),k=A.totalRemaining,_=A.budget,S=A.spentToBudgetRatio,I=A.deptReports,D=A.uBudget,T=Object(m.useMemo)((function(){var e,n=[],t=Fl(I);try{var a=function(){var t=U()(e.value,2),a=t[0],r=t[1],l=r.budget,o=r.spent,i=r.name;if(a===(null==R?void 0:R.id)&&(!l||l.equals(D)))return"continue";var u=p.a.createElement(on.a,{key:a,item:!0,xs:12,md:4,lg:3},p.a.createElement(Ol.a,null,p.a.createElement(jl.a,{titleTypographyProps:{noWrap:!0},title:i}),p.a.createElement(wl.a,null,function(){if(null===l||0===l.n)return p.a.createElement(le.a,{color:o.compare(new Ee.a(0))>0?se.a[900]:de.a[900],clone:!0},p.a.createElement(ce.a,{variant:"h6"},"Spent: ".concat(Q()(o.abs().valueOf()).format("$0,0.00"))));var e=l.sub(o),n=o.div(l).valueOf();return p.a.createElement(p.a.Fragment,null,p.a.createElement(le.a,{color:ql(n,900),clone:!0},p.a.createElement(ce.a,{variant:"h6"},"".concat(Q()(e.valueOf()).format("$0,0.00")," Remaining"))),p.a.createElement(ce.a,{variant:"body1"},"of ".concat(Q()(l.valueOf()).format("$0,0.00"))),p.a.createElement(Ll,{spentPercentage:n,height:5}))}())));n.push(u)};for(t.s();!(e=t.n()).done;)a()}catch(e){t.e(e)}finally{t.f()}return n}),[I,R,D]),x=Object(m.useCallback)((function(){return o(!0)}),[o]),F=Object(m.useMemo)((function(){return p.a.createElement(le.a,{minWidth:120,clone:!0},p.a.createElement(ba.a,{variant:"outlined"},p.a.createElement(Rl.a,null,"Fiscal Year"),p.a.createElement(yr.a,{label:"Fiscal Year<",variant:"outlined",value:(null==w?void 0:w.id)||"",onChange:function(e){var n=e.target.value;if(n){var t,a=Fl((null==v?void 0:v.fiscalYears)||[]);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(r.id===n)return void j(new Date(r.begin))}}catch(e){a.e(e)}finally{a.f()}}}},((null==v?void 0:v.fiscalYears)||[]).sort((function(e,n){return new Date(e.begin).getTime()-new Date(n.begin).getTime()})).map((function(e){return p.a.createElement(Er.a,{key:e.id,value:e.id},e.name)})))))}),[v,j,w]);return y?p.a.createElement("p",null,"Loading..."):f?(console.error(f),p.a.createElement("p",null,f.message)):p.a.createElement(le.a,{display:"flex",flexDirection:"column",overflow:"hidden",clone:!0},p.a.createElement(ml.a,null,p.a.createElement(le.a,{padding:8},p.a.createElement(on.a,{container:!0,alignItems:"center",justify:"center",spacing:4},p.a.createElement(on.a,{item:!0},p.a.createElement(cn.a,{variant:"contained",color:"secondary",startIcon:p.a.createElement(fl.a,null),onClick:x},"New Entry")),p.a.createElement(on.a,{item:!0},p.a.createElement(cn.a,{disabled:!w,component:E.b,to:"/journal/".concat(t,"/").concat((null==w?void 0:w.id)||"","/reconcile"),variant:"contained",startIcon:p.a.createElement(bl.a,null)},"Reconcile")),p.a.createElement(on.a,{item:!0},p.a.createElement(cn.a,{variant:"contained",startIcon:p.a.createElement(gl.a,null)},"Reports")),p.a.createElement(on.a,{item:!0},p.a.createElement(cn.a,{disabled:!w,component:E.b,to:"/journal/".concat(t,"/").concat((null==w?void 0:w.id)||""),variant:"contained",startIcon:p.a.createElement(El.a,null)},"Journal")),p.a.createElement(on.a,{item:!0},F))),p.a.createElement(le.a,{flexGrow:1,overflow:"auto"},p.a.createElement(on.a,{justify:"center",container:!0,spacing:2},p.a.createElement(on.a,{item:!0,xs:12},p.a.createElement(ce.a,{align:"center",variant:"h3"},M),p.a.createElement(le.a,{color:ql(S.valueOf())},p.a.createElement(ce.a,{align:"center",variant:"h4"},"".concat(k," Remaining"))),p.a.createElement(ce.a,{align:"center",variant:"subtitle1"},"of ".concat(_)),p.a.createElement(Ll,{spentPercentage:S.valueOf(),height:10})),T)),p.a.createElement(Aa,{deptId:t,open:l,onClose:i})))};function Wl(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return Jl(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Jl(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Jl(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function Vl(){var e=F()(["\n  query DeptsForNav_1 {\n    departments {\n      __typename\n      id\n      name\n      parent {\n        __typename\n        ... on Business {\n          id\n        }\n        ... on Department {\n          id\n        }\n      }\n      virtualRoot\n    }\n  }\n"]);return Vl=function(){return e},e}var Gl=fe()(Vl()),zl=function(e){var n=Object(K.c)(Gl),t=n.loading,a=n.error,r=n.data,l=Object(m.useState)(""),o=U()(l,2),i=o[0],u=o[1],c=(null==r?void 0:r.departments)||[],d=Object(m.useMemo)((function(){var e,n=[],t=new Set,a=Wl(c);try{for(a.s();!(e=a.n()).done;){var r=e.value;"Business"===r.parent.__typename&&n.push(r),r.virtualRoot&&t.add(r.id)}}catch(e){a.e(e)}finally{a.f()}return{rootDepts:n,virtualRoots:t}}),[c]),s=d.rootDepts,f=d.virtualRoots,v=Object(m.useMemo)((function(){var e=[];if(i&&f.has(i)){var n,t=Wl(c);try{for(t.s();!(n=t.n()).done;){var a=n.value;a.parent.id===i&&e.push(a)}}catch(e){t.e(e)}finally{t.f()}}return e}),[f,i,c]);Object(m.useEffect)((function(){document.title="Select Department"}));var b=Object(m.useCallback)((function(e){var n;u((null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.value)||"")}),[u]);if(t)return p.a.createElement("p",null,"Loading...");if(a)return p.a.createElement("p",null,a.message);var y=v.length>0;return p.a.createElement(le.a,{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",clone:!0},p.a.createElement(ml.a,null,p.a.createElement(le.a,{padding:4,clone:!0},p.a.createElement(ce.a,{align:"center",color:"primary",variant:"h3"},"Select Department")),p.a.createElement(le.a,{minWidth:"250px !important",clone:!0},p.a.createElement(ba.a,{variant:"filled"},p.a.createElement(Rl.a,null,"Department"),p.a.createElement(yr.a,{value:i,onChange:b,autoWidth:!0},s.map((function(e){var n={component:E.b,to:"/department/".concat(e.id),value:e.id,children:e.name};return e.virtualRoot&&(delete n.component,delete n.to),p.a.createElement(Er.a,Object.assign({key:e.id},n))}))))),y&&p.a.createElement(le.a,{pt:2},p.a.createElement(le.a,{pt:2,minWidth:"250px !important",clone:!0},p.a.createElement(ba.a,{variant:"filled"},p.a.createElement(Rl.a,null,"Sub Department"),p.a.createElement(yr.a,{autoWidth:!0},v.map((function(e){var n={component:E.b,to:"/department/".concat(e.id),value:e.id,children:e.name};return p.a.createElement(Er.a,Object.assign({key:e.id},n))}))))))))};function Yl(){var e=F()(["\n  query DepartmentName_1($id: ID!) {\n    department(id: $id) {\n      id\n      __typename\n      name\n    }\n  }\n"]);return Yl=function(){return e},e}var Kl=function(){var e=Object(P.f)().id;return e?p.a.createElement(Ul,{deptId:e}):p.a.createElement("div",null,"Error: No Dept ID!")},Xl=fe()(Yl()),Ql=function(){var e,n=Object(P.f)(),t=n.id,a=n.year,r=Object(K.c)(Xl,{variables:{id:t}}).data,l=(null===(e=null==r?void 0:r.department)||void 0===e?void 0:e.name)?r.department.name:void 0;return p.a.createElement(sl,{mode:Kr.View,deptId:t,fiscalYearId:a,journalTitle:l})},Hl=function(){var e,n=Object(P.f)(),t=n.id,a=n.year,r=Object(K.c)(Xl,{variables:{id:t}}).data,l=(null===(e=null==r?void 0:r.department)||void 0===e?void 0:e.name)?"Reconcile ".concat(r.department.name):"Reconcile";return p.a.createElement(sl,{mode:Kr.Reconcile,deptId:t,fiscalYearId:a,journalTitle:l})},Zl=function(){return p.a.createElement(P.c,null,p.a.createElement(P.a,{exact:!0,path:"/",component:zl}),p.a.createElement(P.a,{exact:!0,path:"/department/:id",component:Kl}),p.a.createElement(P.a,{exact:!0,path:"/journal",component:sl}),p.a.createElement(P.a,{exact:!0,path:"/journal/:id/:year",component:Ql}),p.a.createElement(P.a,{exact:!0,path:"/journal/:id/:year/reconcile",component:Hl}))},eo=function(){return p.a.createElement(m.Fragment,null,p.a.createElement(y.a,null),p.a.createElement(b.a,{client:T},p.a.createElement(E.a,null,p.a.createElement(Zl,null))))};v.a.render(p.a.createElement(eo,null),document.getElementById("root"))}},[[5771,1,2]]]);
//# sourceMappingURL=main.3cb00ef78ba7c7fdd108.js.map