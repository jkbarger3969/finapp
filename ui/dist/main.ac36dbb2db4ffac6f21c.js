(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{397:function(e){e.exports=JSON.parse('{"__schema":{"types":[{"kind":"UNION","name":"BudgetOwner","possibleTypes":[{"name":"Department"},{"name":"Business"}]},{"kind":"UNION","name":"DepartmentAncestor","possibleTypes":[{"name":"Department"},{"name":"Business"}]},{"kind":"UNION","name":"PaymentMethodAuthorizedEntity","possibleTypes":[{"name":"Person"},{"name":"Business"},{"name":"Department"}]},{"kind":"UNION","name":"JournalEntrySource","possibleTypes":[{"name":"Person"},{"name":"Business"},{"name":"Department"}]}]}}')},5769:function(e,n,t){"use strict";t.r(n);var a,r,l,o,i,u,c,d,s,m=t(0),p=t.n(m),f=t(33),v=t.n(f),b=t(75),y=t(5807),E=t(119),h=t(133),g=t(303),O=t(397),j=new g.b({introspectionQueryResultData:O}),w=new g.a({fragmentMatcher:j,addTypename:!0}),C={},M=t(418),R=t(399),A=t(62),k=t(401),_=t(156),S=new M.a({uri:"/graphql",credentials:"same-origin"}),I=new R.a({uri:"ws://".concat(window.location.host,"/graphql"),options:{reconnect:!0}}),D=A.a.from([Object(k.a)((function(e){var n=e.graphQLErrors,t=e.networkError;n&&n.forEach((function(e){var n=e.message,t=e.locations,a=e.path;return console.error("[GraphQL error]: Message: ".concat(n,", Location: ").concat(t,", Path: ").concat(a))})),t&&console.log("[Network error]: ".concat(t))})),A.a.split((function(e){var n=e.query,t=Object(_.a)(n);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),I,S)]),T=new h.a({link:D,cache:w,resolvers:C}),x=t(17),F=t.n(x),P=t(132),$=t(40),N=t.n($),q=t(53),L=t.n(q),B=t(10),U=t.n(B),W=t(20),J=t.n(W),V=t(42),G=t.n(V),z=t(171),Y=t.n(z),K=t(25),X=t(63),Q=t.n(X),H=t(5842),Z=t(409),ee=t(5838),ne=t(5839),te=t(5834),ae=t(5817),re=t(5835),le=t(289),oe=t(362),ie=t(363),ue=t(359),ce=t(64),de=t(165),se=t(162),me=t(41),pe=t(18),fe=t.n(pe),ve=t(417),be=t(172),ye=t(23),Ee=t.n(ye),he=(t(5768),t(169));function ge(){var e=F()(["\n  subscription JournalEntryUpdated_1 {\n    journalEntryUpdated {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return ge=function(){return e},e}function Oe(){var e=F()(["\n  subscription JournalEntryAdded_1 {\n    journalEntryAdded {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return Oe=function(){return e},e}function je(){var e=F()(['\n  query JournalEntries_1($where: JournalEntiresWhereInput!) {\n    journalEntries(where: $where)\n      @connection(key: "JournalEntries_1", filter: ["where"]) {\n      ...JournalEntry_1Fragment\n    }\n    fiscalYears {\n      __typename\n      id\n      name\n      begin\n      end\n    }\n  }\n  ',"\n"]);return je=function(){return e},e}function we(){var e=F()(["\n  fragment JournalEntry_1Fragment on JournalEntry {\n    __typename\n    id\n    date\n    department {\n      __typename\n      id\n      name\n      ancestors {\n        __typename\n        ... on Business {\n          id\n          bizName: name\n        }\n        ... on Department {\n          id\n          deptName: name\n        }\n      }\n    }\n    type\n    category {\n      ...JournalEntryCategory_1Fragment\n    }\n    department {\n      ...JournalEntryDept_1Fragment\n    }\n    description\n    paymentMethod {\n      ...JournalEntryPayMethod_1Fragment\n    }\n    source {\n      __typename\n      ... on Person {\n        id\n        name {\n          first\n          last\n        }\n      }\n      ... on Business {\n        id\n        bizName: name\n      }\n      ... on Department {\n        id\n        deptName: name\n      }\n    }\n    total {\n      n\n      d\n      s\n    }\n    refunds {\n      ...JournalEntryRefund_1Fragment\n    }\n    items {\n      ...JournalEntryItem_1Fragment\n    }\n    deleted\n    lastUpdate\n    reconciled\n  }\n  ","\n  ","\n  ","\n  ","\n  ","\n"]);return we=function(){return e},e}function Ce(){var e=F()(["\n  fragment JournalEntryItem_1Fragment on JournalEntryItem {\n    __typename\n    id\n    category {\n      ...JournalEntryCategory_1Fragment\n    }\n    department {\n      ...JournalEntryDept_1Fragment\n    }\n    total {\n      n\n      d\n      s\n    }\n    units\n    description\n    lastUpdate\n    deleted\n  }\n  ","\n  ","\n"]);return Ce=function(){return e},e}function Me(){var e=F()(["\n  fragment JournalEntryRefund_1Fragment on JournalEntryRefund {\n    __typename\n    id\n    date\n    description\n    total {\n      n\n      d\n      s\n    }\n    paymentMethod {\n      ...JournalEntryPayMethod_1Fragment\n    }\n    reconciled\n    lastUpdate\n    deleted\n  }\n  ","\n"]);return Me=function(){return e},e}function Re(){var e=F()(["\n  fragment JournalEntryDept_1Fragment on Department {\n    __typename\n    id\n    name\n    ancestors {\n      __typename\n      ... on Business {\n        id\n        bizName: name\n      }\n      ... on Department {\n        id\n        deptName: name\n      }\n    }\n  }\n"]);return Re=function(){return e},e}function Ae(){var e=F()(["\n  fragment JournalEntryCategory_1Fragment on JournalEntryCategory {\n    __typename\n    id\n    type\n    name\n  }\n"]);return Ae=function(){return e},e}function ke(){var e=F()(["\n  fragment JournalEntryPayMethod_1Fragment on PaymentMethod {\n    __typename\n    id\n    name\n    parent {\n      __typename\n      id\n    }\n  }\n"]);return ke=function(){return e},e}!function(e){e.Business="BUSINESS",e.Department="DEPARTMENT"}(a||(a={})),function(e){e.Public="PUBLIC",e.Private="PRIVATE"}(r||(r={})),function(e){e.Business="BUSINESS",e.Department="DEPARTMENT"}(l||(l={})),function(e){e.Include="INCLUDE",e.Exclude="EXCLUDE"}(o||(o={})),function(e){e.Business="BUSINESS",e.Department="DEPARTMENT",e.Person="PERSON"}(i||(i={})),function(e){e.Credit="CREDIT",e.Debit="DEBIT"}(u||(u={})),function(e){e.Pos="POS",e.Neg="NEG"}(c||(c={})),function(e){e.CaseInsensitive="CaseInsensitive",e.Multiline="Multiline",e.Extended="Extended",e.DotAll="DotAll",e.I="I",e.M="M",e.X="X",e.S="S"}(d||(d={})),function(e){e.Asc="ASC",e.Desc="DESC"}(s||(s={}));var _e=fe()(ke()),Se=fe()(Ae()),Ie=fe()(Re()),De=fe()(Me(),_e),Te=fe()(Ce(),Se,Ie),xe=fe()(we(),_e,Ie,Se,De,Te),Fe=fe()(je(),xe),Pe=(fe()(Oe(),xe),fe()(ge(),xe),"5dc46d0af74afb2c2805bd54"),$e=t(5812),Ne=t(5813),qe=t(5814),Le=t(5815),Be=t(5816),Ue=t(5818),We=t(5819),Je=t(5820),Ve=t(5821),Ge=t(5822),ze=t(5823),Ye=t(5824),Ke=t(5825),Xe=t(5826),Qe={Add:Object(m.forwardRef)((function(e,n){return p.a.createElement($e.a,Object.assign({},e,{ref:n}))})),Check:Object(m.forwardRef)((function(e,n){return p.a.createElement(Ne.a,Object.assign({},e,{ref:n}))})),Clear:Object(m.forwardRef)((function(e,n){return p.a.createElement(qe.a,Object.assign({},e,{ref:n}))})),Delete:Object(m.forwardRef)((function(e,n){return p.a.createElement(Le.a,Object.assign({},e,{ref:n}))})),DetailPanel:Object(m.forwardRef)((function(e,n){return p.a.createElement(Be.a,Object.assign({},e,{ref:n}))})),Edit:Object(m.forwardRef)((function(e,n){return p.a.createElement(ae.a,Object.assign({},e,{ref:n}))})),Export:Object(m.forwardRef)((function(e,n){return p.a.createElement(Ue.a,Object.assign({},e,{ref:n}))})),Filter:Object(m.forwardRef)((function(e,n){return p.a.createElement(We.a,Object.assign({},e,{ref:n}))})),FirstPage:Object(m.forwardRef)((function(e,n){return p.a.createElement(Je.a,Object.assign({},e,{ref:n}))})),LastPage:Object(m.forwardRef)((function(e,n){return p.a.createElement(Ve.a,Object.assign({},e,{ref:n}))})),NextPage:Object(m.forwardRef)((function(e,n){return p.a.createElement(Be.a,Object.assign({},e,{ref:n}))})),PreviousPage:Object(m.forwardRef)((function(e,n){return p.a.createElement(Ge.a,Object.assign({},e,{ref:n}))})),ResetSearch:Object(m.forwardRef)((function(e,n){return p.a.createElement(qe.a,Object.assign({},e,{ref:n}))})),Search:Object(m.forwardRef)((function(e,n){return p.a.createElement(ze.a,Object.assign({},e,{ref:n}))})),SortArrow:Object(m.forwardRef)((function(e,n){return p.a.createElement(Ye.a,Object.assign({},e,{ref:n}))})),ThirdStateCheck:Object(m.forwardRef)((function(e,n){return p.a.createElement(Ke.a,Object.assign({},e,{ref:n}))})),ViewColumn:Object(m.forwardRef)((function(e,n){return p.a.createElement(Xe.a,Object.assign({},e,{ref:n}))}))},He=t(27),Ze=t(34),en=t(5783),nn=t(5809),tn=t(5808),an=t(5785),rn=t(5800),ln=t(5786),on=t(148),un=t(5830),cn=t(5831);function dn(){var e=F()(["\n  mutation AddEntryRefund(\n    $id: ID!\n    $fields: JournalEntryAddRefundFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n  ) {\n    journalEntryAddRefund(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n    ) {\n      id\n      __typename\n      refunds {\n        ...JournalEntryRefund_1Fragment\n      }\n    }\n  }\n  ","\n"]);return dn=function(){return e},e}var sn,mn=fe()(dn(),De),pn=function(){var e=N()(J.a.mark((function e(n,t,a){var r,l,o,i,u,c;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=void 0,d=a.paymentMethod.value[a.paymentMethod.value.length-1],o="string"==typeof d?{paymentMethod:"",paymentMethodAdd:{parent:a.paymentMethod.value[a.paymentMethod.value.length-2].id,refId:d,name:d,active:!1}}:{paymentMethod:d.id,paymentMethodAdd:null},i=o.paymentMethod,u=o.paymentMethodAdd,c={id:t,fields:{date:a.date.value,description:(null===(r=a.description)||void 0===r?void 0:r.trim())?a.description.trim():null,paymentMethod:i,total:a.total.value,reconciled:null!==(l=a.reconciled)&&void 0!==l?l:null},paymentMethodAdd:u},e.next=4,n.mutate({mutation:mn,variables:c});case 4:case"end":return e.stop()}var d}),e)})));return function(n,t,a){return e.apply(this,arguments)}}(),fn=t(32),vn=t.n(fn),bn=t(45),yn=t(287),En=t(142),hn=t(167),gn=t(5827),On=t(5828),jn=t(5829),wn=function(e){return function(n){for(var t=arguments.length,a=new Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];return{inputValue:n,value:e.apply(void 0,[n].concat(a))}}};!function(e){e[e.NOTIFICATION=0]="NOTIFICATION",e[e.ERROR=1]="ERROR",e[e.FATAL_ERROR=2]="FATAL_ERROR"}(sn||(sn={}));var Cn=function(){var e=Object(He.c)(),n=e.setStatus,t=e.status,a=Object(m.useCallback)((function(e){t?e&&!Object.keys(e).some((function(n){return e[n]!==t[n]}))||n(e):e&&n(e)}),[n,t]);return[null!=t?t:null,a]};function Mn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Rn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Mn(Object(t),!0).forEach((function(n){G()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Mn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var An={inputMode:"numeric"},kn={tabIndex:-1},_n=wn((function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];var a=n[0],r=n[1];return a&&Object(hn.a)(a)?Object(gn.a)(a):r||""})),Sn=function(e){var n,t,a,r=e.autoFocus,l=void 0!==r&&r,o=e.disabled,i=void 0!==o&&o,u=e.maxDate,c=void 0===u?new Date:u,d=e.minDate,s=e.variant,f=void 0===s?"filled":s,v=vn()(e,["variant"]),b=Object(He.c)().isSubmitting,y=Object(m.useCallback)((function(e){var n=((null==e?void 0:e.value)||"").trim();if(!n)return"Date is Required";var t=Object(On.a)(n);return Object(hn.a)(t)?d&&t<d?"Cannot be before ".concat(Object(ve.a)(d,"MM/dd/yyyy")):c<t?"Cannot be after ".concat(Object(ve.a)(c,"MM/dd/yyyy")):void 0:"Invalid Date"}),[d,c]),E=Object(He.b)({name:"date",validate:y}),h=U()(E,3),g=h[0],O=h[1],j=h[2],w=null!==(t=null===(n=g.value)||void 0===n?void 0:n.inputValue)&&void 0!==t?t:null,C=O.error,M=O.touched,R=j.setValue,A=j.setTouched,k=null===(a=O.initialValue)||void 0===a?void 0:a.inputValue,_=Object(m.useMemo)((function(){return k&&Object(hn.a)(k)?k:new Date}),[k]),S=Object(m.useMemo)((function(){return{autoFocus:l}}),[l]),I=Object(m.useRef)(!1),D=Object(m.useCallback)((function(){return setTimeout((function(){I.current||A(!0)}),0)}),[A,I]),T=Object(m.useCallback)((function(){return I.current=!0}),[I]),x=Object(m.useCallback)((function(){I.current=!1,D()}),[I,D]),F=Object(m.useCallback)((function(e,n){R(_n(e&&Object(hn.a)(e)?Object(jn.a)([new Date,e]):e,n))}),[R]),P=Cn(),$=U()(P,1)[0],N=Object(m.useMemo)((function(){return Rn(Rn({},g),{},{disabled:b||i||(null==$?void 0:$.type)===sn.FATAL_ERROR,value:w,error:M&&!!C,helperText:M?C:void 0,animateYearScrolling:!0,disableToolbar:!0,disableFuture:!0,inputVariant:f,variant:"inline",format:"MM/dd/yyyy",margin:"none",label:"Date",initialFocusedDate:_,autoOk:!0,InputProps:S,inputProps:An,placeholder:"mm/dd/yyyy",KeyboardButtonProps:kn,onBlur:D,onOpen:T,onClose:x,onChange:F})}),[w,_,D,C,f,S,b,g,T,x,F,M,i,$]);return p.a.createElement(bn.a,{utils:En.default},p.a.createElement(yn.b,Object.assign({maxDate:c},v,N)))},In=t(247),Dn=function(e){var n,t=e.autoFocus,a=void 0!==t&&t,r=e.disabled,l=void 0!==r&&r,o=e.variant,i=void 0===o?"filled":o,u=vn()(e,["autoFocus","disabled","variant"]),c=Object(He.b)({name:"description"}),d=U()(c,3),s=d[0],f=d[2].setValue,v=Object(m.useCallback)((function(e){var n,t;f((null===(t=null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.value)||void 0===t?void 0:t.trimLeft())||null)}),[f]),b=Object(m.useMemo)((function(){return{type:"text",autoFocus:a}}),[a]),y=Cn(),E=U()(y,1)[0];return p.a.createElement(In.a,Object.assign({},u,s,{disabled:l||(null==E?void 0:E.type)===sn.FATAL_ERROR,onChange:v,value:null!==(n=s.value)&&void 0!==n?n:"",variant:i,label:"Description",name:"description",InputProps:b}))},Tn=t(295),xn=(t(292),function(e){return{n:Math.abs(e.n),d:Math.abs(e.d),s:-1===e.s?c.Neg:c.Pos}}),Fn=function(e){return new Ee.a({n:e.s===c.Neg?-Math.abs(e.n):Math.abs(e.n),d:Math.abs(e.d)})},Pn={min:"0.00",step:"0.01"},$n=wn((function(e){return"string"!=typeof e||e.trim()?xn(new Ee.a(e).round(2)):xn(new Ee.a(0))})),Nn=function(e){var n,t,a=e.autoFocus,r=void 0!==a&&a,l=e.disabled,o=void 0!==l&&l,i=e.variant,u=void 0===i?"filled":i,c=e.maxTotal,d=void 0===c?new Ee.a(Number.MAX_SAFE_INTEGER):c,s=e.minTotal,f=void 0===s?new Ee.a(0):s,v=vn()(e,["autoFocus","disabled","variant","maxTotal","minTotal"]),b=new Ee.a(1,100).compare(f)>0?new Ee.a(1,100):f,y=Object(m.useCallback)((function(e){var n,t;if(!e||null===(t=null===(n=e.inputValue)||void 0===n?void 0:n.trim())||void 0===t||!t)return"Total Required";var a=Fn(e.value);return Number.isNaN(Number.parseInt(e.inputValue))?"Invalid Number":a.compare(d)>0?"Cannot be greater than ".concat(Q()(d.valueOf()).format("$0,0.00")):0===a.compare(new Ee.a(0))?"Cannot be 0":a.compare(b)<0?"Cannot be less than ".concat(Q()(b.valueOf()).format("$0,0.00")):void 0}),[b,d]),E=Object(He.b)({name:"total",validate:y}),h=U()(E,3),g=h[0],O=h[1],j=h[2].setValue,w=null!==(t=null===(n=g.value)||void 0===n?void 0:n.inputValue)&&void 0!==t?t:"",C=O.error,M=O.touched,R=Object(m.useMemo)((function(){return{type:"number",autoFocus:r,startAdornment:p.a.createElement(Tn.a,{position:"start"},"$")}}),[r]),A=Object(m.useCallback)((function(e){var n,t;j($n((null===(t=null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.value)||void 0===t?void 0:t.toString())||""))}),[j]),k=Object(m.useMemo)((function(){var e=new Ee.a(Number.MAX_SAFE_INTEGER),n=new Ee.a(1,100);return M&&C?C:0!==d.compare(e)&&b.compare(n)>0?"Max ".concat(Q()(d.valueOf()).format("$0,0.00")," & Min ").concat(Q()(b.valueOf()).format("$0,0.00")):0!==d.compare(e)?"Max ".concat(Q()(d.valueOf()).format("$0,0.00")):b.compare(n)>0?"Min ".concat(Q()(b.valueOf()).format("$0,0.00")):""}),[M,C,d,b]),_=Cn(),S=U()(_,1)[0];return p.a.createElement(In.a,Object.assign({},v,g,{disabled:o||(null==S?void 0:S.type)===sn.FATAL_ERROR,type:"number",value:w,error:M&&!!C,helperText:k,placeholder:"0.00",label:"Total",name:"total",required:!0,variant:u,inputProps:Pn,InputProps:R,onChange:A}))},qn=t(377),Ln=t(392),Bn={type:"checkbox"},Un=function(e){var n,t=e.label,a=e.disabled,r=void 0!==a&&a,l=vn()(e,["label","disabled"]),o=Object(He.b)({name:"reconciled",type:"checkbox"}),i=U()(o,1)[0],u=null!==(n=i.value)&&void 0!==n&&n,c=Cn(),d=U()(c,1)[0];return t?p.a.createElement(qn.a,Object.assign({},l,i,{value:u,disabled:r||(null==d?void 0:d.type)===sn.FATAL_ERROR,label:"Reconcile",control:p.a.createElement(Ln.a,{inputProps:Bn})})):p.a.createElement(Ln.a,Object.assign({},l,i,{value:u,disabled:r||(null==d?void 0:d.type)===sn.FATAL_ERROR,inputProps:Bn}))},Wn=t(395);function Jn(){var e=F()(["\n  fragment PayMethodEntryOptFragment on PaymentMethod {\n    __typename\n    id\n    refId\n    name\n    active\n    parent {\n      __typename\n      id\n    }\n  }\n"]);return Jn=function(){return e},e}function Vn(){var e=F()(["\n  fragment SrcEntryBizOptFragment on Business {\n    __typename\n    id\n    name\n    vendor {\n      approved\n      vendorId\n    }\n    departments {\n      ...SrcEntryDeptOptFragment\n    }\n  }\n  ","\n"]);return Vn=function(){return e},e}function Gn(){var e=F()(["\n  fragment SrcEntryDeptOptFragment on Department {\n    __typename\n    id\n    name\n    parent {\n      ... on Business {\n        __typename\n        id\n      }\n      ... on Department {\n        __typename\n        id\n      }\n    }\n  }\n"]);return Gn=function(){return e},e}function zn(){var e=F()(["\n  fragment SrcEntryPersonOptFragment on Person {\n    __typename\n    id\n    personName: name {\n      first\n      last\n    }\n  }\n"]);return zn=function(){return e},e}function Yn(){var e=F()(["\n  fragment CatEntryOptFragment on JournalEntryCategory {\n    __typename\n    id\n    name\n    type\n    parent {\n      __typename\n      id\n    }\n  }\n"]);return Yn=function(){return e},e}function Kn(){var e=F()(["\n  fragment DeptEntryOptFragment on Department {\n    __typename\n    id\n    name\n    budgets {\n      id\n      __typename\n      fiscalYear {\n        __typename\n        id\n      }\n    }\n    parent {\n      __typename\n      ... on Business {\n        id\n      }\n      ... on Department {\n        id\n      }\n    }\n  }\n"]);return Kn=function(){return e},e}function Xn(){var e=F()(["\n  query FiscalYear($date: String) {\n    fiscalYears(where: { hasDate: { eq: $date } }) {\n      __typename\n      id\n    }\n  }\n"]);return Xn=function(){return e},e}var Qn=fe()(Xn()),Hn=fe()(Kn()),Zn=fe()(Yn()),et=fe()(zn()),nt=fe()(Gn()),tt=fe()(Vn(),nt),at=fe()(Jn()),rt=t(5841);function lt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function ot(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?lt(Object(t),!0).forEach((function(n){G()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):lt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function it(){var e=F()(["\n  query PayMethodEntryOpts($where: PaymentMethodWhereInput!) {\n    paymentMethods(where: $where) {\n      ...PayMethodEntryOptFragment\n    }\n  }\n  ","\n"]);return it=function(){return e},e}var ut=fe()(it(),at),ct=function(e){var n,t,a=null!==(n=null==e?void 0:e.value)&&void 0!==n?n:[],r=a.length,l=a[r-1],o=a[r-2];if(void 0===l)return"Method Required";if("string"==typeof l){if((null==o?void 0:o.id)===Pe&&!(null!==(t=l.match(/[0-9]/g))&&void 0!==t?t:[]).join(""))return"Check # Required"}else if(l.id===Pe)return"Check # Required"},dt=function(e){return"string"==typeof e?e:e.name},st=function(e,n){var t=e.length-1;return e.map((function(a,r){var l,o,i=t===r,u=n({index:r}),c=u.key,d=vn()(u,["key"]),s=e[r-1],m="string"==typeof a;switch(null==s?void 0:s.id){case Pe:l="CK-"+(m?a:a.name);break;default:l=dt(a)}if(i){if(!m)switch(a.id){case Pe:o=p.a.createElement("span",null,"CK-")}}else o=p.a.createElement(Be.a,{fontSize:"small"});return p.a.createElement(le.a,{key:c,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},p.a.createElement(Wn.a,Object.assign({color:i?"primary":"default",variant:i?"default":"outlined",label:l,size:"medium"},d,{disabled:!i}))," ",o)}))},mt=function(e){var n,t,a,r,l,o=e.disabled,i=void 0!==o&&o,u=vn()(e,["disabled"]),c=Object(m.useState)(!1),d=U()(c,2),s=d[0],f=d[1],v=Object(He.b)({name:"paymentMethod",validate:ct}),b=U()(v,3),y=b[0],E=b[1],h=b[2],g=y.onBlur,O=null!==(t=null===(n=y.value)||void 0===n?void 0:n.value)&&void 0!==t?t:[],j=null!==(r=null===(a=y.value)||void 0===a?void 0:a.inputValue)&&void 0!==r?r:"",w=E.error,C=E.touched,M=h.setValue,R=null!==(l=O[O.length-1])&&void 0!==l?l:null,A=Object(m.useMemo)((function(){return null===R?{where:{hasParent:!1}}:{where:{parent:{eq:R.id}}}}),[R]),k=Cn(),_=U()(k,2),S=_[0],I=_[1],D=Object(m.useCallback)((function(e){I({msg:e.message,type:sn.FATAL_ERROR})}),[I]),T=Object(K.c)(ut,{skip:"string"==typeof R,variables:A,onError:D}),x=T.loading,F=T.error,P=T.data,$=Object(m.useMemo)((function(){return(null==P?void 0:P.paymentMethods)&&"string"!=typeof R&&(null==R?void 0:R.id)!==Pe?P.paymentMethods:[]}),[P,R]),N=$.length>0,q=Object(m.useMemo)((function(){var e;return(null===(e=R)||void 0===e?void 0:e.id)===Pe}),[R]),L=Object(m.useMemo)((function(){return!N&&!q}),[N,q]),B=Object(m.useMemo)((function(){var e;return"string"==typeof R||(null===(e=R)||void 0===e?void 0:e.id)===Pe?"Check #":"Payment Method"}),[R]),W=Object(m.useMemo)((function(){var e;return(null===(e=R)||void 0===e?void 0:e.id)===Pe?{type:"number"}:{}}),[R]),J=Object(m.useMemo)((function(){var e;return(null===(e=R)||void 0===e?void 0:e.id)===Pe?{min:"0",step:"1"}:{}}),[R]),V=Object(m.useCallback)((function(e){var n,t;e.InputProps=ot(ot({},null!==(n=e.InputProps)&&void 0!==n?n:{}),W),e.inputProps=ot(ot({},null!==(t=e.inputProps)&&void 0!==t?t:{}),J);var a=F?F.message:C?w:void 0;return p.a.createElement(In.a,Object.assign({},u,e,{variant:u.variant||"filled",error:C&&!!w||!!F,helperText:a,name:"paymentMethod",label:B}))}),[u,C,F,w,B,W,J]),G=Object(m.useCallback)((function(){return f(!0)}),[f]),z=Object(m.useCallback)((function(e){f(!1),e.persist(),setTimeout((function(){g(e)}),0)}),[f,g]),Y=Object(m.useCallback)((function(e,n){M({inputValue:j,value:n})}),[M,j]),X=Object(m.useCallback)((function(e,n){n=(n||"").trimStart(),L||M({inputValue:n,value:O})}),[M,O,L]),Q=Object(m.useMemo)((function(){return{value:O,disabled:!!F||x||(null==S?void 0:S.type)===sn.FATAL_ERROR||i,multiple:!0,options:$,renderInput:V,renderTags:st,freeSolo:q,getOptionLabel:dt,onChange:Y,onInputChange:X,inputValue:L?"":j,onFocus:G,onBlur:z,open:s&&N&&(null==S?void 0:S.type)!==sn.FATAL_ERROR,loading:x,autoSelect:!0,name:"paymentMethod"}}),[$,O,V,q,Y,X,j,L,G,z,s,N,x,F,i,S]);return p.a.createElement(rt.a,Object.assign({},Q))},pt=t(356),ft=t(187),vt=function(e){var n=Object(Ze.a)(),t=e.opacity,a=void 0===t?.62:t,r=vn()(e,["opacity"]);return p.a.createElement(le.a,Object.assign({},r,{overflow:"auto",position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",width:"100%",top:"0px",bottom:"0px",bgcolor:Object(ft.fade)(n.palette.background.paper,a)}))},bt=function(e){return p.a.createElement(vt,Object.assign({},e),p.a.createElement(pt.a,null))};function yt(){var e=F()(["\n  fragment JournalEntry_2Fragment on JournalEntry {\n    __typename\n    id\n    date\n    type\n    total {\n      n\n      d\n      s\n    }\n    refunds {\n      id\n      __typename\n      deleted\n      total {\n        n\n        d\n        s\n      }\n    }\n  }\n"]);return yt=function(){return e},e}var Et=fe()(yt());function ht(){var e=F()(["\n  query GetEntryRefundInfo_1($id: ID!) {\n    journalEntry(id: $id) {\n      ...JournalEntry_2Fragment\n    }\n  }\n  ","\n"]);return ht=function(){return e},e}var gt=fe()(ht(),Et),Ot=Symbol(),jt=function(e){var n,t,a,r,l=e.entryId,o=e.open,i=e.onClose,c=e.onExited,d=e.handleSubmit,s=Object(He.c)(),f=s.resetForm,v=s.isSubmitting,b=s.isValid,y=Cn(),E=U()(y,2),h=E[0],g=E[1],O=Object(m.useCallback)((function(e){return g({msg:e.message,type:sn.FATAL_ERROR})}),[g]),j=Object(K.c)(gt,{skip:!l,variables:{id:l},onError:O}),w=j.loading,C=j.error,M=j.data,R=null===(n=null==M?void 0:M.journalEntry)||void 0===n?void 0:n.total,A=(null===(t=null==M?void 0:M.journalEntry)||void 0===t?void 0:t.refunds)||[],k=Object(m.useMemo)((function(){if(R){var e=A.reduce((function(e,n){var t=n.deleted,a=n.total;return t?e:e.add(Fn(a))}),new Ee.a(0));return Fn(R).sub(e)}return new Ee.a(Number.MAX_SAFE_INTEGER)}),[R,A]),_=null===(a=null==M?void 0:M.journalEntry)||void 0===a?void 0:a.date,S=Object(m.useMemo)((function(){return _?new Date(_):void 0}),[_]),I=Object(m.useCallback)((function(){c(),f(),g(null)}),[f,c,g]),D=Object(m.useMemo)((function(){return!h||h.type!==sn.FATAL_ERROR&&h.type!==sn.ERROR?[null,null]:[h.msg,h.type===sn.FATAL_ERROR]}),[h]),T=U()(D,2),x=T[0],F=T[1],P=null===(r=null==M?void 0:M.journalEntry)||void 0===r?void 0:r.type,$=Object(m.useMemo)((function(){var e=w||C||(null!=P?P:Ot)===Ot?"Refund":"".concat(P===u.Credit?"Give":"Add"," Refund");return F?"Fatal Error":w?"Loading ".concat(e,"..."):v?"Submitting ".concat(e):e}),[w,C,P,F,v]),N=Object(Ze.a)();return p.a.createElement(en.a,{open:o,onClose:i,onExited:I,disableBackdropClick:v,disableEscapeKeyDown:v,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:d}},p.a.createElement(nn.a,{style:x?{color:N.palette.error.main}:void 0},$),p.a.createElement(le.a,{position:"relative"},(w||v)&&!x&&p.a.createElement(bt,{zIndex:"modal"}),!!x&&F&&p.a.createElement(vt,{opacity:.78,zIndex:"modal",padding:2},p.a.createElement(tn.a,{color:"error"},x)),p.a.createElement(an.a,{dividers:!0},!!x&&!F&&p.a.createElement(tn.a,{color:"error"},x),p.a.createElement(rn.a,{container:!0,spacing:2},p.a.createElement(rn.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(Sn,{minDate:S,disabled:w||v,fullWidth:!0})),p.a.createElement(rn.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(Dn,{disabled:w||v,fullWidth:!0})),p.a.createElement(rn.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(mt,{disabled:w||v,fullWidth:!0})),p.a.createElement(rn.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(Nn,{disabled:w||v,fullWidth:!0,maxTotal:k})),p.a.createElement(rn.a,{item:!0,container:!0,justify:"center",alignItems:"flex-start",lg:4,md:6,sm:12},p.a.createElement(Un,{disabled:w||v,label:!0}))))),p.a.createElement(ln.a,null,!F&&p.a.createElement(on.a,{disabled:w||v||!b,type:"submit",startIcon:p.a.createElement(un.a,null),color:"primary",variant:"contained"},"Add"),p.a.createElement(on.a,{disabled:w||v,color:F?"primary":"default",startIcon:!F&&p.a.createElement(cn.a,null),onClick:i},F?"Ok":"Cancel")))},wt=function(e){var n=e.entryId,t=e.open,a=e.onClose,r=e.onExited,l=Object(m.useMemo)((function(){return{}}),[]),o=Object(K.a)(),i=Object(m.useCallback)(function(){var e=N()(J.a.mark((function e(t,r){var l;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r.setStatus(null),e.next=4,pn(o,n||"",t,r);case 4:a(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),r.setStatus({msg:null!==(l=e.t0.message)&&void 0!==l?l:"".concat(e.t0),type:sn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,t){return e.apply(this,arguments)}}(),[o,n,a]),u=Object(m.useCallback)((function(e){return p.a.createElement(jt,{entryId:n,open:t,onClose:a,onExited:r,handleSubmit:e.handleSubmit})}),[n,t,a,r]);return p.a.createElement(He.a,{initialValues:l,initialStatus:null,enableReinitialize:!0,onSubmit:i},u)},Ct=t(407);function Mt(){var e=F()(["\n  mutation UpdateRefund(\n    $id: ID!\n    $fields: JournalEntryUpdateRefundFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $paymentMethodUpdate: JournalEntryUpdatePaymentMethod\n  ) {\n    journalEntryUpdateRefund(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      paymentMethodUpdate: $paymentMethodUpdate\n    ) {\n      id\n      __typename\n      refunds {\n        ...JournalEntryRefund_1Fragment\n      }\n    }\n  }\n  ","\n"]);return Mt=function(){return e},e}var Rt=fe()(Mt(),De),At=function(){var e=N()(J.a.mark((function e(n,t,a,r){var l,o,i,u,c,d,s,m;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(Ct.a)(t.date.inputValue,r.date.inputValue)?null:r.date.value,u=r.description!==t.description?null!==(o=null===(l=r.description)||void 0===l?void 0:l.trim())&&void 0!==o?o:"":null,c=0===Fn(r.total.value).compare(Fn(t.total.value))?null:r.total.value,d=r.reconciled===t.reconciled?null:r.reconciled,p=void 0,f=void 0,v=void 0,b=void 0,y=void 0,p=t.paymentMethod.value[t.paymentMethod.value.length-1],f=r.paymentMethod.value.slice(-2).reverse(),v=U()(f,2),b=v[0],y=v[1],s="string"==typeof b?p.parent&&p.parent.id===Pe?{paymentMethod:null,paymentMethodAdd:null,paymentMethodUpdate:{id:p.id,fields:{active:null,refId:b,name:b}}}:{paymentMethod:null,paymentMethodAdd:{parent:y.id,refId:b,name:b,active:!1},paymentMethodUpdate:null}:b.id!==p.id?{paymentMethod:b.id,paymentMethodAdd:null,paymentMethodUpdate:null}:{paymentMethod:null,paymentMethodAdd:null,paymentMethodUpdate:null},m={id:a,fields:{date:i,description:u,total:c,reconciled:d,paymentMethod:s.paymentMethod},paymentMethodAdd:s.paymentMethodAdd,paymentMethodUpdate:s.paymentMethodUpdate},e.next=8,n.mutate({mutation:Rt,variables:m});case 8:case"end":return e.stop()}var p,f,v,b,y}),e)})));return function(n,t,a,r){return e.apply(this,arguments)}}();function kt(){var e=F()(["\n  query UpdateRefundIniState($entryId: ID!, $refundId: ID!) {\n    journalEntry(id: $entryId) {\n      ...JournalEntry_2Fragment\n    }\n    journalEntryRefund(id: $refundId) {\n      __typename\n      id\n      date\n      description\n      paymentMethod {\n        ...PayMethodEntryOptFragment\n        ancestors {\n          ...PayMethodEntryOptFragment\n        }\n      }\n      total {\n        n\n        d\n        s\n      }\n      reconciled\n    }\n  }\n  ","\n  ","\n"]);return kt=function(){return e},e}var _t=fe()(kt(),Et,at),St=function(e){var n=e.refundId,t=e.open,a=e.onClose,r=e.onExited,l=e.journalEntry,o=e.loading,i=e.handleSubmit,u=Object(He.c)(),c=u.resetForm,d=u.isSubmitting,s=u.isValid,f=Cn(),v=U()(f,2),b=v[0],y=v[1],E=null==l?void 0:l.total,h=(null==l?void 0:l.refunds)||[],g=Object(m.useMemo)((function(){if(E){var e=h.reduce((function(e,t){var a=t.id,r=t.deleted,l=t.total;return r||a===n?e:e.add(Fn(l))}),new Ee.a(0));return Fn(E).sub(e)}return new Ee.a(Number.MAX_SAFE_INTEGER)}),[E,h,n]),O=null==l?void 0:l.date,j=Object(m.useMemo)((function(){return O?new Date(O):void 0}),[O]),w=Object(m.useCallback)((function(){r(),c(),y(null)}),[c,r,y]),C=Object(m.useMemo)((function(){return!b||b.type!==sn.FATAL_ERROR&&b.type!==sn.ERROR?[null,null]:[b.msg,b.type===sn.FATAL_ERROR]}),[b]),M=U()(C,2),R=M[0],A=M[1],k=Object(m.useMemo)((function(){var e="Refund Update";return A?"Fatal Error":o?"Loading ".concat(e,"..."):d?"Submitting ".concat(e):e}),[o,A,d]),_=Object(Ze.a)();return p.a.createElement(en.a,{open:t,onClose:a,onExited:w,disableBackdropClick:d,disableEscapeKeyDown:d,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:i}},p.a.createElement(nn.a,{style:R?{color:_.palette.error.main}:void 0},k),p.a.createElement(le.a,{position:"relative"},(o||d)&&!R&&p.a.createElement(bt,{zIndex:"modal"}),!!R&&A&&p.a.createElement(vt,{opacity:.78,zIndex:"modal",padding:2},p.a.createElement(tn.a,{color:"error"},R)),p.a.createElement(an.a,{dividers:!0},!!R&&!A&&p.a.createElement(tn.a,{color:"error"},R),p.a.createElement(rn.a,{container:!0,spacing:2},p.a.createElement(rn.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(Sn,{minDate:j,disabled:o||d||!!A,fullWidth:!0})),p.a.createElement(rn.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(Dn,{disabled:o||d||!!A,fullWidth:!0})),p.a.createElement(rn.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(mt,{disabled:o||d||!!A,fullWidth:!0})),p.a.createElement(rn.a,{item:!0,lg:4,sm:6,xs:12},p.a.createElement(Nn,{disabled:o||d||!!A,fullWidth:!0,maxTotal:g})),p.a.createElement(rn.a,{item:!0,container:!0,justify:"center",alignItems:"flex-start",lg:4,md:6,sm:12},p.a.createElement(Un,{disabled:o||d||!!A,label:!0}))))),p.a.createElement(ln.a,null,!A&&p.a.createElement(on.a,{disabled:o||d||!s,type:"submit",startIcon:p.a.createElement(un.a,null),color:"primary",variant:"contained"},"Update"),p.a.createElement(on.a,{disabled:o||d||!!A,color:A?"primary":"default",startIcon:!A&&p.a.createElement(cn.a,null),onClick:a},A?"Ok":"Cancel")))},It=function(e){var n=e.entryId,t=e.refundId,a=e.open,r=e.onClose,l=e.onExited,o=Object(K.c)(_t,{skip:!n,variables:{entryId:n,refundId:t}}),i=o.loading,u=o.error,c=o.data,d=Object(m.useMemo)((function(){return u?{msg:u.message,type:sn.FATAL_ERROR}:null}),[u]),s=null==c?void 0:c.journalEntryRefund,f=Object(m.useMemo)((function(){var e;return s?{date:{inputValue:new Date(s.date),value:s.date},paymentMethod:function(){var e=s.paymentMethod,n=e.ancestors,t=vn()(e,["ancestors"]),a=L()(n).sort((function(e,n){var t,a;return e.id===(null===(t=n.parent)||void 0===t?void 0:t.id)?-1:n.id===(null===(a=e.parent)||void 0===a?void 0:a.id)?1:0}));return a.push(t),{inputValue:"",value:a}}(),total:{inputValue:Fn(s.total).round(2).toString(),value:s.total},reconciled:s.reconciled,description:null!==(e=s.description)&&void 0!==e?e:null}:{}}),[s]),v=Object(K.a)(),b=Object(m.useCallback)(function(){var e=N()(J.a.mark((function e(n,a){var l;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=5;break}return a.setStatus({msg:'Failed to load initial values for refund "'.concat(t,'".'),type:sn.FATAL_ERROR}),e.abrupt("return");case 5:if(t){e.next=8;break}return a.setStatus({msg:"No refund ID.",type:sn.FATAL_ERROR}),e.abrupt("return");case 8:return e.prev=8,a.setStatus(null),e.next=12,At(v,f,t,n,a);case 12:r(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),a.setStatus({msg:null!==(l=null===e.t0||void 0===e.t0?void 0:e.t0.message)&&void 0!==l?l:"".concat(e.t0),type:sn.FATAL_ERROR});case 18:case"end":return e.stop()}}),e,null,[[8,15]])})));return function(n,t){return e.apply(this,arguments)}}(),[v,f,r,t]),y=Object(m.useCallback)((function(e){var o;return p.a.createElement(St,{entryId:n,refundId:t,open:a,onClose:r,onExited:l,journalEntry:null!==(o=null==c?void 0:c.journalEntry)&&void 0!==o?o:null,loading:i,handleSubmit:e.handleSubmit})}),[c,n,i,r,l,a,t]);return p.a.createElement(He.a,{initialValues:null!=f?f:{},initialStatus:d,enableReinitialize:!0,onSubmit:b},y)},Dt=t(5833),Tt=t(170);function xt(){var e=F()(["\n  mutation AddEntry(\n    $fields: JournalEntryAddFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $personAdd: PersonAddFields\n    $businessAdd: BusinessAddFields\n  ) {\n    journalEntryAdd(\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      personAdd: $personAdd\n      businessAdd: $businessAdd\n    ) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return xt=function(){return e},e}var Ft=fe()(xt(),xe),Pt=function(){var e=N()(J.a.mark((function e(n,t){var a,r,l,o,u,c,d,s,m,p;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=void 0,f=t.paymentMethod.value[t.paymentMethod.value.length-1],l="string"==typeof f?{paymentMethod:"",paymentMethodAdd:{parent:t.paymentMethod.value[t.paymentMethod.value.length-2].id,refId:f,name:f,active:!1}}:{paymentMethod:f.id,paymentMethodAdd:null},o=l.paymentMethod,u=l.paymentMethodAdd,c=function(){var e=t.source.value[0],n=t.source.value[t.source.value.length-1];if("string"==typeof n){if(e===i.Person){var a=Object(Tt.parseName)(n);return{source:{sourceType:i.Person,id:""},businessAdd:null,personAdd:{name:{first:a.firstName,last:a.lastName}}}}return{source:{sourceType:i.Business,id:""},businessAdd:{name:n},personAdd:null}}return{source:{sourceType:function(){switch(n.__typename){case"Business":return i.Business;case"Department":return i.Department;case"Person":return i.Person}}(),id:n.id},personAdd:null,businessAdd:null}}(),d=c.source,s=c.personAdd,m=c.businessAdd,p={fields:{date:t.date.value,department:t.department.id,type:t.type,category:t.category.value[t.category.value.length-1].id,description:(null===(a=t.description)||void 0===a?void 0:a.trim())||null,total:t.total.value,reconciled:null!==(r=t.reconciled)&&void 0!==r?r:null,paymentMethod:o,source:d},paymentMethodAdd:u,personAdd:s,businessAdd:m},e.next=5,n.mutate({mutation:Ft,variables:p});case 5:case"end":return e.stop()}var f}),e)})));return function(n,t){return e.apply(this,arguments)}}();function $t(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Nt(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?$t(Object(t),!0).forEach((function(n){G()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$t(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function qt(){var e=F()(["\n  query CatEntryOpts($where: JournalEntryCategoryWhereInput!) {\n    catOpts: journalEntryCategories(where: $where) {\n      ...CatEntryOptFragment\n    }\n  }\n  ","\n"]);return qt=function(){return e},e}var Lt=fe()(qt(),Zn),Bt=function(e){return e.name},Ut=function(e,n){var t=e.length-1;return e.map((function(e,a){var r=t===a,l=n({index:a}),o=l.key,i=vn()(l,["key"]);return p.a.createElement(le.a,{key:o,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},p.a.createElement(Wn.a,Object.assign({color:r?"primary":"default",variant:r?"default":"outlined",label:e.name,size:"medium"},i,{disabled:!r}))," ",!r&&p.a.createElement(Be.a,{fontSize:"small"}))}))},Wt=Symbol(),Jt=function(e){var n,t,a,r,l,o,i=Object(He.c)(),u=e.disabled,c=void 0!==u&&u,d=e.required,s=e.entryType,f=vn()(e,["entryType"]),v=(null===(t=null===(n=i.values)||void 0===n?void 0:n.category)||void 0===t?void 0:t.value)||[],b=(null===(r=null===(a=i.values)||void 0===a?void 0:a.category)||void 0===r?void 0:r.inputValue.trimLeft())||"",y=null!==(o=null!=s?s:null===(l=i.values)||void 0===l?void 0:l.type)&&void 0!==o?o:null,E=v[v.length-1],h=Object(m.useMemo)((function(){return(null==E?void 0:E.id)?{where:{parent:{eq:E.id},type:{eq:y}}}:{where:{hasParent:!1,type:{eq:y}}}}),[E,y]),g=Cn(),O=U()(g,2),j=O[0],w=O[1],C=Object(m.useCallback)((function(e){w({msg:e.message,type:sn.FATAL_ERROR})}),[w]),M=Object(K.c)(Lt,{skip:(null!=y?y:Wt)===Wt,variables:h,onCompleted:function(){return setTimeout((function(){return i.validateField("category")}),0)},onError:C}),R=M.loading,A=M.error,k=M.data,_=null==k?void 0:k.catOpts,S=Object(m.useMemo)((function(){return _||[]}),[_]),I=Object(m.useCallback)((function(e){var n=(null==e?void 0:e.value)||[];return n[n.length-1]||null?S.length>0?"Sub-category Required":void 0:d?"Category Required":void 0}),[S,d]),D=Object(He.b)({name:"category",validate:I}),T=U()(D,3),x=T[0],F=T[1],P=T[2],$=x.onBlur,N=F.error,q=F.touched,L=P.setValue;Object(m.useEffect)((function(){E&&y!==E.type&&L({inputValue:"",value:[]})}),[y,E,L]);var B=Object(m.useMemo)((function(){return N&&q?N:(null!=y?y:Wt)===Wt?"Category requires entry type.":A?A.message:""}),[y,N,q,A]),W=Object(m.useMemo)((function(){return R||(null==j?void 0:j.type)===sn.FATAL_ERROR||(null!=y?y:Wt)===Wt||c||v.length>0&&0===S.length}),[c,y,j,R,S.length,v.length]),J=Object(m.useCallback)((function(e){return p.a.createElement(In.a,Object.assign({},f,{variant:f.variant||"filled"},e,{error:q&&!!N||!!A,disabled:W,helperText:B,name:"category",label:"Category"}))}),[f,q,N,A,W,B]),V=Object(m.useState)(!1),G=U()(V,2),z=G[0],Y=G[1],X=Object(m.useCallback)((function(){return Y(!0)}),[Y]),Q=Object(m.useCallback)((function(e){Y(!1),e.persist(),setTimeout((function(){$(e)}),0)}),[Y,$]),H=Object(m.useCallback)((function(e,n){L({inputValue:b,value:n})}),[L,b]),Z=Object(m.useCallback)((function(e,n){n=(n||"").trimStart(),L({inputValue:n,value:v})}),[L,v]),ee=Object(m.useMemo)((function(){return Nt(Nt({},x),{},{open:z&&S.length>0,onFocus:X,onBlur:Q,options:S,renderTags:Ut,forcePopupIcon:!1,disabled:W,value:v,renderInput:J,loading:R,autoSelect:!0,multiple:!0,getOptionLabel:Bt,onInputChange:Z,inputValue:b,onChange:H,name:"category"})}),[x,z,S,X,Q,R,W,v,J,Z,b,H]);return p.a.createElement(rt.a,Object.assign({},ee))};function Vt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Gt(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Vt(Object(t),!0).forEach((function(n){G()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Vt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function zt(){var e=F()(["\n  query DeptEntryOpts($bizId: ID!) {\n    deptOpts: business(id: $bizId) {\n      __typename\n      id\n      departments {\n        ...DeptEntryOptFragment\n      }\n    }\n  }\n  ","\n"]);return zt=function(){return e},e}var Yt=fe()(zt(),Hn),Kt=function(e){return e.name},Xt=function(e,n){var t=e.length-1;return e.map((function(e,a){var r=t===a,l=n({index:a}),o=l.key,i=vn()(l,["key"]);return p.a.createElement(le.a,{key:o,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},p.a.createElement(Wn.a,Object.assign({color:r?"primary":"default",variant:r?"default":"outlined",label:e.name,size:"medium"},i,{disabled:!r}))," ",!r&&p.a.createElement(Be.a,{fontSize:"small"}))}))},Qt=function(e){var n=e.disabled,t=void 0!==n&&n,a=e.required,r=e.fiscalYearId,l="string"==typeof r,o=Cn(),i=U()(o,2),u=i[0],c=i[1],d=Object(m.useCallback)((function(e){c({msg:e.message,type:sn.FATAL_ERROR})}),[c]),s=Object(K.c)(Yt,{onError:d,variables:{bizId:"5dc4b09bcf96e166daaa0090"}}),f=s.loading,v=s.error,b=s.data,y=(null==b?void 0:b.deptOpts.departments)||[],E=Object(m.useState)(!1),h=U()(E,2),g=h[0],O=h[1],j=Object(m.useState)(""),w=U()(j,2),C=w[0],M=w[1],R=Object(m.useCallback)((function(e){return e?l?e.budgets.every((function(e){return e.fiscalYear.id!==r}))?"Department has no budget.":void 0:y.some((function(n){var t=n.parent;return"Department"===t.__typename&&t.id===e.id}))?"Sub-department Required":void 0:a?"Department Required":void 0}),[y,a,l,r]),A=Object(He.b)({name:"department",validate:R}),k=U()(A,3),_=k[0],S=k[1],I=k[2],D=_.value,T=_.onBlur,x=S.error,F=S.touched,P=I.setValue,$=Object(m.useMemo)((function(){return!!D&&!D.budgets.every((function(e){return e.fiscalYear.id!==r}))}),[D]),N=Object(m.useMemo)((function(){return new Map(y.reduce((function(e,n){return e.push([n.id,n]),e}),[]))}),[y]),q=Object(m.useMemo)((function(){if(!D)return[];for(var e=[D],n=D.parent,t=n.__typename,a=n.id;"Business"!==t&&N.has(a);){var r=N.get(a);e.unshift(r);var l=r.parent;t=l.__typename,a=l.id}return e}),[D,N]),L=Object(m.useMemo)((function(){var e,n=null===(e=q[q.length-1])||void 0===e?void 0:e.id;return y.filter((function(e){return n?e.parent.id===n:"Business"===e.parent.__typename}))}),[y,q]),B=Object(m.useMemo)((function(){return q.length>0&&0===L.length}),[q,L]),W=Object(m.useMemo)((function(){return x&&F?x:v?v.message:""===r?"Department requires a date.":""}),[x,F,v]),J=Object(m.useMemo)((function(){return f||B||(null==u?void 0:u.type)===sn.FATAL_ERROR||t||l&&!r}),[B,t,u,f,l,r]),V=Object(m.useCallback)((function(n){return p.a.createElement(In.a,Object.assign({},e,{required:l?!$:!!e.required,variant:e.variant||"filled"},n,{error:F&&!!x,helperText:W,name:"department",label:"Department",disabled:J}))}),[e,F,x,W,J,l,$]),G=Object(m.useCallback)((function(){return O(!0)}),[O]),z=Object(m.useCallback)((function(e){O(!1),T(e)}),[O,T]),Y=Object(m.useCallback)((function(e,n){if(n)if(Array.isArray(n)){var t=n.length;P(0===t?null:n[t-1])}else P(n);else P(null)}),[P]),X=Object(m.useCallback)((function(e,n){M((n||"").trimStart())}),[M]),Q=Object(m.useMemo)((function(){return Gt(Gt({},_),{},{open:g&&L.length>0,onFocus:G,onBlur:z,options:L,renderTags:Xt,forcePopupIcon:!1,disabled:J,value:q,renderInput:V,loading:f,autoSelect:!1,multiple:!0,getOptionLabel:Kt,onChange:Y,onInputChange:X,inputValue:B?"":C,name:"department"})}),[_,g,L,G,z,B,J,q,V,f,Y,X,C]);return v?p.a.createElement("pre",null,JSON.stringify(v,null,2)):p.a.createElement(rt.a,Object.assign({},Q))},Ht=t(300);function Zt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function ea(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Zt(Object(t),!0).forEach((function(n){G()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Zt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function na(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return ta(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ta(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function ta(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function aa(){var e=F()(["\n  query SrcEntryOpts($name: String!, $isBiz: Boolean!) {\n    businesses(where: { name: { pattern: $name, options: I } })\n      @include(if: $isBiz) {\n      ...SrcEntryBizOptFragment\n    }\n    people(\n      where: {\n        or: [\n          { firstName: { pattern: $name, options: I } }\n          { lastName: { pattern: $name, options: I } }\n        ]\n      }\n    ) @skip(if: $isBiz) {\n      ...SrcEntryPersonOptFragment\n    }\n  }\n  ","\n  ","\n  ","\n"]);return aa=function(){return e},e}var ra=fe()(aa(),et,tt,nt),la=function(e){switch(e){case i.Business:case i.Department:case i.Person:break;default:return"string"==typeof e}return!1},oa=function(e){switch(e){case i.Business:return"Vendor";case i.Department:return"Department";case i.Person:return"Person";default:if("string"==typeof e)return e}return"Person"===e.__typename?"".concat(e.personName.first," ").concat(e.personName.last):e.name},ia=function(e,n){var t=e.length-1;return e.map((function(e,a){var r=t===a,l=n({index:a}),o=l.key,i=vn()(l,["key"]);return la(e)?e:p.a.createElement(le.a,{key:o,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},p.a.createElement(Wn.a,Object.assign({color:r?"primary":"default",variant:r?"default":"outlined",label:oa(e),size:"medium"},i,{disabled:!r}))," ",!r&&p.a.createElement(Be.a,{fontSize:"small"}))}))},ua=function(e,n){var t=n.inputValue,a=new RegExp("(^|\\s)".concat(t),"i");return e.filter((function(e){return a.test(oa(e))}))},ca=function(e){var n,t=(null==e?void 0:e.value)||[],a=null!==(n=t[0])&&void 0!==n?n:null,r=t.length>1?t[t.length-1]:null;if(null===a||null===r||""===r)return"Source Required";if(la(r)&&a===i.Person){var l=Object(Tt.parseName)(r);if(!l.firstName.trim())return"First Name Required";if(!l.lastName.trim())return"Last Name Required"}},da=function(e){var n,t,a,r,l,o=e.disabled,u=void 0!==o&&o,c=Object(m.useState)(!1),d=U()(c,2),s=d[0],f=d[1],v=Object(He.b)({name:"source",validate:ca}),b=U()(v,3),y=b[0],E=b[1],h=b[2],g=y.onBlur,O=null!==(t=null===(n=y.value)||void 0===n?void 0:n.value)&&void 0!==t?t:[],j=null!==(r=null===(a=y.value)||void 0===a?void 0:a.inputValue)&&void 0!==r?r:"",w=E.error,C=E.touched,M=h.setValue,R=null!==(l=O[0])&&void 0!==l?l:null,A=O.length>1?O[O.length-1]:null,k=Object(m.useRef)(""),_=Cn(),S=U()(_,2),I=S[0],D=S[1],T=Object(m.useCallback)((function(e){D({msg:e.message,type:sn.FATAL_ERROR})}),[D]),x=Object(K.c)(ra,{skip:!k.current&&!O[1],variables:{name:k.current,isBiz:R!==i.Person},onError:T}),F=x.loading,P=x.error,$=x.data,N=Object(m.useMemo)((function(){var e,n=new Map,t=na((null==$?void 0:$.businesses)||[]);try{for(t.s();!(e=t.n()).done;){var a,r=na(e.value.departments);try{for(r.s();!(a=r.n()).done;){var l=a.value;n.set(l.id,l)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){t.e(e)}finally{t.f()}return n}),[$]),q=Object(m.useMemo)((function(){if(null===R)return[i.Business,i.Person];if(R===i.Person)return null===A&&(null==$?void 0:$.people)||[];if(!A)return(null==$?void 0:$.businesses)||[];if("string"==typeof A)return[];var e,n=[],t=na(N.values());try{for(t.s();!(e=t.n()).done;){var a=e.value;a.parent.__typename===A.__typename&&a.parent.id===A.id&&n.push(a)}}catch(e){t.e(e)}finally{t.f()}return n}),[R,$,N,A]),L=Object(m.useMemo)((function(){return null!==R&&null===A}),[R,A]),B=Object(m.useMemo)((function(){return O.length>0&&0===q.length&&!L}),[O,q,L]),W=Object(m.useMemo)((function(){return null===R?"Source Type":R===i.Person?"Person Name":1===O.length?"Vendor":2===O.length&&q.length>0?"Department":q.length>0?"Sub-Department":"Vendor"}),[O,q,R]),J=Object(m.useMemo)((function(){return u||B||(null==I?void 0:I.type)===sn.FATAL_ERROR}),[B,u,I]),V=Object(m.useCallback)((function(n){var t;return A&&"string"!=typeof A&&"Person"!==A.__typename&&0===q.length&&(n=ea(ea({},n),{},{inputProps:ea(ea({},(null==n?void 0:n.inputProps)||{}),{},{style:ea(ea({},(null===(t=null==n?void 0:n.inputProps)||void 0===t?void 0:t.style)||{}),{},{display:"none"})})})),p.a.createElement(In.a,Object.assign({},e,{variant:e.variant||"filled"},n,{error:C&&!!w,helperText:C?w:void 0,name:"source",label:W,disabled:J}))}),[A,q.length,e,C,w,W,J]),G=Object(m.useCallback)((function(){return f(!0)}),[f]),z=Object(m.useCallback)((function(e){f(!1),e.persist(),setTimeout((function(){return g(e)}),0)}),[f,g]),Y=Object(m.useCallback)((function(e,n){var t=n.length-1,a=n[t];if(la(a)){var r,l=[],o=na(a.split(" "));try{for(o.s();!(r=o.n()).done;){var i=r.value;i&&(Ht.checkName(i)&&(i=Ht(i)),l.push(i))}}catch(e){o.e(e)}finally{o.f()}var u=l.join(" ").trim();n[t]=u.charAt(0).toUpperCase()+u.substring(1)}M({inputValue:j,value:n})}),[M,j]),X=Object(m.useCallback)((function(e,n){n=(n||"").trimStart(),B||M({inputValue:n,value:O}),null!==R&&null===A&&n&&(k.current=n[0].toLowerCase())}),[M,R,A,O,B,k]),Q=Object(m.useMemo)((function(){return ea(ea({},y),{},{inputValue:B?"":j,open:s&&q.length>0,onFocus:G,onBlur:z,options:q,renderTags:ia,forcePopupIcon:!1,freeSolo:L,value:O,renderInput:V,loading:F,autoSelect:!0,multiple:!0,getOptionLabel:oa,onInputChange:X,onChange:Y,filterOptions:ua,name:"source",disabled:J})}),[y,B,j,s,q,G,z,L,O,V,F,X,Y,J]);return P?p.a.createElement("pre",null,JSON.stringify(P,null,2)):p.a.createElement(rt.a,Object.assign({},Q))},sa=t(5844),ma=t(5832),pa=t(361),fa=t(293),va=t(5781);function ba(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function ya(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ba(Object(t),!0).forEach((function(n){G()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ba(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Ea=Symbol(),ha=function(e){if((null!=e?e:Ea)===Ea)return"Type Required"},ga=function(e){var n=e.disabled,t=void 0!==n&&n,a=Cn(),r=U()(a,1)[0],l=e.label,o=void 0!==l&&l,i=Object(He.c)().isSubmitting,c=Object(He.b)({name:"type",validate:ha}),d=U()(c,3),s=d[0],f=d[1],v=d[2],b=f.error,y=f.touched,E=v.setValue,h=v.setTouched,g=Object(m.useMemo)((function(){return ya(ya({size:"small",exclusive:!0,disabled:i},s),{},{onChange:(e=N()(J.a.mark((function e(n,t){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null!=t?t:Ea)!==Ea){e.next=2;break}return e.abrupt("return");case 2:return E(t),e.next=5,new Promise((function(e){return setTimeout(e,0)}));case 5:h(!0);case 6:case"end":return e.stop()}}),e)}))),function(n,t){return e.apply(this,arguments)})});var e}),[s,i,E,h]),O=i||t||(null==r?void 0:r.type)===sn.FATAL_ERROR,j=Object(m.useMemo)((function(){return p.a.createElement(le.a,{pl:1,clone:!0},p.a.createElement(sa.a,Object.assign({},e,g),p.a.createElement(ma.a,{disabled:O,value:u.Credit},p.a.createElement(pa.a,{arrow:!0,placement:"top",title:"Credit"},p.a.createElement(me.b,null))),p.a.createElement(ma.a,{disabled:O,value:u.Debit},p.a.createElement(pa.a,{arrow:!0,placement:"top",title:"Debit"},p.a.createElement(me.a,null)))))}),[e,g,O]);return o?p.a.createElement(fa.a,null,p.a.createElement(qn.a,Object.assign({},e,{labelPlacement:"boolean"==typeof o?void 0:o,control:j,label:"Type"})),y&&!!b&&p.a.createElement(va.a,{error:!0},b)):p.a.createElement(fa.a,null,j,!!b&&p.a.createElement(va.a,{error:!0},b))};function Oa(){var e=F()(["\n  query DeptIniValueForAddEntry($id: ID!) {\n    department(id: $id) {\n      ...DeptEntryOptFragment\n    }\n  }\n  ","\n"]);return Oa=function(){return e},e}var ja={item:!0,lg:4,sm:6,xs:12},wa=fe()(Oa(),Hn),Ca=function(e){var n=e.open,t=e.onClose,a=e.loading,r=Object(He.c)(),l=r.resetForm,o=r.isSubmitting,i=r.isValid,u=r.submitForm,c=r.values.date,d=Cn(),s=U()(d,2),f=s[0],v=s[1],b=Object(m.useCallback)((function(e){v({msg:e.message,type:sn.FATAL_ERROR})}),[v]),y=Object(K.c)(Qn,{skip:!(null==c?void 0:c.inputValue),variables:{date:(null==c?void 0:c.value)||""},onError:b}).data,E=Object(m.useMemo)((function(){var e,n;return null!==(n=null===(e=null==y?void 0:y.fiscalYears[0])||void 0===e?void 0:e.id)&&void 0!==n?n:""}),[y]),h=Object(m.useMemo)((function(){return!f||f.type!==sn.FATAL_ERROR&&f.type!==sn.ERROR?[null,null]:[f.msg,f.type===sn.FATAL_ERROR]}),[f]),g=U()(h,2),O=g[0],j=g[1],w=Object(m.useCallback)((function(){l(),v(null)}),[l,v]),C=Object(m.useMemo)((function(){return j?"Fatal Error":o?"Submitting Add Entry...":a?"Loading Add Entry...":"Add Entry"}),[j,o,a]),M=Object(Ze.a)(),R=Object(m.useCallback)(N()(J.a.mark((function e(){var n;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v(null),e.next=4,u();case 4:t(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),v({msg:null!==(n=e.t0.message)&&void 0!==n?n:"".concat(e.t0),type:sn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[u,t,v]),A=Object(m.useCallback)(N()(J.a.mark((function e(){var n;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v(null),e.next=4,u();case 4:l(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),v({msg:null!==(n=e.t0.message)&&void 0!==n?n:"".concat(e.t0),type:sn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[u,l,v]),k=Object(m.useCallback)((function(e){return e.preventDefault()}),[]);return p.a.createElement(en.a,{open:n,onClose:t,onExited:w,disableBackdropClick:o,disableEscapeKeyDown:o,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:k}},p.a.createElement(nn.a,{style:O?{color:M.palette.error.main}:void 0},C),p.a.createElement(le.a,{position:"relative"},(o||a)&&!O&&p.a.createElement(bt,{zIndex:"modal"}),!!O&&j&&p.a.createElement(vt,{opacity:.78,zIndex:"modal",padding:2},p.a.createElement(tn.a,{color:"error"},O)),p.a.createElement(an.a,{dividers:!0},!!O&&!j&&p.a.createElement(tn.a,{color:"error"},O),p.a.createElement(rn.a,{container:!0,spacing:2},p.a.createElement(rn.a,Object.assign({},ja,{justify:"center",container:!0}),p.a.createElement(ga,{style:{margin:M.spacing(1)},label:"start",disabled:a||o||!!j})),p.a.createElement(rn.a,Object.assign({},ja),p.a.createElement(Sn,{disabled:a||o||!!j,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({},ja),p.a.createElement(da,{disabled:a||o||!!j,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({},ja),p.a.createElement(Jt,{disabled:a||o||!!j,fullWidth:!0,required:!0})),p.a.createElement(rn.a,Object.assign({},ja),p.a.createElement(Qt,{disabled:a||o||!!j,fullWidth:!0,required:!0,fiscalYearId:E})),p.a.createElement(rn.a,Object.assign({},ja),p.a.createElement(Dn,{disabled:a||o||!!j,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({},ja),p.a.createElement(mt,{disabled:a||o||!!j,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({},ja),p.a.createElement(Nn,{disabled:a||o||!!j,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({container:!0,justify:"center",alignItems:"flex-start"},ja),p.a.createElement(Un,{disabled:a||o||!!j,label:!0}))))),p.a.createElement(ln.a,null,!j&&p.a.createElement(p.a.Fragment,null,p.a.createElement(on.a,{onClick:R,disabled:a||o||!i,type:"submit",startIcon:p.a.createElement(un.a,null),color:"primary",variant:"contained"},"Add"),p.a.createElement(on.a,{onClick:A,disabled:a||o||!i,type:"submit",startIcon:p.a.createElement(Dt.a,null),variant:"outlined"},"Add & New")),p.a.createElement(on.a,{disabled:o,color:j?"primary":"default",startIcon:!j&&p.a.createElement(cn.a,null),onClick:t},j?"Ok":"Cancel")))},Ma=function(e){var n=e.open,t=e.onClose,a=e.deptId,r=Object(K.c)(wa,{skip:!a,variables:{id:a}}),l=r.loading,o=r.error,i=r.data,u=null==i?void 0:i.department,c=Object(m.useMemo)((function(){return u?{department:u}:{}}),[u]),d=Object(m.useMemo)((function(){return o?{msg:o.message,type:sn.FATAL_ERROR}:null}),[o]),s=Object(K.a)(),f=Object(m.useCallback)((function(e,n){return Pt(s,e,n)}),[s]),v=Object(m.useCallback)((function(){return p.a.createElement(Ca,{open:n,onClose:t,loading:l})}),[n,t,l]);return p.a.createElement(He.a,{initialValues:c,initialStatus:d,enableReinitialize:!0,onSubmit:f},v)};function Ra(){var e=F()(["\n  mutation UpdateEntry(\n    $id: ID!\n    $fields: JournalEntryUpdateFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $paymentMethodUpdate: JournalEntryUpdatePaymentMethod\n    $personAdd: PersonAddFields\n    $businessAdd: BusinessAddFields\n  ) {\n    journalEntryUpdate(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      paymentMethodUpdate: $paymentMethodUpdate\n      personAdd: $personAdd\n      businessAdd: $businessAdd\n    ) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return Ra=function(){return e},e}var Aa=fe()(Ra(),xe),ka=function(){var e=N()(J.a.mark((function e(n,t,a,r){var l,o,u,c,d,s,m,p,f,v,b,y,E,h,g,O,j;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(){var e,n,a,l,o=null!==(n=null===(e=r.category.value[r.category.value.length-1])||void 0===e?void 0:e.id)&&void 0!==n?n:null;return o===(null!==(l=null===(a=t.category.value[t.category.value.length-1])||void 0===a?void 0:a.id)&&void 0!==l?l:null)?null:o}(),u=Object(Ct.a)(t.date.inputValue,r.date.inputValue)?null:r.date.value,c=r.department.id===t.department.id?null:r.department.id,d=(null===(l=r.description)||void 0===l?void 0:l.trim())&&r.description!==t.description?r.description.trim():null,s=0===Fn(r.total.value).compare(Fn(t.total.value))?null:r.total.value,m=r.type===t.type?null:r.type,p=r.reconciled===t.reconciled?null:r.reconciled,w=void 0,C=void 0,M=void 0,R=void 0,A=void 0,w=t.paymentMethod.value[t.paymentMethod.value.length-1],C=r.paymentMethod.value.slice(-2).reverse(),M=U()(C,2),R=M[0],A=M[1],f="string"==typeof R?w.parent&&w.parent.id===Pe?{paymentMethod:null,paymentMethodAdd:null,paymentMethodUpdate:{id:w.id,fields:{active:null,refId:R,name:R}}}:{paymentMethod:null,paymentMethodAdd:{parent:A.id,refId:R,name:R,active:!1},paymentMethodUpdate:null}:R.id!==w.id?{paymentMethod:R.id,paymentMethodAdd:null,paymentMethodUpdate:null}:{paymentMethod:null,paymentMethodAdd:null,paymentMethodUpdate:null},v=f.paymentMethod,b=f.paymentMethodAdd,y=f.paymentMethodUpdate,E=function(){var e=r.source.value[0],n=r.source.value[r.source.value.length-1],a=t.source.value[0],l=t.source.value[t.source.value.length-1];if("string"==typeof n){if(e===i.Person){var o=Object(Tt.parseName)(n);return{source:{sourceType:i.Person,id:""},businessAdd:null,personAdd:{name:{first:o.firstName,last:o.lastName}}}}return{source:{sourceType:i.Business,id:""},businessAdd:{name:n},personAdd:null}}return e===a&&n.id===l.id?{source:null,businessAdd:null,personAdd:null}:{source:{sourceType:function(){switch(n.__typename){case"Business":return i.Business;case"Department":return i.Department;case"Person":return i.Person}}(),id:n.id},personAdd:null,businessAdd:null}}(),h=E.source,g=E.personAdd,O=E.businessAdd,j={id:a,fields:{category:o,date:u,department:c,description:d,total:s,type:m,source:h,reconciled:p,paymentMethod:v},paymentMethodAdd:b,paymentMethodUpdate:y,personAdd:g,businessAdd:O},console.log(j),e.next=13,n.mutate({mutation:Aa,variables:j});case 13:case"end":return e.stop()}var w,C,M,R,A}),e)})));return function(n,t,a,r){return e.apply(this,arguments)}}();function _a(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return Sa(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Sa(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Sa(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function Ia(){var e=F()(["\n  query UpdateEntryIniState($id: ID!) {\n    journalEntry(id: $id) {\n      id\n      __typename\n      type\n      date\n      department {\n        ...DeptEntryOptFragment\n      }\n      category {\n        ...CatEntryOptFragment\n        ancestors {\n          ...CatEntryOptFragment\n        }\n      }\n      source {\n        ...SrcEntryPersonOptFragment\n        ...SrcEntryBizOptFragment\n        ...SrcEntryDeptOptFragment\n        ... on Department {\n          ancestors {\n            ...SrcEntryDeptOptFragment\n            ...SrcEntryBizOptFragment\n          }\n        }\n      }\n      paymentMethod {\n        ...PayMethodEntryOptFragment\n        ancestors {\n          ...PayMethodEntryOptFragment\n        }\n      }\n      description\n      total {\n        n\n        d\n        s\n      }\n      refunds {\n        id\n        __typename\n        deleted\n        date\n        total {\n          n\n          d\n          s\n        }\n      }\n      reconciled\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n"]);return Ia=function(){return e},e}var Da=fe()(Ia(),Hn,Zn,et,tt,nt,at),Ta=new Date(864e13),xa={item:!0,lg:4,sm:6,xs:12},Fa=function(e){var n=e.open,t=e.onClose,a=e.onExited,r=e.journalEntry,l=e.loading,o=e.handleSubmit,i=Object(He.c)(),u=i.resetForm,c=i.isSubmitting,d=i.isValid,s=i.values.date,f=Cn(),v=U()(f,2),b=v[0],y=v[1],E=Object(m.useCallback)((function(e){y({msg:e.message,type:sn.FATAL_ERROR})}),[y]),h=Object(K.c)(Qn,{skip:!(null==s?void 0:s.inputValue),variables:{date:(null==s?void 0:s.value)||""},onError:E}).data,g=Object(m.useMemo)((function(){var e,n;return null!==(n=null===(e=null==h?void 0:h.fiscalYears[0])||void 0===e?void 0:e.id)&&void 0!==n?n:""}),[h]),O=(null==r?void 0:r.refunds)||[],j=Object(m.useMemo)((function(){return O.reduce((function(e,n){var t=U()(e,2),a=t[0],r=t[1],l=n.deleted,o=n.total,i=n.date;return[l?a:a.add(Fn(o)),l?r:Object(jn.a)([r,new Date(i)])]}),[new Ee.a(0),Ta])}),[O]),w=U()(j,2),C=w[0],M=w[1],R=Object(m.useCallback)((function(){a(),u(),y(null)}),[u,a,y]),A=Object(m.useMemo)((function(){return!b||b.type!==sn.FATAL_ERROR&&b.type!==sn.ERROR?[null,null]:[b.msg,b.type===sn.FATAL_ERROR]}),[b]),k=U()(A,2),_=k[0],S=k[1],I=Object(m.useMemo)((function(){var e="Entry Update";return S?"Fatal Error":l?"Loading ".concat(e,"..."):c?"Submitting ".concat(e):e}),[l,S,c]),D=Object(Ze.a)();return p.a.createElement(en.a,{open:n,onClose:t,onExited:R,fullWidth:!0,disableBackdropClick:c,disableEscapeKeyDown:c,maxWidth:"lg",PaperProps:{component:"form",onSubmit:o}},p.a.createElement(nn.a,{style:_?{color:D.palette.error.main}:void 0},I),p.a.createElement(le.a,{position:"relative"},(c||l)&&!_&&p.a.createElement(bt,{zIndex:"modal"}),!!_&&S&&p.a.createElement(vt,{opacity:.78,zIndex:"modal",padding:2},p.a.createElement(tn.a,{color:"error"},_)),p.a.createElement(an.a,{dividers:!0},!!_&&!S&&p.a.createElement(tn.a,{color:"error"},_),p.a.createElement(rn.a,{container:!0,spacing:2},p.a.createElement(rn.a,Object.assign({},xa,{justify:"center",container:!0}),p.a.createElement(ga,{style:{margin:D.spacing(1)},label:"start",disabled:c||l||!!S})),p.a.createElement(rn.a,Object.assign({},xa),p.a.createElement(Sn,{disabled:c||l||!!S,maxDate:M===Ta?void 0:M,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({},xa),p.a.createElement(da,{disabled:c||l||!!S,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({},xa),p.a.createElement(Jt,{disabled:c||l||!!S,fullWidth:!0,required:!0})),p.a.createElement(rn.a,Object.assign({},xa),p.a.createElement(Qt,{disabled:c||l||!!S,fullWidth:!0,required:!0,fiscalYearId:g})),p.a.createElement(rn.a,Object.assign({},xa),p.a.createElement(Dn,{disabled:c||l||!!S,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({},xa),p.a.createElement(mt,{disabled:c||l||!!S,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({},xa),p.a.createElement(Nn,{disabled:c||l||!!S,minTotal:C,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({container:!0,justify:"center",alignItems:"flex-start"},xa),p.a.createElement(Un,{disabled:c||l||!!S,label:!0}))))),p.a.createElement(ln.a,null,!S&&p.a.createElement(on.a,{disabled:c||!d||l,type:"submit",startIcon:p.a.createElement(un.a,null),color:"primary",variant:"contained"},"Update"),p.a.createElement(on.a,{disabled:c,color:S?"primary":"default",startIcon:!S&&p.a.createElement(cn.a,null),onClick:t},S?"Ok":"Cancel")))},Pa=function(e){var n,t=e.entryId,a=e.open,r=e.onClose,l=e.onExited,o=Object(K.c)(Da,{skip:!t,variables:{id:t}}),u=o.loading,c=o.error,d=o.data;c&&(console.log(t,Da),console.error(c));var s=Object(m.useMemo)((function(){return c?{msg:c.message,type:sn.FATAL_ERROR}:null}),[c]),f=null==d?void 0:d.journalEntry,v=Object(m.useMemo)((function(){var e;if(!f)return{};var n={inputValue:new Date(f.date),value:f.date},t=function(){var e=f.category,n=e.ancestors,t=vn()(e,["ancestors"]),a=L()(n).sort((function(e,n){var t,a;return e.id===(null===(t=n.parent)||void 0===t?void 0:t.id)?-1:n.id===(null===(a=e.parent)||void 0===a?void 0:a.id)?1:0}));return a.push(t),{inputValue:"",value:a}}(),a=function(){var e=f.paymentMethod,n=e.ancestors,t=vn()(e,["ancestors"]),a=L()(n).sort((function(e,n){var t,a;return e.id===(null===(t=n.parent)||void 0===t?void 0:t.id)?-1:n.id===(null===(a=e.parent)||void 0===a?void 0:a.id)?1:0}));return a.push(t),{inputValue:"",value:a}}(),r={inputValue:Fn(f.total).round(2).toString(),value:f.total};return{date:n,category:t,paymentMethod:a,department:f.department,total:r,reconciled:f.reconciled,description:null!==(e=f.description)&&void 0!==e?e:null,type:f.type,source:function(){var e=[],n=null==f?void 0:f.source;switch(null==n?void 0:n.__typename){case"Person":e.push(i.Person,n);break;case"Business":e.push(i.Business,n);break;case"Department":e.push(i.Business);var t,a=[],r=_a(n.ancestors);try{for(r.s();!(t=r.n()).done;){var l=t.value;"Business"===l.__typename?e.push(l):a.push(l.id)}}catch(e){r.e(e)}finally{r.f()}var o=e[1];if(a.length>0){var u,c=[],d=_a(o.departments);try{for(d.s();!(u=d.n()).done;){var s=u.value;if(-1!==a.indexOf(s.id)&&c.push(s)===a.length)break}}catch(e){d.e(e)}finally{d.f()}c.sort((function(e,n){return e.id===n.parent.id||o.id||e.parent.id?-1:n.id===e.parent.id?1:0})),e.push.apply(e,c.concat([n]))}}return{inputValue:"",value:e}}()}}),[f]),b=Object(K.a)(),y=Object(m.useCallback)(function(){var e=N()(J.a.mark((function e(n,a){var l;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setStatus(null),e.next=4,ka(b,v,t,n,a);case 4:r(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),a.setStatus({msg:null!==(l=e.t0.message)&&void 0!==l?l:"".concat(e.t0),type:sn.ERROR});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,t){return e.apply(this,arguments)}}(),[b,v,t,r]),E=Object(m.useCallback)((function(e){return p.a.createElement(Fa,{open:a,onClose:r,onExited:l,loading:u,journalEntry:null!=f?f:null,handleSubmit:e.handleSubmit})}),[a,r,l,u,f]);return p.a.createElement(He.a,{initialValues:v,initialStatus:s,journalEntry:null!==(n=null==d?void 0:d.journalEntry)&&void 0!==n?n:null,loading:u,onSubmit:y,enableReinitialize:!0},E)};function $a(){var e=F()(["\n  mutation DeleteEntry($id: ID!) {\n    journalEntryDelete(id: $id) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return $a=function(){return e},e}var Na=fe()($a(),xe),qa=function(e){var n=e.entryId,t=e.onClose,a=Object(K.b)(Na),r=U()(a,2),l=r[0],o=r[1],i=o.loading,u=o.error,c=!!u,d=Object(m.useCallback)((function(){l({variables:{id:n}}).then((function(){return t()}))}),[n,l,t]),s=Object(m.useMemo)((function(){return c?"Error":i?"Deleting Entry...":"Delete Entry"}),[c,i]),f=Object(Ze.a)();return p.a.createElement(en.a,{open:!!n,maxWidth:"sm",fullWidth:!0,disableBackdropClick:i,disableEscapeKeyDown:i,onClose:t},p.a.createElement(nn.a,{style:c?{color:f.palette.error.main}:void 0},s),p.a.createElement(le.a,{position:"relative"},i&&p.a.createElement(bt,{zIndex:"modal"}),p.a.createElement(an.a,null,c&&p.a.createElement(tn.a,{color:"error"},null==u?void 0:u.message),!c&&p.a.createElement(tn.a,null,"Are you sure you want to delete this entry?"))),p.a.createElement(ln.a,null,!c&&p.a.createElement(on.a,{disabled:i,onClick:d,startIcon:p.a.createElement(te.a,null),color:"primary",variant:"contained"},"Delete"),p.a.createElement(on.a,{disabled:i,startIcon:!c&&p.a.createElement(cn.a,null),onClick:t},c?"Close":"Cancel")))};function La(){var e=F()(["\n  mutation DeleteRefund($id: ID!) {\n    journalEntryDeleteRefund(id: $id) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return La=function(){return e},e}var Ba=fe()(La(),xe),Ua=function(e){var n=e.refundId,t=e.onClose,a=Object(K.b)(Ba),r=U()(a,2),l=r[0],o=r[1],i=o.loading,u=o.error,c=!!u,d=Object(m.useCallback)((function(){l({variables:{id:n}}).then((function(){return t()}))}),[n,l,t]),s=Object(m.useMemo)((function(){return c?"Error":i?"Deleting Refund...":"Delete Refund"}),[c,i]),f=Object(Ze.a)();return p.a.createElement(en.a,{open:!!n,maxWidth:"sm",fullWidth:!0,disableBackdropClick:i,disableEscapeKeyDown:i,onClose:t},p.a.createElement(nn.a,{style:c?{color:f.palette.error.main}:void 0},s),p.a.createElement(le.a,{position:"relative"},i&&p.a.createElement(bt,{zIndex:"modal"}),p.a.createElement(an.a,null,c&&p.a.createElement(tn.a,{color:"error"},null==u?void 0:u.message),!c&&p.a.createElement(tn.a,null,"Are you sure you want to delete this refund?"))),p.a.createElement(ln.a,null,!c&&p.a.createElement(on.a,{disabled:i,onClick:d,startIcon:p.a.createElement(te.a,null),color:"primary",variant:"contained"},"Delete"),p.a.createElement(on.a,{disabled:i,startIcon:!c&&p.a.createElement(cn.a,null),onClick:t},c?"Close":"Cancel")))},Wa=t(5810);function Ja(){var e=F()(["\n  mutation AddEntryItem($id: ID!, $fields: JournalEntryAddItemFields!) {\n    journalEntryAddItem(id: $id, fields: $fields) {\n      journalEntry {\n        ...JournalEntry_1Fragment\n      }\n    }\n  }\n  ","\n"]);return Ja=function(){return e},e}var Va=fe()(Ja(),xe),Ga=function(){var e=N()(J.a.mark((function e(n,t,a){var r,l,o,i,u;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=function(){var e,n,t,r=(null===(e=a.category)||void 0===e?void 0:e.value)||[];return null!==(t=null===(n=r[r.length-1])||void 0===n?void 0:n.id)&&void 0!==t?t:null}(),o=function(){var e;return(null===(e=a.department)||void 0===e?void 0:e.id)||null}(),i=a.units,u={id:t,fields:{units:i,category:l,department:o,description:(null===(r=a.description)||void 0===r?void 0:r.trim())||null,total:a.total.value}},e.next=6,n.mutate({mutation:Va,variables:u});case 6:case"end":return e.stop()}}),e)})));return function(n,t,a){return e.apply(this,arguments)}}(),za={min:"1",step:"1",type:"number"},Ya=Symbol(),Ka=function(e){var n,t=e.autoFocus,a=void 0!==t&&t,r=e.disabled,l=void 0!==r&&r,o=e.variant,i=void 0===o?"filled":o,u=vn()(e,["autoFocus","disabled","variant"]),c=Object(m.useCallback)((function(e){return(null!=(e=e||null)?e:Ya)===Ya?"Units Required":0===e?"Cannot be 0":e<0?"Units must be 1 or greater":void 0}),[]),d=Object(He.b)({name:"units",validate:c}),s=U()(d,3),f=s[0],v=s[1],b=s[2].setValue,y=null!==(n=f.value)&&void 0!==n?n:"",E=v.error,h=v.touched,g=Cn(),O=U()(g,1)[0],j=Object(m.useMemo)((function(){return{type:"number",autoFocus:a}}),[a]),w=Object(m.useCallback)((function(e){var n,t=(null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.value)||0;b(Math.max("number"==typeof t?t:Number.parseInt(t),0))}),[b]);return p.a.createElement(In.a,Object.assign({},u,f,{disabled:l||(null==O?void 0:O.type)===sn.FATAL_ERROR,type:"number",value:y,error:h&&!!E,helperText:h&&E?E:void 0,placeholder:"1",label:"Units",name:"units",required:!0,variant:i,inputProps:za,InputProps:j,onChange:w}))};function Xa(){var e=F()(["\n  fragment JournalEntry_3Fragment on JournalEntry {\n    __typename\n    id\n    type\n    total {\n      n\n      d\n      s\n    }\n    date\n    items {\n      id\n      __typename\n      deleted\n      total {\n        n\n        d\n        s\n      }\n    }\n  }\n"]);return Xa=function(){return e},e}var Qa=fe()(Xa());function Ha(){var e=F()(["\n  query GetEntryItemState_1($id: ID!) {\n    journalEntry(id: $id) {\n      ...JournalEntry_3Fragment\n    }\n  }\n  ","\n"]);return Ha=function(){return e},e}var Za=fe()(Ha(),Qa),er={item:!0,lg:4,sm:6,xs:12},nr=function(e){var n,t,a,r,l,o=e.entryId,i=e.open,u=e.onClose,c=e.onExited,d=Object(He.c)(),s=d.resetForm,f=d.isSubmitting,v=d.isValid,b=d.submitForm,y=Cn(),E=U()(y,2),h=E[0],g=E[1],O=Object(m.useCallback)((function(e){return g({msg:e.message,type:sn.FATAL_ERROR})}),[g]),j=Object(K.c)(Za,{skip:!o,variables:{id:o},onError:O}),w=j.loading,C=j.data,M=Object(m.useCallback)((function(e){g({msg:e.message,type:sn.FATAL_ERROR})}),[g]),R=(null===(n=null==C?void 0:C.journalEntry)||void 0===n?void 0:n.date)||"",A=Object(K.c)(Qn,{skip:!R,variables:{date:R},onError:M}).data,k=Object(m.useMemo)((function(){var e,n;return null!==(n=null===(e=null==A?void 0:A.fiscalYears[0])||void 0===e?void 0:e.id)&&void 0!==n?n:""}),[A]),_=null!==(a=null===(t=null==C?void 0:C.journalEntry)||void 0===t?void 0:t.type)&&void 0!==a?a:null,S=null===(r=null==C?void 0:C.journalEntry)||void 0===r?void 0:r.total,I=(null===(l=null==C?void 0:C.journalEntry)||void 0===l?void 0:l.items)||[],D=Object(m.useMemo)((function(){if(S){var e=I.reduce((function(e,n){var t=n.deleted,a=n.total;return t?e:e.add(Fn(a))}),new Ee.a(0));return Fn(S).sub(e)}return new Ee.a(Number.MAX_SAFE_INTEGER)}),[S,I]),T=Object(m.useCallback)((function(){c(),s(),g(null)}),[s,c,g]),x=Object(m.useMemo)((function(){return!h||h.type!==sn.FATAL_ERROR&&h.type!==sn.ERROR?[null,null]:[h.msg,h.type===sn.FATAL_ERROR]}),[h]),F=U()(x,2),P=F[0],$=F[1],q=Object(m.useMemo)((function(){return $?"Fatal Error":w?"Loading ".concat("Add Item","..."):f?"Submitting ".concat("Add Item"):"Add Item"}),[w,$,f]),L=Object(Ze.a)(),B=Object(m.useCallback)(N()(J.a.mark((function e(){var n;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g(null),e.next=4,b();case 4:u(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),g({msg:null!==(n=e.t0.message)&&void 0!==n?n:"".concat(e.t0),type:sn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[b,u,g]),W=Object(m.useCallback)(N()(J.a.mark((function e(){var n;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g(null),e.next=4,b();case 4:s(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),g({msg:null!==(n=e.t0.message)&&void 0!==n?n:"".concat(e.t0),type:sn.ERROR});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[b,s,g]),V=Object(m.useCallback)((function(e){return e.preventDefault()}),[]);return p.a.createElement(en.a,{open:i,onClose:u,onExited:T,disableBackdropClick:f,disableEscapeKeyDown:f,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:V}},p.a.createElement(nn.a,{style:P?{color:L.palette.error.main}:void 0},q),p.a.createElement(le.a,{position:"relative"},(w||f)&&!P&&p.a.createElement(bt,{zIndex:"modal"}),!!P&&$&&p.a.createElement(vt,{opacity:.78,zIndex:"modal",padding:2},p.a.createElement(tn.a,{color:"error"},P)),p.a.createElement(an.a,{dividers:!0},!!P&&!$&&p.a.createElement(tn.a,{color:"error"},P),p.a.createElement(rn.a,{container:!0,spacing:2},p.a.createElement(rn.a,Object.assign({},er),p.a.createElement(Nn,{disabled:w||f,fullWidth:!0,maxTotal:D})),p.a.createElement(rn.a,Object.assign({},er),p.a.createElement(Ka,{disabled:w||f,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({},er),p.a.createElement(Dn,{disabled:w||f,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({},er),p.a.createElement(Jt,{disabled:w||f||!!$,entryType:_,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({},er),p.a.createElement(Qt,{disabled:w||f||!!$,fullWidth:!0,fiscalYearId:k}))))),p.a.createElement(ln.a,null,!$&&p.a.createElement(p.a.Fragment,null,p.a.createElement(on.a,{onClick:B,disabled:w||f||!v,type:"submit",startIcon:p.a.createElement(un.a,null),color:"primary",variant:"contained"},"Add"),p.a.createElement(on.a,{onClick:W,disabled:w||f||!v,type:"submit",startIcon:p.a.createElement(Dt.a,null),variant:"outlined"},"Add & New")),p.a.createElement(on.a,{disabled:w||f,color:$?"primary":"default",startIcon:!$&&p.a.createElement(cn.a,null),onClick:u},$?"Ok":"Cancel")))},tr=function(e){var n=e.entryId,t=e.open,a=e.onClose,r=e.onExited,l=Object(m.useMemo)((function(){return{}}),[]),o=Object(K.a)(),i=Object(m.useCallback)((function(e,t){return Ga(o,n||"",e,t)}),[o,n]),u=Object(m.useCallback)((function(e){return p.a.createElement(nr,{entryId:n,open:t,onClose:a,onExited:r,handleSubmit:e.handleSubmit})}),[n,t,a,r]);return p.a.createElement(He.a,{initialValues:l,initialStatus:null,enableReinitialize:!0,onSubmit:i},u)};function ar(){var e=F()(["\n  mutation UpdateEntryItem($id: ID!, $fields: JournalEntryUpdateItemFields!) {\n    journalEntryUpdateItem(id: $id, fields: $fields) {\n      journalEntryItem {\n        ...JournalEntryItem_1Fragment\n      }\n    }\n  }\n  ","\n"]);return ar=function(){return e},e}var rr=fe()(ar(),Te),lr=function(){var e=N()(J.a.mark((function e(n,t,a,r){var l,o,i,u,c,d,s,m,p,f,v;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=r.description!==t.description&&(null===(l=r.description)||void 0===l?void 0:l.trim())||null,s=(null===(o=r.department)||void 0===o?void 0:o.id)===(null===(i=t.department)||void 0===i?void 0:i.id)?null:null!==(c=null===(u=r.department)||void 0===u?void 0:u.id)&&void 0!==c?c:null,m=function(){var e,n,a,l,o=null!==(n=null===(e=r.category.value[r.category.value.length-1])||void 0===e?void 0:e.id)&&void 0!==n?n:null;return o===(null!==(l=null===(a=t.category.value[t.category.value.length-1])||void 0===a?void 0:a.id)&&void 0!==l?l:null)?null:o}(),p=r.units===t.units?null:r.units,f=0===Fn(r.total.value).compare(Fn(t.total.value))?null:r.total.value,v={id:a,fields:{units:p,description:d,department:s,category:m,total:f}},e.next=8,n.mutate({mutation:rr,variables:v});case 8:case"end":return e.stop()}}),e)})));return function(n,t,a,r){return e.apply(this,arguments)}}();function or(){var e=F()(["\n  query UpdateItemIniState($entryId: ID!, $itemId: ID!) {\n    journalEntry(id: $entryId) {\n      ...JournalEntry_3Fragment\n    }\n    journalEntryItem(id: $itemId) {\n      __typename\n      id\n      department {\n        ...DeptEntryOptFragment\n      }\n      category {\n        ...CatEntryOptFragment\n        ancestors {\n          ...CatEntryOptFragment\n        }\n      }\n      description\n      units\n      total {\n        n\n        d\n        s\n      }\n    }\n  }\n  ","\n  ","\n  ","\n"]);return or=function(){return e},e}var ir=fe()(or(),Qa,Hn,Zn),ur={item:!0,lg:4,sm:6,xs:12},cr=function(e){var n,t=e.itemId,a=e.open,r=e.onClose,l=e.onExited,o=e.journalEntry,i=e.loading,u=e.handleSubmit,c=Object(He.c)(),d=c.resetForm,s=c.isSubmitting,f=c.isValid,v=Cn(),b=U()(v,2),y=b[0],E=b[1],h=Object(m.useCallback)((function(e){E({msg:e.message,type:sn.FATAL_ERROR})}),[E]),g=(null==o?void 0:o.date)||"",O=Object(K.c)(Qn,{skip:!g,variables:{date:g},onError:h}).data,j=Object(m.useMemo)((function(){var e,n;return null!==(n=null===(e=null==O?void 0:O.fiscalYears[0])||void 0===e?void 0:e.id)&&void 0!==n?n:""}),[O]),w=null!==(n=null==o?void 0:o.type)&&void 0!==n?n:null,C=null==o?void 0:o.total,M=(null==o?void 0:o.items)||[],R=Object(m.useMemo)((function(){if(C){var e=M.reduce((function(e,n){var a=n.id,r=n.deleted,l=n.total;return r||a===t?e:e.add(Fn(l))}),new Ee.a(0));return Fn(C).sub(e)}return new Ee.a(Number.MAX_SAFE_INTEGER)}),[C,M,t]),A=Object(m.useCallback)((function(){l(),d(),E(null)}),[d,l,E]),k=Object(m.useMemo)((function(){return!y||y.type!==sn.FATAL_ERROR&&y.type!==sn.ERROR?[null,null]:[y.msg,y.type===sn.FATAL_ERROR]}),[y]),_=U()(k,2),S=_[0],I=_[1],D=Object(m.useMemo)((function(){var e="Item Update";return I?"Fatal Error":i?"Loading ".concat(e,"..."):s?"Submitting ".concat(e):e}),[i,I,s]),T=Object(Ze.a)();return p.a.createElement(en.a,{open:a,onClose:r,onExited:A,disableBackdropClick:s,disableEscapeKeyDown:s,fullWidth:!0,maxWidth:"lg",PaperProps:{component:"form",onSubmit:u}},p.a.createElement(nn.a,{style:S?{color:T.palette.error.main}:void 0},D),p.a.createElement(le.a,{position:"relative"},(i||s)&&!S&&p.a.createElement(bt,{zIndex:"modal"}),!!S&&I&&p.a.createElement(vt,{opacity:.78,zIndex:"modal",padding:2},p.a.createElement(tn.a,{color:"error"},S)),p.a.createElement(an.a,{dividers:!0},!!S&&!I&&p.a.createElement(tn.a,{color:"error"},S),p.a.createElement(rn.a,{container:!0,spacing:2},p.a.createElement(rn.a,Object.assign({},ur),p.a.createElement(Nn,{disabled:i||s,fullWidth:!0,maxTotal:R})),p.a.createElement(rn.a,Object.assign({},ur),p.a.createElement(Ka,{disabled:i||s,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({},ur),p.a.createElement(Dn,{disabled:i||s,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({},ur),p.a.createElement(Jt,{disabled:i||s||!!I,entryType:w,fullWidth:!0})),p.a.createElement(rn.a,Object.assign({},ur),p.a.createElement(Qt,{disabled:i||s||!!I,fullWidth:!0,fiscalYearId:j}))))),p.a.createElement(ln.a,null,!I&&p.a.createElement(on.a,{disabled:i||s||!f,type:"submit",startIcon:p.a.createElement(un.a,null),color:"primary",variant:"contained"},"Update"),p.a.createElement(on.a,{disabled:i||s||!!I,color:I?"primary":"default",startIcon:!I&&p.a.createElement(cn.a,null),onClick:r},I?"Ok":"Cancel")))},dr=function(e){var n=e.entryId,t=e.itemId,a=e.open,r=e.onClose,l=e.onExited,o=Object(K.c)(ir,{skip:!n,variables:{entryId:n,itemId:t}}),i=o.loading,u=o.error,c=o.data,d=Object(m.useMemo)((function(){return u?{msg:u.message,type:sn.FATAL_ERROR}:null}),[u]),s=null==c?void 0:c.journalEntryItem,f=Object(m.useMemo)((function(){var e,n;if(!s)return{};var t={inputValue:Fn(s.total).round(2).toString(),value:s.total},a=function(){if(!s.category)return{inputValue:"",value:[]};var e=s.category,n=e.ancestors,t=vn()(e,["ancestors"]),a=L()(n).sort((function(e,n){var t,a;return e.id===(null===(t=n.parent)||void 0===t?void 0:t.id)?-1:n.id===(null===(a=e.parent)||void 0===a?void 0:a.id)?1:0}));return a.push(t),{inputValue:"",value:a}}(),r=null!==(e=s.department)&&void 0!==e?e:null,l=null!==(n=s.description)&&void 0!==n?n:null;return{total:t,units:s.units,category:a,department:r,description:l}}),[s]),v=Object(K.a)(),b=Object(m.useCallback)(function(){var e=N()(J.a.mark((function e(n,a){var l;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=5;break}return a.setStatus({msg:'Failed to load initial values for item "'.concat(t,'".'),type:sn.FATAL_ERROR}),e.abrupt("return");case 5:if(t){e.next=8;break}return a.setStatus({msg:"No item ID.",type:sn.FATAL_ERROR}),e.abrupt("return");case 8:return e.prev=8,a.setStatus(null),e.next=12,lr(v,f,t,n,a);case 12:r(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),a.setStatus({msg:null!==(l=null===e.t0||void 0===e.t0?void 0:e.t0.message)&&void 0!==l?l:"".concat(e.t0),type:sn.FATAL_ERROR});case 18:case"end":return e.stop()}}),e,null,[[8,15]])})));return function(n,t){return e.apply(this,arguments)}}(),[v,f,r,t]),y=Object(m.useCallback)((function(e){var o;return p.a.createElement(cr,{entryId:n,itemId:t,open:a,onClose:r,onExited:l,journalEntry:null!==(o=null==c?void 0:c.journalEntry)&&void 0!==o?o:null,loading:i,handleSubmit:e.handleSubmit})}),[c,n,i,r,l,a,t]);return p.a.createElement(He.a,{initialValues:null!=f?f:{},initialStatus:d,enableReinitialize:!0,onSubmit:b},y)};function sr(){var e=F()(["\n  mutation DeleteItem($id: ID!) {\n    journalEntryDeleteItem(id: $id) {\n      journalEntryItem {\n        id\n        __typename\n        deleted\n      }\n    }\n  }\n"]);return sr=function(){return e},e}var mr=fe()(sr()),pr=function(e){var n=e.itemId,t=e.onClose,a=Object(K.b)(mr),r=U()(a,2),l=r[0],o=r[1],i=o.loading,u=o.error,c=!!u,d=Object(m.useCallback)((function(){l({variables:{id:n}}).then((function(){return t()}))}),[n,l,t]),s=Object(m.useMemo)((function(){return c?"Error":i?"Deleting Item...":"Delete Item"}),[c,i]),f=Object(Ze.a)();return p.a.createElement(en.a,{open:!!n,maxWidth:"sm",fullWidth:!0,disableBackdropClick:i,disableEscapeKeyDown:i,onClose:t},p.a.createElement(nn.a,{style:c?{color:f.palette.error.main}:void 0},s),p.a.createElement(le.a,{position:"relative"},i&&p.a.createElement(bt,{zIndex:"modal"}),p.a.createElement(an.a,null,c&&p.a.createElement(tn.a,{color:"error"},null==u?void 0:u.message),!c&&p.a.createElement(tn.a,null,"Are you sure you want to delete this item?"))),p.a.createElement(ln.a,null,!c&&p.a.createElement(on.a,{disabled:i,onClick:d,startIcon:p.a.createElement(te.a,null),color:"primary",variant:"contained"},"Delete"),p.a.createElement(on.a,{disabled:i,startIcon:!c&&p.a.createElement(cn.a,null),onClick:t},c?"Close":"Cancel")))},fr=function(e){var n,t,a=e.entry,r=a.items,l=a.category,o=a.description,i=a.department,u=a.id,c=Object(m.useState)(!1),d=U()(c,2),s=d[0],f=d[1],v=Object(m.useState)(null),b=U()(v,2),y=b[0],E=b[1],h=Object(m.useCallback)((function(){f(!1)}),[f]),g=Object(m.useCallback)((function(){E(null)}),[E]),O=Object(m.useState)(!1),j=U()(O,2),w=j[0],C=j[1],M=Object(m.useState)(null),R=U()(M,2),A=R[0],k=R[1],_=Object(m.useState)(null),S=U()(_,2),I=S[0],D=S[1],T=Object(m.useCallback)((function(){D(null)}),[D]),x=Object(m.useCallback)((function(){C(!1)}),[C]),F=Object(m.useCallback)((function(){k(null)}),[k]),P=Object(m.useMemo)((function(){return[{icon:te.a,tooltip:"Delete Item",onClick:function(e,n){return D(n.id)}},{icon:ae.a,tooltip:"Edit Item",onClick:function(e,n){C(!0),k({entryId:u,itemId:n.id})}},{icon:function(e){return p.a.createElement(re.a,Object.assign({},e))},iconProps:{color:"secondary",fontSize:"large"},tooltip:"Add Item",isFreeAction:!0,onClick:function(){f(!0),E(u)}}]}),[u]),$=Object(m.useMemo)((function(){return[{field:"total",title:"Total",render:function(e){var n=e.total;return Q()(Fn(n).valueOf()).format("$0,0.00")}},{field:"units",title:"Units"},{field:"description",title:"Description",render:function(e){var n;return(null===(n=e.description)||void 0===n?void 0:n.trim())||o}},{field:"category",title:"Category",render:function(e){var n,t,a=null!==(t=null===(n=e.category)||void 0===n?void 0:n.name)&&void 0!==t?t:l.name;return Object(H.a)(a)}},{field:"department",title:"Department",render:function(e){var n,t,a=null!==(t=null===(n=e.department)||void 0===n?void 0:n.name)&&void 0!==t?t:i.name;return Object(H.a)(a)}}]}),[l,o,i]),N=Object(m.useMemo)((function(){return{search:!1,emptyRowsWhenPaging:!1}}),[]),q=Object(m.useMemo)((function(){return r.filter((function(e){return!e.deleted}))}),[r]),L=Object(Ze.a)(),B=Object(m.useMemo)((function(){return{boxShadow:L.shadows[0]}}),[L.shadows]),W=Object(m.useMemo)((function(){return{backgroundColor:L.palette.primary.main}}),[L.palette.primary.main]);return p.a.createElement(le.a,null,p.a.createElement(Y.a,{title:"Items",actions:P,options:N,columns:$,icons:Qe,data:q,style:B}),p.a.createElement(tr,{entryId:y,open:s,onClose:h,onExited:g}),p.a.createElement(dr,{entryId:null!==(n=null==A?void 0:A.entryId)&&void 0!==n?n:null,itemId:null!==(t=null==A?void 0:A.itemId)&&void 0!==t?t:null,open:w,onClose:x,onExited:F}),p.a.createElement(pr,{itemId:I,onClose:T}),p.a.createElement(Wa.a,{style:W}))},vr=t(296),br=t(360),yr=function(e){var n=e.setFilter,t=Object(m.useState)("None"),a=U()(t,2),r=a[0],l=a[1],o=Object(m.useCallback)((function(e){var t=e.target.value;switch(t){case"Reconciled":n({reconciled:{$eq:!0}});break;case"Unreconciled":n({reconciled:{$eq:!1}});break;case"None":n({})}l(t)}),[n,l]);return p.a.createElement(pa.a,{title:"None"===r?"No Filter":r},p.a.createElement(vr.a,{startAdornment:p.a.createElement(Tn.a,{disablePointerEvents:!0,position:"start"},p.a.createElement(We.a,null)),onChange:o,fullWidth:!0,value:"None"===r?"":r},p.a.createElement(br.a,{value:"None"},"None"),p.a.createElement(br.a,{value:"Reconciled"},"Reconciled"),p.a.createElement(br.a,{value:"Unreconciled"},"Unreconciled")))},Er=t(375),hr=t(240);function gr(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return Or(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Or(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Or(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var jr=function(e){var n=e.setFilter,t=e.options,a=Object(m.useState)([]),r=U()(a,2),l=r[0],o=r[1],i=Object(m.useMemo)((function(){var e,n=[],a=new Map,r=gr(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;a.set(o.id,o.name),n.push(p.a.createElement(br.a,{key:o.id,value:o.id},p.a.createElement(Ln.a,{checked:l.includes(o.id)}),p.a.createElement(Er.a,{primary:o.name})))}}catch(e){r.e(e)}finally{r.f()}return[n,a]}),[t,l]),u=U()(i,2),c=u[0],d=u[1],s=Object(m.useCallback)((function(e){return e.map((function(e){var n;return null!==(n=d.get(e))&&void 0!==n?n:""})).join(", ")}),[d]),f=Object(m.useCallback)((function(e){var t=e.target.value||[];0===t.length?n({}):n({"category.id":{$in:t}}),o(t)}),[n]);return p.a.createElement(pa.a,{title:0===l.length?"No Filter":s(l)},p.a.createElement(le.a,{maxWidth:250},p.a.createElement(vr.a,{startAdornment:p.a.createElement(Tn.a,{disablePointerEvents:!0,position:"start"},p.a.createElement(We.a,null)),fullWidth:!0,multiple:!0,value:l,onChange:f,input:p.a.createElement(hr.a,null),renderValue:s},c)))};function wr(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return Cr(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Cr(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Cr(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var Mr=function(e){var n=e.setFilter,t=e.options,a=Object(m.useState)([]),r=U()(a,2),l=r[0],o=r[1],i=Object(m.useMemo)((function(){var e,n=[],a=new Map,r=wr(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;a.set(o.id,o.name),n.push(p.a.createElement(br.a,{key:o.id,value:o.id},p.a.createElement(Ln.a,{checked:l.includes(o.id)}),p.a.createElement(Er.a,{primary:o.name})))}}catch(e){r.e(e)}finally{r.f()}return[n,a]}),[t,l]),u=U()(i,2),c=u[0],d=u[1],s=Object(m.useCallback)((function(e){return e.map((function(e){var n;return null!==(n=d.get(e))&&void 0!==n?n:""})).join(", ")}),[d]),f=Object(m.useCallback)((function(e){var t=e.target.value||[];0===t.length?n({}):n({$or:[{"paymentMethod.id":{$in:t}},{"paymentMethod.parent.id":{$in:t}}]}),o(t)}),[n]);return p.a.createElement(pa.a,{title:0===l.length?"No Filter":s(l)},p.a.createElement(le.a,{maxWidth:250},p.a.createElement(vr.a,{startAdornment:p.a.createElement(Tn.a,{disablePointerEvents:!0,position:"start"},p.a.createElement(We.a,null)),fullWidth:!0,multiple:!0,value:l,onChange:f,input:p.a.createElement(hr.a,null),renderValue:s},c)))};function Rr(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return Ar(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ar(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Ar(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var kr=function(e){var n=e.setFilter,t=e.options,a=Object(m.useState)([]),r=U()(a,2),l=r[0],o=r[1],i=Object(m.useMemo)((function(){var e,n=[],a=new Map,r=Rr(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;a.set(o.id,o.name),n.push(p.a.createElement(br.a,{key:o.id,value:o.id},p.a.createElement(Ln.a,{checked:l.includes(o.id)}),p.a.createElement(Er.a,{primary:o.name})))}}catch(e){r.e(e)}finally{r.f()}return[n,a]}),[t,l]),u=U()(i,2),c=u[0],d=u[1],s=Object(m.useCallback)((function(e){return e.map((function(e){var n;return null!==(n=d.get(e))&&void 0!==n?n:""})).join(", ")}),[d]),f=Object(m.useCallback)((function(e){var t=e.target.value||[];0===t.length?n({}):n({"department.id":{$in:t}}),o(t)}),[n]);return p.a.createElement(pa.a,{title:0===l.length?"No Filter":s(l)},p.a.createElement(le.a,{maxWidth:250},p.a.createElement(vr.a,{startAdornment:p.a.createElement(Tn.a,{disablePointerEvents:!0,position:"start"},p.a.createElement(We.a,null)),fullWidth:!0,multiple:!0,value:l,onChange:f,input:p.a.createElement(hr.a,null),renderValue:s},c)))};function _r(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return Sr(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Sr(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Sr(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var Ir,Dr=function(e){var n=e.setFilter,t=e.options,a=Object(m.useState)([]),r=U()(a,2),l=r[0],o=r[1],i=Object(m.useMemo)((function(){var e,n,a,r,o=[],i=new Map,u=_r(t);try{for(u.s();!(e=u.n()).done;)n=void 0,a=void 0,r=void 0,n=e.value,a=function(){switch(n.__typename){case"Person":return"".concat(n.name.first," ").concat(n.name.last);case"Business":return n.bizName;case"Department":return n.deptName}}(),r="".concat(n.__typename,"-").concat(n.id),i.set(r,a),o.push(p.a.createElement(br.a,{key:r,value:r},p.a.createElement(Ln.a,{checked:l.includes(r)}),p.a.createElement(Er.a,{primary:a})))}catch(e){u.e(e)}finally{u.f()}return[o,i]}),[t,l]),u=U()(i,2),c=u[0],d=u[1],s=Object(m.useCallback)((function(e){return e.map((function(e){var n;return null!==(n=d.get(e))&&void 0!==n?n:""})).join(", ")}),[d]),f=Object(m.useCallback)((function(e){var t=e.target.value||[];0===t.length?n({}):n({$or:t.map((function(e){var n=e.split("-"),t=U()(n,2),a=t[0];return{"source.id":t[1],"source.__typename":a}}))}),o(t)}),[n]);return p.a.createElement(pa.a,{title:0===l.length?"No Filter":s(l)},p.a.createElement(le.a,{maxWidth:250},p.a.createElement(vr.a,{startAdornment:p.a.createElement(Tn.a,{disablePointerEvents:!0,position:"start"},p.a.createElement(We.a,null)),fullWidth:!0,multiple:!0,value:l,onChange:f,input:p.a.createElement(hr.a,null),renderValue:s},c)))},Tr=t(193),xr=t(421),Fr=t(5837),Pr=t(194),$r=t(5836);function Nr(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return qr(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return qr(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function qr(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}!function(e){e[e.None=1]="None",e[e.Equal=2]="Equal",e[e.GreaterThan=3]="GreaterThan",e[e.LessThan=4]="LessThan",e[e.GreaterThanOrEqual=5]="GreaterThanOrEqual",e[e.LessThanOrEqual=6]="LessThanOrEqual"}(Ir||(Ir={}));var Lr,Br=function(e,n){if(!e)return[void 0,void 0,[Ir.None]];switch(n){case Ir.None:case Ir.Equal:return[void 0,void 0,[Ir.None]];case Ir.GreaterThan:case Ir.GreaterThanOrEqual:return[Object(Pr.a)(e,1),void 0,[Ir.None,Ir.LessThan,Ir.LessThanOrEqual]];case Ir.LessThan:case Ir.LessThanOrEqual:return[void 0,Object($r.a)(e,1),[Ir.None,Ir.GreaterThan,Ir.GreaterThanOrEqual]]}},Ur=new Date(864e13),Wr=new Date(-864e13),Jr=function(e){var n=e.setFilter,t=Object(m.useState)(""),a=U()(t,2),r=a[0],l=a[1],o=Object(m.useState)(Ir.Equal),i=U()(o,2),u=i[0],c=i[1],d=Object(m.useState)(null),s=U()(d,2),f=s[0],v=s[1],b=Object(m.useState)(Ir.None),y=U()(b,2),E=y[0],h=y[1],g=Object(m.useState)(null),O=U()(g,2),j=O[0],w=O[1],C=Object(m.useMemo)((function(){return Br(f,u)}),[f,u]),M=U()(C,3),R=M[0],A=M[1],k=M[2],_=Object(m.useCallback)((function(e){if(0===e.length)return l(""),void n({});var t,a,r,o,i,u,c,d,s=[],m=[],p=Nr(e);try{for(p.s();!(t=p.n()).done;)a=void 0,r=void 0,o=void 0,i=void 0,u=void 0,c=void 0,d=void 0,a=t.value,r=a.op,o=a.date,i=function(){switch(r){case Ir.Equal:return["$eq","="];case Ir.GreaterThan:return["$gt",">"];case Ir.GreaterThanOrEqual:return["$gte",">="];case Ir.LessThan:return["$lt","<"];case Ir.LessThanOrEqual:return["$lte","<="];case Ir.None:return["",""]}}(),u=U()(i,2),c=u[0],d=u[1],s.push({date:G()({},c,Object(be.a)(o))}),m.push("".concat(d,"[").concat(Object(ve.a)(o,"d/M/yy"),"]"))}catch(e){p.e(e)}finally{p.f()}l(m.join(" & ")),n({$and:s})}),[n]),S=Object(m.useCallback)((function(e){var n,t=null!==(n=e.target.value)&&void 0!==n?n:Ir.Equal;c(t);var a=Br(f,t),r=U()(a,3)[2].includes(E);if(r||(h(Ir.None),w(null)),f){var l=[{op:t,date:f}];r&&E!==Ir.None&&E!==Ir.Equal&&j&&l.push({op:E,date:j}),_(l)}}),[f,j,E,_]),I=Object(m.useCallback)((function(e){var n,t=null!==(n=e.target.value)&&void 0!==n?n:Ir.None;h(t),t===Ir.None?(w(null),_(f?[{op:u,date:f}]:[])):j&&_([{op:u,date:f},{op:t,date:j}])}),[f,j,u,_]),D=Object(m.useCallback)((function(e){if(!e||Object(hn.a)(e))if(v(e),e){var n=[{op:u,date:e}];if(j){var t=Br(e,u),a=U()(t,2),r=a[0],l=a[1];E!==Ir.None&&E!==Ir.Equal&&r&&j>=r||l&&j<=l?n.push({op:E,date:j}):(h(Ir.None),w(null))}_(n)}else _([]),h(Ir.None),w(null)}),[j,u,E,_]),T=Object(m.useCallback)((function(e){e&&!Object(hn.a)(e)||(w(e),e?_([{op:u,date:f},{op:E,date:e}]):(_(f?[{op:u,date:f}]:[]),w(null)))}),[f,u,E,_]),x=Object(m.useCallback)((function(e){e.stopPropagation(),c(Ir.Equal),v(null),h(Ir.None),w(null),_([])}),[_]),F=Object(m.useMemo)((function(){return{startAdornment:p.a.createElement(Tn.a,{disablePointerEvents:!0,position:"start"},p.a.createElement(We.a,null)),endAdornment:f?p.a.createElement(Tn.a,{position:"end"},p.a.createElement(Tr.a,{onClick:x},p.a.createElement(qe.a,null))):p.a.createElement(Tn.a,{disablePointerEvents:!0,position:"end"},p.a.createElement(Fr.a,null))}}),[f,x]),P=Object(m.useState)(null),$=U()(P,2),N=$[0],q=$[1],L=Object(m.useCallback)((function(e){q(e.currentTarget)}),[]),B=Object(m.useCallback)((function(){q(null)}),[]);return p.a.createElement(le.a,null,p.a.createElement(pa.a,{title:r||"No Filter"},p.a.createElement(le.a,{maxWidth:250},p.a.createElement(In.a,{fullWidth:!0,value:r,InputProps:F,onClick:L}))),p.a.createElement(xr.a,{onClose:B,open:!!N,anchorEl:N},p.a.createElement(le.a,{maxWidth:350,margin:2,clone:!0},p.a.createElement(rn.a,{container:!0,spacing:2},p.a.createElement(rn.a,{xs:12,item:!0},p.a.createElement(le.a,{marginTop:1},p.a.createElement(vr.a,{value:u,onChange:S},p.a.createElement(br.a,{value:Ir.Equal},p.a.createElement(me.e,null)),p.a.createElement(br.a,{value:Ir.GreaterThan},p.a.createElement(me.h,null)),p.a.createElement(br.a,{value:Ir.LessThan},p.a.createElement(me.j,null)),p.a.createElement(br.a,{value:Ir.GreaterThanOrEqual},p.a.createElement(me.i,null)),p.a.createElement(br.a,{value:Ir.LessThanOrEqual},p.a.createElement(me.k,null)))),p.a.createElement(bn.a,{utils:En.default},p.a.createElement(yn.b,{onChange:D,value:f,format:"MM/dd/yyyy",placeholder:"mm/dd/yyyy",margin:"none",label:"Date",animateYearScrolling:!0,disableToolbar:!0,autoOk:!0,variant:"inline"}))),!!f&&u!==Ir.Equal&&p.a.createElement(rn.a,{xs:12,item:!0},p.a.createElement(le.a,{marginTop:1},p.a.createElement(vr.a,{value:E,onChange:I},p.a.createElement(br.a,{value:Ir.None},"None"),p.a.createElement(br.a,{style:{display:"None"},value:Ir.Equal},p.a.createElement(me.e,null)),p.a.createElement(br.a,{style:k.includes(Ir.GreaterThan)?void 0:{display:"none"},disabled:!k.includes(Ir.GreaterThan),value:Ir.GreaterThan},p.a.createElement(me.h,null)),p.a.createElement(br.a,{style:k.includes(Ir.LessThan)?void 0:{display:"none"},disabled:!k.includes(Ir.LessThan),value:Ir.LessThan},p.a.createElement(me.j,null)),p.a.createElement(br.a,{style:k.includes(Ir.GreaterThanOrEqual)?void 0:{display:"none"},disabled:!k.includes(Ir.GreaterThanOrEqual),value:Ir.GreaterThanOrEqual},p.a.createElement(me.i,null)),p.a.createElement(br.a,{style:k.includes(Ir.LessThanOrEqual)?void 0:{display:"none"},disabled:!k.includes(Ir.LessThanOrEqual),value:Ir.LessThanOrEqual},p.a.createElement(me.k,null)))),p.a.createElement(bn.a,{utils:En.default},p.a.createElement(yn.b,{disabled:E===Ir.None,minDate:R||Wr,maxDate:A||Ur,onChange:T,value:j,format:"MM/dd/yyyy",placeholder:"mm/dd/yyyy",margin:"none",label:"Date",animateYearScrolling:!0,disableToolbar:!0,autoOk:!0,variant:"inline"})))))))};function Vr(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return Gr(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Gr(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Gr(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}!function(e){e[e.None=1]="None",e[e.Equal=2]="Equal",e[e.GreaterThan=3]="GreaterThan",e[e.LessThan=4]="LessThan",e[e.GreaterThanOrEqual=5]="GreaterThanOrEqual",e[e.LessThanOrEqual=6]="LessThanOrEqual"}(Lr||(Lr={}));var zr,Yr=function(e,n){if(!e)return[void 0,void 0,[Lr.None]];switch(n){case Lr.None:case Lr.Equal:return[void 0,void 0,[Lr.None]];case Lr.GreaterThan:case Lr.GreaterThanOrEqual:return[e.add(new Ee.a({n:1,d:100})),void 0,[Lr.None,Lr.LessThan,Lr.LessThanOrEqual]];case Lr.LessThan:case Lr.LessThanOrEqual:return[void 0,e.sub(new Ee.a({n:1,d:100})),[Lr.None,Lr.GreaterThan,Lr.GreaterThanOrEqual]]}},Kr={type:"number",startAdornment:p.a.createElement(Tn.a,{position:"start"},"$")},Xr=function(e){var n=e.setFilter,t=Object(m.useState)(""),a=U()(t,2),r=a[0],l=a[1],o=Object(m.useState)(Lr.Equal),i=U()(o,2),u=i[0],c=i[1],d=Object(m.useState)(""),s=U()(d,2),f=s[0],v=s[1],b=Object(m.useState)(Lr.None),y=U()(b,2),E=y[0],h=y[1],g=Object(m.useState)(""),O=U()(g,2),j=O[0],w=O[1],C=Object(m.useMemo)((function(){return Yr(f?new Ee.a(f):null,u)}),[f,u]),M=U()(C,3),R=M[0],A=M[1],k=M[2],_=Object(m.useMemo)((function(){return{min:R?R.toString():"0.00",max:A?A.toString():void 0,step:"0.01"}}),[R,A]),S=Object(m.useCallback)((function(e){if(0===e.length)return l(""),void n({});var t,a,r,o,i,u,c,d,s=[],m=[],p=Vr(e);try{for(p.s();!(t=p.n()).done;)a=void 0,r=void 0,o=void 0,i=void 0,u=void 0,c=void 0,d=void 0,a=t.value,r=a.op,o=a.total,i=function(){switch(r){case Lr.Equal:return["$eq","="];case Lr.GreaterThan:return["$gt",">"];case Lr.GreaterThanOrEqual:return["$gte",">="];case Lr.LessThan:return["$lt","<"];case Lr.LessThanOrEqual:return["$lte","<="];case Lr.None:return["",""]}}(),u=U()(i,2),c=u[0],d=u[1],s.push({total:G()({},c,o)}),m.push("".concat(d,"[").concat(o,"]"))}catch(e){p.e(e)}finally{p.f()}l(m.join(" & ")),n({$and:s})}),[n]),I=Object(m.useCallback)((function(e){var n,t=null!==(n=e.target.value)&&void 0!==n?n:Lr.Equal;c(t);var a=Yr(f?new Ee.a(f):null,t),r=U()(a,3)[2].includes(E);if(r||(h(Lr.None),w("")),f){var l=[{op:t,total:new Ee.a(f).valueOf()}];if(r&&E!==Lr.None&&E!==Lr.Equal&&j){var o=new Ee.a(j);l.push({op:E,total:o.valueOf()})}S(l)}}),[f,j,E,S]),D=Object(m.useCallback)((function(e){var n,t=null!==(n=e.target.value)&&void 0!==n?n:Lr.None;if(h(t),t===Lr.None)if(w(""),f){var a=new Ee.a(f);S([{op:u,total:a.valueOf()}])}else S([]);else if(j){var r=new Ee.a(f),l=new Ee.a(j);S([{op:u,total:r.valueOf()},{op:t,total:l.valueOf()}])}}),[f,j,u,S]),T=Object(m.useCallback)((function(e){var n=e.target.value.trim();if(n){var t=new Ee.a(n).round(2);l(t.toString()),v(n);var a=[{op:u,total:t.valueOf()}];if(j){var r=Yr(t,u),o=U()(r,2),i=o[0],c=o[1],d=new Ee.a(j);E!==Lr.None&&E!==Lr.Equal&&i&&d.compare(i)>=0||c&&d.compare(c)<=0?a.push({op:E,total:d.valueOf()}):(h(Lr.None),w(""))}S(a)}else l(n),S([]),h(Lr.None),w("")}),[u,j,S,E]),x=Object(m.useCallback)((function(e){var n=e.target.value.trim();if(n){var t=new Ee.a(f),a=new Ee.a(n).round(2);w(n),S([{op:u,total:t.valueOf()},{op:E,total:a.valueOf()}])}else{if(f){var r=new Ee.a(f);S([{op:u,total:r.valueOf()}])}else S([]);w("")}}),[f,u,E,S]),F=Object(m.useCallback)((function(e){e.stopPropagation(),c(Lr.Equal),v(""),h(Lr.None),w(""),S([])}),[S]),P=Object(m.useMemo)((function(){return{startAdornment:p.a.createElement(Tn.a,{disablePointerEvents:!0,position:"start"},p.a.createElement(We.a,null)),endAdornment:f?p.a.createElement(Tn.a,{position:"end"},p.a.createElement(Tr.a,{onClick:F},p.a.createElement(qe.a,null))):p.a.createElement(Tn.a,{disablePointerEvents:!0,position:"end"},p.a.createElement(Fr.a,null))}}),[f,F]),$=Object(m.useState)(null),N=U()($,2),q=N[0],L=N[1],B=Object(m.useCallback)((function(e){L(e.currentTarget)}),[]),W=Object(m.useCallback)((function(){L(null)}),[]);return p.a.createElement(le.a,null,p.a.createElement(pa.a,{title:r||"No Filter"},p.a.createElement(le.a,{maxWidth:250},p.a.createElement(In.a,{fullWidth:!0,value:r,InputProps:P,onClick:B}))),p.a.createElement(xr.a,{onClose:W,open:!!q,anchorEl:q},p.a.createElement(le.a,{maxWidth:350,margin:2,clone:!0},p.a.createElement(rn.a,{container:!0,spacing:2},p.a.createElement(rn.a,{xs:12,item:!0},p.a.createElement(vr.a,{value:u,onChange:I},p.a.createElement(br.a,{value:Lr.Equal},p.a.createElement(me.e,null)),p.a.createElement(br.a,{value:Lr.GreaterThan},p.a.createElement(me.h,null)),p.a.createElement(br.a,{value:Lr.LessThan},p.a.createElement(me.j,null)),p.a.createElement(br.a,{value:Lr.GreaterThanOrEqual},p.a.createElement(me.i,null)),p.a.createElement(br.a,{value:Lr.LessThanOrEqual},p.a.createElement(me.k,null))),p.a.createElement(le.a,{marginTop:2},p.a.createElement(In.a,{placeholder:"0.00",label:"Total",type:"number",inputProps:_,InputProps:Kr,value:f,onChange:T}))),!!f&&u!==Lr.Equal&&p.a.createElement(rn.a,{xs:12,item:!0},p.a.createElement(vr.a,{value:E,onChange:D},p.a.createElement(br.a,{value:Lr.None},"None"),p.a.createElement(br.a,{style:{display:"None"},value:Lr.Equal},p.a.createElement(me.e,null)),p.a.createElement(br.a,{style:k.includes(Lr.GreaterThan)?void 0:{display:"none"},disabled:!k.includes(Lr.GreaterThan),value:Lr.GreaterThan},p.a.createElement(me.h,null)),p.a.createElement(br.a,{style:k.includes(Lr.LessThan)?void 0:{display:"none"},disabled:!k.includes(Lr.LessThan),value:Lr.LessThan},p.a.createElement(me.j,null)),p.a.createElement(br.a,{style:k.includes(Lr.GreaterThanOrEqual)?void 0:{display:"none"},disabled:!k.includes(Lr.GreaterThanOrEqual),value:Lr.GreaterThanOrEqual},p.a.createElement(me.i,null)),p.a.createElement(br.a,{style:k.includes(Lr.LessThanOrEqual)?void 0:{display:"none"},disabled:!k.includes(Lr.LessThanOrEqual),value:Lr.LessThanOrEqual},p.a.createElement(me.k,null))),p.a.createElement(le.a,{marginTop:2},p.a.createElement(In.a,{disabled:E===Lr.None,placeholder:"0.00",label:"Total",type:"number",inputProps:_,InputProps:Kr,value:j,onChange:x})))))))},Qr=t(8);function Hr(){var e=F()(["\n  mutation ReconcileRefund($id: ID!) {\n    journalEntryUpdateRefund(id: $id, fields: { reconciled: true }) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return Hr=function(){return e},e}function Zr(){var e=F()(["\n  mutation ReconcileEntry($id: ID!) {\n    journalEntryUpdate(id: $id, fields: { reconciled: true }) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ","\n"]);return Zr=function(){return e},e}function el(){var e=F()(["\n  subscription OnEntryUpsert_1 {\n    journalEntryUpserted {\n      ...JournalEntry_1Fragment\n      department {\n        ancestors {\n          ... on Department {\n            __typename\n            id\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return el=function(){return e},e}function nl(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function tl(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?nl(Object(t),!0).forEach((function(n){G()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nl(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function al(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return rl(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return rl(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function rl(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}Object(Qr.b)(Qr.a.EXPRESSION,(function(e){return{$expressionCb:function(n,t,a){return t(n,a,e)}}})),Object(Qr.b)(Qr.a.QUERY,(function(e){return{$queryCb:function(n,t,a,r){return a(n,t,r,e)}}})),function(e){e[e.View=0]="View",e[e.Reconcile=1]="Reconcile"}(zr||(zr={}));var ll=J.a.mark((function e(n){var t,a,r,l,o,i,c;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=al(n),e.prev=1,t.s();case 3:if((a=t.n()).done){e.next=27;break}return r=a.value,e.next=7,r;case 7:l=r.type===u.Credit?u.Debit:u.Credit,o=al(r.refunds),e.prev=9,o.s();case 11:if((i=o.n()).done){e.next=17;break}return c=i.value,e.next=15,tl(tl(tl({},r),c),{},{type:l,description:c.description||r.description,refunds:r.id});case 15:e.next=11;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(9),o.e(e.t0);case 22:return e.prev=22,o.f(),e.finish(22);case 25:e.next=3;break;case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(1),t.e(e.t1);case 32:return e.prev=32,t.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,null,[[1,29,32,35],[9,19,22,25]])})),ol=(Symbol(),fe()(el(),xe)),il=fe()(Zr(),xe),ul=fe()(Hr(),xe),cl=function(e){var n,t,a=e.journalTitle,r=void 0===a?null:a,l=e.deptId,o=void 0===l?null:l,i=e.fiscalYearId,c=void 0===i?null:i,d=e.mode,s=Object(m.useState)(!1),f=U()(s,2),v=f[0],b=f[1],y=Object(m.useCallback)((function(){b(!1)}),[b]),E=Object(m.useState)(!1),h=U()(E,2),g=h[0],O=h[1],j=Object(m.useState)(null),w=U()(j,2),C=w[0],M=w[1],R=Object(m.useCallback)((function(){O(!1)}),[O]),A=Object(m.useCallback)((function(){M(null)}),[M]),k=Object(m.useState)(null),_=U()(k,2),S=_[0],I=_[1],D=Object(m.useCallback)((function(){I(null)}),[I]),T=Object(m.useState)(!1),x=U()(T,2),F=x[0],P=x[1],$=Object(m.useState)(null),q=U()($,2),B=q[0],W=q[1],V=Object(m.useCallback)((function(){P(!1)}),[P]),G=Object(m.useCallback)((function(){W(null)}),[W]),X=Object(m.useState)(!1),pe=U()(X,2),fe=pe[0],ye=pe[1],ge=Object(m.useState)(null),Oe=U()(ge,2),je=Oe[0],we=Oe[1],Ce=Object(m.useCallback)((function(){ye(!1)}),[ye]),Me=Object(m.useCallback)((function(){we(null)}),[we]),Re=Object(m.useState)(null),Ae=U()(Re,2),ke=Ae[0],_e=Ae[1],Se=Object(m.useCallback)((function(){_e(null)}),[_e]),Ie=Object(K.b)(il),De=U()(Ie,2),Te=De[0],xe=De[1].loading,$e=Object(K.b)(ul),Ne=U()($e,2),qe=Ne[0],Le=Ne[1].loading,Be=Object(m.useMemo)((function(){return o&&c?{where:{department:{eq:{id:o,matchDescendants:!0}},fiscalYear:{eq:c}}}:o?{where:{department:{eq:{id:o,matchDescendants:!0}}}}:c?{where:{fiscalYear:{eq:c}}}:void 0}),[o,c]),Ue=Object(K.c)(Fe,{variables:Be,fetchPolicy:"cache-and-network"}),We=Ue.loading,Je=Ue.error,Ve=Ue.data,Ge=Ue.subscribeToMore,ze=We&&!(null==Ve?void 0:Ve.journalEntries),Ye=Object(m.useMemo)((function(){var e;return null!==(e=((null==Ve?void 0:Ve.fiscalYears)||[]).find((function(e){return e.id===c})))&&void 0!==e?e:null}),[c,Ve]);Object(m.useEffect)((function(){return Ge({document:ol,updateQuery:function(e,n){var t=n.subscriptionData;if(!t.data)return e;var a=t.data.journalEntryUpserted,r=a.department.ancestors;if(o&&a.department.id!==o&&r.every((function(e){return"Department"===e.__typename&&e.id!==o}))){var l=e.journalEntries.filter((function(e){return e.id!==a.id}));return Object.assign({},e,{journalEntries:l})}if(Ye){var i=new Date(a.date);if(i<new Date(Ye.begin)||i>=new Date(Ye.end)){var u=e.journalEntries.filter((function(e){return e.id!==a.id}));return Object.assign({},e,{journalEntries:u})}}return e.journalEntries.some((function(e){return e.id===a.id}))?e:Object.assign({},e,{journalEntries:[a].concat(L()(e.journalEntries))})}})}),[o,Ye,Ge]);var Ke=(null==Ve?void 0:Ve.journalEntries)||[],Xe=Object(m.useMemo)((function(){var e,n={category:new Map,paymentMethod:new Map,source:new Map,department:new Map},t=[],a=al(ll(Ke));try{for(a.s();!(e=a.n()).done;){var r=e.value;r.deleted||d===zr.Reconcile&&r.reconciled||(n.category.set(r.category.id,r.category),n.department.set(r.department.id,r.department),n.paymentMethod.set(r.paymentMethod.id,r.paymentMethod),n.source.set("".concat(r.source.__typename,"-").concat(r.source.id),r.source),t.push(r))}}catch(e){a.e(e)}finally{a.f()}return[t,{category:L()(n.category.values()),department:L()(n.department.values()),paymentMethod:L()(n.paymentMethod.values()).filter((function(e){var n;return"5dc46d0af74afb2c2805bd54"!==(null===(n=e.parent)||void 0===n?void 0:n.id)})),source:L()(n.source.values())}]}),[Ke,d]),He=U()(Xe,2),Ze=He[0],en=He[1],nn=Object(m.useMemo)((function(){return[{field:"reconciled",title:"Reconciled",render:function(e){return e.reconciled?p.a.createElement(ee.a,null):null},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return p.a.createElement(yr,{setFilter:function(e){var a,r;return t(null!==(r=null===(a=n.tableData)||void 0===a?void 0:a.id)&&void 0!==r?r:"0",e)}})},hidden:d===zr.Reconcile,filtering:!0},{field:"total",title:"Total",render:function(e){var n=e.total;return Q()(Fn(n).valueOf()).format("$0,0.00")},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return p.a.createElement(Xr,{setFilter:function(e){var a,r;t(null!==(r=null===(a=n.tableData)||void 0===a?void 0:a.id)&&void 0!==r?r:"1",e)}})}},{field:"date",title:"Date",render:function(e){var n=e.date;return Object(ve.a)(new Date(n),"MMM dd, yyyy")},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return p.a.createElement(Jr,{setFilter:function(e){var a,r;t(null!==(r=null===(a=n.tableData)||void 0===a?void 0:a.id)&&void 0!==r?r:"2",e)}})},defaultSort:"desc"},{field:"category",title:"Category",render:function(e,n){var t="group"===n?e.name:e.category.name;return Object(H.a)(t)},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return p.a.createElement(jr,{options:en.category,setFilter:function(e){var a,r;return t(null!==(r=null===(a=n.tableData)||void 0===a?void 0:a.id)&&void 0!==r?r:"3",e)}})}},{field:"source",title:"Source",render:function(e){var n=e.source;switch(n.__typename){case"Person":return"".concat(n.name.first," ").concat(n.name.last);case"Business":return n.bizName;case"Department":return n.deptName}},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return p.a.createElement(Dr,{options:en.source,setFilter:function(e){var a,r;return t(null!==(r=null===(a=n.tableData)||void 0===a?void 0:a.id)&&void 0!==r?r:"4",e)}})}},{field:"paymentMethod",title:"Payment Method",render:function(e){var n,t=e.paymentMethod;return(null===(n=t.parent)||void 0===n?void 0:n.id)===Pe?"CK-".concat(t.name):t.name},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return p.a.createElement(Mr,{options:en.paymentMethod,setFilter:function(e){var a,r;return t(null!==(r=null===(a=n.tableData)||void 0===a?void 0:a.id)&&void 0!==r?r:"5",e)}})}},{field:"description",title:"Description",render:function(e){return e.description},searchable:!1,filtering:!1,sorting:!1},{field:"department",title:"Department",render:function(e){var n=e.department;return Object(H.a)(n.name)},searchable:!1,filterComponent:function(e){var n=e.columnDef,t=e.onFilterChanged;return p.a.createElement(kr,{options:en.department,setFilter:function(e){var a,r;return t(null!==(r=null===(a=n.tableData)||void 0===a?void 0:a.id)&&void 0!==r?r:"5",e)}})}}]}),[en.category,en.department,en.paymentMethod,en.source,d]),tn=Object(m.useMemo)((function(){return{toolbar:{searchTooltip:p.a.createElement(le.a,{fontSize:12,component:"span"},'[abc] | [efg] = "abc" OR "efg"',p.a.createElement("br",null),'\'[abc] = EXACTLY "abc"',p.a.createElement("br",null),'![abc] = NOT "abc"',p.a.createElement("br",null),'^[abc] = STARTS WITH "abc"',p.a.createElement("br",null),'!^[abc] = DOES NOT START WITH "abc"',p.a.createElement("br",null),'[abc]$ = ENDS WITH "abc"',p.a.createElement("br",null),'![abc]$ = DOES NOT END WITH "abc"'),nRowsSelected:"Reconcile {0} Entry(s)"}}}),[]),an=Object(m.useMemo)((function(){return{rowStyle:function(e){var n={};return n.color=e.type===u.Credit?de.a[900]:se.a[900],n},maxBodyHeight:"calc(100vh - 53px - 64px)",headerStyle:{position:"sticky",top:0},pageSize:25,pageSizeOptions:[25,50,100],showTitle:!!r,selection:d===zr.Reconcile,showSelectAllCheckbox:!1,debounceInterval:500,emptyRowsWhenPaging:!1,columnsButton:!0,filtering:!0,sorting:!0,thirdSortClick:!1}}),[r,d]),rn=Object(m.useMemo)((function(){return d===zr.Reconcile?[{icon:function(e){return p.a.createElement(ne.a,Object.assign({},e))},tooltip:"Reconcile Selected",position:"toolbarOnSelect",iconProps:{color:"secondary",fontSize:"large"},onClick:(e=N()(J.a.mark((function e(n,t){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all((Array.isArray(t)?t:[t]).map(function(){var e=N()(J.a.mark((function e(n){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.reconciled){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,"JournalEntryRefund"!==n.__typename){e.next=8;break}return e.next=6,qe({variables:{id:n.id}});case 6:e.next=10;break;case 8:return e.next=10,Te({variables:{id:n.id}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)}))),function(n,t){return e.apply(this,arguments)})}]:[function(e){var n=function(){switch(e.__typename){case"JournalEntry":return{tooltip:"Delete Entry",onClick:function(e,n){return I(n.id)}};case"JournalEntryRefund":return{tooltip:"Delete Refund",onClick:function(e,n){return _e(n.id)}}}}(),t=n.tooltip,a=n.onClick;return{icon:te.a,tooltip:t,onClick:a}},function(e){var n=function(){switch(e.__typename){case"JournalEntry":return{tooltip:"Edit Entry",onClick:function(e,n){O(!0),M(n.id)}};case"JournalEntryRefund":return{tooltip:"Edit Refund",onClick:function(e,n){ye(!0),we({entryId:n.refunds,refundId:n.id})}}}}(),t=n.tooltip,a=n.onClick;return{icon:ae.a,tooltip:t,onClick:a}},function(e){if("JournalEntry"!==e.__typename)return null;var n=e.type===u.Credit;return{icon:function(e){return n?p.a.createElement(me.d,Object.assign({},e)):p.a.createElement(me.c,Object.assign({},e))},tooltip:n?"Give Refund":"Add Refund",iconProps:{style:{color:n?se.a[900]:de.a[900]}},onClick:function(e,n){P(!0),W(n.id)}}},{icon:function(e){return p.a.createElement(re.a,Object.assign({},e))},iconProps:{color:"secondary",fontSize:"large"},tooltip:"Add Entry",isFreeAction:!0,onClick:function(){b(!0)}}];var e}),[d,qe,Te,_e,I]),ln=Object(m.useMemo)((function(){return new Map}),[]),on=Object(m.useMemo)((function(){return{Body:Je?function(e){return p.a.createElement(oe.a,Object.assign({},e),p.a.createElement(ie.a,null,p.a.createElement(ue.a,{colSpan:nn.length+(Array.isArray(rn)&&rn.length>0?1:0),align:"left"},p.a.createElement(ce.a,{align:"center",color:"error",variant:"h4"},"Error Loading Entries"),p.a.createElement(ce.a,{variant:"body1"},Je.message))))}:function(e){return p.a.createElement(z.MTableBody,Object.assign({},e))},Row:function(e){var n=tl(tl({},e),{},{onToggleDetailPanel:function(n,t){ln.has(e.data.id)?ln.delete(e.data.id):ln.set(e.data.id,t);for(var a=arguments.length,r=new Array(a>2?a-2:0),l=2;l<a;l++)r[l-2]=arguments[l];return e.onToggleDetailPanel.apply(e,[n,t].concat(r))}});return p.a.createElement(z.MTableBodyRow,Object.assign({},n))}}}),[Je,nn.length,rn,ln]),un=Object(m.useMemo)((function(){return[function(e){var n="JournalEntry"===e.__typename,t=!!n&&e.items.length>0;return{icon:function(e){return n?t?p.a.createElement(me.f,Object.assign({},e)):p.a.createElement(me.g,Object.assign({},e)):null},openIcon:function(e){return t?p.a.createElement(me.f,Object.assign({},e,{color:"primary"})):p.a.createElement(me.g,Object.assign({},e,{color:"primary"}))},disabled:!n,tooltip:n?"Itemize":void 0,render:function(e){return"JournalEntry"!==e.__typename?null:p.a.createElement(fr,{entry:e})}}}]}),[]),cn=Object(m.useState)(new Ee.a(0)),dn=U()(cn,2),sn=dn[0],mn=dn[1],pn=Object(m.useMemo)((function(){var e=(null==Ye?void 0:Ye.name)?"".concat(null==Ye?void 0:Ye.name," "):"",n=sn.compare(new Ee.a(0)),t=p.a.createElement(le.a,{color:0===n?void 0:n>0?de.a[900]:se.a[900],component:"span"},Q()(sn.valueOf()).format("$0,0.00"));return r?p.a.createElement(ce.a,{variant:"h6"},"".concat(e).concat(r,": "),t):p.a.createElement(ce.a,{variant:"h6"},e,t)}),[Ye,sn,r]),fn=Object(m.useRef)(null),vn=Object(m.useCallback)(function(){var e=N()(J.a.mark((function e(n){var t,a,r,l,i,c,d,s,m,p,f,v,b,y,E,h,g,O,j,w,C,M,R;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.filters,r=n.page,l=n.pageSize,i=n.orderBy,c=n.orderDirection,d=null===(t=n.search)||void 0===t?void 0:t.trim(),s=d?new Z.a(Ze,{keys:["date","total","description","department","category","paymentMethod","source"],threshold:.4,useExtendedSearch:!0,getFn:function(e,n){var t;switch(n){case"date":var a=new Date(e.date);return[e.date,Object(ve.a)(a,"M/d/yy"),Object(ve.a)(a,"MM/d/yy"),Object(ve.a)(a,"M/d/yyyy"),Object(ve.a)(a,"MM/d/yyyy"),Object(ve.a)(a,"MMM dd, yyyy")];case"total":var r=Fn(e.total).valueOf();return[Q()(r).format("$0,0.00"),r.toFixed(2)];case"description":return(null===(t=e.description)||void 0===t?void 0:t.trim())||"";case"department":return e.department.name;case"category":return e.category.name;case"paymentMethod":return e.paymentMethod.name;case"source":switch(e.source.__typename){case"Person":return[e.source.name.first,e.source.name.last];case"Business":return e.source.bizName;case"Department":return e.source.deptName}break;default:return""}}}).search(d).map((function(e){return e.item})):Ze,m=[],p={$and:[]},a.length>0){f=p.$and,v=al(a);try{for(v.s();!(b=v.n()).done;)y=b.value,Object.keys(y.value).length>0&&f.push(y.value)}catch(e){v.e(e)}finally{v.f()}}if(p.$and.length>0&&m.push({$addFields:{_dateStr_:"$date",date:{$expressionCb:function(e){return Object(be.a)(new Date(e.date))}},_totalRational_:"$total",total:{$expressionCb:function(e){return Fn(e.total).valueOf()}}}},{$match:p},{$addFields:{date:"$_dateStr_",total:"$_totalRational_"}},{$project:{_dateStr_:!1,_totalRational_:!1}}),E={data:[],raw:[]},!i){e.next=29;break}h=i.field,e.t0=h,e.next="date"===e.t0?13:"total"===e.t0?15:"reconciled"===e.t0?17:"department"===e.t0?19:"category"===e.t0?21:"paymentMethod"===e.t0?23:"source"===e.t0?25:27;break;case 13:return E.data.push({$addFields:{_sortBy_:{$toDate:"$date"}}}),e.abrupt("break",28);case 15:return E.data.push({$addFields:{_sortBy_:{$expressionCb:function(e){return Fn(e.total).valueOf()}}}}),e.abrupt("break",28);case 17:return E.data.push({$addFields:{_sortBy_:"$reconciled"}}),e.abrupt("break",28);case 19:return E.data.push({$addFields:{_sortBy_:"$department.name"}}),e.abrupt("break",28);case 21:return E.data.push({$addFields:{_sortBy_:"$category.name"}}),e.abrupt("break",28);case 23:return E.data.push({$addFields:{_sortBy_:"$paymentMethod.name"}}),e.abrupt("break",28);case 25:return E.data.push({$addFields:{_sortBy_:{$cond:{if:{$eq:[{$ifNull:["$source.name.first",null]},null]},then:"$source.name",else:{$concat:["$source.name.first"," ","$source.name.last"]}}}}}),e.abrupt("break",28);case 27:E.data.push({$addFields:{_sortBy_:{$toDate:"$date"}}});case 28:E.data.push({$sort:{_sortBy_:"asc"===c?1:-1}},{$project:{_sortBy_:!1}});case 29:return E.data.push({$skip:r*l},{$limit:l}),m.push({$facet:E}),g=new he.a(m).run(s),O=U()(g,1),j=O[0],w=j.data.map((function(e){return ln.has(e.id)?tl(tl({},e),{},{tableData:{showDetailPanel:ln.get(e.id)}}):e})),C=j.raw,function(){var e=new Map(ln);ln.clear();var n,t=al(C);try{for(t.s();!(n=t.n()).done;){var a=n.value.id;e.has(a)&&ln.set(a,e.get(a))}}catch(e){t.e(e)}finally{t.f()}}(),M=C.length,R=function(){var e,n=new Ee.a(0),t=al(C);try{for(t.s();!(e=t.n()).done;){var a=e.value;if(!a.deleted){var r=Fn(a.total);if(o){var l,i=al(a.items);try{for(i.s();!(l=i.n()).done;){var c=l.value;c.deleted||!c.department||c.department.id===o||c.department.ancestors.some((function(e){return"Department"===e.__typename&&e.id===o}))||(r=r.sub(Fn(c.total)))}}catch(e){i.e(e)}finally{i.f()}}n=a.type===u.Credit?n.add(r):n.sub(r)}}}catch(e){t.e(e)}finally{t.f()}return n}(),0!==sn.compare(R)&&mn(R),e.abrupt("return",{data:w,page:r,totalCount:M});case 39:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[sn,o,Ze,ln]);return Object(m.useEffect)((function(){fn.current&&fn.current.onQueryChange(null)}),[fn,Ze]),p.a.createElement(p.a.Fragment,null,p.a.createElement(Y.a,{icons:Qe,isLoading:ze||xe||Le,columns:nn,data:vn,options:an,localization:tn,actions:rn,components:on,title:pn,detailPanel:un,tableRef:fn}),p.a.createElement(Ma,{deptId:o,open:v,onClose:y}),p.a.createElement(Pa,{entryId:C,open:g,onClose:R,onExited:A}),p.a.createElement(qa,{entryId:S,onClose:D}),p.a.createElement(wt,{entryId:B,open:F,onClose:V,onExited:G}),p.a.createElement(It,{entryId:null!==(n=null==je?void 0:je.entryId)&&void 0!==n?n:null,refundId:null!==(t=null==je?void 0:je.refundId)&&void 0!==t?t:null,open:fe,onClose:Ce,onExited:Me}),p.a.createElement(Ua,{refundId:ke,onClose:Se}))},dl=t(5806),sl=t(412),ml=t.n(sl),pl=t(414),fl=t.n(pl),vl=t(416),bl=t.n(vl),yl=t(415),El=t.n(yl),hl=t(5803),gl=t(5805),Ol=t(5804),jl=t(163),wl=t(159),Cl=t(294);function Ml(){var e=F()(["\n  subscription JournalEntryUpdated_2 {\n    journalEntryUpdated {\n      ...GetReportDataEntry_1Fragment\n    }\n  }\n  ","\n"]);return Ml=function(){return e},e}function Rl(){var e=F()(["\n  subscription JournalEntryAdded_2 {\n    journalEntryAdded {\n      ...GetReportDataEntry_1Fragment\n    }\n  }\n  ","\n"]);return Rl=function(){return e},e}function Al(){var e=F()(["\n  query GetReportData($deptId:ID!, $where:JournalEntiresWhereInput!) {\n    department(id:$deptId) {\n      ...GetReportDataDept_1Fragment\n      descendants {\n        ...GetReportDataDept_1Fragment\n      }\n    }\n    journalEntries(where:$where) {\n      ...GetReportDataEntry_1Fragment\n    }\n    fiscalYears {\n      __typename\n      id\n      name\n      begin\n      end\n    }\n  }\n  ",",\n  ","\n"]);return Al=function(){return e},e}function kl(){var e=F()(["\n  fragment GetReportDataEntry_1Fragment on JournalEntry {\n    id\n    __typename\n    category {\n      __typename\n      id\n      name\n    }\n    type\n    total {\n      n\n      d\n      s\n    }\n    fiscalYear {\n      __typename\n      id\n    }\n    department {\n      __typename\n      id\n      ancestors {\n        __typename\n        ... on Business {\n          id\n        }\n        ... on Department {\n          id\n        }\n      }\n    }\n    refunds {\n      __typename\n      id\n      total {\n        n\n        d\n        s\n      }\n      deleted\n      lastUpdate\n    }\n    items {\n      __typename\n      id\n      total {\n        n\n        d\n        s\n      }\n      department {\n        __typename\n        id\n      }\n      deleted\n    }\n    lastUpdate\n    deleted\n  }\n"]);return kl=function(){return e},e}function _l(){var e=F()(["\n  fragment GetReportDataDept_1Fragment on Department {\n    __typename\n    id\n    name\n    budgets {\n      id\n      __typename\n      amount {\n        n\n        d\n        s\n      }\n      fiscalYear {\n        __typename\n        id\n      }\n    }\n  }\n"]);return _l=function(){return e},e}var Sl=fe()(_l()),Il=fe()(kl()),Dl=fe()(Al(),Sl,Il);fe()(Rl(),Il),fe()(Ml(),Il);function Tl(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return xl(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return xl(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function xl(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function Fl(){var e=F()(["\n  subscription OnEntryUpsert_2 {\n    journalEntryUpserted {\n      ...GetReportDataEntry_1Fragment\n      department {\n        ancestors {\n          ... on Department {\n            __typename\n            id\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return Fl=function(){return e},e}function Pl(){var e=F()(["\n  query DeptForUpsertAdd($id: ID!) {\n    department(id: $id) {\n      ...DeptEntryOptFragment\n    }\n  }\n  ","\n"]);return Pl=function(){return e},e}var $l=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:800;return e<.75?de.a[n]:e<.9?jl.a[n]:se.a[n]},Nl=function(e){var n=e.spentPercentage,t=e.height;return p.a.createElement(le.a,{height:t,bgcolor:$l(n),display:"flex",justifyContent:"flex-start"},p.a.createElement(le.a,{height:"100%",width:"".concat(100*n,"%"),bgcolor:wl.a[400]}))},ql=(fe()(Pl(),Hn),fe()(Fl(),Il)),Ll=function(e){var n,t=e.deptId,a=Object(m.useState)(!1),r=U()(a,2),l=r[0],o=r[1],i=Object(m.useCallback)((function(){o(!1)}),[o]),c=Object(m.useMemo)((function(){return{deptId:t,where:{department:{eq:{id:t,matchDescendants:!0}},deleted:!1}}}),[t]),d=Object(K.c)(Dl,{variables:c,fetchPolicy:"cache-and-network"}),s=d.loading,f=d.error,v=d.data,b=d.subscribeToMore,y=s&&!(null==v?void 0:v.journalEntries);Object(m.useEffect)((function(){return b({document:ql,updateQuery:function(e,n){var a=n.subscriptionData;if(!a.data)return e;var r=a.data.journalEntryUpserted,l=r.department.ancestors;if(t&&r.department.id!==t&&l.every((function(e){return"Department"===e.__typename&&e.id!==t}))){var o=e.journalEntries.filter((function(e){return e.id!==r.id}));return o.length===e.journalEntries.length?e:Object.assign({},e,{journalEntries:o})}return e.journalEntries.some((function(e){return e.id===r.id}))?e:Object.assign({},e,{journalEntries:[r].concat(L()(e.journalEntries))})}})}),[t,b]);var h=Object(m.useState)(new Date((new Date).toDateString())),g=U()(h,2),O=g[0],j=g[1],w=Object(m.useMemo)((function(){var e,n=Tl((null==v?void 0:v.fiscalYears)||[]);try{for(n.s();!(e=n.n()).done;){var t=e.value;if(O>=new Date(t.begin)&&O<new Date(t.end))return t}}catch(e){n.e(e)}finally{n.f()}return null}),[O,v]),C=Object(m.useMemo)((function(){return((null==v?void 0:v.journalEntries)||[]).filter((function(e){return!e.deleted&&(null==w?void 0:w.id)===e.fiscalYear.id}))}),[v,w]),M=(null===(n=null==v?void 0:v.department)||void 0===n?void 0:n.name)||"";Object(m.useEffect)((function(){document.title=M}),[M]);var R=(null==v?void 0:v.department)||null,A=Object(m.useMemo)((function(){var e,n=new Map,t=new Ee.a(0),a=new Ee.a(0),r=[];R&&function(){var a=new Set;r.push.apply(r,[R].concat(L()(R.descendants)));var l,o=Tl(r);try{for(o.s();!(l=o.n()).done;){var i=l.value,u=null!==(e=i.budgets.find((function(e){return e.fiscalYear.id===(null==w?void 0:w.id)&&!a.has(e.id)})))&&void 0!==e?e:null,c=null;if(u){var d=u.amount;a.add(u.id),c=Fn(d),t=t.add(c)}n.set(i.id,{name:i.name,spent:new Ee.a(0),budget:c})}}catch(e){o.e(e)}finally{o.f()}}();var l,o=Tl(C);try{for(o.s();!(l=o.n()).done;){var i=l.value;if(!i.deleted){var c,d=n.get(i.department.id),s=Fn(i.total),m=Tl(i.refunds);try{for(m.s();!(c=m.n()).done;){var p=c.value;p.deleted||(s=s.sub(Fn(p.total)))}}catch(e){m.e(e)}finally{m.f()}if(R){var f,v=Tl(i.items);try{var b=function(){var e=f.value;if(e.deleted||!e.department||r.some((function(n){var t;return n.id===(null===(t=e.department)||void 0===t?void 0:t.id)})))return"continue";s=s.sub(Fn(e.total))};for(v.s();!(f=v.n()).done;)b()}catch(e){v.e(e)}finally{v.f()}}i.type===u.Credit?(a=a.sub(s),d.spent=d.spent.sub(s)):(a=a.add(s),d.spent=d.spent.add(s))}}}catch(e){o.e(e)}finally{o.f()}return{totalRemaining:Q()(t.sub(a).valueOf()).format("$0,0.00"),budget:Q()(t.valueOf()).format("$0,0.00"),spentToBudgetRatio:0===t.n?1:a.div(t).valueOf(),deptReports:n,uBudget:t}}),[C,R]),k=A.totalRemaining,_=A.budget,S=A.spentToBudgetRatio,I=A.deptReports,D=A.uBudget,T=Object(m.useMemo)((function(){var e,n=[],t=Tl(I);try{var a=function(){var t=U()(e.value,2),a=t[0],r=t[1],l=r.budget,o=r.spent,i=r.name;if(a===(null==R?void 0:R.id)&&(!l||l.equals(D)))return"continue";var u=p.a.createElement(rn.a,{key:a,item:!0,xs:12,md:4,lg:3},p.a.createElement(hl.a,null,p.a.createElement(gl.a,{titleTypographyProps:{noWrap:!0},title:i}),p.a.createElement(Ol.a,null,function(){if(null===l||0===l.n)return p.a.createElement(le.a,{color:o.compare(new Ee.a(0))>0?se.a[900]:de.a[900],clone:!0},p.a.createElement(ce.a,{variant:"h6"},"Spent: ".concat(Q()(o.abs().valueOf()).format("$0,0.00"))));var e=l.sub(o),n=o.div(l).valueOf();return p.a.createElement(p.a.Fragment,null,p.a.createElement(le.a,{color:$l(n,900),clone:!0},p.a.createElement(ce.a,{variant:"h6"},"".concat(Q()(e.valueOf()).format("$0,0.00")," Remaining"))),p.a.createElement(ce.a,{variant:"body1"},"of ".concat(Q()(l.valueOf()).format("$0,0.00"))),p.a.createElement(Nl,{spentPercentage:n,height:5}))}())));n.push(u)};for(t.s();!(e=t.n()).done;)a()}catch(e){t.e(e)}finally{t.f()}return n}),[I,R,D]),x=Object(m.useCallback)((function(){return o(!0)}),[o]),F=Object(m.useMemo)((function(){return p.a.createElement(le.a,{minWidth:120,clone:!0},p.a.createElement(fa.a,{variant:"outlined"},p.a.createElement(Cl.a,null,"Fiscal Year"),p.a.createElement(vr.a,{label:"Fiscal Year<",variant:"outlined",value:(null==w?void 0:w.id)||"",onChange:function(e){var n=e.target.value;if(n){var t,a=Tl((null==v?void 0:v.fiscalYears)||[]);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(r.id===n)return void j(new Date(r.begin))}}catch(e){a.e(e)}finally{a.f()}}}},((null==v?void 0:v.fiscalYears)||[]).sort((function(e,n){return new Date(e.begin).getTime()-new Date(n.begin).getTime()})).map((function(e){return p.a.createElement(br.a,{key:e.id,value:e.id},e.name)})))))}),[v,j,w]);return y?p.a.createElement("p",null,"Loading..."):f?(console.error(f),p.a.createElement("p",null,f.message)):p.a.createElement(le.a,{display:"flex",flexDirection:"column",overflow:"hidden",clone:!0},p.a.createElement(dl.a,null,p.a.createElement(le.a,{padding:8},p.a.createElement(rn.a,{container:!0,alignItems:"center",justify:"center",spacing:4},p.a.createElement(rn.a,{item:!0},p.a.createElement(on.a,{variant:"contained",color:"secondary",startIcon:p.a.createElement(ml.a,null),onClick:x},"New Entry")),p.a.createElement(rn.a,{item:!0},p.a.createElement(on.a,{disabled:!w,component:E.b,to:"/journal/".concat(t,"/").concat((null==w?void 0:w.id)||"","/reconcile"),variant:"contained",startIcon:p.a.createElement(fl.a,null)},"Reconcile")),p.a.createElement(rn.a,{item:!0},p.a.createElement(on.a,{variant:"contained",startIcon:p.a.createElement(El.a,null)},"Reports")),p.a.createElement(rn.a,{item:!0},p.a.createElement(on.a,{disabled:!w,component:E.b,to:"/journal/".concat(t,"/").concat((null==w?void 0:w.id)||""),variant:"contained",startIcon:p.a.createElement(bl.a,null)},"Journal")),p.a.createElement(rn.a,{item:!0},F))),p.a.createElement(le.a,{flexGrow:1,overflow:"auto"},p.a.createElement(rn.a,{justify:"center",container:!0,spacing:2},p.a.createElement(rn.a,{item:!0,xs:12},p.a.createElement(ce.a,{align:"center",variant:"h3"},M),p.a.createElement(le.a,{color:$l(S.valueOf())},p.a.createElement(ce.a,{align:"center",variant:"h4"},"".concat(k," Remaining"))),p.a.createElement(ce.a,{align:"center",variant:"subtitle1"},"of ".concat(_)),p.a.createElement(Nl,{spentPercentage:S.valueOf(),height:10})),T)),p.a.createElement(Ma,{deptId:t,open:l,onClose:i})))};function Bl(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return Ul(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ul(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw l}}}}function Ul(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function Wl(){var e=F()(["\n  query DeptsForNav_1 {\n    departments {\n      __typename\n      id\n      name\n      parent {\n        __typename\n        ... on Business {\n          id\n        }\n        ... on Department {\n          id\n        }\n      }\n      virtualRoot\n    }\n  }\n"]);return Wl=function(){return e},e}var Jl=fe()(Wl()),Vl=function(e){var n=Object(K.c)(Jl),t=n.loading,a=n.error,r=n.data,l=Object(m.useState)(""),o=U()(l,2),i=o[0],u=o[1],c=(null==r?void 0:r.departments)||[],d=Object(m.useMemo)((function(){var e,n=[],t=new Set,a=Bl(c);try{for(a.s();!(e=a.n()).done;){var r=e.value;"Business"===r.parent.__typename&&n.push(r),r.virtualRoot&&t.add(r.id)}}catch(e){a.e(e)}finally{a.f()}return{rootDepts:n,virtualRoots:t}}),[c]),s=d.rootDepts,f=d.virtualRoots,v=Object(m.useMemo)((function(){var e=[];if(i&&f.has(i)){var n,t=Bl(c);try{for(t.s();!(n=t.n()).done;){var a=n.value;a.parent.id===i&&e.push(a)}}catch(e){t.e(e)}finally{t.f()}}return e}),[f,i,c]);Object(m.useEffect)((function(){document.title="Select Department"}));var b=Object(m.useCallback)((function(e){var n;u((null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.value)||"")}),[u]);if(t)return p.a.createElement("p",null,"Loading...");if(a)return p.a.createElement("p",null,a.message);var y=v.length>0;return p.a.createElement(le.a,{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",clone:!0},p.a.createElement(dl.a,null,p.a.createElement(le.a,{padding:4,clone:!0},p.a.createElement(ce.a,{align:"center",color:"primary",variant:"h3"},"Select Department")),p.a.createElement(le.a,{minWidth:"250px !important",clone:!0},p.a.createElement(fa.a,{variant:"filled"},p.a.createElement(Cl.a,null,"Department"),p.a.createElement(vr.a,{value:i,onChange:b,autoWidth:!0},s.map((function(e){var n={component:E.b,to:"/department/".concat(e.id),value:e.id,children:e.name};return e.virtualRoot&&(delete n.component,delete n.to),p.a.createElement(br.a,Object.assign({key:e.id},n))}))))),y&&p.a.createElement(le.a,{pt:2},p.a.createElement(le.a,{pt:2,minWidth:"250px !important",clone:!0},p.a.createElement(fa.a,{variant:"filled"},p.a.createElement(Cl.a,null,"Sub Department"),p.a.createElement(vr.a,{autoWidth:!0},v.map((function(e){var n={component:E.b,to:"/department/".concat(e.id),value:e.id,children:e.name};return p.a.createElement(br.a,Object.assign({key:e.id},n))}))))))))};function Gl(){var e=F()(["\n  query DepartmentName_1($id: ID!) {\n    department(id: $id) {\n      id\n      __typename\n      name\n    }\n  }\n"]);return Gl=function(){return e},e}var zl=function(){var e=Object(P.f)().id;return e?p.a.createElement(Ll,{deptId:e}):p.a.createElement("div",null,"Error: No Dept ID!")},Yl=fe()(Gl()),Kl=function(){var e,n=Object(P.f)(),t=n.id,a=n.year,r=Object(K.c)(Yl,{variables:{id:t}}).data,l=(null===(e=null==r?void 0:r.department)||void 0===e?void 0:e.name)?r.department.name:void 0;return p.a.createElement(cl,{mode:zr.View,deptId:t,fiscalYearId:a,journalTitle:l})},Xl=function(){var e,n=Object(P.f)(),t=n.id,a=n.year,r=Object(K.c)(Yl,{variables:{id:t}}).data,l=(null===(e=null==r?void 0:r.department)||void 0===e?void 0:e.name)?"Reconcile ".concat(r.department.name):"Reconcile";return p.a.createElement(cl,{mode:zr.Reconcile,deptId:t,fiscalYearId:a,journalTitle:l})},Ql=function(){return p.a.createElement(P.c,null,p.a.createElement(P.a,{exact:!0,path:"/",component:Vl}),p.a.createElement(P.a,{exact:!0,path:"/department/:id",component:zl}),p.a.createElement(P.a,{exact:!0,path:"/journal",component:cl}),p.a.createElement(P.a,{exact:!0,path:"/journal/:id/:year",component:Kl}),p.a.createElement(P.a,{exact:!0,path:"/journal/:id/:year/reconcile",component:Xl}))},Hl=function(){return p.a.createElement(m.Fragment,null,p.a.createElement(y.a,null),p.a.createElement(b.a,{client:T},p.a.createElement(E.a,null,p.a.createElement(Ql,null))))};v.a.render(p.a.createElement(Hl,null),document.getElementById("root"))}},[[5769,1,2]]]);
//# sourceMappingURL=main.ac36dbb2db4ffac6f21c.js.map