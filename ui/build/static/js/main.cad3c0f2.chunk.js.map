{"version":3,"sources":["apollo/inMemoryCache.ts","apollo/schema/upsertJournalEntry.gql.ts","apollo/graphTypes.ts","apollo/typeDefs.ts","apollo/resolvers.ts","apollo/link.ts","apollo/apollo.ts","components/Journal/Table/JournalEntries.gql.ts","components/Journal/constants.ts","components/utils/materialTableIcons.tsx","components/Journal/Upsert/Refunds/submitAdd.ts","formik/utils.ts","components/Journal/Upsert/EntryFields/DateEntry.tsx","components/Journal/Upsert/EntryFields/Description.tsx","utils/rational.ts","components/Journal/Upsert/EntryFields/Total.tsx","components/Journal/Upsert/EntryFields/Reconcile.tsx","components/Journal/Upsert/upsertEntry.gql.ts","components/Journal/Upsert/EntryFields/PaymentMethod.tsx","components/utils/Overlay.tsx","components/utils/OverlayLoading.tsx","components/Journal/Upsert/Refunds/refunds.gql.ts","components/Journal/Upsert/Refunds/AddRefund.tsx","components/Journal/Upsert/Refunds/submitUpdate.ts","components/Journal/Upsert/Refunds/UpdateRefund.tsx","components/Journal/Upsert/Entries/submitAdd.ts","components/Journal/Upsert/EntryFields/Category.tsx","components/Journal/Upsert/EntryFields/Department.tsx","components/Journal/Upsert/EntryFields/Source.tsx","components/Journal/Upsert/EntryFields/Type.tsx","components/Journal/Upsert/Entries/AddEntry.tsx","components/Journal/Upsert/Entries/submitUpdate.ts","components/Journal/Upsert/Entries/UpdateEntry.tsx","components/Journal/Upsert/Entries/DeleteEntry.tsx","components/Journal/Upsert/Refunds/DeleteRefund.tsx","components/Journal/Upsert/Items/submitAdd.ts","components/Journal/Upsert/Items/ItemFields/Units.tsx","components/Journal/Upsert/Items/items.gql.ts","components/Journal/Upsert/Items/AddItem.tsx","components/Journal/Upsert/Items/submitUpdate.ts","components/Journal/Upsert/Items/UpdateItem.tsx","components/Journal/Upsert/Items/DeleteItem.tsx","components/Journal/Table/FilterFields/Date.tsx","components/Journal/Table/Items.tsx","components/Journal/Table/FilterFields/Reconciled.tsx","components/Journal/Table/FilterFields/Category.tsx","components/Journal/Table/FilterFields/PaymentMethod.tsx","components/Journal/Table/FilterFields/Department.tsx","components/Journal/Table/FilterFields/Source.tsx","components/Journal/Table/FilterFields/Total.tsx","components/Journal/Table/Journal.tsx","utils/mingoUtils.ts","components/Dashboard/ReportData.gql.ts","components/Dashboard/Dashboard.tsx","components/TopNav.tsx","Routes.tsx","App.tsx","serviceWorker.js","index.js"],"names":["fragmentMatcher","IntrospectionFragmentMatcher","introspectionQueryResultData","inMemoryCache","InMemoryCache","addTypename","gql","CacheControlScope","FilterType","JournalEntrySourceType","JournalEntryType","Lc_JournalEntryUpsertSubmitStatus","Lc_JournalEntryUpsertType","RationalSign","SortDirection","resolvers","batchHttpLink","BatchHttpLink","uri","credentials","wsLink","WebSocketLink","window","location","host","options","reconnect","link","ApolloLink","from","onError","graphQLErrors","networkError","forEach","message","locations","path","console","error","log","split","query","def","getMainDefinition","kind","operation","ApolloClient","cache","typeDefs","JOURNAL_ENTRY_PAY_METHOD_FRAGMENT","JOURNAL_ENTRY_CATEGORY_FRAGMENT","JOURNAL_ENTRY_DEPT_FRAGMENT","JOURNAL_ENTRY_REFUND","JOURNAL_ENTRY_ITEM","JOURNAL_ENTRY_FRAGMENT","JOURNAL_ENTRIES","CHECK_ID","tableIcons","Add","forwardRef","props","ref","AddBox","Check","Clear","Delete","DeleteOutline","DetailPanel","ChevronRight","Edit","Export","SaveAlt","Filter","FilterList","FirstPage","LastPage","NextPage","PreviousPage","ChevronLeft","ResetSearch","Search","SortArrow","ArrowDownward","ThirdStateCheck","Remove","ViewColumn","FormikStatusType","ADD_REFUND","submitAdd","client","id","values","a","payMethod","paymentMethod","value","length","paymentMethodAdd","parent","refId","name","active","variables","fields","date","description","trim","total","reconciled","mutate","mutation","createValueTransmutator","transMutator","inputValue","rest","useFormikStatus","useFormikContext","setStatusNative","setStatus","status","useCallback","args","Object","keys","some","key","inputProps","inputMode","keyboardButtonProps","tabIndex","dateValueTransmutator","isValid","formatISO","DateField","variant","inputVariant","autoFocus","disabled","maxDate","Date","minDate","isSubmitting","validate","dateStr","parseISO","format","useField","field","meta","helpers","touched","setValue","setTouched","initialInputValue","initialValue","initialFocusedDate","useMemo","InputProps","calOpen","useRef","onBlur","setTimeout","current","onOpen","onClose","onChange","min","formikStatus","dataPickerProps","type","FATAL_ERROR","helperText","undefined","animateYearScrolling","disableToolbar","disableFuture","margin","label","autoOk","placeholder","KeyboardButtonProps","utils","DateFnsUtils","Description","textFieldProps","event","target","trimLeft","TextField","fractionToRational","fraction","n","Math","abs","d","s","Neg","Pos","rationalToFraction","rational","Fraction","step","totalValueTransmutator","round","Total","maxTotal","Number","MAX_SAFE_INTEGER","minTotal","minTotalProp","compare","num","isNaN","parseInt","numeral","valueOf","startAdornment","InputAdornment","position","toString","maxSafe","minValid","required","Reconcile","customProps","FormControlLabel","control","Checkbox","DEPT_ENTRY_OPT_FRAGMENT","CAT_ENTRY_OPT_FRAGMENT","SRC_ENTRY_PERSON_OPT_FRAGMENT","SRC_ENTRY_DEPT_OPT_FRAGMENT","SRC_ENTRY_BIZ_OPT_FRAGMENT","PAY_METHOD_ENTRY_OPT_FRAGMENT","PAY_METHOD_ENTRY_OPTS","payMethodValue","numValues","curValue","match","join","getOptionLabel","opt","renderTags","getTagProps","lastIndex","map","index","endAdornment","isLastIndex","isString","fontSize","Box","display","flexDirection","alignItems","justifyContent","Chip","color","size","PaymentMethod","useState","hasFocus","setHasFocus","onBlurField","where","hasParent","eq","setFormikStatus","msg","useQuery","skip","loading","gqlError","data","paymentMethods","hasOptions","freeSolo","disableTextInput","renderInput","params","onFocus","persist","onInputChange","reason","trimStart","autoCompleteProps","multiple","open","autoSelect","Autocomplete","Overlay","theme","useTheme","opacity","boxProps","overflow","width","top","bottom","bgcolor","fade","palette","background","paper","OverlayLoading","children","CircularProgress","JOURNAL_FRAGMENT","GET_ENTRY_REFUND_INFO","NULLISH","Symbol","AddRefundDialog","entryId","onExitedCb","onExited","handleSubmit","resetForm","journalEntry","refunds","totalRefunds","reduce","deleted","add","sub","ERROR","generalError","fatalError","journalEntryType","title","Credit","Dialog","disableBackdropClick","disableEscapeKeyDown","fullWidth","maxWidth","PaperProps","component","onSubmit","DialogTitle","style","main","zIndex","padding","DialogContentText","DialogContent","dividers","Grid","container","spacing","item","lg","sm","xs","DateEntry","justify","md","DialogActions","Button","startIcon","Cancel","onClick","AddRefund","initialValues","useApolloClient","formikHelpers","initialStatus","enableReinitialize","UPDATE_REFUND","submitUpdate","iniValues","isEqual","iniPayMethod","slice","reverse","paymentMethodUpdate","UPDATE_REFUND_INI_STATE","UpdateRefundDialog","refundId","UpdateRefund","journalEntryRefund","ancestors","sort","b","push","ADD_ENTRY","srcType","source","src","Person","parsedName","parseName","sourceType","businessAdd","personAdd","first","firstName","last","lastName","Business","__typename","Department","department","category","CAT_OPTS_QUERY","dept","Category","formikContext","disabledFromProps","entryTypeFromProps","entryType","catValue","onCompleted","validateField","catOpts","transmutationVal","useEffect","forcePopupIcon","DEPT_OPTS_QUERY","fromParent","depts","deptOpts","setInputValue","deptValue","idDeptMap","Map","idDepts","has","parentDept","get","unshift","deptId","filter","Array","isArray","len","JSON","stringify","SRC_ENTRY_OPTS_QUERY","isFreeSoloOpt","personName","filterOptions","regex","RegExp","test","srcValue","Source","searchedName","isBiz","businesses","bizOpt","departments","deptOpt","set","people","srcValueIndex","formattedSrcStrs","str","namecase","formattedStr","charAt","toUpperCase","substring","toLowerCase","Type","toggleButtonGroupProps","exclusive","Promise","resolve","pl","clone","ToggleButtonGroup","ToggleButton","Tooltip","arrow","placement","Debit","FormControl","labelPlacement","FormHelperText","gridEntryResponsiveProps","DEPT_INI_VALUE","AddEntryDialog","submitForm","onClickAdd","onClickAddAndNew","preventDefault","Fragment","Queue","AddEntry","UPDATE_ENTRY","iniSrcType","iniSrc","UPDATE_ENTRY_INI_STATE","MAX_DATE","UpdateEntryDialog","UpdateEntry","ancestorDeptQueue","ancestor","bizAncestor","ancestorDepts","indexOf","DELETE_ENTRY","DeleteEntry","useMutation","deleteEntry","hasError","onDelete","then","DELETE_REFUND","DeleteRefund","deleteRefund","ADD_ENTRY_ITEM","units","Units","max","ENTRY_ITEM_STATE","AddItemDialog","items","totalItems","AddItem","UPDATE_ITEM","UPDATE_ITEM_INI_STATE","UpdateItemDialog","itemId","UpdateItem","journalEntryItem","Op","DELETE_ITEM","DeleteItem","deleteItem","Items","entry","addItemOpen","setAddItemOpen","addItemToEntry","setAddItemToEntry","addItemOnClose","addItemOnExited","updateItemOpen","setUpdateItemOpen","updateItem","setUpdateItem","setDeleteItem","deleteItemOnClose","updateItemOnClose","updateItemOnExited","actions","icon","DeleteIcon","tooltip","rowData","EditIcon","AddCircle","iconProps","isFreeAction","columns","render","capitalCase","search","emptyRowsWhenPaging","tableStyle","boxShadow","shadows","dividerStyle","backgroundColor","primary","icons","Divider","Reconciled","setFilter","$eq","Select","disablePointerEvents","MenuItem","idNameMap","checked","includes","ListItemText","renderValue","renderValues","v","$in","input","Input","$or","bizName","deptName","op2ValidOptions","date1","op1","None","Equal","GreaterThan","GreaterThanOrEqual","addDays","LessThan","LessThanOrEqual","subDays","MIN_DATE","DateFilter","setFilterCb","setOp1","setDate1","op2","setOp2","date2","setDate2","validOp2s","queries","$and","op","mongoOp","opSym","startOfDay","dateFormat","onChangeOp1","op2Valid","filters","onChangeOp2","onChangeDate1","isDateValid","onChangeDate2","onClickClear","stopPropagation","IconButton","ArrowDropDown","anchorEl","setAnchorEl","currentTarget","Popover","marginTop","JournalMode","total1","TotalInputProps","setTotal1","total2","setTotal2","total2Fraction","total1Fraction","onChangeTotal1","total2Faction","onChangeTotal2","total1Faction","addOperators","OperatorType","EXPRESSION","$expressionCb","obj","expr","QUERY","$queryCb","selector","lhs","rhs","entriesGen","entries","refundType","refund","ON_ENTRY_UPSERT","RECONCILE_ENTRY","RECONCILE_REFUND","Journal","journalTitle","mode","addEntryOpen","setAddEntryOpen","addEntryOnClose","updateEntryOpen","setUpdateEntryOpen","updateEntry","setUpdateEntry","updateEntryOnClose","updateEntryOnExited","setDeleteEntry","deleteEntryOnClose","addRefundOpen","setAddRefundOpen","addRefundToEntry","setAddRefundToEntry","addRefundOnClose","addRefundOnExited","updateRefundOpen","setUpdateRefundOpen","updateRefund","setUpdateRefund","updateRefundOnClose","updateRefundOnExited","setDeleteRefund","deleteRefundOnClose","reconcileEntry","reconcilingEntry","reconcileRefund","reconcilingRefund","matchDecedentTree","fetchPolicy","subscribeToMore","isLoading","journalEntries","document","updateQuery","prev","subscriptionData","upsertEntry","journalEntryUpserted","every","journalEntriesFiltered","assign","p","Done","searchable","filterComponent","columnDef","onFilterChanged","tableData","hidden","filtering","defaultSort","sorting","localization","toolbar","searchTooltip","nRowsSelected","rowStyle","green","red","maxBodyHeight","headerStyle","pageSize","pageSizeOptions","showTitle","selection","showSelectAllCheckbox","debounceInterval","columnsButton","thirdSortClick","CheckCircle","all","isCredit","detailPanelState","components","Body","TableBody","TableRow","TableCell","colSpan","align","Typography","Row","onToggleDetailPanel","delete","detailPanel","isJournalEntry","hasItems","openIcon","aggregate","setAggregate","aggregateSpan","tableRef","mTData","page","orderBy","orderDirection","collection","Fuse","threshold","useExtendedSearch","getFn","toFixed","result","pipeline","$match","$addFields","_dateStr_","_totalRational_","$project","$facet","raw","_sortBy_","$toDate","$cond","if","$ifNull","else","$concat","$sort","$skip","$limit","Aggregator","run","showDetailPanel","copyShowDetailPanel","clear","totalCount","newAggregate","onQueryChange","GET_REPORT_DATA_DEPT_FRAGMENT","GET_REPORT_DATA_ENTRY_FRAGMENT","GET_REPORT_DATA","colorMeter","percentSpent","shade","orange","BudgetMeter","spentPercentage","height","grey","Dashboard","deptReport","subDeptBudgetAg","budget","amount","spent","descendants","subDept","subBudget","deptReportObj","entryTotal","budgetF","totalRemaining","spentToBudgetRatio","div","subDeptCards","card","Card","CardHeader","titleTypographyProps","noWrap","CardContent","onClickAddEntry","Container","Link","to","flexGrow","DEPTS_FOR_NAV","TopNav","rootDepts","virtualRoots","Set","virtualRoot","subDepts","showSubDepts","minWidth","InputLabel","autoWidth","pt","DashBoardRender","useParams","DEPARTMENT_NAME","JournalViewRender","View","JournalReconcileRender","Routes","exact","App","CssBaseline","Boolean","hostname","ReactDOM","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.cad3c0f2.chunk.js","sourcesContent":["import {\n  InMemoryCache,\n  IntrospectionFragmentMatcher,\n} from \"apollo-cache-inmemory\";\n\nimport introspectionQueryResultData from \"./fragmentTypes.json\";\n\nconst fragmentMatcher = new IntrospectionFragmentMatcher({\n  introspectionQueryResultData,\n});\n\nconst inMemoryCache = new InMemoryCache({ fragmentMatcher, addTypename: true });\n\nexport default inMemoryCache;\n","import gql from 'graphql-tag';\n\nexport default gql`\n\n  type LC_JournalEntryUpsertSource {\n    sourceType:JournalEntrySourceType!\n    id:ID!\n  }\n\n  type LC_JournalEntryUpsertFields {\n    id:ID\n    date:String\n    department:[ID!]!\n    type:ID\n    paymentMethod:ID\n    total:Rational\n    source:[LC_JournalEntryUpsertSource!]!\n  }\n\n  type LC_JournalEntryUpsertInputValues {\n    deptInput:String\n    totalInput:String\n    srcInput:String\n    srcType:JournalEntrySourceType\n  }\n\n  type LC_JournalEntryUpsertInputErrors {\n    dateError:String\n    deptError:String\n    typeError:String\n    payMethodError:String\n    totalError:String\n    srcError:String\n  }\n\n  enum LC_JournalEntryUpsertSubmitStatus {\n    NOT_SUBMITTED\n    SUBMITTING\n    SUBMITTED\n  }\n\n  enum LC_JournalEntryUpsertType {\n    UPDATE\n    ADD\n  }\n\n  type LC_JournalEntryUpsert {\n    id:ID!\n    valid:Boolean!\n    type:LC_JournalEntryUpsertType!\n    submitStatus:LC_JournalEntryUpsertSubmitStatus!\n    submitError:String\n    inputValues:LC_JournalEntryUpsertInputValues!\n    inputErrors:LC_JournalEntryUpsertInputErrors!\n    fields:LC_JournalEntryUpsertFields!\n  }\n\n  extend type Query {\n    lc_journalEntryUpserts:[LC_JournalEntryUpsert!]!\n  }\n  \n`;","import { GraphQLResolveInfo, GraphQLScalarType, GraphQLScalarTypeConfig } from 'graphql';\nimport { Context } from './types';\nexport type Maybe<T> = T | null;\nexport type Omit<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>;\nexport type RequireFields<T, K extends keyof T> = { [X in Exclude<keyof T, K>]?: T[X] } & { [P in K]-?: NonNullable<T[P]> };\n/** All built-in and custom scalars, mapped to their actual values */\nexport type Scalars = {\n  ID: string;\n  String: string;\n  Boolean: boolean;\n  Int: number;\n  Float: number;\n  /** The `Upload` scalar type represents a file upload. */\n  Upload: any;\n};\n\nexport type Budget = {\n   __typename?: 'Budget';\n  id: Scalars['ID'];\n  amount: Rational;\n  owner: BudgetOwner;\n};\n\nexport type BudgetOwner = Department | Business;\n\nexport type Business = {\n   __typename?: 'Business';\n  id: Scalars['ID'];\n  name: Scalars['String'];\n  budget?: Maybe<Budget>;\n  departments: Array<Department>;\n  vendor?: Maybe<Vendor>;\n};\n\nexport type BusinessAddFields = {\n  name: Scalars['String'];\n};\n\nexport type ByIdFilter = {\n  eq?: Maybe<Scalars['ID']>;\n};\n\nexport enum CacheControlScope {\n  Public = 'PUBLIC',\n  Private = 'PRIVATE'\n}\n\nexport type Department = {\n   __typename?: 'Department';\n  id: Scalars['ID'];\n  name: Scalars['String'];\n  code?: Maybe<Scalars['String']>;\n  budget?: Maybe<Budget>;\n  business: Business;\n  parent: DepartmentAncestor;\n  ancestors: Array<DepartmentAncestor>;\n  descendants: Array<Department>;\n  virtualRoot?: Maybe<Scalars['Boolean']>;\n};\n\nexport type DepartmentAddFields = {\n  name: Scalars['String'];\n};\n\nexport type DepartmentAncestor = Department | Business;\n\nexport enum FilterType {\n  Include = 'INCLUDE',\n  Exclude = 'EXCLUDE'\n}\n\nexport type JournalEntiresWhereInput = {\n  date?: Maybe<WhereDate>;\n  department?: Maybe<JournalEntriesWhereDepartment>;\n  category?: Maybe<JournalEntriesWhereCategory>;\n  source?: Maybe<JournalEntriesWhereSource>;\n  paymentMethod?: Maybe<JournalEntriesWherePaymentMethod>;\n  total?: Maybe<WhereRational>;\n  reconciled?: Maybe<Scalars['Boolean']>;\n  deleted?: Maybe<Scalars['Boolean']>;\n  lastUpdate?: Maybe<WhereDate>;\n  lastUpdateRefund?: Maybe<WhereDate>;\n  lastUpdateItem?: Maybe<WhereDate>;\n  or?: Maybe<Array<Maybe<JournalEntiresWhereInput>>>;\n  and?: Maybe<Array<Maybe<JournalEntiresWhereInput>>>;\n};\n\nexport type JournalEntriesWhereCategory = {\n  eq?: Maybe<Scalars['ID']>;\n  ne?: Maybe<Scalars['ID']>;\n  in?: Maybe<Array<Maybe<Scalars['ID']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['ID']>>>;\n  matchDecedentTree?: Maybe<Scalars['Boolean']>;\n};\n\n/** Where */\nexport type JournalEntriesWhereDepartment = {\n  eq?: Maybe<Scalars['ID']>;\n  ne?: Maybe<Scalars['ID']>;\n  in?: Maybe<Array<Maybe<Scalars['ID']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['ID']>>>;\n  matchDecedentTree?: Maybe<Scalars['Boolean']>;\n};\n\nexport type JournalEntriesWherePaymentMethod = {\n  eq?: Maybe<Scalars['ID']>;\n  ne?: Maybe<Scalars['ID']>;\n  in?: Maybe<Array<Maybe<Scalars['ID']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['ID']>>>;\n  matchDecedentTree?: Maybe<Scalars['Boolean']>;\n};\n\nexport type JournalEntriesWhereSource = {\n  sourceType: JournalEntrySourceType;\n  eq?: Maybe<Scalars['ID']>;\n  ne?: Maybe<Scalars['ID']>;\n  in?: Maybe<Array<Maybe<Scalars['ID']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['ID']>>>;\n};\n\nexport type JournalEntry = {\n   __typename?: 'JournalEntry';\n  id: Scalars['ID'];\n  refunds: Array<JournalEntryRefund>;\n  items: Array<JournalEntryItem>;\n  type: JournalEntryType;\n  date: Scalars['String'];\n  department: Department;\n  category: JournalEntryCategory;\n  paymentMethod: PaymentMethod;\n  description?: Maybe<Scalars['String']>;\n  total: Rational;\n  source: JournalEntrySource;\n  reconciled: Scalars['Boolean'];\n  lastUpdate: Scalars['String'];\n  deleted: Scalars['Boolean'];\n};\n\nexport type JournalEntryAddFields = {\n  date: Scalars['String'];\n  department: Scalars['ID'];\n  type: JournalEntryType;\n  category: Scalars['ID'];\n  paymentMethod: Scalars['ID'];\n  description?: Maybe<Scalars['String']>;\n  total: RationalInput;\n  source: JournalEntrySourceInput;\n  reconciled?: Maybe<Scalars['Boolean']>;\n};\n\nexport type JournalEntryAddItemFields = {\n  department?: Maybe<Scalars['ID']>;\n  category?: Maybe<Scalars['ID']>;\n  description?: Maybe<Scalars['String']>;\n  units: Scalars['Int'];\n  total: RationalInput;\n};\n\nexport type JournalEntryAddRefundFields = {\n  date: Scalars['String'];\n  description?: Maybe<Scalars['String']>;\n  paymentMethod: Scalars['ID'];\n  total: RationalInput;\n  reconciled?: Maybe<Scalars['Boolean']>;\n};\n\nexport type JournalEntryCategory = {\n   __typename?: 'JournalEntryCategory';\n  id: Scalars['ID'];\n  name: Scalars['String'];\n  type: JournalEntryType;\n  parent?: Maybe<JournalEntryCategory>;\n  ancestors: Array<JournalEntryCategory>;\n  children: Array<JournalEntryCategory>;\n};\n\nexport type JournalEntryCategoryWhereInput = {\n  name?: Maybe<JournalEntryCategoryWhereNameInput>;\n  type?: Maybe<JournalEntryCategoryWhereTypeInput>;\n  hasParent?: Maybe<Scalars['Boolean']>;\n  parent?: Maybe<JournalEntryCategoryWhereParentInput>;\n  or?: Maybe<Array<Maybe<JournalEntryCategoryWhereInput>>>;\n  and?: Maybe<Array<Maybe<JournalEntryCategoryWhereInput>>>;\n};\n\nexport type JournalEntryCategoryWhereNameInput = {\n  eq?: Maybe<Scalars['String']>;\n  ne?: Maybe<Scalars['String']>;\n  in?: Maybe<Array<Maybe<Scalars['String']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['String']>>>;\n};\n\nexport type JournalEntryCategoryWhereParentInput = {\n  eq?: Maybe<Scalars['ID']>;\n  ne?: Maybe<Scalars['ID']>;\n  in?: Maybe<Array<Maybe<Scalars['ID']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['ID']>>>;\n};\n\nexport type JournalEntryCategoryWhereTypeInput = {\n  eq?: Maybe<JournalEntryType>;\n  ne?: Maybe<JournalEntryType>;\n};\n\n/** Items */\nexport type JournalEntryItem = {\n   __typename?: 'JournalEntryItem';\n  id: Scalars['ID'];\n  department?: Maybe<Department>;\n  category?: Maybe<JournalEntryCategory>;\n  description?: Maybe<Scalars['String']>;\n  units: Scalars['Int'];\n  total: Rational;\n  lastUpdate: Scalars['String'];\n  deleted: Scalars['Boolean'];\n};\n\nexport type JournalEntryItemUpsertResult = {\n   __typename?: 'JournalEntryItemUpsertResult';\n  journalEntryItem: JournalEntryItem;\n  journalEntry: JournalEntry;\n};\n\n/** Refunds */\nexport type JournalEntryRefund = {\n   __typename?: 'JournalEntryRefund';\n  id: Scalars['ID'];\n  date: Scalars['String'];\n  description?: Maybe<Scalars['String']>;\n  paymentMethod: PaymentMethod;\n  total: Rational;\n  reconciled: Scalars['Boolean'];\n  lastUpdate: Scalars['String'];\n  deleted: Scalars['Boolean'];\n};\n\nexport type JournalEntrySource = Person | Business | Department;\n\nexport type JournalEntrySourceInput = {\n  sourceType: JournalEntrySourceType;\n  id: Scalars['ID'];\n};\n\nexport enum JournalEntrySourceType {\n  Business = 'BUSINESS',\n  Department = 'DEPARTMENT',\n  Person = 'PERSON'\n}\n\nexport enum JournalEntryType {\n  Credit = 'CREDIT',\n  Debit = 'DEBIT'\n}\n\nexport type JournalEntryUpdateFields = {\n  date?: Maybe<Scalars['String']>;\n  department?: Maybe<Scalars['ID']>;\n  type?: Maybe<JournalEntryType>;\n  category?: Maybe<Scalars['ID']>;\n  paymentMethod?: Maybe<Scalars['ID']>;\n  description?: Maybe<Scalars['String']>;\n  total?: Maybe<RationalInput>;\n  source?: Maybe<JournalEntrySourceInput>;\n  reconciled?: Maybe<Scalars['Boolean']>;\n};\n\nexport type JournalEntryUpdateItemFields = {\n  department?: Maybe<Scalars['ID']>;\n  category?: Maybe<Scalars['ID']>;\n  description?: Maybe<Scalars['String']>;\n  units?: Maybe<Scalars['Int']>;\n  total?: Maybe<RationalInput>;\n};\n\nexport type JournalEntryUpdatePaymentMethod = {\n  id: Scalars['ID'];\n  fields: PaymentMethodUpdateFields;\n};\n\nexport type JournalEntryUpdateRefundFields = {\n  date?: Maybe<Scalars['String']>;\n  description?: Maybe<Scalars['String']>;\n  paymentMethod?: Maybe<Scalars['ID']>;\n  total?: Maybe<RationalInput>;\n  reconciled?: Maybe<Scalars['Boolean']>;\n};\n\nexport type Lc_JournalEntryUpsert = {\n   __typename?: 'LC_JournalEntryUpsert';\n  id: Scalars['ID'];\n  valid: Scalars['Boolean'];\n  type: Lc_JournalEntryUpsertType;\n  submitStatus: Lc_JournalEntryUpsertSubmitStatus;\n  submitError?: Maybe<Scalars['String']>;\n  inputValues: Lc_JournalEntryUpsertInputValues;\n  inputErrors: Lc_JournalEntryUpsertInputErrors;\n  fields: Lc_JournalEntryUpsertFields;\n};\n\nexport type Lc_JournalEntryUpsertFields = {\n   __typename?: 'LC_JournalEntryUpsertFields';\n  id?: Maybe<Scalars['ID']>;\n  date?: Maybe<Scalars['String']>;\n  department: Array<Scalars['ID']>;\n  type?: Maybe<Scalars['ID']>;\n  paymentMethod?: Maybe<Scalars['ID']>;\n  total?: Maybe<Rational>;\n  source: Array<Lc_JournalEntryUpsertSource>;\n};\n\nexport type Lc_JournalEntryUpsertInputErrors = {\n   __typename?: 'LC_JournalEntryUpsertInputErrors';\n  dateError?: Maybe<Scalars['String']>;\n  deptError?: Maybe<Scalars['String']>;\n  typeError?: Maybe<Scalars['String']>;\n  payMethodError?: Maybe<Scalars['String']>;\n  totalError?: Maybe<Scalars['String']>;\n  srcError?: Maybe<Scalars['String']>;\n};\n\nexport type Lc_JournalEntryUpsertInputValues = {\n   __typename?: 'LC_JournalEntryUpsertInputValues';\n  deptInput?: Maybe<Scalars['String']>;\n  totalInput?: Maybe<Scalars['String']>;\n  srcInput?: Maybe<Scalars['String']>;\n  srcType?: Maybe<JournalEntrySourceType>;\n};\n\nexport type Lc_JournalEntryUpsertSource = {\n   __typename?: 'LC_JournalEntryUpsertSource';\n  sourceType: JournalEntrySourceType;\n  id: Scalars['ID'];\n};\n\nexport enum Lc_JournalEntryUpsertSubmitStatus {\n  NotSubmitted = 'NOT_SUBMITTED',\n  Submitting = 'SUBMITTING',\n  Submitted = 'SUBMITTED'\n}\n\nexport enum Lc_JournalEntryUpsertType {\n  Update = 'UPDATE',\n  Add = 'ADD'\n}\n\nexport type Mutation = {\n   __typename?: 'Mutation';\n  addBusiness: Business;\n  journalEntryUpdate: JournalEntry;\n  journalEntryAdd: JournalEntry;\n  journalEntryDelete: JournalEntry;\n  journalEntryAddRefund: JournalEntry;\n  journalEntryUpdateRefund: JournalEntry;\n  journalEntryDeleteRefund: JournalEntry;\n  journalEntryAddItem: JournalEntryItemUpsertResult;\n  journalEntryUpdateItem: JournalEntryItemUpsertResult;\n  journalEntryDeleteItem: JournalEntryItemUpsertResult;\n  paymentMethodUpdate: PaymentMethod;\n  paymentMethodAdd: PaymentMethod;\n  addPerson: Person;\n};\n\n\nexport type MutationAddBusinessArgs = {\n  fields: BusinessAddFields;\n};\n\n\nexport type MutationJournalEntryUpdateArgs = {\n  id: Scalars['ID'];\n  fields: JournalEntryUpdateFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n  paymentMethodUpdate?: Maybe<JournalEntryUpdatePaymentMethod>;\n  personAdd?: Maybe<PersonAddFields>;\n  businessAdd?: Maybe<BusinessAddFields>;\n};\n\n\nexport type MutationJournalEntryAddArgs = {\n  fields: JournalEntryAddFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n  personAdd?: Maybe<PersonAddFields>;\n  businessAdd?: Maybe<BusinessAddFields>;\n};\n\n\nexport type MutationJournalEntryDeleteArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type MutationJournalEntryAddRefundArgs = {\n  id: Scalars['ID'];\n  fields: JournalEntryAddRefundFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n};\n\n\nexport type MutationJournalEntryUpdateRefundArgs = {\n  id: Scalars['ID'];\n  fields: JournalEntryUpdateRefundFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n  paymentMethodUpdate?: Maybe<JournalEntryUpdatePaymentMethod>;\n};\n\n\nexport type MutationJournalEntryDeleteRefundArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type MutationJournalEntryAddItemArgs = {\n  id: Scalars['ID'];\n  fields: JournalEntryAddItemFields;\n};\n\n\nexport type MutationJournalEntryUpdateItemArgs = {\n  id: Scalars['ID'];\n  fields: JournalEntryUpdateItemFields;\n};\n\n\nexport type MutationJournalEntryDeleteItemArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type MutationPaymentMethodUpdateArgs = {\n  id: Scalars['ID'];\n  fields: PaymentMethodUpdateFields;\n};\n\n\nexport type MutationPaymentMethodAddArgs = {\n  fields: PaymentMethodAddFields;\n};\n\n\nexport type MutationAddPersonArgs = {\n  fields: PersonAddFields;\n};\n\nexport type PaginateInput = {\n  skip: Scalars['Int'];\n  limit: Scalars['Int'];\n};\n\nexport type PaymentMethod = {\n   __typename?: 'PaymentMethod';\n  id: Scalars['ID'];\n  active: Scalars['Boolean'];\n  refId?: Maybe<Scalars['String']>;\n  name: Scalars['String'];\n  parent?: Maybe<PaymentMethod>;\n  ancestors: Array<PaymentMethod>;\n  children: Array<PaymentMethod>;\n  allowChildren: Scalars['Boolean'];\n  authorization: Array<PaymentMethodAuthorization>;\n};\n\nexport type PaymentMethodAddFields = {\n  active: Scalars['Boolean'];\n  refId?: Maybe<Scalars['String']>;\n  name: Scalars['String'];\n  parent: Scalars['ID'];\n};\n\nexport type PaymentMethodAuthorization = {\n   __typename?: 'PaymentMethodAuthorization';\n  owner: Scalars['Boolean'];\n  entity?: Maybe<PaymentMethodAuthorizedEntity>;\n};\n\nexport type PaymentMethodAuthorizedEntity = Person | Business | Department;\n\nexport type PaymentMethodUpdateFields = {\n  active?: Maybe<Scalars['Boolean']>;\n  refId?: Maybe<Scalars['String']>;\n  name?: Maybe<Scalars['String']>;\n};\n\nexport type PaymentMethodWhereInput = {\n  active?: Maybe<Scalars['Boolean']>;\n  refId?: Maybe<PaymentMethodWhereRefIdInput>;\n  name?: Maybe<PaymentMethodWhereNameInput>;\n  hasParent?: Maybe<Scalars['Boolean']>;\n  parent?: Maybe<PaymentMethodWhereParentInput>;\n  or?: Maybe<Array<Maybe<PaymentMethodWhereInput>>>;\n  and?: Maybe<Array<Maybe<PaymentMethodWhereInput>>>;\n};\n\nexport type PaymentMethodWhereNameInput = {\n  eq?: Maybe<Scalars['String']>;\n  ne?: Maybe<Scalars['String']>;\n  in?: Maybe<Array<Maybe<Scalars['String']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['String']>>>;\n};\n\nexport type PaymentMethodWhereParentInput = {\n  eq?: Maybe<Scalars['ID']>;\n  ne?: Maybe<Scalars['ID']>;\n  in?: Maybe<Array<Maybe<Scalars['ID']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['ID']>>>;\n};\n\nexport type PaymentMethodWhereRefIdInput = {\n  eq?: Maybe<Scalars['String']>;\n  ne?: Maybe<Scalars['String']>;\n  in?: Maybe<Array<Maybe<Scalars['String']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['String']>>>;\n};\n\nexport type Person = {\n   __typename?: 'Person';\n  id: Scalars['ID'];\n  name: PersonName;\n};\n\nexport type PersonAddFields = {\n  name: PersonNameInput;\n};\n\nexport type PersonName = {\n   __typename?: 'PersonName';\n  first: Scalars['String'];\n  last: Scalars['String'];\n};\n\nexport type PersonNameInput = {\n  first: Scalars['String'];\n  last: Scalars['String'];\n};\n\nexport type Query = {\n   __typename?: 'Query';\n  budget: Budget;\n  budgets: Array<Budget>;\n  business: Business;\n  businesses: Array<Business>;\n  department?: Maybe<Department>;\n  departments: Array<Department>;\n  journalEntries: Array<JournalEntry>;\n  journalEntry?: Maybe<JournalEntry>;\n  journalEntryCategories: Array<JournalEntryCategory>;\n  journalEntryCategory: JournalEntryCategory;\n  journalEntryItem?: Maybe<JournalEntryItem>;\n  journalEntryRefund?: Maybe<JournalEntryRefund>;\n  journalEntrySources: Array<JournalEntrySource>;\n  lc_journalEntryUpserts: Array<Lc_JournalEntryUpsert>;\n  paymentMethod?: Maybe<PaymentMethod>;\n  paymentMethods: Array<PaymentMethod>;\n  people: Array<Person>;\n};\n\n\nexport type QueryBudgetArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryBusinessArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryBusinessesArgs = {\n  searchByName?: Maybe<Scalars['String']>;\n};\n\n\nexport type QueryDepartmentArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryDepartmentsArgs = {\n  fromParent?: Maybe<Scalars['ID']>;\n  searchByName?: Maybe<Scalars['String']>;\n};\n\n\nexport type QueryJournalEntriesArgs = {\n  where?: Maybe<JournalEntiresWhereInput>;\n};\n\n\nexport type QueryJournalEntryArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryJournalEntryCategoriesArgs = {\n  where?: Maybe<JournalEntryCategoryWhereInput>;\n};\n\n\nexport type QueryJournalEntryCategoryArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryJournalEntryItemArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryJournalEntryRefundArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryJournalEntrySourcesArgs = {\n  searchByName: Scalars['String'];\n};\n\n\nexport type QueryPaymentMethodArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryPaymentMethodsArgs = {\n  where?: Maybe<PaymentMethodWhereInput>;\n};\n\n\nexport type QueryPeopleArgs = {\n  searchByName?: Maybe<PersonNameInput>;\n};\n\nexport type Rational = {\n   __typename?: 'Rational';\n  n: Scalars['Int'];\n  d: Scalars['Int'];\n  s: RationalSign;\n};\n\nexport type RationalInput = {\n  n: Scalars['Int'];\n  d: Scalars['Int'];\n  s: RationalSign;\n};\n\nexport enum RationalSign {\n  Pos = 'POS',\n  Neg = 'NEG'\n}\n\nexport enum SortDirection {\n  Asc = 'ASC',\n  Desc = 'DESC'\n}\n\nexport type Subscription = {\n   __typename?: 'Subscription';\n  journalEntryAdded: JournalEntry;\n  journalEntryUpdated: JournalEntry;\n  journalEntryUpserted: JournalEntry;\n};\n\n\nexport type User = {\n   __typename?: 'User';\n  id: Scalars['ID'];\n  user: Person;\n};\n\nexport type Vendor = {\n   __typename?: 'Vendor';\n  approved: Scalars['Boolean'];\n  vendorId?: Maybe<Scalars['ID']>;\n};\n\nexport type WhereDate = {\n  eq?: Maybe<Scalars['String']>;\n  ne?: Maybe<Scalars['String']>;\n  gt?: Maybe<Scalars['String']>;\n  gte?: Maybe<Scalars['String']>;\n  lt?: Maybe<Scalars['String']>;\n  lte?: Maybe<Scalars['String']>;\n  ignoreTime?: Maybe<Scalars['Boolean']>;\n};\n\nexport type WhereRational = {\n  eq?: Maybe<RationalInput>;\n  ne?: Maybe<RationalInput>;\n  gt?: Maybe<RationalInput>;\n  gte?: Maybe<RationalInput>;\n  lt?: Maybe<RationalInput>;\n  lte?: Maybe<RationalInput>;\n};\n\nexport type WhereRegexInput = {\n  pattern: Scalars['String'];\n  flags?: Maybe<Scalars['String']>;\n};\n\nexport type DepartmentName_1QueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type DepartmentName_1Query = { __typename?: 'Query', department?: Maybe<{ __typename: 'Department', id: string, name: string }> };\n\nexport type DeptForUpsertAddQueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type DeptForUpsertAddQuery = { __typename?: 'Query', department?: Maybe<(\n    { __typename?: 'Department' }\n    & DeptEntryOptFragment\n  )> };\n\nexport type OnEntryUpsert_2SubscriptionVariables = {};\n\n\nexport type OnEntryUpsert_2Subscription = { __typename?: 'Subscription', journalEntryUpserted: (\n    { __typename?: 'JournalEntry', department: { __typename?: 'Department', ancestors: Array<{ __typename: 'Department', id: string } | { __typename?: 'Business' }> } }\n    & GetReportDataEntry_1Fragment\n  ) };\n\nexport type GetReportDataDept_1Fragment = { __typename: 'Department', id: string, name: string, budget?: Maybe<{ __typename: 'Budget', id: string, amount: { __typename?: 'Rational', n: number, d: number, s: RationalSign } }> };\n\nexport type GetReportDataEntry_1Fragment = { __typename: 'JournalEntry', id: string, type: JournalEntryType, lastUpdate: string, deleted: boolean, category: { __typename: 'JournalEntryCategory', id: string, name: string }, total: { __typename?: 'Rational', n: number, d: number, s: RationalSign }, department: { __typename: 'Department', id: string, ancestors: Array<{ __typename: 'Department', id: string } | { __typename: 'Business', id: string }> }, refunds: Array<{ __typename: 'JournalEntryRefund', id: string, deleted: boolean, lastUpdate: string, total: { __typename?: 'Rational', n: number, d: number, s: RationalSign } }> };\n\nexport type GetReportDataQueryVariables = {\n  deptId: Scalars['ID'];\n  where: JournalEntiresWhereInput;\n};\n\n\nexport type GetReportDataQuery = { __typename?: 'Query', department?: Maybe<(\n    { __typename?: 'Department', descendants: Array<(\n      { __typename?: 'Department' }\n      & GetReportDataDept_1Fragment\n    )> }\n    & GetReportDataDept_1Fragment\n  )>, journalEntries: Array<(\n    { __typename?: 'JournalEntry' }\n    & GetReportDataEntry_1Fragment\n  )> };\n\nexport type JournalEntryAdded_2SubscriptionVariables = {};\n\n\nexport type JournalEntryAdded_2Subscription = { __typename?: 'Subscription', journalEntryAdded: (\n    { __typename?: 'JournalEntry' }\n    & GetReportDataEntry_1Fragment\n  ) };\n\nexport type JournalEntryUpdated_2SubscriptionVariables = {};\n\n\nexport type JournalEntryUpdated_2Subscription = { __typename?: 'Subscription', journalEntryUpdated: (\n    { __typename?: 'JournalEntry' }\n    & GetReportDataEntry_1Fragment\n  ) };\n\nexport type OnEntryUpsert_1SubscriptionVariables = {};\n\n\nexport type OnEntryUpsert_1Subscription = { __typename?: 'Subscription', journalEntryUpserted: (\n    { __typename?: 'JournalEntry', department: { __typename?: 'Department', ancestors: Array<{ __typename: 'Department', id: string } | { __typename?: 'Business' }> } }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type ReconcileEntryMutationVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type ReconcileEntryMutation = { __typename?: 'Mutation', journalEntryUpdate: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type ReconcileRefundMutationVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type ReconcileRefundMutation = { __typename?: 'Mutation', journalEntryUpdateRefund: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type JournalEntryPayMethod_1Fragment = { __typename: 'PaymentMethod', id: string, name: string, parent?: Maybe<{ __typename: 'PaymentMethod', id: string }> };\n\nexport type JournalEntryCategory_1Fragment = { __typename: 'JournalEntryCategory', id: string, type: JournalEntryType, name: string };\n\nexport type JournalEntryDept_1Fragment = { __typename: 'Department', id: string, name: string, ancestors: Array<{ __typename: 'Department', id: string, deptName: string } | { __typename: 'Business', id: string, bizName: string }> };\n\nexport type JournalEntryRefund_1Fragment = { __typename: 'JournalEntryRefund', id: string, date: string, description?: Maybe<string>, reconciled: boolean, lastUpdate: string, deleted: boolean, total: { __typename?: 'Rational', n: number, d: number, s: RationalSign }, paymentMethod: (\n    { __typename?: 'PaymentMethod' }\n    & JournalEntryPayMethod_1Fragment\n  ) };\n\nexport type JournalEntryItem_1Fragment = { __typename: 'JournalEntryItem', id: string, units: number, description?: Maybe<string>, lastUpdate: string, deleted: boolean, category?: Maybe<(\n    { __typename?: 'JournalEntryCategory' }\n    & JournalEntryCategory_1Fragment\n  )>, department?: Maybe<(\n    { __typename?: 'Department' }\n    & JournalEntryDept_1Fragment\n  )>, total: { __typename?: 'Rational', n: number, d: number, s: RationalSign } };\n\nexport type JournalEntry_1Fragment = { __typename: 'JournalEntry', id: string, date: string, type: JournalEntryType, description?: Maybe<string>, deleted: boolean, lastUpdate: string, reconciled: boolean, department: (\n    { __typename: 'Department', id: string, name: string, ancestors: Array<{ __typename: 'Department', id: string, deptName: string } | { __typename: 'Business', id: string, bizName: string }> }\n    & JournalEntryDept_1Fragment\n  ), category: (\n    { __typename?: 'JournalEntryCategory' }\n    & JournalEntryCategory_1Fragment\n  ), paymentMethod: (\n    { __typename?: 'PaymentMethod' }\n    & JournalEntryPayMethod_1Fragment\n  ), source: { __typename: 'Person', id: string, name: { __typename?: 'PersonName', first: string, last: string } } | { __typename: 'Business', id: string, bizName: string } | { __typename: 'Department', id: string, deptName: string }, total: { __typename?: 'Rational', n: number, d: number, s: RationalSign }, refunds: Array<(\n    { __typename?: 'JournalEntryRefund' }\n    & JournalEntryRefund_1Fragment\n  )>, items: Array<(\n    { __typename?: 'JournalEntryItem' }\n    & JournalEntryItem_1Fragment\n  )> };\n\nexport type JournalEntries_1QueryVariables = {\n  where: JournalEntiresWhereInput;\n};\n\n\nexport type JournalEntries_1Query = { __typename?: 'Query', journalEntries: Array<(\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  )> };\n\nexport type JournalEntryAdded_1SubscriptionVariables = {};\n\n\nexport type JournalEntryAdded_1Subscription = { __typename?: 'Subscription', journalEntryAdded: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type JournalEntryUpdated_1SubscriptionVariables = {};\n\n\nexport type JournalEntryUpdated_1Subscription = { __typename?: 'Subscription', journalEntryUpdated: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type DeptIniValueForAddEntryQueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type DeptIniValueForAddEntryQuery = { __typename?: 'Query', department?: Maybe<(\n    { __typename?: 'Department' }\n    & DeptEntryOptFragment\n  )> };\n\nexport type DeleteEntryMutationVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type DeleteEntryMutation = { __typename?: 'Mutation', journalEntryDelete: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type UpdateEntryIniStateQueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type UpdateEntryIniStateQuery = { __typename?: 'Query', journalEntry?: Maybe<{ __typename: 'JournalEntry', id: string, type: JournalEntryType, date: string, description?: Maybe<string>, reconciled: boolean, department: (\n      { __typename?: 'Department' }\n      & DeptEntryOptFragment\n    ), category: (\n      { __typename?: 'JournalEntryCategory', ancestors: Array<(\n        { __typename?: 'JournalEntryCategory' }\n        & CatEntryOptFragment\n      )> }\n      & CatEntryOptFragment\n    ), source: (\n      { __typename?: 'Person' }\n      & SrcEntryPersonOptFragment\n    ) | (\n      { __typename?: 'Business' }\n      & SrcEntryBizOptFragment\n    ) | (\n      { __typename?: 'Department', ancestors: Array<(\n        { __typename?: 'Department' }\n        & SrcEntryDeptOptFragment\n      ) | (\n        { __typename?: 'Business' }\n        & SrcEntryBizOptFragment\n      )> }\n      & SrcEntryDeptOptFragment\n    ), paymentMethod: (\n      { __typename?: 'PaymentMethod', ancestors: Array<(\n        { __typename?: 'PaymentMethod' }\n        & PayMethodEntryOptFragment\n      )> }\n      & PayMethodEntryOptFragment\n    ), total: { __typename?: 'Rational', n: number, d: number, s: RationalSign }, refunds: Array<{ __typename: 'JournalEntryRefund', id: string, deleted: boolean, date: string, total: { __typename?: 'Rational', n: number, d: number, s: RationalSign } }> }> };\n\nexport type AddEntryMutationVariables = {\n  fields: JournalEntryAddFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n  personAdd?: Maybe<PersonAddFields>;\n  businessAdd?: Maybe<BusinessAddFields>;\n};\n\n\nexport type AddEntryMutation = { __typename?: 'Mutation', journalEntryAdd: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type UpdateEntryMutationVariables = {\n  id: Scalars['ID'];\n  fields: JournalEntryUpdateFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n  paymentMethodUpdate?: Maybe<JournalEntryUpdatePaymentMethod>;\n  personAdd?: Maybe<PersonAddFields>;\n  businessAdd?: Maybe<BusinessAddFields>;\n};\n\n\nexport type UpdateEntryMutation = { __typename?: 'Mutation', journalEntryUpdate: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type CatEntryOptsQueryVariables = {\n  where: JournalEntryCategoryWhereInput;\n};\n\n\nexport type CatEntryOptsQuery = { __typename?: 'Query', catOpts: Array<(\n    { __typename?: 'JournalEntryCategory' }\n    & CatEntryOptFragment\n  )> };\n\nexport type DeptEntryOptsQueryVariables = {\n  fromParent?: Maybe<Scalars['ID']>;\n};\n\n\nexport type DeptEntryOptsQuery = { __typename?: 'Query', deptOpts: Array<(\n    { __typename?: 'Department' }\n    & DeptEntryOptFragment\n  )> };\n\nexport type PayMethodEntryOptsQueryVariables = {\n  where: PaymentMethodWhereInput;\n};\n\n\nexport type PayMethodEntryOptsQuery = { __typename?: 'Query', paymentMethods: Array<(\n    { __typename?: 'PaymentMethod' }\n    & PayMethodEntryOptFragment\n  )> };\n\nexport type SrcEntryOptsQueryVariables = {\n  name: Scalars['String'];\n  isBiz: Scalars['Boolean'];\n};\n\n\nexport type SrcEntryOptsQuery = { __typename?: 'Query', businesses: Array<(\n    { __typename?: 'Business' }\n    & SrcEntryBizOptFragment\n  )>, people: Array<(\n    { __typename?: 'Person' }\n    & SrcEntryPersonOptFragment\n  )> };\n\nexport type GetEntryItemState_1QueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type GetEntryItemState_1Query = { __typename?: 'Query', journalEntry?: Maybe<(\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_3Fragment\n  )> };\n\nexport type DeleteItemMutationVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type DeleteItemMutation = { __typename?: 'Mutation', journalEntryDeleteItem: { __typename?: 'JournalEntryItemUpsertResult', journalEntryItem: { __typename: 'JournalEntryItem', id: string, deleted: boolean } } };\n\nexport type UpdateItemIniStateQueryVariables = {\n  entryId: Scalars['ID'];\n  itemId: Scalars['ID'];\n};\n\n\nexport type UpdateItemIniStateQuery = { __typename?: 'Query', journalEntry?: Maybe<(\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_3Fragment\n  )>, journalEntryItem?: Maybe<{ __typename: 'JournalEntryItem', id: string, description?: Maybe<string>, units: number, department?: Maybe<(\n      { __typename?: 'Department' }\n      & DeptEntryOptFragment\n    )>, category?: Maybe<(\n      { __typename?: 'JournalEntryCategory', ancestors: Array<(\n        { __typename?: 'JournalEntryCategory' }\n        & CatEntryOptFragment\n      )> }\n      & CatEntryOptFragment\n    )>, total: { __typename?: 'Rational', n: number, d: number, s: RationalSign } }> };\n\nexport type JournalEntry_3Fragment = { __typename: 'JournalEntry', id: string, type: JournalEntryType, total: { __typename?: 'Rational', n: number, d: number, s: RationalSign }, items: Array<{ __typename: 'JournalEntryItem', id: string, deleted: boolean, total: { __typename?: 'Rational', n: number, d: number, s: RationalSign } }> };\n\nexport type AddEntryItemMutationVariables = {\n  id: Scalars['ID'];\n  fields: JournalEntryAddItemFields;\n};\n\n\nexport type AddEntryItemMutation = { __typename?: 'Mutation', journalEntryAddItem: { __typename?: 'JournalEntryItemUpsertResult', journalEntry: (\n      { __typename?: 'JournalEntry' }\n      & JournalEntry_1Fragment\n    ) } };\n\nexport type UpdateEntryItemMutationVariables = {\n  id: Scalars['ID'];\n  fields: JournalEntryUpdateItemFields;\n};\n\n\nexport type UpdateEntryItemMutation = { __typename?: 'Mutation', journalEntryUpdateItem: { __typename?: 'JournalEntryItemUpsertResult', journalEntryItem: (\n      { __typename?: 'JournalEntryItem' }\n      & JournalEntryItem_1Fragment\n    ) } };\n\nexport type GetEntryRefundInfo_1QueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type GetEntryRefundInfo_1Query = { __typename?: 'Query', journalEntry?: Maybe<(\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_2Fragment\n  )> };\n\nexport type DeleteRefundMutationVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type DeleteRefundMutation = { __typename?: 'Mutation', journalEntryDeleteRefund: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type UpdateRefundIniStateQueryVariables = {\n  entryId: Scalars['ID'];\n  refundId: Scalars['ID'];\n};\n\n\nexport type UpdateRefundIniStateQuery = { __typename?: 'Query', journalEntry?: Maybe<(\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_2Fragment\n  )>, journalEntryRefund?: Maybe<{ __typename: 'JournalEntryRefund', id: string, date: string, description?: Maybe<string>, reconciled: boolean, paymentMethod: (\n      { __typename?: 'PaymentMethod', ancestors: Array<(\n        { __typename?: 'PaymentMethod' }\n        & PayMethodEntryOptFragment\n      )> }\n      & PayMethodEntryOptFragment\n    ), total: { __typename?: 'Rational', n: number, d: number, s: RationalSign } }> };\n\nexport type JournalEntry_2Fragment = { __typename: 'JournalEntry', id: string, date: string, type: JournalEntryType, total: { __typename?: 'Rational', n: number, d: number, s: RationalSign }, refunds: Array<{ __typename: 'JournalEntryRefund', id: string, deleted: boolean, total: { __typename?: 'Rational', n: number, d: number, s: RationalSign } }> };\n\nexport type AddEntryRefundMutationVariables = {\n  id: Scalars['ID'];\n  fields: JournalEntryAddRefundFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n};\n\n\nexport type AddEntryRefundMutation = { __typename?: 'Mutation', journalEntryAddRefund: { __typename: 'JournalEntry', id: string, refunds: Array<(\n      { __typename?: 'JournalEntryRefund' }\n      & JournalEntryRefund_1Fragment\n    )> } };\n\nexport type UpdateRefundMutationVariables = {\n  id: Scalars['ID'];\n  fields: JournalEntryUpdateRefundFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n  paymentMethodUpdate?: Maybe<JournalEntryUpdatePaymentMethod>;\n};\n\n\nexport type UpdateRefundMutation = { __typename?: 'Mutation', journalEntryUpdateRefund: { __typename: 'JournalEntry', id: string, refunds: Array<(\n      { __typename?: 'JournalEntryRefund' }\n      & JournalEntryRefund_1Fragment\n    )> } };\n\nexport type DeptEntryOptFragment = { __typename: 'Department', id: string, name: string, parent: { __typename: 'Department', id: string } | { __typename: 'Business', id: string } };\n\nexport type CatEntryOptFragment = { __typename: 'JournalEntryCategory', id: string, name: string, type: JournalEntryType, parent?: Maybe<{ __typename: 'JournalEntryCategory', id: string }> };\n\nexport type SrcEntryPersonOptFragment = { __typename: 'Person', id: string, personName: { __typename?: 'PersonName', first: string, last: string } };\n\nexport type SrcEntryDeptOptFragment = { __typename: 'Department', id: string, name: string, parent: { __typename: 'Department', id: string } | { __typename: 'Business', id: string } };\n\nexport type SrcEntryBizOptFragment = { __typename: 'Business', id: string, name: string, vendor?: Maybe<{ __typename?: 'Vendor', approved: boolean, vendorId?: Maybe<string> }>, departments: Array<(\n    { __typename?: 'Department' }\n    & SrcEntryDeptOptFragment\n  )> };\n\nexport type PayMethodEntryOptFragment = { __typename: 'PaymentMethod', id: string, refId?: Maybe<string>, name: string, active: boolean, parent?: Maybe<{ __typename: 'PaymentMethod', id: string }> };\n\nexport type DeptsForNav_1QueryVariables = {};\n\n\nexport type DeptsForNav_1Query = { __typename?: 'Query', departments: Array<{ __typename: 'Department', id: string, name: string, virtualRoot?: Maybe<boolean>, parent: { __typename: 'Department', id: string } | { __typename: 'Business', id: string } }> };\n\n\n\nexport type ResolverTypeWrapper<T> = Promise<T> | T;\n\nexport type Resolver<TResult, TParent = {}, TContext = {}, TArgs = {}> = ResolverFn<TResult, TParent, TContext, TArgs>;\n\nexport type ResolverFn<TResult, TParent, TContext, TArgs> = (\n  parent: TParent,\n  args: TArgs,\n  context: TContext,\n  info: GraphQLResolveInfo\n) => Promise<TResult> | TResult;\n\nexport type SubscriptionSubscribeFn<TResult, TParent, TContext, TArgs> = (\n  parent: TParent,\n  args: TArgs,\n  context: TContext,\n  info: GraphQLResolveInfo\n) => AsyncIterator<TResult> | Promise<AsyncIterator<TResult>>;\n\nexport type SubscriptionResolveFn<TResult, TParent, TContext, TArgs> = (\n  parent: TParent,\n  args: TArgs,\n  context: TContext,\n  info: GraphQLResolveInfo\n) => TResult | Promise<TResult>;\n\nexport interface SubscriptionSubscriberObject<TResult, TKey extends string, TParent, TContext, TArgs> {\n  subscribe: SubscriptionSubscribeFn<{ [key in TKey]: TResult }, TParent, TContext, TArgs>;\n  resolve?: SubscriptionResolveFn<TResult, { [key in TKey]: TResult }, TContext, TArgs>;\n}\n\nexport interface SubscriptionResolverObject<TResult, TParent, TContext, TArgs> {\n  subscribe: SubscriptionSubscribeFn<any, TParent, TContext, TArgs>;\n  resolve: SubscriptionResolveFn<TResult, any, TContext, TArgs>;\n}\n\nexport type SubscriptionObject<TResult, TKey extends string, TParent, TContext, TArgs> =\n  | SubscriptionSubscriberObject<TResult, TKey, TParent, TContext, TArgs>\n  | SubscriptionResolverObject<TResult, TParent, TContext, TArgs>;\n\nexport type SubscriptionResolver<TResult, TKey extends string, TParent = {}, TContext = {}, TArgs = {}> =\n  | ((...args: any[]) => SubscriptionObject<TResult, TKey, TParent, TContext, TArgs>)\n  | SubscriptionObject<TResult, TKey, TParent, TContext, TArgs>;\n\nexport type TypeResolveFn<TTypes, TParent = {}, TContext = {}> = (\n  parent: TParent,\n  context: TContext,\n  info: GraphQLResolveInfo\n) => Maybe<TTypes> | Promise<Maybe<TTypes>>;\n\nexport type isTypeOfResolverFn<T = {}> = (obj: T, info: GraphQLResolveInfo) => boolean | Promise<boolean>;\n\nexport type NextResolverFn<T> = () => Promise<T>;\n\nexport type DirectiveResolverFn<TResult = {}, TParent = {}, TContext = {}, TArgs = {}> = (\n  next: NextResolverFn<TResult>,\n  parent: TParent,\n  args: TArgs,\n  context: TContext,\n  info: GraphQLResolveInfo\n) => TResult | Promise<TResult>;\n\n/** Mapping between all available schema types and the resolvers types */\nexport type ResolversTypes = {\n  Query: ResolverTypeWrapper<{}>,\n  ID: ResolverTypeWrapper<Scalars['ID']>,\n  Budget: ResolverTypeWrapper<Omit<Budget, 'owner'> & { owner: ResolversTypes['BudgetOwner'] }>,\n  Rational: ResolverTypeWrapper<Rational>,\n  Int: ResolverTypeWrapper<Scalars['Int']>,\n  RationalSign: RationalSign,\n  BudgetOwner: ResolversTypes['Department'] | ResolversTypes['Business'],\n  Department: ResolverTypeWrapper<Omit<Department, 'parent' | 'ancestors'> & { parent: ResolversTypes['DepartmentAncestor'], ancestors: Array<ResolversTypes['DepartmentAncestor']> }>,\n  String: ResolverTypeWrapper<Scalars['String']>,\n  Business: ResolverTypeWrapper<Business>,\n  Vendor: ResolverTypeWrapper<Vendor>,\n  Boolean: ResolverTypeWrapper<Scalars['Boolean']>,\n  DepartmentAncestor: ResolversTypes['Department'] | ResolversTypes['Business'],\n  JournalEntiresWhereInput: JournalEntiresWhereInput,\n  WhereDate: WhereDate,\n  JournalEntriesWhereDepartment: JournalEntriesWhereDepartment,\n  JournalEntriesWhereCategory: JournalEntriesWhereCategory,\n  JournalEntriesWhereSource: JournalEntriesWhereSource,\n  JournalEntrySourceType: JournalEntrySourceType,\n  JournalEntriesWherePaymentMethod: JournalEntriesWherePaymentMethod,\n  WhereRational: WhereRational,\n  RationalInput: RationalInput,\n  JournalEntry: ResolverTypeWrapper<Omit<JournalEntry, 'source'> & { source: ResolversTypes['JournalEntrySource'] }>,\n  JournalEntryRefund: ResolverTypeWrapper<JournalEntryRefund>,\n  PaymentMethod: ResolverTypeWrapper<PaymentMethod>,\n  PaymentMethodAuthorization: ResolverTypeWrapper<Omit<PaymentMethodAuthorization, 'entity'> & { entity?: Maybe<ResolversTypes['PaymentMethodAuthorizedEntity']> }>,\n  PaymentMethodAuthorizedEntity: ResolversTypes['Person'] | ResolversTypes['Business'] | ResolversTypes['Department'],\n  Person: ResolverTypeWrapper<Person>,\n  PersonName: ResolverTypeWrapper<PersonName>,\n  JournalEntryItem: ResolverTypeWrapper<JournalEntryItem>,\n  JournalEntryCategory: ResolverTypeWrapper<JournalEntryCategory>,\n  JournalEntryType: JournalEntryType,\n  JournalEntrySource: ResolversTypes['Person'] | ResolversTypes['Business'] | ResolversTypes['Department'],\n  JournalEntryCategoryWhereInput: JournalEntryCategoryWhereInput,\n  JournalEntryCategoryWhereNameInput: JournalEntryCategoryWhereNameInput,\n  JournalEntryCategoryWhereTypeInput: JournalEntryCategoryWhereTypeInput,\n  JournalEntryCategoryWhereParentInput: JournalEntryCategoryWhereParentInput,\n  LC_JournalEntryUpsert: ResolverTypeWrapper<Lc_JournalEntryUpsert>,\n  LC_JournalEntryUpsertType: Lc_JournalEntryUpsertType,\n  LC_JournalEntryUpsertSubmitStatus: Lc_JournalEntryUpsertSubmitStatus,\n  LC_JournalEntryUpsertInputValues: ResolverTypeWrapper<Lc_JournalEntryUpsertInputValues>,\n  LC_JournalEntryUpsertInputErrors: ResolverTypeWrapper<Lc_JournalEntryUpsertInputErrors>,\n  LC_JournalEntryUpsertFields: ResolverTypeWrapper<Lc_JournalEntryUpsertFields>,\n  LC_JournalEntryUpsertSource: ResolverTypeWrapper<Lc_JournalEntryUpsertSource>,\n  PaymentMethodWhereInput: PaymentMethodWhereInput,\n  PaymentMethodWhereRefIdInput: PaymentMethodWhereRefIdInput,\n  PaymentMethodWhereNameInput: PaymentMethodWhereNameInput,\n  PaymentMethodWhereParentInput: PaymentMethodWhereParentInput,\n  PersonNameInput: PersonNameInput,\n  Mutation: ResolverTypeWrapper<{}>,\n  BusinessAddFields: BusinessAddFields,\n  JournalEntryUpdateFields: JournalEntryUpdateFields,\n  JournalEntrySourceInput: JournalEntrySourceInput,\n  PaymentMethodAddFields: PaymentMethodAddFields,\n  JournalEntryUpdatePaymentMethod: JournalEntryUpdatePaymentMethod,\n  PaymentMethodUpdateFields: PaymentMethodUpdateFields,\n  PersonAddFields: PersonAddFields,\n  JournalEntryAddFields: JournalEntryAddFields,\n  JournalEntryAddRefundFields: JournalEntryAddRefundFields,\n  JournalEntryUpdateRefundFields: JournalEntryUpdateRefundFields,\n  JournalEntryAddItemFields: JournalEntryAddItemFields,\n  JournalEntryItemUpsertResult: ResolverTypeWrapper<JournalEntryItemUpsertResult>,\n  JournalEntryUpdateItemFields: JournalEntryUpdateItemFields,\n  Subscription: ResolverTypeWrapper<{}>,\n  DepartmentAddFields: DepartmentAddFields,\n  SortDirection: SortDirection,\n  FilterType: FilterType,\n  PaginateInput: PaginateInput,\n  ByIdFilter: ByIdFilter,\n  WhereRegexInput: WhereRegexInput,\n  User: ResolverTypeWrapper<User>,\n  CacheControlScope: CacheControlScope,\n  Upload: ResolverTypeWrapper<Scalars['Upload']>,\n};\n\n/** Mapping between all available schema types and the resolvers parents */\nexport type ResolversParentTypes = {\n  Query: {},\n  ID: Scalars['ID'],\n  Budget: Omit<Budget, 'owner'> & { owner: ResolversParentTypes['BudgetOwner'] },\n  Rational: Rational,\n  Int: Scalars['Int'],\n  RationalSign: RationalSign,\n  BudgetOwner: ResolversParentTypes['Department'] | ResolversParentTypes['Business'],\n  Department: Omit<Department, 'parent' | 'ancestors'> & { parent: ResolversParentTypes['DepartmentAncestor'], ancestors: Array<ResolversParentTypes['DepartmentAncestor']> },\n  String: Scalars['String'],\n  Business: Business,\n  Vendor: Vendor,\n  Boolean: Scalars['Boolean'],\n  DepartmentAncestor: ResolversParentTypes['Department'] | ResolversParentTypes['Business'],\n  JournalEntiresWhereInput: JournalEntiresWhereInput,\n  WhereDate: WhereDate,\n  JournalEntriesWhereDepartment: JournalEntriesWhereDepartment,\n  JournalEntriesWhereCategory: JournalEntriesWhereCategory,\n  JournalEntriesWhereSource: JournalEntriesWhereSource,\n  JournalEntrySourceType: JournalEntrySourceType,\n  JournalEntriesWherePaymentMethod: JournalEntriesWherePaymentMethod,\n  WhereRational: WhereRational,\n  RationalInput: RationalInput,\n  JournalEntry: Omit<JournalEntry, 'source'> & { source: ResolversParentTypes['JournalEntrySource'] },\n  JournalEntryRefund: JournalEntryRefund,\n  PaymentMethod: PaymentMethod,\n  PaymentMethodAuthorization: Omit<PaymentMethodAuthorization, 'entity'> & { entity?: Maybe<ResolversParentTypes['PaymentMethodAuthorizedEntity']> },\n  PaymentMethodAuthorizedEntity: ResolversParentTypes['Person'] | ResolversParentTypes['Business'] | ResolversParentTypes['Department'],\n  Person: Person,\n  PersonName: PersonName,\n  JournalEntryItem: JournalEntryItem,\n  JournalEntryCategory: JournalEntryCategory,\n  JournalEntryType: JournalEntryType,\n  JournalEntrySource: ResolversParentTypes['Person'] | ResolversParentTypes['Business'] | ResolversParentTypes['Department'],\n  JournalEntryCategoryWhereInput: JournalEntryCategoryWhereInput,\n  JournalEntryCategoryWhereNameInput: JournalEntryCategoryWhereNameInput,\n  JournalEntryCategoryWhereTypeInput: JournalEntryCategoryWhereTypeInput,\n  JournalEntryCategoryWhereParentInput: JournalEntryCategoryWhereParentInput,\n  LC_JournalEntryUpsert: Lc_JournalEntryUpsert,\n  LC_JournalEntryUpsertType: Lc_JournalEntryUpsertType,\n  LC_JournalEntryUpsertSubmitStatus: Lc_JournalEntryUpsertSubmitStatus,\n  LC_JournalEntryUpsertInputValues: Lc_JournalEntryUpsertInputValues,\n  LC_JournalEntryUpsertInputErrors: Lc_JournalEntryUpsertInputErrors,\n  LC_JournalEntryUpsertFields: Lc_JournalEntryUpsertFields,\n  LC_JournalEntryUpsertSource: Lc_JournalEntryUpsertSource,\n  PaymentMethodWhereInput: PaymentMethodWhereInput,\n  PaymentMethodWhereRefIdInput: PaymentMethodWhereRefIdInput,\n  PaymentMethodWhereNameInput: PaymentMethodWhereNameInput,\n  PaymentMethodWhereParentInput: PaymentMethodWhereParentInput,\n  PersonNameInput: PersonNameInput,\n  Mutation: {},\n  BusinessAddFields: BusinessAddFields,\n  JournalEntryUpdateFields: JournalEntryUpdateFields,\n  JournalEntrySourceInput: JournalEntrySourceInput,\n  PaymentMethodAddFields: PaymentMethodAddFields,\n  JournalEntryUpdatePaymentMethod: JournalEntryUpdatePaymentMethod,\n  PaymentMethodUpdateFields: PaymentMethodUpdateFields,\n  PersonAddFields: PersonAddFields,\n  JournalEntryAddFields: JournalEntryAddFields,\n  JournalEntryAddRefundFields: JournalEntryAddRefundFields,\n  JournalEntryUpdateRefundFields: JournalEntryUpdateRefundFields,\n  JournalEntryAddItemFields: JournalEntryAddItemFields,\n  JournalEntryItemUpsertResult: JournalEntryItemUpsertResult,\n  JournalEntryUpdateItemFields: JournalEntryUpdateItemFields,\n  Subscription: {},\n  DepartmentAddFields: DepartmentAddFields,\n  SortDirection: SortDirection,\n  FilterType: FilterType,\n  PaginateInput: PaginateInput,\n  ByIdFilter: ByIdFilter,\n  WhereRegexInput: WhereRegexInput,\n  User: User,\n  CacheControlScope: CacheControlScope,\n  Upload: Scalars['Upload'],\n};\n\nexport type BudgetResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Budget'] = ResolversParentTypes['Budget']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  amount?: Resolver<ResolversTypes['Rational'], ParentType, ContextType>,\n  owner?: Resolver<ResolversTypes['BudgetOwner'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type BudgetOwnerResolvers<ContextType = Context, ParentType extends ResolversParentTypes['BudgetOwner'] = ResolversParentTypes['BudgetOwner']> = {\n  __resolveType: TypeResolveFn<'Department' | 'Business', ParentType, ContextType>\n};\n\nexport type BusinessResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Business'] = ResolversParentTypes['Business']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  name?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  budget?: Resolver<Maybe<ResolversTypes['Budget']>, ParentType, ContextType>,\n  departments?: Resolver<Array<ResolversTypes['Department']>, ParentType, ContextType>,\n  vendor?: Resolver<Maybe<ResolversTypes['Vendor']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type DepartmentResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Department'] = ResolversParentTypes['Department']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  name?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  code?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  budget?: Resolver<Maybe<ResolversTypes['Budget']>, ParentType, ContextType>,\n  business?: Resolver<ResolversTypes['Business'], ParentType, ContextType>,\n  parent?: Resolver<ResolversTypes['DepartmentAncestor'], ParentType, ContextType>,\n  ancestors?: Resolver<Array<ResolversTypes['DepartmentAncestor']>, ParentType, ContextType>,\n  descendants?: Resolver<Array<ResolversTypes['Department']>, ParentType, ContextType>,\n  virtualRoot?: Resolver<Maybe<ResolversTypes['Boolean']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type DepartmentAncestorResolvers<ContextType = Context, ParentType extends ResolversParentTypes['DepartmentAncestor'] = ResolversParentTypes['DepartmentAncestor']> = {\n  __resolveType: TypeResolveFn<'Department' | 'Business', ParentType, ContextType>\n};\n\nexport type JournalEntryResolvers<ContextType = Context, ParentType extends ResolversParentTypes['JournalEntry'] = ResolversParentTypes['JournalEntry']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  refunds?: Resolver<Array<ResolversTypes['JournalEntryRefund']>, ParentType, ContextType>,\n  items?: Resolver<Array<ResolversTypes['JournalEntryItem']>, ParentType, ContextType>,\n  type?: Resolver<ResolversTypes['JournalEntryType'], ParentType, ContextType>,\n  date?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  department?: Resolver<ResolversTypes['Department'], ParentType, ContextType>,\n  category?: Resolver<ResolversTypes['JournalEntryCategory'], ParentType, ContextType>,\n  paymentMethod?: Resolver<ResolversTypes['PaymentMethod'], ParentType, ContextType>,\n  description?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  total?: Resolver<ResolversTypes['Rational'], ParentType, ContextType>,\n  source?: Resolver<ResolversTypes['JournalEntrySource'], ParentType, ContextType>,\n  reconciled?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  lastUpdate?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  deleted?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type JournalEntryCategoryResolvers<ContextType = Context, ParentType extends ResolversParentTypes['JournalEntryCategory'] = ResolversParentTypes['JournalEntryCategory']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  name?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  type?: Resolver<ResolversTypes['JournalEntryType'], ParentType, ContextType>,\n  parent?: Resolver<Maybe<ResolversTypes['JournalEntryCategory']>, ParentType, ContextType>,\n  ancestors?: Resolver<Array<ResolversTypes['JournalEntryCategory']>, ParentType, ContextType>,\n  children?: Resolver<Array<ResolversTypes['JournalEntryCategory']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type JournalEntryItemResolvers<ContextType = Context, ParentType extends ResolversParentTypes['JournalEntryItem'] = ResolversParentTypes['JournalEntryItem']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  department?: Resolver<Maybe<ResolversTypes['Department']>, ParentType, ContextType>,\n  category?: Resolver<Maybe<ResolversTypes['JournalEntryCategory']>, ParentType, ContextType>,\n  description?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  units?: Resolver<ResolversTypes['Int'], ParentType, ContextType>,\n  total?: Resolver<ResolversTypes['Rational'], ParentType, ContextType>,\n  lastUpdate?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  deleted?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type JournalEntryItemUpsertResultResolvers<ContextType = Context, ParentType extends ResolversParentTypes['JournalEntryItemUpsertResult'] = ResolversParentTypes['JournalEntryItemUpsertResult']> = {\n  journalEntryItem?: Resolver<ResolversTypes['JournalEntryItem'], ParentType, ContextType>,\n  journalEntry?: Resolver<ResolversTypes['JournalEntry'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type JournalEntryRefundResolvers<ContextType = Context, ParentType extends ResolversParentTypes['JournalEntryRefund'] = ResolversParentTypes['JournalEntryRefund']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  date?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  description?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  paymentMethod?: Resolver<ResolversTypes['PaymentMethod'], ParentType, ContextType>,\n  total?: Resolver<ResolversTypes['Rational'], ParentType, ContextType>,\n  reconciled?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  lastUpdate?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  deleted?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type JournalEntrySourceResolvers<ContextType = Context, ParentType extends ResolversParentTypes['JournalEntrySource'] = ResolversParentTypes['JournalEntrySource']> = {\n  __resolveType: TypeResolveFn<'Person' | 'Business' | 'Department', ParentType, ContextType>\n};\n\nexport type Lc_JournalEntryUpsertResolvers<ContextType = Context, ParentType extends ResolversParentTypes['LC_JournalEntryUpsert'] = ResolversParentTypes['LC_JournalEntryUpsert']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  valid?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  type?: Resolver<ResolversTypes['LC_JournalEntryUpsertType'], ParentType, ContextType>,\n  submitStatus?: Resolver<ResolversTypes['LC_JournalEntryUpsertSubmitStatus'], ParentType, ContextType>,\n  submitError?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  inputValues?: Resolver<ResolversTypes['LC_JournalEntryUpsertInputValues'], ParentType, ContextType>,\n  inputErrors?: Resolver<ResolversTypes['LC_JournalEntryUpsertInputErrors'], ParentType, ContextType>,\n  fields?: Resolver<ResolversTypes['LC_JournalEntryUpsertFields'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type Lc_JournalEntryUpsertFieldsResolvers<ContextType = Context, ParentType extends ResolversParentTypes['LC_JournalEntryUpsertFields'] = ResolversParentTypes['LC_JournalEntryUpsertFields']> = {\n  id?: Resolver<Maybe<ResolversTypes['ID']>, ParentType, ContextType>,\n  date?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  department?: Resolver<Array<ResolversTypes['ID']>, ParentType, ContextType>,\n  type?: Resolver<Maybe<ResolversTypes['ID']>, ParentType, ContextType>,\n  paymentMethod?: Resolver<Maybe<ResolversTypes['ID']>, ParentType, ContextType>,\n  total?: Resolver<Maybe<ResolversTypes['Rational']>, ParentType, ContextType>,\n  source?: Resolver<Array<ResolversTypes['LC_JournalEntryUpsertSource']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type Lc_JournalEntryUpsertInputErrorsResolvers<ContextType = Context, ParentType extends ResolversParentTypes['LC_JournalEntryUpsertInputErrors'] = ResolversParentTypes['LC_JournalEntryUpsertInputErrors']> = {\n  dateError?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  deptError?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  typeError?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  payMethodError?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  totalError?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  srcError?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type Lc_JournalEntryUpsertInputValuesResolvers<ContextType = Context, ParentType extends ResolversParentTypes['LC_JournalEntryUpsertInputValues'] = ResolversParentTypes['LC_JournalEntryUpsertInputValues']> = {\n  deptInput?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  totalInput?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  srcInput?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  srcType?: Resolver<Maybe<ResolversTypes['JournalEntrySourceType']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type Lc_JournalEntryUpsertSourceResolvers<ContextType = Context, ParentType extends ResolversParentTypes['LC_JournalEntryUpsertSource'] = ResolversParentTypes['LC_JournalEntryUpsertSource']> = {\n  sourceType?: Resolver<ResolversTypes['JournalEntrySourceType'], ParentType, ContextType>,\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type MutationResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Mutation'] = ResolversParentTypes['Mutation']> = {\n  addBusiness?: Resolver<ResolversTypes['Business'], ParentType, ContextType, RequireFields<MutationAddBusinessArgs, 'fields'>>,\n  journalEntryUpdate?: Resolver<ResolversTypes['JournalEntry'], ParentType, ContextType, RequireFields<MutationJournalEntryUpdateArgs, 'id' | 'fields'>>,\n  journalEntryAdd?: Resolver<ResolversTypes['JournalEntry'], ParentType, ContextType, RequireFields<MutationJournalEntryAddArgs, 'fields'>>,\n  journalEntryDelete?: Resolver<ResolversTypes['JournalEntry'], ParentType, ContextType, RequireFields<MutationJournalEntryDeleteArgs, 'id'>>,\n  journalEntryAddRefund?: Resolver<ResolversTypes['JournalEntry'], ParentType, ContextType, RequireFields<MutationJournalEntryAddRefundArgs, 'id' | 'fields'>>,\n  journalEntryUpdateRefund?: Resolver<ResolversTypes['JournalEntry'], ParentType, ContextType, RequireFields<MutationJournalEntryUpdateRefundArgs, 'id' | 'fields'>>,\n  journalEntryDeleteRefund?: Resolver<ResolversTypes['JournalEntry'], ParentType, ContextType, RequireFields<MutationJournalEntryDeleteRefundArgs, 'id'>>,\n  journalEntryAddItem?: Resolver<ResolversTypes['JournalEntryItemUpsertResult'], ParentType, ContextType, RequireFields<MutationJournalEntryAddItemArgs, 'id' | 'fields'>>,\n  journalEntryUpdateItem?: Resolver<ResolversTypes['JournalEntryItemUpsertResult'], ParentType, ContextType, RequireFields<MutationJournalEntryUpdateItemArgs, 'id' | 'fields'>>,\n  journalEntryDeleteItem?: Resolver<ResolversTypes['JournalEntryItemUpsertResult'], ParentType, ContextType, RequireFields<MutationJournalEntryDeleteItemArgs, 'id'>>,\n  paymentMethodUpdate?: Resolver<ResolversTypes['PaymentMethod'], ParentType, ContextType, RequireFields<MutationPaymentMethodUpdateArgs, 'id' | 'fields'>>,\n  paymentMethodAdd?: Resolver<ResolversTypes['PaymentMethod'], ParentType, ContextType, RequireFields<MutationPaymentMethodAddArgs, 'fields'>>,\n  addPerson?: Resolver<ResolversTypes['Person'], ParentType, ContextType, RequireFields<MutationAddPersonArgs, 'fields'>>,\n};\n\nexport type PaymentMethodResolvers<ContextType = Context, ParentType extends ResolversParentTypes['PaymentMethod'] = ResolversParentTypes['PaymentMethod']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  active?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  refId?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  name?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  parent?: Resolver<Maybe<ResolversTypes['PaymentMethod']>, ParentType, ContextType>,\n  ancestors?: Resolver<Array<ResolversTypes['PaymentMethod']>, ParentType, ContextType>,\n  children?: Resolver<Array<ResolversTypes['PaymentMethod']>, ParentType, ContextType>,\n  allowChildren?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  authorization?: Resolver<Array<ResolversTypes['PaymentMethodAuthorization']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type PaymentMethodAuthorizationResolvers<ContextType = Context, ParentType extends ResolversParentTypes['PaymentMethodAuthorization'] = ResolversParentTypes['PaymentMethodAuthorization']> = {\n  owner?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  entity?: Resolver<Maybe<ResolversTypes['PaymentMethodAuthorizedEntity']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type PaymentMethodAuthorizedEntityResolvers<ContextType = Context, ParentType extends ResolversParentTypes['PaymentMethodAuthorizedEntity'] = ResolversParentTypes['PaymentMethodAuthorizedEntity']> = {\n  __resolveType: TypeResolveFn<'Person' | 'Business' | 'Department', ParentType, ContextType>\n};\n\nexport type PersonResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Person'] = ResolversParentTypes['Person']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  name?: Resolver<ResolversTypes['PersonName'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type PersonNameResolvers<ContextType = Context, ParentType extends ResolversParentTypes['PersonName'] = ResolversParentTypes['PersonName']> = {\n  first?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  last?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type QueryResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Query'] = ResolversParentTypes['Query']> = {\n  budget?: Resolver<ResolversTypes['Budget'], ParentType, ContextType, RequireFields<QueryBudgetArgs, 'id'>>,\n  budgets?: Resolver<Array<ResolversTypes['Budget']>, ParentType, ContextType>,\n  business?: Resolver<ResolversTypes['Business'], ParentType, ContextType, RequireFields<QueryBusinessArgs, 'id'>>,\n  businesses?: Resolver<Array<ResolversTypes['Business']>, ParentType, ContextType, RequireFields<QueryBusinessesArgs, never>>,\n  department?: Resolver<Maybe<ResolversTypes['Department']>, ParentType, ContextType, RequireFields<QueryDepartmentArgs, 'id'>>,\n  departments?: Resolver<Array<ResolversTypes['Department']>, ParentType, ContextType, RequireFields<QueryDepartmentsArgs, never>>,\n  journalEntries?: Resolver<Array<ResolversTypes['JournalEntry']>, ParentType, ContextType, RequireFields<QueryJournalEntriesArgs, never>>,\n  journalEntry?: Resolver<Maybe<ResolversTypes['JournalEntry']>, ParentType, ContextType, RequireFields<QueryJournalEntryArgs, 'id'>>,\n  journalEntryCategories?: Resolver<Array<ResolversTypes['JournalEntryCategory']>, ParentType, ContextType, RequireFields<QueryJournalEntryCategoriesArgs, never>>,\n  journalEntryCategory?: Resolver<ResolversTypes['JournalEntryCategory'], ParentType, ContextType, RequireFields<QueryJournalEntryCategoryArgs, 'id'>>,\n  journalEntryItem?: Resolver<Maybe<ResolversTypes['JournalEntryItem']>, ParentType, ContextType, RequireFields<QueryJournalEntryItemArgs, 'id'>>,\n  journalEntryRefund?: Resolver<Maybe<ResolversTypes['JournalEntryRefund']>, ParentType, ContextType, RequireFields<QueryJournalEntryRefundArgs, 'id'>>,\n  journalEntrySources?: Resolver<Array<ResolversTypes['JournalEntrySource']>, ParentType, ContextType, RequireFields<QueryJournalEntrySourcesArgs, 'searchByName'>>,\n  lc_journalEntryUpserts?: Resolver<Array<ResolversTypes['LC_JournalEntryUpsert']>, ParentType, ContextType>,\n  paymentMethod?: Resolver<Maybe<ResolversTypes['PaymentMethod']>, ParentType, ContextType, RequireFields<QueryPaymentMethodArgs, 'id'>>,\n  paymentMethods?: Resolver<Array<ResolversTypes['PaymentMethod']>, ParentType, ContextType, RequireFields<QueryPaymentMethodsArgs, never>>,\n  people?: Resolver<Array<ResolversTypes['Person']>, ParentType, ContextType, RequireFields<QueryPeopleArgs, never>>,\n};\n\nexport type RationalResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Rational'] = ResolversParentTypes['Rational']> = {\n  n?: Resolver<ResolversTypes['Int'], ParentType, ContextType>,\n  d?: Resolver<ResolversTypes['Int'], ParentType, ContextType>,\n  s?: Resolver<ResolversTypes['RationalSign'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type SubscriptionResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Subscription'] = ResolversParentTypes['Subscription']> = {\n  journalEntryAdded?: SubscriptionResolver<ResolversTypes['JournalEntry'], \"journalEntryAdded\", ParentType, ContextType>,\n  journalEntryUpdated?: SubscriptionResolver<ResolversTypes['JournalEntry'], \"journalEntryUpdated\", ParentType, ContextType>,\n  journalEntryUpserted?: SubscriptionResolver<ResolversTypes['JournalEntry'], \"journalEntryUpserted\", ParentType, ContextType>,\n};\n\nexport interface UploadScalarConfig extends GraphQLScalarTypeConfig<ResolversTypes['Upload'], any> {\n  name: 'Upload'\n}\n\nexport type UserResolvers<ContextType = Context, ParentType extends ResolversParentTypes['User'] = ResolversParentTypes['User']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  user?: Resolver<ResolversTypes['Person'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type VendorResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Vendor'] = ResolversParentTypes['Vendor']> = {\n  approved?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  vendorId?: Resolver<Maybe<ResolversTypes['ID']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type Resolvers<ContextType = Context> = {\n  Budget?: BudgetResolvers<ContextType>,\n  BudgetOwner?: BudgetOwnerResolvers,\n  Business?: BusinessResolvers<ContextType>,\n  Department?: DepartmentResolvers<ContextType>,\n  DepartmentAncestor?: DepartmentAncestorResolvers,\n  JournalEntry?: JournalEntryResolvers<ContextType>,\n  JournalEntryCategory?: JournalEntryCategoryResolvers<ContextType>,\n  JournalEntryItem?: JournalEntryItemResolvers<ContextType>,\n  JournalEntryItemUpsertResult?: JournalEntryItemUpsertResultResolvers<ContextType>,\n  JournalEntryRefund?: JournalEntryRefundResolvers<ContextType>,\n  JournalEntrySource?: JournalEntrySourceResolvers,\n  LC_JournalEntryUpsert?: Lc_JournalEntryUpsertResolvers<ContextType>,\n  LC_JournalEntryUpsertFields?: Lc_JournalEntryUpsertFieldsResolvers<ContextType>,\n  LC_JournalEntryUpsertInputErrors?: Lc_JournalEntryUpsertInputErrorsResolvers<ContextType>,\n  LC_JournalEntryUpsertInputValues?: Lc_JournalEntryUpsertInputValuesResolvers<ContextType>,\n  LC_JournalEntryUpsertSource?: Lc_JournalEntryUpsertSourceResolvers<ContextType>,\n  Mutation?: MutationResolvers<ContextType>,\n  PaymentMethod?: PaymentMethodResolvers<ContextType>,\n  PaymentMethodAuthorization?: PaymentMethodAuthorizationResolvers<ContextType>,\n  PaymentMethodAuthorizedEntity?: PaymentMethodAuthorizedEntityResolvers,\n  Person?: PersonResolvers<ContextType>,\n  PersonName?: PersonNameResolvers<ContextType>,\n  Query?: QueryResolvers<ContextType>,\n  Rational?: RationalResolvers<ContextType>,\n  Subscription?: SubscriptionResolvers<ContextType>,\n  Upload?: GraphQLScalarType,\n  User?: UserResolvers<ContextType>,\n  Vendor?: VendorResolvers<ContextType>,\n};\n\n\n/**\n * @deprecated\n * Use \"Resolvers\" root object instead. If you wish to get \"IResolvers\", add \"typesPrefix: I\" to your config.\n*/\nexport type IResolvers<ContextType = Context> = Resolvers<ContextType>;\n","\nimport {DocumentNode} from 'graphql';\n\nimport upsertJournalEntry from './schema/upsertJournalEntry.gql';\n\nexport default <DocumentNode[]>[\n  upsertJournalEntry\n];","import {Resolvers} from \"apollo-client\";\n\nconst resolvers:Resolvers = {};\n\nexport default resolvers;","import { BatchHttpLink } from 'apollo-link-batch-http';\nimport { WebSocketLink } from 'apollo-link-ws';\nimport { ApolloLink } from 'apollo-link';\nimport { onError } from 'apollo-link-error';\nimport { getMainDefinition } from 'apollo-utilities';\n\nconst batchHttpLink = new BatchHttpLink({\n  uri: '/graphql',\n  credentials: 'same-origin',\n});\n\nconst wsLink = new WebSocketLink({\n  uri: `ws://${window.location.host}/graphql`,\n  options: {\n    reconnect: true\n  }\n});\n\nconst link = ApolloLink.from([\n  onError(({ graphQLErrors, networkError }) => {\n    if (graphQLErrors)\n      graphQLErrors.forEach(({ message, locations, path }) =>\n        console.error(\n          `[GraphQL error]: Message: ${message}, Location: ${locations}, Path: ${path}`,\n        ),\n      );\n    if (networkError) console.log(`[Network error]: ${networkError}`);\n  }),\n  ApolloLink.split(({query}) => {\n    const def = getMainDefinition(query);\n    return def.kind === 'OperationDefinition'\n      && def.operation === 'subscription';\n  },wsLink, batchHttpLink)\n\n]);\n\nexport default link;","import { ApolloClient } from 'apollo-client';\n\nimport cache from './inMemoryCache';\nimport typeDefs from './typeDefs';\nimport resolvers from './resolvers';\nimport link from './link';\n\nexport default new ApolloClient({\n  link,\n  cache,\n  typeDefs,\n  resolvers\n});","import gql from \"graphql-tag\";\n\nexport const JOURNAL_ENTRY_PAY_METHOD_FRAGMENT = gql`\n  fragment JournalEntryPayMethod_1Fragment on PaymentMethod {\n    __typename\n    id\n    name\n    parent {\n      __typename\n      id\n    }\n  }\n`;\n\nexport const JOURNAL_ENTRY_CATEGORY_FRAGMENT = gql`\n  fragment JournalEntryCategory_1Fragment on JournalEntryCategory {\n    __typename\n    id\n    type\n    name\n  }\n`;\n\nexport const JOURNAL_ENTRY_DEPT_FRAGMENT = gql`\n  fragment JournalEntryDept_1Fragment on Department {\n    __typename\n    id\n    name\n    ancestors {\n      __typename\n      ... on Business {\n        id\n        bizName: name\n      }\n      ... on Department {\n        id\n        deptName: name\n      }\n    }\n  }\n`;\n\nexport const JOURNAL_ENTRY_REFUND = gql`\n  fragment JournalEntryRefund_1Fragment on JournalEntryRefund {\n    __typename\n    id\n    date\n    description\n    total {\n      n\n      d\n      s\n    }\n    paymentMethod {\n      ...JournalEntryPayMethod_1Fragment\n    }\n    reconciled\n    lastUpdate\n    deleted\n  }\n  ${JOURNAL_ENTRY_PAY_METHOD_FRAGMENT}\n`;\n\nexport const JOURNAL_ENTRY_ITEM = gql`\n  fragment JournalEntryItem_1Fragment on JournalEntryItem {\n    __typename\n    id\n    category {\n      ...JournalEntryCategory_1Fragment\n    }\n    department {\n      ...JournalEntryDept_1Fragment\n    }\n    total {\n      n\n      d\n      s\n    }\n    units\n    description\n    lastUpdate\n    deleted\n  }\n  ${JOURNAL_ENTRY_CATEGORY_FRAGMENT}\n  ${JOURNAL_ENTRY_DEPT_FRAGMENT}\n`;\n\nexport const JOURNAL_ENTRY_FRAGMENT = gql`\n  fragment JournalEntry_1Fragment on JournalEntry {\n    __typename\n    id\n    date\n    department {\n      __typename\n      id\n      name\n      ancestors {\n        __typename\n        ... on Business {\n          id\n          bizName: name\n        }\n        ... on Department {\n          id\n          deptName: name\n        }\n      }\n    }\n    type\n    category {\n      ...JournalEntryCategory_1Fragment\n    }\n    department {\n      ...JournalEntryDept_1Fragment\n    }\n    description\n    paymentMethod {\n      ...JournalEntryPayMethod_1Fragment\n    }\n    source {\n      __typename\n      ... on Person {\n        id\n        name {\n          first\n          last\n        }\n      }\n      ... on Business {\n        id\n        bizName: name\n      }\n      ... on Department {\n        id\n        deptName: name\n      }\n    }\n    total {\n      n\n      d\n      s\n    }\n    refunds {\n      ...JournalEntryRefund_1Fragment\n    }\n    items {\n      ...JournalEntryItem_1Fragment\n    }\n    deleted\n    lastUpdate\n    reconciled\n  }\n  ${JOURNAL_ENTRY_PAY_METHOD_FRAGMENT}\n  ${JOURNAL_ENTRY_DEPT_FRAGMENT}\n  ${JOURNAL_ENTRY_CATEGORY_FRAGMENT}\n  ${JOURNAL_ENTRY_REFUND}\n  ${JOURNAL_ENTRY_ITEM}\n`;\n\nexport const JOURNAL_ENTRIES = gql`\n  query JournalEntries_1($where: JournalEntiresWhereInput!) {\n    journalEntries(where: $where)\n      @connection(key: \"JournalEntries_1\", filter: [\"where\"]) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nexport const JOURNAL_ENTRY_ADDED_SUB = gql`\n  subscription JournalEntryAdded_1 {\n    journalEntryAdded {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nexport const JOURNAL_ENTRY_UPDATED_SUB = gql`\n  subscription JournalEntryUpdated_1 {\n    journalEntryUpdated {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n","export const CHECK_ID = \"5dc46d0af74afb2c2805bd54\";\nexport const CREDIT_ID = \"5dc46d0af74afb2c2805bd55\";\n","import React, { forwardRef } from \"react\";\n\nimport {\n  AddBox,\n  ArrowDownward,\n  Check,\n  ChevronLeft,\n  ChevronRight,\n  Clear,\n  DeleteOutline,\n  Edit,\n  FilterList,\n  FirstPage,\n  LastPage,\n  Remove,\n  SaveAlt,\n  Search,\n  ViewColumn,\n} from \"@material-ui/icons\";\n\nconst tableIcons = {\n  Add: forwardRef<SVGSVGElement>((props, ref) => (\n    <AddBox {...props} ref={ref} />\n  )),\n  Check: forwardRef<SVGSVGElement>((props, ref) => (\n    <Check {...props} ref={ref} />\n  )),\n  Clear: forwardRef<SVGSVGElement>((props, ref) => (\n    <Clear {...props} ref={ref} />\n  )),\n  Delete: forwardRef<SVGSVGElement>((props, ref) => (\n    <DeleteOutline {...props} ref={ref} />\n  )),\n  DetailPanel: forwardRef<SVGSVGElement>((props, ref) => (\n    <ChevronRight {...props} ref={ref} />\n  )),\n  Edit: forwardRef<SVGSVGElement>((props, ref) => (\n    <Edit {...props} ref={ref} />\n  )),\n  Export: forwardRef<SVGSVGElement>((props, ref) => (\n    <SaveAlt {...props} ref={ref} />\n  )),\n  Filter: forwardRef<SVGSVGElement>((props, ref) => (\n    <FilterList {...props} ref={ref} />\n  )),\n  FirstPage: forwardRef<SVGSVGElement>((props, ref) => (\n    <FirstPage {...props} ref={ref} />\n  )),\n  LastPage: forwardRef<SVGSVGElement>((props, ref) => (\n    <LastPage {...props} ref={ref} />\n  )),\n  NextPage: forwardRef<SVGSVGElement>((props, ref) => (\n    <ChevronRight {...props} ref={ref} />\n  )),\n  PreviousPage: forwardRef<SVGSVGElement>((props, ref) => (\n    <ChevronLeft {...props} ref={ref} />\n  )),\n  ResetSearch: forwardRef<SVGSVGElement>((props, ref) => (\n    <Clear {...props} ref={ref} />\n  )),\n  Search: forwardRef<SVGSVGElement>((props, ref) => (\n    <Search {...props} ref={ref} />\n  )),\n  SortArrow: forwardRef<SVGSVGElement>((props, ref) => (\n    <ArrowDownward {...props} ref={ref} />\n  )),\n  ThirdStateCheck: forwardRef<SVGSVGElement>((props, ref) => (\n    <Remove {...props} ref={ref} />\n  )),\n  ViewColumn: forwardRef<SVGSVGElement>((props, ref) => (\n    <ViewColumn {...props} ref={ref} />\n  )),\n} as const;\n\nexport default tableIcons;\n","import { O } from \"ts-toolbelt\";\nimport { FormikConfig } from \"formik\";\nimport gql from \"graphql-tag\";\nimport ApolloClient from \"apollo-client\";\n\nimport {\n  JournalEntryAddRefundFields,\n  PayMethodEntryOptFragment,\n  AddEntryRefundMutation as AddRefund,\n  AddEntryRefundMutationVariables as AddRefundVars,\n} from \"../../../../apollo/graphTypes\";\nimport { TransmutationValue } from \"../../../../formik/utils\";\nimport { JOURNAL_ENTRY_REFUND } from \"../../Table/JournalEntries.gql\";\n\nexport type AddValues = O.Overwrite<\n  O.Required<\n    JournalEntryAddRefundFields,\n    keyof JournalEntryAddRefundFields,\n    \"deep\"\n  >,\n  {\n    date: TransmutationValue<Date | null, JournalEntryAddRefundFields[\"date\"]>;\n    total: TransmutationValue<string, JournalEntryAddRefundFields[\"total\"]>;\n    paymentMethod: TransmutationValue<\n      string,\n      (PayMethodEntryOptFragment | string)[]\n    >;\n  }\n>;\n\nconst ADD_REFUND = gql`\n  mutation AddEntryRefund(\n    $id: ID!\n    $fields: JournalEntryAddRefundFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n  ) {\n    journalEntryAddRefund(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n    ) {\n      id\n      __typename\n      refunds {\n        ...JournalEntryRefund_1Fragment\n      }\n    }\n  }\n  ${JOURNAL_ENTRY_REFUND}\n`;\n\nconst submitAdd: (\n  client: ApolloClient<any>,\n  id: string,\n  ...rest: Parameters<FormikConfig<AddValues>[\"onSubmit\"]>\n) => ReturnType<FormikConfig<AddValues>[\"onSubmit\"]> = async (\n  client,\n  id,\n  values\n) => {\n  const { paymentMethod, paymentMethodAdd } = (() => {\n    const payMethod =\n      values.paymentMethod.value[values.paymentMethod.value.length - 1];\n\n    // New Payment Method\n    if (typeof payMethod === \"string\") {\n      const parent = (values.paymentMethod.value[\n        values.paymentMethod.value.length - 2\n      ] as PayMethodEntryOptFragment).id;\n\n      return {\n        paymentMethod: \"\",\n        paymentMethodAdd: {\n          parent,\n          refId: payMethod,\n          name: payMethod,\n          active: false,\n        },\n      };\n    }\n\n    return {\n      paymentMethod: payMethod.id,\n      paymentMethodAdd: null,\n    };\n  })();\n\n  const variables: O.Required<AddRefundVars, keyof AddRefundVars, \"deep\"> = {\n    id,\n    fields: {\n      date: values.date.value,\n      description: values.description?.trim()\n        ? values.description.trim()\n        : null,\n      paymentMethod,\n      total: values.total.value,\n      reconciled: values.reconciled ?? null,\n    },\n    paymentMethodAdd,\n  };\n\n  await client.mutate<AddRefund, AddRefundVars>({\n    mutation: ADD_REFUND,\n    variables,\n  });\n};\n\nexport default submitAdd;\n","import { useFormikContext } from \"formik\";\nimport { useCallback } from \"react\";\n\nexport type TransmutationValue<TinputValue, Tvalue> = {\n  inputValue: TinputValue;\n  value: Tvalue;\n};\n\nexport const createValueTransmutator = <\n  TinputValue,\n  Tvalue,\n  Trest extends any[]\n>(\n  transMutator: (inputValue: TinputValue, ...rest: Trest) => Tvalue\n) => (inputValue: TinputValue, ...rest: Trest) =>\n  ({\n    inputValue,\n    value: transMutator(inputValue, ...rest),\n  } as TransmutationValue<TinputValue, Tvalue>);\n\nexport enum FormikStatusType {\n  NOTIFICATION,\n  ERROR,\n  FATAL_ERROR,\n}\n\nexport interface FormikStatus {\n  msg: string;\n  type: FormikStatusType;\n}\n\nexport const useFormikStatus = <Values = any>() => {\n  const { setStatus: setStatusNative, status } = useFormikContext<Values>();\n\n  const setStatus = useCallback(\n    (args: FormikStatus | null) => {\n      if (status) {\n        if (\n          !args ||\n          Object.keys(args).some((key) => args[key] !== status[key])\n        ) {\n          setStatusNative(args);\n        }\n      } else if (args) {\n        setStatusNative(args);\n      }\n    },\n    [setStatusNative, status]\n  );\n\n  return [status ?? null, setStatus] as [FormikStatus | null, typeof setStatus];\n};\n","import React, { useMemo, useCallback, useRef } from \"react\";\nimport {\n  KeyboardDatePicker,\n  KeyboardDatePickerProps,\n  MuiPickersUtilsProvider,\n} from \"@material-ui/pickers\";\nimport DateFnsUtils from \"@date-io/date-fns\";\nimport { useField, useFormikContext, FieldInputProps } from \"formik\";\nimport { TextFieldProps } from \"@material-ui/core\";\nimport { parseISO, min, isValid, formatISO, format } from \"date-fns\";\n\nimport {\n  TransmutationValue,\n  createValueTransmutator,\n  useFormikStatus,\n  FormikStatusType,\n} from \"../../../../formik/utils\";\n\nconst inputProps = {\n  inputMode: \"numeric\",\n} as const;\n\nconst keyboardButtonProps = {\n  tabIndex: -1,\n} as const;\n\nconst dateValueTransmutator = createValueTransmutator(\n  (...args: Parameters<KeyboardDatePickerProps[\"onChange\"]>) => {\n    const [date, value] = args;\n    if (date && isValid(date)) {\n      return formatISO(date);\n    }\n    return value || \"\";\n  }\n);\nexport type DateValue = TransmutationValue<Date | null, string>;\n\nconst DateField = (\n  props: {\n    variant?: \"filled\" | \"outlined\";\n    maxDate?: Date;\n    minDate?: Date;\n  } & Omit<\n    TextFieldProps,\n    | \"value\"\n    | \"variant\"\n    | \"error\"\n    | \"helperText\"\n    | \"animateYearScrolling\"\n    | \"disableToolbar\"\n    | \"disableFuture\"\n    | \"inputVariant\"\n    | \"variant\"\n    | \"format\"\n    | \"margin\"\n    | \"label\"\n    | \"maxDate\"\n    | \"initialFocusedDate\"\n    | \"autoOk\"\n    | \"InputProps\"\n    | \"inputProps\"\n    | \"placeholder\"\n    | \"KeyboardButtonProps\"\n    | \"onBlur\"\n    | \"onOpen\"\n    | \"onClose\"\n    | \"onChange\"\n    | keyof FieldInputProps<any>\n  >\n) => {\n  const {\n    variant: inputVariant = \"filled\",\n    autoFocus = false,\n    disabled = false,\n    maxDate = new Date(),\n    minDate,\n  } = props;\n\n  const { isSubmitting } = useFormikContext();\n\n  const validate = useCallback(\n    (\n      value: TransmutationValue<Date | null, string> | undefined\n    ): string | undefined => {\n      const dateStr = (value?.value || \"\").trim();\n      if (dateStr) {\n        const date = parseISO(dateStr);\n        if (!isValid(date)) {\n          return \"Invalid Date\";\n        } else if (minDate && date < minDate) {\n          return `Cannot be before ${format(minDate, \"MM/dd/yyyy\")}`;\n        } else if (maxDate < date) {\n          return `Cannot be after ${format(maxDate, \"MM/dd/yyyy\")}`;\n        }\n      } else {\n        return \"Date is Required\";\n      }\n    },\n    [minDate, maxDate]\n  );\n\n  const [field, meta, helpers] = useField<\n    TransmutationValue<Date | null, string> | undefined\n  >({\n    name: \"date\",\n    validate,\n  });\n\n  const value = field.value?.inputValue ?? null;\n  const { error, touched } = meta;\n  const { setValue, setTouched } = helpers;\n\n  const initialInputValue = meta.initialValue?.inputValue;\n  const initialFocusedDate = useMemo(\n    () =>\n      initialInputValue && isValid(initialInputValue)\n        ? initialInputValue\n        : new Date(),\n    [initialInputValue]\n  );\n\n  const InputProps = useMemo(\n    () => ({\n      autoFocus,\n    }),\n    [autoFocus]\n  );\n\n  // Handle touched\n  const calOpen = useRef(false);\n  const onBlur = useCallback(\n    () =>\n      setTimeout(() => {\n        if (calOpen.current) {\n          return;\n        }\n        setTouched(true);\n      }, 0),\n    [setTouched, calOpen]\n  );\n  const onOpen = useCallback(() => (calOpen.current = true), [calOpen]);\n  const onClose = useCallback(() => {\n    calOpen.current = false;\n    onBlur();\n  }, [calOpen, onBlur]);\n\n  const onChange = useCallback<KeyboardDatePickerProps[\"onChange\"]>(\n    (date, value) => {\n      setValue(\n        dateValueTransmutator(\n          // limit max date\n          date && isValid(date) ? min([new Date(), date]) : date,\n          value\n        )\n      );\n    },\n    [setValue]\n  );\n\n  const [formikStatus] = useFormikStatus();\n\n  const dataPickerProps: KeyboardDatePickerProps = useMemo(\n    () => ({\n      ...field,\n      disabled:\n        isSubmitting ||\n        disabled ||\n        formikStatus?.type === FormikStatusType.FATAL_ERROR,\n      value,\n      error: touched && !!error,\n      helperText: touched ? error : undefined,\n      animateYearScrolling: true,\n      disableToolbar: true,\n      disableFuture: true,\n      inputVariant,\n      variant: \"inline\",\n      format: \"MM/dd/yyyy\",\n      margin: \"none\",\n      label: \"Date\",\n      initialFocusedDate,\n      autoOk: true,\n      InputProps,\n      inputProps,\n      placeholder: \"mm/dd/yyyy\",\n      KeyboardButtonProps: keyboardButtonProps,\n      onBlur,\n      onOpen,\n      onClose,\n      onChange,\n    }),\n    [\n      value,\n      initialFocusedDate,\n      onBlur,\n      error,\n      inputVariant,\n      InputProps,\n      isSubmitting,\n      field,\n      onOpen,\n      onClose,\n      onChange,\n      touched,\n      disabled,\n      formikStatus,\n    ]\n  );\n\n  return (\n    <MuiPickersUtilsProvider utils={DateFnsUtils}>\n      <KeyboardDatePicker\n        maxDate={maxDate}\n        {...(props as any)}\n        {...dataPickerProps}\n      />\n    </MuiPickersUtilsProvider>\n  );\n};\n\nexport default DateField;\n","import React, { useMemo, useCallback } from \"react\";\nimport { TextField, TextFieldProps } from \"@material-ui/core\";\nimport { useField, FieldInputProps } from \"formik\";\nimport { useFormikStatus, FormikStatusType } from \"../../../../formik/utils\";\n\nconst Description = (\n  props: {\n    variant?: \"filled\" | \"outlined\";\n  } & Omit<\n    TextFieldProps,\n    | \"variant\"\n    | \"onChange\"\n    | \"value\"\n    | \"variant\"\n    | \"label\"\n    | \"name\"\n    | \"InputProps\"\n    | keyof FieldInputProps<any>\n  >\n) => {\n  const {\n    autoFocus = false,\n    disabled = false,\n    variant = \"filled\",\n    ...textFieldProps\n  } = props;\n\n  const [field, , { setValue }] = useField<string | null | undefined>({\n    name: \"description\",\n  });\n\n  const onChange = useCallback<NonNullable<TextFieldProps[\"onChange\"]>>(\n    (event) => void setValue(event?.target?.value?.trimLeft() || null),\n    [setValue]\n  );\n\n  const InputProps = useMemo(\n    () => ({\n      type: \"text\",\n      autoFocus,\n    }),\n    [autoFocus]\n  );\n\n  const [formikStatus] = useFormikStatus();\n\n  return (\n    <TextField\n      {...textFieldProps}\n      {...field}\n      disabled={disabled || formikStatus?.type === FormikStatusType.FATAL_ERROR}\n      onChange={onChange}\n      value={field.value ?? \"\"}\n      variant={variant as any}\n      label={\"Description\"}\n      name={\"description\"}\n      InputProps={InputProps}\n    />\n  );\n};\n\nexport default Description;\n","import Fraction from \"fraction.js\";\n\nimport { RationalSign, Rational, RationalInput } from \"../apollo/graphTypes\";\n\nexport const isRational = (rational) =>\n  typeof rational === \"object\" &&\n  rational !== null &&\n  \"s\" in rational &&\n  \"n\" in rational &&\n  \"d\" in rational;\n\nexport const fractionToRational = (\n  fraction: Fraction | { s: number; n: number; d: number }\n): Omit<Rational & RationalInput, \"__typename\"> => ({\n  n: Math.abs(fraction.n),\n  d: Math.abs(fraction.d),\n  s: fraction.s === -1 ? RationalSign.Neg : RationalSign.Pos,\n});\n\nexport const rationalToFraction = (rational: Rational | RationalInput) =>\n  new Fraction({\n    n:\n      rational.s === RationalSign.Neg\n        ? -Math.abs(rational.n)\n        : Math.abs(rational.n),\n    d: Math.abs(rational.d),\n  });\n","import React, { useMemo, useCallback } from \"react\";\nimport { TextField, TextFieldProps, InputAdornment } from \"@material-ui/core\";\nimport { useField, FieldInputProps } from \"formik\";\nimport numeral from \"numeral\";\nimport Fraction from \"fraction.js\";\n\nimport {\n  createValueTransmutator,\n  TransmutationValue,\n  useFormikStatus,\n  FormikStatusType,\n} from \"../../../../formik/utils\";\nimport { RationalInput } from \"../../../../apollo/graphTypes\";\nimport {\n  fractionToRational,\n  rationalToFraction,\n} from \"../../../../utils/rational\";\n\nexport type TotalValue = TransmutationValue<string, RationalInput>;\n\nconst inputProps = {\n  min: \"0.00\",\n  step: \"0.01\",\n} as const;\n\nexport const totalValueTransmutator = createValueTransmutator(\n  (inputValue: string) => {\n    if (typeof inputValue === \"string\" && !inputValue.trim()) {\n      return fractionToRational(new Fraction(0));\n    }\n    return fractionToRational(\n      new Fraction(inputValue as string | number).round(2)\n    );\n  }\n);\n\nconst Total = (\n  props: {\n    variant?: \"filled\" | \"outlined\";\n    minTotal?: Fraction;\n    maxTotal?: Fraction;\n  } & Omit<\n    TextFieldProps,\n    | \"variant\"\n    | \"type\"\n    | \"value\"\n    | \"error\"\n    | \"helperText\"\n    | \"placeholder\"\n    | \"label\"\n    | \"name\"\n    | \"required\"\n    | \"variant\"\n    | \"inputProps\"\n    | \"InputProps\"\n    | \"onChange\"\n    | keyof FieldInputProps<any>\n  >\n) => {\n  const {\n    autoFocus = false,\n    disabled = false,\n    variant = \"filled\",\n    maxTotal = new Fraction(Number.MAX_SAFE_INTEGER),\n    minTotal: minTotalProp = new Fraction(0),\n    ...textFieldProps\n  } = props;\n\n  const minTotal =\n    new Fraction(1, 100).compare(minTotalProp) > 0\n      ? new Fraction(1, 100)\n      : minTotalProp;\n\n  // Math.max(0.01, minTotalProp);\n\n  const validate = useCallback(\n    (value: TotalValue | undefined | null) => {\n      if (!value || !(value.inputValue?.trim() ?? \"\")) {\n        return \"Total Required\";\n      }\n\n      const num = rationalToFraction(value.value);\n\n      if (Number.isNaN(Number.parseInt(value.inputValue))) {\n        return \"Invalid Number\";\n      } else if (num.compare(maxTotal) > 0) {\n        return `Cannot be greater than ${numeral(maxTotal.valueOf()).format(\n          \"$0,0.00\"\n        )}`;\n      } else if (num.compare(new Fraction(0)) === 0) {\n        return \"Cannot be 0\";\n      } else if (num.compare(minTotal) < 0) {\n        return `Cannot be less than ${numeral(minTotal.valueOf()).format(\n          \"$0,0.00\"\n        )}`;\n      }\n    },\n    [minTotal, maxTotal]\n  );\n\n  const [field, meta, { setValue }] = useField<TotalValue | undefined>({\n    name: \"total\",\n    validate,\n  });\n\n  const inputValue = field.value?.inputValue ?? \"\";\n\n  const { error, touched } = meta;\n\n  const InputProps = useMemo(\n    () => ({\n      type: \"number\",\n      autoFocus,\n      startAdornment: <InputAdornment position=\"start\">$</InputAdornment>,\n    }),\n    [autoFocus]\n  );\n\n  const onChange = useCallback<NonNullable<TextFieldProps[\"onChange\"]>>(\n    (event) => {\n      setValue(totalValueTransmutator(event?.target?.value?.toString() || \"\"));\n    },\n    [setValue]\n  );\n\n  const helperText = useMemo(() => {\n    const maxSafe = new Fraction(Number.MAX_SAFE_INTEGER);\n    const minValid = new Fraction(1, 100);\n    if (touched && error) {\n      return error;\n    } else if (\n      maxTotal.compare(maxSafe) !== 0 &&\n      minTotal.compare(minValid) > 0\n    ) {\n      return `Max ${numeral(maxTotal.valueOf()).format(\n        \"$0,0.00\"\n      )} & Min ${numeral(minTotal.valueOf()).format(\"$0,0.00\")}`;\n    } else if (maxTotal.compare(maxSafe) !== 0) {\n      return `Max ${numeral(maxTotal.valueOf()).format(\"$0,0.00\")}`;\n    } else if (minTotal.compare(minValid) > 0) {\n      return `Min ${numeral(minTotal.valueOf()).format(\"$0,0.00\")}`;\n    } else {\n      return \"\";\n    }\n  }, [touched, error, maxTotal, minTotal]);\n\n  const [formikStatus] = useFormikStatus();\n\n  return (\n    <TextField\n      {...textFieldProps}\n      {...field}\n      disabled={disabled || formikStatus?.type === FormikStatusType.FATAL_ERROR}\n      type=\"number\"\n      value={inputValue}\n      error={touched && !!error}\n      helperText={helperText}\n      placeholder={\"0.00\"}\n      label={\"Total\"}\n      name={\"total\"}\n      required\n      variant={variant as any}\n      inputProps={inputProps}\n      InputProps={InputProps}\n      onChange={onChange}\n    />\n  );\n};\n\nexport default Total;\n","import React from \"react\";\nimport {\n  Checkbox,\n  FormControlLabel,\n  FormControlLabelProps,\n  CheckboxProps,\n} from \"@material-ui/core\";\nimport { useField, FieldInputProps } from \"formik\";\nimport { useFormikStatus, FormikStatusType } from \"../../../../formik/utils\";\n\nconst inputProps = {\n  type: \"checkbox\",\n} as const;\n\nconst Reconcile = (\n  props:\n    | ({ label: true } & Partial<\n        Omit<\n          FormControlLabelProps,\n          | \"inputProps\"\n          | \"control\"\n          | \"checked\"\n          | \"label\"\n          | keyof FieldInputProps<any>\n        >\n      >)\n    | ({ label?: false } & Partial<\n        Omit<\n          CheckboxProps,\n          \"inputProps\" | \"checked\" | keyof FieldInputProps<any>\n        >\n      >)\n) => {\n  const { label, disabled = false, ...customProps } = props;\n\n  const [field] = useField<boolean | undefined>({\n    name: \"reconciled\",\n    type: \"checkbox\",\n  });\n\n  const value = field.value ?? false;\n\n  const [formikStatus] = useFormikStatus();\n\n  if (label) {\n    return (\n      <FormControlLabel\n        {...customProps}\n        {...(field as any)}\n        value={value}\n        disabled={\n          disabled || formikStatus?.type === FormikStatusType.FATAL_ERROR\n        }\n        label=\"Reconcile\"\n        control={<Checkbox inputProps={inputProps} />}\n      />\n    );\n  }\n\n  return (\n    <Checkbox\n      {...(customProps as any)}\n      {...field}\n      value={value}\n      disabled={disabled || formikStatus?.type === FormikStatusType.FATAL_ERROR}\n      inputProps={inputProps}\n    />\n  );\n};\n\nexport default Reconcile;\n","import gql from \"graphql-tag\";\n\nexport const DEPT_ENTRY_OPT_FRAGMENT = gql`\n  fragment DeptEntryOptFragment on Department {\n    __typename\n    id\n    name\n    parent {\n      __typename\n      ... on Business {\n        id\n      }\n      ... on Department {\n        id\n      }\n    }\n  }\n`;\n\nexport const CAT_ENTRY_OPT_FRAGMENT = gql`\n  fragment CatEntryOptFragment on JournalEntryCategory {\n    __typename\n    id\n    name\n    type\n    parent {\n      __typename\n      id\n    }\n  }\n`;\n\nexport const SRC_ENTRY_PERSON_OPT_FRAGMENT = gql`\n  fragment SrcEntryPersonOptFragment on Person {\n    __typename\n    id\n    personName: name {\n      first\n      last\n    }\n  }\n`;\n\nexport const SRC_ENTRY_DEPT_OPT_FRAGMENT = gql`\n  fragment SrcEntryDeptOptFragment on Department {\n    __typename\n    id\n    name\n    parent {\n      ... on Business {\n        __typename\n        id\n      }\n      ... on Department {\n        __typename\n        id\n      }\n    }\n  }\n`;\n\nexport const SRC_ENTRY_BIZ_OPT_FRAGMENT = gql`\n  fragment SrcEntryBizOptFragment on Business {\n    __typename\n    id\n    name\n    vendor {\n      approved\n      vendorId\n    }\n    departments {\n      ...SrcEntryDeptOptFragment\n    }\n  }\n  ${SRC_ENTRY_DEPT_OPT_FRAGMENT}\n`;\n\nexport const PAY_METHOD_ENTRY_OPT_FRAGMENT = gql`\n  fragment PayMethodEntryOptFragment on PaymentMethod {\n    __typename\n    id\n    refId\n    name\n    active\n    parent {\n      __typename\n      id\n    }\n  }\n`;\n","import React, { useMemo, useState, useCallback } from \"react\";\nimport { TextField, TextFieldProps, Box, Chip } from \"@material-ui/core\";\nimport gql from \"graphql-tag\";\nimport { useQuery, QueryHookOptions } from \"@apollo/react-hooks\";\nimport { useField, FieldInputProps } from \"formik\";\n\nimport { PAY_METHOD_ENTRY_OPT_FRAGMENT } from \"../upsertEntry.gql\";\nimport {\n  PayMethodEntryOptsQuery as PayMethodEntryOpts,\n  PayMethodEntryOptsQueryVariables as PayMethodEntryOptsQueryVars,\n  PayMethodEntryOptFragment,\n} from \"../../../../apollo/graphTypes\";\nimport Autocomplete, {\n  AutocompleteProps as AutocompletePropsRaw,\n  RenderInputParams,\n} from \"@material-ui/lab/Autocomplete\";\nimport { UseAutocompleteMultipleProps } from \"@material-ui/lab/useAutocomplete\";\nimport { ChevronRight } from \"@material-ui/icons\";\nimport { CHECK_ID } from \"../../constants\";\nimport {\n  TransmutationValue,\n  useFormikStatus,\n  FormikStatusType,\n} from \"../../../../formik/utils\";\n\ntype Value = PayMethodEntryOptFragment | string;\n\ntype AutocompleteProps = AutocompletePropsRaw<Value> &\n  UseAutocompleteMultipleProps<Value>;\n\nconst PAY_METHOD_ENTRY_OPTS = gql`\n  query PayMethodEntryOpts($where: PaymentMethodWhereInput!) {\n    paymentMethods(where: $where) {\n      ...PayMethodEntryOptFragment\n    }\n  }\n  ${PAY_METHOD_ENTRY_OPT_FRAGMENT}\n`;\n\nexport type PaymentMethodValue = TransmutationValue<string, Value[]>;\n\nconst validate = (payMethodValue: PaymentMethodValue | undefined) => {\n  const value = payMethodValue?.value ?? [];\n  const numValues = value.length;\n  const curValue = value[numValues - 1];\n  const parent = value[numValues - 2] as PayMethodEntryOptFragment | undefined;\n\n  if (curValue === undefined) {\n    return \"Method Required\";\n  } else if (typeof curValue === \"string\") {\n    if (parent?.id === CHECK_ID) {\n      const checkNumber = (curValue.match(/[0-9]/g) ?? []).join(\"\");\n      if (!checkNumber) {\n        return \"Check # Required\";\n      }\n    }\n  } else if (curValue.id === CHECK_ID) {\n    return \"Check # Required\";\n  }\n};\n\nconst getOptionLabel: AutocompleteProps[\"getOptionLabel\"] = (opt): string => {\n  return typeof opt === \"string\" ? opt : opt.name;\n};\n\nconst renderTags: AutocompleteProps[\"renderTags\"] = (values, getTagProps) => {\n  const lastIndex = values.length - 1;\n  return values.map((value: Value, index: number) => {\n    const isLastIndex = lastIndex === index;\n    const { key, ...props } = getTagProps({ index }) as any;\n\n    const parent = values[index - 1] as PayMethodEntryOptFragment | undefined;\n\n    const isString = typeof value === \"string\";\n\n    let label: string;\n    switch (parent?.id) {\n      case CHECK_ID:\n        label =\n          \"CK-\" +\n          (isString ? value : (value as PayMethodEntryOptFragment).name);\n        break;\n      default:\n        label = getOptionLabel(value);\n    }\n\n    let endAdornment: JSX.Element | undefined;\n    if (!isLastIndex) {\n      endAdornment = <ChevronRight fontSize=\"small\" />;\n    } else if (!isString) {\n      // Add Prefixes\n      switch ((value as PayMethodEntryOptFragment).id) {\n        case CHECK_ID:\n          endAdornment = <span>CK-</span>;\n          break;\n      }\n    }\n\n    return (\n      <Box\n        key={key}\n        display=\"flex\"\n        flexDirection=\"row\"\n        alignItems=\"center\"\n        justifyContent=\"flex-start\"\n      >\n        <Chip\n          color={isLastIndex ? \"primary\" : \"default\"}\n          variant={isLastIndex ? \"default\" : \"outlined\"}\n          label={label}\n          size=\"medium\"\n          {...props}\n          disabled={!isLastIndex}\n        />{\" \"}\n        {endAdornment}\n      </Box>\n    );\n  });\n};\n\nconst PaymentMethod = (\n  props: {\n    variant?: \"filled\" | \"outlined\";\n  } & {} & Omit<\n      TextFieldProps,\n      | \"value\"\n      | \"variant\"\n      | \"error\"\n      | \"helperText\"\n      | \"name\"\n      | \"label\"\n      | keyof FieldInputProps<any>\n      | keyof Omit<RenderInputParams, \"id\" | \"disabled\">\n    >\n) => {\n  const { disabled = false, ...textFieldProps } = props;\n\n  const [hasFocus, setHasFocus] = useState(false);\n\n  const [field, meta, helpers] = useField<PaymentMethodValue | undefined>({\n    name: \"paymentMethod\",\n    validate,\n  });\n\n  const onBlurField = field.onBlur;\n  const value = field.value?.value ?? [];\n  const inputValue = field.value?.inputValue ?? \"\";\n  const { error, touched } = meta;\n  const { setValue } = helpers;\n\n  const curValue = value[value.length - 1] ?? null;\n\n  const variables = useMemo<PayMethodEntryOptsQueryVars>(\n    () =>\n      curValue === null\n        ? {\n            where: {\n              hasParent: false,\n            },\n          }\n        : {\n            where: {\n              parent: {\n                eq: (curValue as PayMethodEntryOptFragment).id,\n              },\n            },\n          },\n    [curValue]\n  );\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const onError = useCallback<\n    NonNullable<\n      QueryHookOptions<\n        PayMethodEntryOpts,\n        PayMethodEntryOptsQueryVars\n      >[\"onError\"]\n    >\n  >(\n    (error) =>\n      void setFormikStatus({\n        msg: error.message,\n        type: FormikStatusType.FATAL_ERROR,\n      }),\n    [setFormikStatus]\n  );\n\n  const { loading, error: gqlError, data } = useQuery<\n    PayMethodEntryOpts,\n    PayMethodEntryOptsQueryVars\n  >(PAY_METHOD_ENTRY_OPTS, {\n    skip: typeof curValue === \"string\",\n    variables,\n    onError,\n  });\n\n  const options = useMemo<PayMethodEntryOptFragment[]>(\n    () =>\n      !data?.paymentMethods ||\n      typeof curValue === \"string\" ||\n      curValue?.id === CHECK_ID\n        ? []\n        : data.paymentMethods,\n    [data, curValue]\n  );\n\n  const hasOptions = options.length > 0;\n\n  const freeSolo = useMemo<boolean>(\n    () => (curValue as PayMethodEntryOptFragment | null)?.id === CHECK_ID,\n    [curValue]\n  );\n\n  const disableTextInput = useMemo(() => !hasOptions && !freeSolo, [\n    hasOptions,\n    freeSolo,\n  ]);\n\n  const label = useMemo(() => {\n    if (\n      typeof curValue === \"string\" ||\n      (curValue as PayMethodEntryOptFragment | null)?.id === CHECK_ID\n    ) {\n      return \"Check #\";\n    }\n\n    return \"Payment Method\";\n  }, [curValue]);\n\n  const InputProps = useMemo(() => {\n    if ((curValue as PayMethodEntryOptFragment | null)?.id === CHECK_ID) {\n      return {\n        type: \"number\",\n      };\n    }\n\n    return {};\n  }, [curValue]);\n\n  const inputProps = useMemo(() => {\n    if ((curValue as PayMethodEntryOptFragment | null)?.id === CHECK_ID) {\n      return {\n        min: \"0\",\n        step: \"1\",\n      };\n    }\n\n    return {};\n  }, [curValue]);\n\n  const renderInput = useCallback(\n    (params: RenderInputParams) => {\n      params.InputProps = {\n        ...(params.InputProps ?? {}),\n        ...InputProps,\n      };\n\n      params.inputProps = {\n        ...(params.inputProps ?? {}),\n        ...inputProps,\n      };\n\n      const helperText = (() => {\n        if (gqlError) {\n          return gqlError.message;\n        } else if (touched) {\n          return error;\n        }\n      })();\n\n      return (\n        <TextField\n          {...textFieldProps}\n          {...params}\n          variant={(textFieldProps.variant || \"filled\") as any}\n          error={(touched && !!error) || !!gqlError}\n          helperText={helperText}\n          name=\"paymentMethod\"\n          label={label}\n        />\n      );\n    },\n    [textFieldProps, touched, gqlError, error, label, InputProps, inputProps]\n  );\n\n  const onFocus = useCallback((event?) => setHasFocus(true), [setHasFocus]);\n  const onBlur = useCallback<NonNullable<AutocompleteProps[\"onBlur\"]>>(\n    (event) => {\n      setHasFocus(false);\n      // Fixes formik validate called with wrong version of value\n      event.persist();\n      setTimeout(() => void onBlurField(event), 0);\n    },\n    [setHasFocus, onBlurField]\n  );\n\n  const onChange = useCallback<NonNullable<AutocompleteProps[\"onChange\"]>>(\n    (event, value) => {\n      setValue({ inputValue, value });\n    },\n    [setValue, inputValue]\n  );\n\n  const onInputChange = useCallback<\n    NonNullable<AutocompleteProps[\"onInputChange\"]>\n  >(\n    (event, inputValue: string, reason) => {\n      inputValue = (inputValue || \"\").trimStart();\n      if (!disableTextInput) {\n        setValue({ inputValue, value });\n      }\n    },\n    [setValue, value, disableTextInput]\n  );\n\n  const autoCompleteProps = useMemo<AutocompleteProps>(\n    () => ({\n      value,\n      disabled:\n        !!gqlError ||\n        loading ||\n        formikStatus?.type === FormikStatusType.FATAL_ERROR ||\n        disabled,\n      multiple: true,\n      options,\n      renderInput,\n      renderTags,\n      freeSolo,\n      getOptionLabel,\n      onChange,\n      onInputChange,\n      inputValue: disableTextInput ? \"\" : inputValue,\n      onFocus,\n      onBlur,\n      open:\n        hasFocus &&\n        hasOptions &&\n        formikStatus?.type !== FormikStatusType.FATAL_ERROR,\n      loading,\n      autoSelect: true,\n      name: \"paymentMethod\",\n    }),\n    [\n      options,\n      value,\n      renderInput,\n      freeSolo,\n      onChange,\n      onInputChange,\n      inputValue,\n      disableTextInput,\n      onFocus,\n      onBlur,\n      hasFocus,\n      hasOptions,\n      loading,\n      gqlError,\n      disabled,\n      formikStatus,\n    ]\n  );\n\n  return <Autocomplete {...autoCompleteProps} />;\n};\n\nexport default PaymentMethod;\n","import React from \"react\";\nimport { useTheme, Box, BoxProps, Theme } from \"@material-ui/core\";\nimport { fade } from \"@material-ui/core/styles/colorManipulator\";\n\nconst Overlay = (\n  props: {\n    children: React.ReactNode;\n    zIndex: keyof Theme[\"zIndex\"] | number;\n    opacity?: number;\n  } & Pick<\n    BoxProps,\n    | \"p\"\n    | \"pt\"\n    | \"pr\"\n    | \"pb\"\n    | \"pl\"\n    | \"px\"\n    | \"py\"\n    | \"padding\"\n    | \"paddingTop\"\n    | \"paddingRight\"\n    | \"paddingBottom\"\n    | \"paddingLeft\"\n    | \"paddingX\"\n    | \"paddingY\"\n  >\n) => {\n  const theme = useTheme();\n\n  const { opacity = 0.62, ...boxProps } = props;\n\n  return (\n    <Box\n      {...boxProps}\n      overflow=\"auto\"\n      position=\"absolute\"\n      display=\"flex\"\n      alignItems=\"center\"\n      justifyContent=\"center\"\n      width=\"100%\"\n      top=\"0px\"\n      bottom=\"0px\"\n      bgcolor={fade(theme.palette.background.paper, opacity)}\n    />\n  );\n};\n\nexport default Overlay;\n","import React from \"react\";\nimport { CircularProgress, Theme } from \"@material-ui/core\";\n\nimport Overlay from \"./Overlay\";\n\nconst OverlayLoading = (props: { zIndex: keyof Theme[\"zIndex\"] | number }) => {\n  return <Overlay {...props} children={<CircularProgress />} />;\n};\n\nexport default OverlayLoading;\n","import gql from \"graphql-tag\";\n\nexport const JOURNAL_FRAGMENT = gql`\n  fragment JournalEntry_2Fragment on JournalEntry {\n    __typename\n    id\n    date\n    type\n    total {\n      n\n      d\n      s\n    }\n    refunds {\n      id\n      __typename\n      deleted\n      total {\n        n\n        d\n        s\n      }\n    }\n  }\n`;\n","import React, { useCallback, useMemo } from \"react\";\nimport { Formik, FormikConfig, useFormikContext, FormikProps } from \"formik\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  PaperProps,\n  Grid,\n  DialogContentText,\n  useTheme,\n  Box,\n} from \"@material-ui/core\";\nimport {\n  useApolloClient,\n  useQuery,\n  QueryHookOptions,\n} from \"@apollo/react-hooks\";\nimport { Add as AddIcon, Cancel as CancelIcon } from \"@material-ui/icons\";\nimport gql from \"graphql-tag\";\nimport Fraction from \"fraction.js\";\n\nimport submitAdd, { AddValues } from \"./submitAdd\";\nimport {\n  GetEntryRefundInfo_1Query as GetEntryRefundInfo,\n  GetEntryRefundInfo_1QueryVariables as GetEntryRefundInfoVars,\n  JournalEntryType,\n} from \"../../../../apollo/graphTypes\";\nimport DateEntry from \"../EntryFields/DateEntry\";\nimport Description from \"../EntryFields/Description\";\nimport Total from \"../EntryFields/Total\";\nimport Reconcile from \"../EntryFields/Reconcile\";\nimport PaymentMethod from \"../EntryFields/PaymentMethod\";\nimport {\n  FormikStatusType,\n  useFormikStatus,\n  FormikStatus,\n} from \"../../../../formik/utils\";\nimport OverlayLoading from \"../../../utils/OverlayLoading\";\nimport Overlay from \"../../../utils/Overlay\";\nimport { JOURNAL_FRAGMENT } from \"./refunds.gql\";\nimport { rationalToFraction } from \"../../../../utils/rational\";\n\nconst GET_ENTRY_REFUND_INFO = gql`\n  query GetEntryRefundInfo_1($id: ID!) {\n    journalEntry(id: $id) {\n      ...JournalEntry_2Fragment\n    }\n  }\n  ${JOURNAL_FRAGMENT}\n`;\n\nconst NULLISH = Symbol();\n\nexport interface AddRefundProps {\n  entryId: string | null;\n  open: boolean;\n  onClose: () => void;\n  onExited: () => void;\n}\n\n// Must be in separate component to access FormikContext.\nconst AddRefundDialog = (\n  props: AddRefundProps & {\n    handleSubmit: FormikProps<AddValues>[\"handleSubmit\"];\n  }\n) => {\n  const { entryId, open, onClose, onExited: onExitedCb, handleSubmit } = props;\n\n  const { resetForm, isSubmitting, isValid } = useFormikContext<AddValues>();\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const onError = useCallback<\n    NonNullable<\n      QueryHookOptions<GetEntryRefundInfo, GetEntryRefundInfoVars>[\"onError\"]\n    >\n  >(\n    (error) =>\n      setFormikStatus({\n        msg: error.message,\n        type: FormikStatusType.FATAL_ERROR,\n      }),\n    [setFormikStatus]\n  );\n\n  const { loading, error, data } = useQuery<\n    GetEntryRefundInfo,\n    GetEntryRefundInfoVars\n  >(GET_ENTRY_REFUND_INFO, {\n    skip: !entryId,\n    variables: { id: entryId as string },\n    onError,\n  });\n\n  const total = data?.journalEntry?.total;\n  const refunds = data?.journalEntry?.refunds || [];\n  const maxTotal = useMemo(() => {\n    if (total) {\n      const totalRefunds = refunds.reduce(\n        (totalRefunds, { deleted, total }) =>\n          deleted ? totalRefunds : totalRefunds.add(rationalToFraction(total)),\n        new Fraction(0)\n      );\n      return rationalToFraction(total).sub(totalRefunds);\n    }\n    return new Fraction(Number.MAX_SAFE_INTEGER);\n  }, [total, refunds]);\n\n  const date = data?.journalEntry?.date;\n  const minDate = useMemo<Date | undefined>(\n    () => (date ? new Date(date) : undefined),\n    [date]\n  );\n\n  const onExited = useCallback(() => {\n    onExitedCb();\n    resetForm();\n    setFormikStatus(null);\n  }, [resetForm, onExitedCb, setFormikStatus]);\n\n  const [generalError, fatalError] = useMemo<\n    [string | null, boolean | null]\n  >(() => {\n    if (\n      formikStatus &&\n      (formikStatus.type === FormikStatusType.FATAL_ERROR ||\n        formikStatus.type === FormikStatusType.ERROR)\n    ) {\n      return [\n        formikStatus.msg,\n        formikStatus.type === FormikStatusType.FATAL_ERROR,\n      ];\n    }\n    return [null, null];\n  }, [formikStatus]);\n\n  const journalEntryType = data?.journalEntry?.type;\n  const title = useMemo(() => {\n    const title =\n      !loading && !error && (journalEntryType ?? NULLISH) !== NULLISH\n        ? `${\n            journalEntryType === JournalEntryType.Credit ? \"Give\" : \"Add\"\n          } Refund`\n        : \"Refund\";\n\n    if (fatalError) {\n      return \"Fatal Error\";\n    } else if (loading) {\n      return `Loading ${title}...`;\n    } else if (isSubmitting) {\n      return `Submitting ${title}`;\n    }\n    return title;\n  }, [loading, error, journalEntryType, fatalError, isSubmitting]);\n\n  const theme = useTheme();\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      onExited={onExited}\n      disableBackdropClick={isSubmitting}\n      disableEscapeKeyDown={isSubmitting}\n      fullWidth\n      maxWidth=\"lg\"\n      PaperProps={\n        {\n          component: \"form\",\n          onSubmit: handleSubmit,\n        } as PaperProps & { onSubmit: FormikProps<AddValues>[\"handleSubmit\"] }\n      }\n    >\n      <DialogTitle\n        style={generalError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {(loading || isSubmitting) && !generalError && (\n          <OverlayLoading zIndex=\"modal\" />\n        )}\n        {!!generalError && fatalError && (\n          <Overlay opacity={0.78} zIndex=\"modal\" padding={2}>\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          </Overlay>\n        )}\n        <DialogContent dividers>\n          {!!generalError && !fatalError && (\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          )}\n          <Grid container spacing={2}>\n            <Grid item lg={4} sm={6} xs={12}>\n              <DateEntry\n                minDate={minDate}\n                disabled={loading || isSubmitting}\n                fullWidth\n              />\n            </Grid>\n            <Grid item lg={4} sm={6} xs={12}>\n              <Description disabled={loading || isSubmitting} fullWidth />\n            </Grid>\n            <Grid item lg={4} sm={6} xs={12}>\n              <PaymentMethod disabled={loading || isSubmitting} fullWidth />\n            </Grid>\n            <Grid item lg={4} sm={6} xs={12}>\n              <Total\n                disabled={loading || isSubmitting}\n                fullWidth\n                maxTotal={maxTotal}\n              />\n            </Grid>\n            <Grid\n              item\n              container\n              justify=\"center\"\n              alignItems=\"flex-start\"\n              lg={4}\n              md={6}\n              sm={12}\n            >\n              <Reconcile disabled={loading || isSubmitting} label />\n            </Grid>\n          </Grid>\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!fatalError && (\n          <Button\n            disabled={loading || isSubmitting || !isValid}\n            type=\"submit\"\n            startIcon={<AddIcon />}\n            color=\"primary\"\n            variant=\"contained\"\n          >\n            Add\n          </Button>\n        )}\n        <Button\n          disabled={loading || isSubmitting}\n          color={fatalError ? \"primary\" : \"default\"}\n          startIcon={!fatalError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {fatalError ? \"Ok\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst AddRefund = (props: AddRefundProps) => {\n  const { entryId, open, onClose, onExited } = props;\n\n  const initialValues = useMemo<Partial<AddValues>>(() => ({}), []);\n\n  const client = useApolloClient();\n  const onSubmit = useCallback<FormikConfig<AddValues>[\"onSubmit\"]>(\n    async (values, formikHelpers) => {\n      try {\n        formikHelpers.setStatus(null);\n        await submitAdd(client, entryId || \"\", values, formikHelpers);\n        onClose();\n      } catch (error) {\n        formikHelpers.setStatus({\n          msg: error.message ?? `${error}`,\n          type: FormikStatusType.ERROR,\n        } as FormikStatus);\n      }\n    },\n    [client, entryId, onClose]\n  );\n\n  const children = useCallback(\n    (props: FormikProps<AddValues>) => (\n      <AddRefundDialog\n        entryId={entryId}\n        open={open}\n        onClose={onClose}\n        onExited={onExited}\n        handleSubmit={props.handleSubmit}\n      />\n    ),\n    [entryId, open, onClose, onExited]\n  );\n\n  return (\n    <Formik\n      initialValues={initialValues as AddValues}\n      initialStatus={null}\n      // isInitialValid={false}\n      enableReinitialize={true}\n      onSubmit={onSubmit}\n      children={children}\n    />\n  );\n};\n\nexport default AddRefund;\n","import { O } from \"ts-toolbelt\";\nimport { FormikConfig } from \"formik\";\nimport gql from \"graphql-tag\";\nimport ApolloClient from \"apollo-client\";\nimport { isEqual } from \"date-fns\";\n\nimport {\n  JournalEntryUpdateRefundFields,\n  PayMethodEntryOptFragment,\n  UpdateRefundMutation as UpdateRefund,\n  UpdateRefundMutationVariables as UpdateRefundVars,\n} from \"../../../../apollo/graphTypes\";\nimport { TransmutationValue } from \"../../../../formik/utils\";\nimport { JOURNAL_ENTRY_REFUND } from \"../../Table/JournalEntries.gql\";\nimport { CHECK_ID } from \"../../constants\";\nimport { rationalToFraction } from \"../../../../utils/rational\";\n\nexport type UpdateValues = O.NonNullable<\n  O.Overwrite<\n    O.Required<JournalEntryUpdateRefundFields>,\n    {\n      date: TransmutationValue<\n        Date,\n        NonNullable<JournalEntryUpdateRefundFields[\"date\"]>\n      >;\n      total: TransmutationValue<\n        string,\n        NonNullable<JournalEntryUpdateRefundFields[\"total\"]>\n      >;\n      paymentMethod: TransmutationValue<\n        string,\n        (PayMethodEntryOptFragment | string)[]\n      >;\n    }\n  >,\n  keyof Omit<JournalEntryUpdateRefundFields, \"description\">\n>;\n\nexport type IniUpdateValues = O.Overwrite<\n  UpdateValues,\n  {\n    paymentMethod: TransmutationValue<string, PayMethodEntryOptFragment[]>;\n  }\n>;\n\nconst UPDATE_REFUND = gql`\n  mutation UpdateRefund(\n    $id: ID!\n    $fields: JournalEntryUpdateRefundFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $paymentMethodUpdate: JournalEntryUpdatePaymentMethod\n  ) {\n    journalEntryUpdateRefund(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      paymentMethodUpdate: $paymentMethodUpdate\n    ) {\n      id\n      __typename\n      refunds {\n        ...JournalEntryRefund_1Fragment\n      }\n    }\n  }\n  ${JOURNAL_ENTRY_REFUND}\n`;\n\nconst submitUpdate: (\n  client: ApolloClient<any>,\n  iniValues: IniUpdateValues,\n  id: string,\n  ...rest: Parameters<FormikConfig<UpdateValues>[\"onSubmit\"]>\n) => ReturnType<FormikConfig<UpdateValues>[\"onSubmit\"]> = async (\n  client,\n  iniValues,\n  id,\n  values\n) => {\n  // Date\n  const date = isEqual(iniValues.date.inputValue, values.date.inputValue)\n    ? null\n    : values.date.value;\n\n  // Description\n  const description =\n    values.description !== iniValues.description\n      ? values.description?.trim() ?? \"\"\n      : null;\n\n  // Total\n  const total =\n    rationalToFraction(values.total.value).compare(\n      rationalToFraction(iniValues.total.value)\n    ) === 0\n      ? null\n      : values.total.value;\n\n  // Reconciled\n  const reconciled =\n    values.reconciled === iniValues.reconciled ? null : values.reconciled;\n\n  // Payment Method\n  const { paymentMethod, paymentMethodAdd, paymentMethodUpdate } = (() => {\n    const iniPayMethod =\n      iniValues.paymentMethod.value[iniValues.paymentMethod.value.length - 1];\n\n    const [payMethod, parent] = values.paymentMethod.value\n      .slice(-2)\n      .reverse() as [\n      string | PayMethodEntryOptFragment,\n      PayMethodEntryOptFragment\n    ];\n\n    // Currently CHECK Numbers only\n    if (typeof payMethod === \"string\") {\n      // Update check number on payment method\n      if (iniPayMethod.parent && iniPayMethod.parent.id === CHECK_ID) {\n        return {\n          paymentMethod: null,\n          paymentMethodAdd: null,\n          paymentMethodUpdate: {\n            id: iniPayMethod.id,\n            fields: {\n              active: null,\n              refId: payMethod,\n              name: payMethod,\n            },\n          },\n        };\n\n        // Add new check number payment method\n      } else {\n        return {\n          paymentMethod: null,\n          paymentMethodAdd: {\n            parent: parent.id,\n            refId: payMethod,\n            name: payMethod,\n            active: false,\n          },\n          paymentMethodUpdate: null,\n        };\n      }\n      // Update payment method\n    } else if (payMethod.id !== iniPayMethod.id) {\n      return {\n        paymentMethod: payMethod.id,\n        paymentMethodAdd: null,\n        paymentMethodUpdate: null,\n      };\n    }\n\n    return {\n      paymentMethod: null,\n      paymentMethodAdd: null,\n      paymentMethodUpdate: null,\n    };\n  })();\n\n  const variables: O.Required<\n    UpdateRefundVars,\n    keyof UpdateRefundVars,\n    \"deep\"\n  > = {\n    id,\n    fields: {\n      date,\n      description,\n      total,\n      reconciled,\n      paymentMethod,\n    },\n    paymentMethodAdd,\n    paymentMethodUpdate,\n  };\n\n  await client.mutate<UpdateRefund, UpdateRefundVars>({\n    mutation: UPDATE_REFUND,\n    variables,\n  });\n};\n\nexport default submitUpdate;\n","import React, { useMemo, useCallback } from \"react\";\nimport { useQuery, useApolloClient } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\nimport { Formik, FormikConfig, FormikProps, useFormikContext } from \"formik\";\nimport {\n  useTheme,\n  Dialog,\n  DialogTitle,\n  PaperProps,\n  Box,\n  DialogContent,\n  DialogContentText,\n  Grid,\n  DialogActions,\n  Button,\n} from \"@material-ui/core\";\nimport { Add as AddIcon, Cancel as CancelIcon } from \"@material-ui/icons\";\nimport Fraction from \"fraction.js\";\n\nimport {\n  UpdateRefundIniStateQuery as UpdateRefundIniState,\n  UpdateRefundIniStateQueryVariables as UpdateRefundIniStateVars,\n  JournalEntry_2Fragment as JournalEntryFragment,\n} from \"../../../../apollo/graphTypes\";\nimport submitUpdate, { UpdateValues, IniUpdateValues } from \"./submitUpdate\";\nimport { JOURNAL_FRAGMENT } from \"./refunds.gql\";\nimport { PAY_METHOD_ENTRY_OPT_FRAGMENT } from \"../upsertEntry.gql\";\nimport {\n  FormikStatus,\n  FormikStatusType,\n  useFormikStatus,\n} from \"../../../../formik/utils\";\nimport OverlayLoading from \"../../../utils/OverlayLoading\";\nimport Overlay from \"../../../utils/Overlay\";\nimport Description from \"../EntryFields/Description\";\nimport PaymentMethod from \"../EntryFields/PaymentMethod\";\nimport Total from \"../EntryFields/Total\";\nimport DateEntry from \"../EntryFields/DateEntry\";\nimport Reconcile from \"../EntryFields/Reconcile\";\nimport { rationalToFraction } from \"../../../../utils/rational\";\n\nexport interface UpdateRefundProps {\n  entryId: string | null;\n  refundId: string | null;\n  open: boolean;\n  onClose: () => void;\n  onExited: () => void;\n}\n\nconst UPDATE_REFUND_INI_STATE = gql`\n  query UpdateRefundIniState($entryId: ID!, $refundId: ID!) {\n    journalEntry(id: $entryId) {\n      ...JournalEntry_2Fragment\n    }\n    journalEntryRefund(id: $refundId) {\n      __typename\n      id\n      date\n      description\n      paymentMethod {\n        ...PayMethodEntryOptFragment\n        ancestors {\n          ...PayMethodEntryOptFragment\n        }\n      }\n      total {\n        n\n        d\n        s\n      }\n      reconciled\n    }\n  }\n  ${JOURNAL_FRAGMENT}\n  ${PAY_METHOD_ENTRY_OPT_FRAGMENT}\n`;\n\nconst UpdateRefundDialog = (\n  props: UpdateRefundProps & {\n    journalEntry: JournalEntryFragment | null;\n    loading: boolean;\n    handleSubmit: FormikProps<UpdateValues>[\"handleSubmit\"];\n  }\n) => {\n  const {\n    refundId,\n    open,\n    onClose,\n    onExited: onExitedCb,\n    journalEntry,\n    loading,\n    handleSubmit,\n  } = props;\n\n  const { resetForm, isSubmitting, isValid } = useFormikContext<UpdateValues>();\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const total = journalEntry?.total;\n  const refunds = journalEntry?.refunds || [];\n  const maxTotal = useMemo(() => {\n    if (total) {\n      const totalRefunds = refunds.reduce(\n        (totalRefunds, { id, deleted, total }) =>\n          // Do NOT include refund being updated in max total calculation\n          deleted || id === refundId\n            ? totalRefunds\n            : totalRefunds.add(rationalToFraction(total)),\n        new Fraction(0)\n      );\n      return rationalToFraction(total).sub(totalRefunds);\n    }\n    return new Fraction(Number.MAX_SAFE_INTEGER);\n  }, [total, refunds, refundId]);\n\n  const date = journalEntry?.date;\n  const minDate = useMemo<Date | undefined>(\n    () => (date ? new Date(date) : undefined),\n    [date]\n  );\n\n  const onExited = useCallback(() => {\n    onExitedCb();\n    resetForm();\n    setFormikStatus(null);\n  }, [resetForm, onExitedCb, setFormikStatus]);\n\n  const [generalError, fatalError] = useMemo<\n    [string | null, boolean | null]\n  >(() => {\n    if (\n      formikStatus &&\n      (formikStatus.type === FormikStatusType.FATAL_ERROR ||\n        formikStatus.type === FormikStatusType.ERROR)\n    ) {\n      return [\n        formikStatus.msg,\n        formikStatus.type === FormikStatusType.FATAL_ERROR,\n      ];\n    }\n    return [null, null];\n  }, [formikStatus]);\n\n  const title = useMemo(() => {\n    const title = \"Refund Update\";\n\n    if (fatalError) {\n      return \"Fatal Error\";\n    } else if (loading) {\n      return `Loading ${title}...`;\n    } else if (isSubmitting) {\n      return `Submitting ${title}`;\n    }\n    return title;\n  }, [loading, fatalError, isSubmitting]);\n\n  const theme = useTheme();\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      onExited={onExited}\n      disableBackdropClick={isSubmitting}\n      disableEscapeKeyDown={isSubmitting}\n      fullWidth\n      maxWidth=\"lg\"\n      PaperProps={\n        {\n          component: \"form\",\n          onSubmit: handleSubmit,\n        } as PaperProps & {\n          onSubmit: FormikProps<UpdateValues>[\"handleSubmit\"];\n        }\n      }\n    >\n      <DialogTitle\n        style={generalError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {(loading || isSubmitting) && !generalError && (\n          <OverlayLoading zIndex=\"modal\" />\n        )}\n        {!!generalError && fatalError && (\n          <Overlay opacity={0.78} zIndex=\"modal\" padding={2}>\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          </Overlay>\n        )}\n        <DialogContent dividers>\n          {!!generalError && !fatalError && (\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          )}\n          <Grid container spacing={2}>\n            <Grid item lg={4} sm={6} xs={12}>\n              <DateEntry\n                minDate={minDate}\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid item lg={4} sm={6} xs={12}>\n              <Description\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid item lg={4} sm={6} xs={12}>\n              <PaymentMethod\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid item lg={4} sm={6} xs={12}>\n              <Total\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n                maxTotal={maxTotal}\n              />\n            </Grid>\n            <Grid\n              item\n              container\n              justify=\"center\"\n              alignItems=\"flex-start\"\n              lg={4}\n              md={6}\n              sm={12}\n            >\n              <Reconcile\n                disabled={loading || isSubmitting || !!fatalError}\n                label\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!fatalError && (\n          <Button\n            disabled={loading || isSubmitting || !isValid}\n            type=\"submit\"\n            startIcon={<AddIcon />}\n            color=\"primary\"\n            variant=\"contained\"\n          >\n            Update\n          </Button>\n        )}\n        <Button\n          disabled={loading || isSubmitting || !!fatalError}\n          color={fatalError ? \"primary\" : \"default\"}\n          startIcon={!fatalError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {fatalError ? \"Ok\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst UpdateRefund = (props: UpdateRefundProps) => {\n  const { entryId, refundId, open, onClose, onExited } = props;\n\n  const { loading, error, data } = useQuery<\n    UpdateRefundIniState,\n    UpdateRefundIniStateVars\n  >(UPDATE_REFUND_INI_STATE, {\n    skip: !entryId,\n    variables: {\n      entryId: entryId as string,\n      refundId: refundId as string,\n    },\n  });\n\n  const initialStatus = useMemo(\n    () =>\n      error\n        ? ({\n            msg: error.message,\n            type: FormikStatusType.FATAL_ERROR,\n          } as FormikStatus)\n        : null,\n    [error]\n  );\n\n  const journalEntryRefund = data?.journalEntryRefund;\n  const initialValues = useMemo<IniUpdateValues>(() => {\n    if (!journalEntryRefund) {\n      return {} as any;\n    }\n\n    const date = {\n      inputValue: new Date(journalEntryRefund.date),\n      value: journalEntryRefund.date,\n    };\n\n    const paymentMethod = (() => {\n      const { ancestors, ...paymentMethod } = journalEntryRefund.paymentMethod;\n\n      // Array.prototype.sort mutates the array, create copy.\n      const value = [...ancestors].sort((a, b) => {\n        // a is the parent of b\n        if (a.id === b.parent?.id) {\n          return -1;\n          // b is the parent of a\n        } else if (b.id === a.parent?.id) {\n          return 1;\n        }\n        return 0;\n      });\n\n      value.push(paymentMethod);\n\n      return {\n        inputValue: \"\",\n        value,\n      };\n    })();\n\n    const total = {\n      inputValue: rationalToFraction(journalEntryRefund.total)\n        .round(2)\n        .toString(),\n      value: journalEntryRefund.total,\n    };\n\n    const reconciled = journalEntryRefund.reconciled;\n\n    const description = journalEntryRefund.description ?? null;\n\n    return {\n      date,\n      paymentMethod,\n      total,\n      reconciled,\n      description,\n    };\n  }, [journalEntryRefund]);\n\n  const client = useApolloClient();\n  const onSubmit = useCallback<FormikConfig<UpdateValues>[\"onSubmit\"]>(\n    async (values, formikHelpers) => {\n      if (!initialValues) {\n        formikHelpers.setStatus({\n          msg: `Failed to load initial values for refund \"${refundId}\".`,\n          type: FormikStatusType.FATAL_ERROR,\n        } as FormikStatus);\n        return;\n      } else if (!refundId) {\n        formikHelpers.setStatus({\n          msg: `No refund ID.`,\n          type: FormikStatusType.FATAL_ERROR,\n        } as FormikStatus);\n        return;\n      }\n\n      try {\n        formikHelpers.setStatus(null);\n        await submitUpdate(\n          client,\n          initialValues,\n          refundId,\n          values,\n          formikHelpers\n        );\n        onClose();\n      } catch (error) {\n        formikHelpers.setStatus({\n          msg: error?.message ?? `${error}`,\n          type: FormikStatusType.FATAL_ERROR,\n        } as FormikStatus);\n      }\n    },\n    [client, initialValues, onClose, refundId]\n  );\n\n  const children = useCallback(\n    (props: FormikProps<UpdateValues>) => {\n      return (\n        <UpdateRefundDialog\n          entryId={entryId}\n          refundId={refundId}\n          open={open}\n          onClose={onClose}\n          onExited={onExited}\n          journalEntry={data?.journalEntry ?? null}\n          loading={loading}\n          handleSubmit={props.handleSubmit}\n        />\n      );\n    },\n    [data, entryId, loading, onClose, onExited, open, refundId]\n  );\n\n  return (\n    <Formik\n      initialValues={(initialValues ?? {}) as UpdateValues}\n      initialStatus={initialStatus}\n      // isInitialValid={false}\n      enableReinitialize={true}\n      onSubmit={onSubmit}\n      children={children}\n    />\n  );\n};\n\nexport default UpdateRefund;\n","import { O } from \"ts-toolbelt\";\nimport { FormikConfig } from \"formik\";\nimport gql from \"graphql-tag\";\nimport ApolloClient from \"apollo-client\";\nimport { parseName } from \"humanparser\";\n\nimport {\n  JournalEntryAddFields,\n  PayMethodEntryOptFragment,\n  DeptEntryOptFragment,\n  CatEntryOptFragment,\n  SrcEntryBizOptFragment,\n  SrcEntryDeptOptFragment,\n  SrcEntryPersonOptFragment,\n  JournalEntrySourceType,\n  AddEntryMutation as AddEntry,\n  AddEntryMutationVariables as AddEntryVars,\n} from \"../../../../apollo/graphTypes\";\nimport { TransmutationValue } from \"../../../../formik/utils\";\nimport { JOURNAL_ENTRY_FRAGMENT } from \"../../Table/JournalEntries.gql\";\n\nexport type SourceValue =\n  | SrcEntryBizOptFragment\n  | SrcEntryDeptOptFragment\n  | SrcEntryPersonOptFragment\n  | string;\n\nexport type AddValues = O.Overwrite<\n  O.Required<JournalEntryAddFields, keyof JournalEntryAddFields, \"deep\">,\n  {\n    category: TransmutationValue<string, CatEntryOptFragment[]>;\n    date: TransmutationValue<Date | null, JournalEntryAddFields[\"date\"]>;\n    total: TransmutationValue<string, JournalEntryAddFields[\"total\"]>;\n    paymentMethod: TransmutationValue<\n      string,\n      (PayMethodEntryOptFragment | string)[]\n    >;\n    department: DeptEntryOptFragment;\n    source: TransmutationValue<\n      string,\n      (JournalEntrySourceType | SourceValue)[]\n    >;\n  }\n>;\n\nconst ADD_ENTRY = gql`\n  mutation AddEntry(\n    $fields: JournalEntryAddFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $personAdd: PersonAddFields\n    $businessAdd: BusinessAddFields\n  ) {\n    journalEntryAdd(\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      personAdd: $personAdd\n      businessAdd: $businessAdd\n    ) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst submitAdd: (\n  client: ApolloClient<any>,\n  ...rest: Parameters<FormikConfig<AddValues>[\"onSubmit\"]>\n) => ReturnType<FormikConfig<AddValues>[\"onSubmit\"]> = async (\n  client,\n  values\n) => {\n  const { paymentMethod, paymentMethodAdd } = (() => {\n    const payMethod =\n      values.paymentMethod.value[values.paymentMethod.value.length - 1];\n\n    // New Payment Method\n    if (typeof payMethod === \"string\") {\n      const parent = (values.paymentMethod.value[\n        values.paymentMethod.value.length - 2\n      ] as PayMethodEntryOptFragment).id;\n\n      return {\n        paymentMethod: \"\",\n        paymentMethodAdd: {\n          parent,\n          refId: payMethod,\n          name: payMethod,\n          active: false,\n        },\n      };\n    }\n\n    return {\n      paymentMethod: payMethod.id,\n      paymentMethodAdd: null,\n    };\n  })();\n\n  const { source, personAdd, businessAdd } = (() => {\n    const srcType = values.source.value[0] as JournalEntrySourceType;\n    const src = values.source.value[\n      values.source.value.length - 1\n    ] as SourceValue;\n\n    if (typeof src === \"string\") {\n      if (srcType === JournalEntrySourceType.Person) {\n        const parsedName = parseName(src);\n\n        return {\n          source: {\n            sourceType: JournalEntrySourceType.Person,\n            id: \"\",\n          },\n          businessAdd: null,\n          personAdd: {\n            name: {\n              first: parsedName.firstName,\n              last: parsedName.lastName,\n            },\n          },\n        };\n      } else {\n        return {\n          source: {\n            sourceType: JournalEntrySourceType.Business,\n            id: \"\",\n          },\n          businessAdd: {\n            name: src,\n          },\n          personAdd: null,\n        };\n      }\n    }\n\n    return {\n      source: {\n        sourceType: (() => {\n          switch (src.__typename) {\n            case \"Business\":\n              return JournalEntrySourceType.Business;\n            case \"Department\":\n              return JournalEntrySourceType.Department;\n            case \"Person\":\n              return JournalEntrySourceType.Person;\n          }\n        })(),\n        id: src.id,\n      },\n      personAdd: null,\n      businessAdd: null,\n    };\n  })();\n\n  const variables: O.Required<AddEntryVars, keyof AddEntryVars, \"deep\"> = {\n    fields: {\n      date: values.date.value,\n      department: values.department.id,\n      type: values.type,\n      category: values.category.value[values.category.value.length - 1].id,\n      description: values.description?.trim() || null,\n      total: values.total.value,\n      reconciled: values.reconciled ?? null,\n      paymentMethod,\n      source,\n    },\n    paymentMethodAdd,\n    personAdd,\n    businessAdd,\n  };\n\n  await client.mutate<AddEntry, AddEntryVars>({\n    mutation: ADD_ENTRY,\n    variables,\n  });\n};\n\nexport default submitAdd;\n","import React, { useCallback, useMemo, useState, useEffect } from \"react\";\nimport Autocomplete, {\n  AutocompleteProps as AutocompletePropsRaw,\n  RenderInputParams,\n} from \"@material-ui/lab/Autocomplete\";\nimport { UseAutocompleteMultipleProps } from \"@material-ui/lab/useAutocomplete\";\nimport { useField, useFormikContext } from \"formik\";\nimport gql from \"graphql-tag\";\nimport { useQuery, QueryHookOptions } from \"@apollo/react-hooks\";\nimport { TextFieldProps, TextField, Box, Chip } from \"@material-ui/core\";\nimport { ChevronRight } from \"@material-ui/icons\";\n\nimport { CAT_ENTRY_OPT_FRAGMENT } from \"../upsertEntry.gql\";\nimport {\n  CatEntryOptsQuery as CatEntryOpts,\n  CatEntryOptsQueryVariables as CatEntryOptsVars,\n  CatEntryOptFragment as CatValue,\n  CatEntryOptFragment,\n  JournalEntryType,\n} from \"../../../../apollo/graphTypes\";\nimport {\n  TransmutationValue,\n  useFormikStatus,\n  FormikStatusType,\n} from \"../../../../formik/utils\";\n\nconst CAT_OPTS_QUERY = gql`\n  query CatEntryOpts($where: JournalEntryCategoryWhereInput!) {\n    catOpts: journalEntryCategories(where: $where) {\n      ...CatEntryOptFragment\n    }\n  }\n  ${CAT_ENTRY_OPT_FRAGMENT}\n`;\n\ntype CatValueBeta = TransmutationValue<String, CatEntryOptFragment[]>;\n\ntype AutocompleteProps = AutocompletePropsRaw<CatValue> &\n  UseAutocompleteMultipleProps<CatValue>;\n\nconst getOptionLabel = (opt: CatValue) => opt.name;\nconst renderTags: AutocompleteProps[\"renderTags\"] = (\n  values: CatValue[],\n  getTagProps\n) => {\n  const lastIndex = values.length - 1;\n\n  return values.map((dept: any, index: number) => {\n    const isLastIndex = lastIndex === index;\n    const { key, ...props } = getTagProps({ index }) as any;\n\n    return (\n      <Box\n        key={key}\n        display=\"flex\"\n        flexDirection=\"row\"\n        alignItems=\"center\"\n        justifyContent=\"flex-start\"\n      >\n        <Chip\n          color={isLastIndex ? \"primary\" : \"default\"}\n          variant={isLastIndex ? \"default\" : \"outlined\"}\n          label={dept.name}\n          size=\"medium\"\n          {...props}\n          disabled={!isLastIndex}\n        />{\" \"}\n        {!isLastIndex && <ChevronRight fontSize=\"small\" />}\n      </Box>\n    );\n  });\n};\n\nconst NULLISH = Symbol();\n\nexport type CategoryProps = {\n  entryType?: JournalEntryType | null;\n  variant?: \"filled\" | \"outlined\";\n  autoFocus?: boolean;\n} & Omit<TextFieldProps, \"value\">;\n\nconst Category = function (props: CategoryProps) {\n  const formikContext = useFormikContext<{\n    category?: CatValueBeta;\n    type?: JournalEntryType;\n  }>();\n\n  const { disabled: disabledFromProps = false, required } = props;\n\n  const { entryType: entryTypeFromProps, ...textFieldProps } = props;\n\n  const value = formikContext.values?.category?.value || [];\n  const inputValue =\n    formikContext.values?.category?.inputValue.trimLeft() || \"\";\n  const entryType = entryTypeFromProps ?? formikContext.values?.type ?? null;\n\n  const catValue = value[value.length - 1];\n\n  const variables = useMemo<CatEntryOptsVars>(\n    () =>\n      catValue?.id\n        ? {\n            where: {\n              parent: {\n                eq: catValue.id,\n              },\n              type: {\n                eq: entryType,\n              },\n            },\n          }\n        : {\n            where: {\n              hasParent: false,\n              type: {\n                eq: entryType,\n              },\n            },\n          },\n    [catValue, entryType]\n  );\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const onError = useCallback<\n    NonNullable<QueryHookOptions<CatEntryOpts, CatEntryOptsVars>[\"onError\"]>\n  >(\n    (error) =>\n      void setFormikStatus({\n        msg: error.message,\n        type: FormikStatusType.FATAL_ERROR,\n      }),\n    [setFormikStatus]\n  );\n\n  const { loading, error: gqlError, data } = useQuery<\n    CatEntryOpts,\n    CatEntryOptsVars\n  >(CAT_OPTS_QUERY, {\n    skip: (entryType ?? NULLISH) === NULLISH,\n    variables,\n    onCompleted: () =>\n      setTimeout(() => formikContext.validateField(\"category\"), 0),\n    onError,\n  });\n  const catOpts = data?.catOpts;\n  const options = useMemo<CatEntryOptFragment[]>(() => catOpts || [], [\n    catOpts,\n  ]);\n\n  const validate = useCallback(\n    (transmutationVal: CatValueBeta | null | undefined) => {\n      const values = transmutationVal?.value || [];\n      const value = values[values.length - 1] || null;\n\n      if (!value) {\n        if (required) {\n          return \"Category Required\";\n        }\n        return;\n      } else if (options.length > 0) {\n        return \"Sub-category Required\";\n      }\n    },\n    [options, required]\n  );\n\n  const [field, meta, helpers] = useField<CatValueBeta | null | undefined>({\n    name: \"category\",\n    validate,\n  });\n\n  const { onBlur: onBlurField } = field;\n  const { error, touched } = meta;\n  const { setValue } = helpers;\n\n  // Reset category value if type changes\n  useEffect(() => {\n    if (catValue && entryType !== catValue.type) {\n      setValue({\n        inputValue: \"\",\n        value: [],\n      });\n    }\n  }, [entryType, catValue, setValue]);\n\n  // const disableTextInput = useMemo(() => {\n  //   return value.length > 0 && options.length === 0;\n  // }, [value, options]);\n\n  const helperText = useMemo(() => {\n    if (!!error && touched) {\n      return error;\n    } else if ((entryType ?? NULLISH) === NULLISH) {\n      return \"Category requires entry type.\";\n    } else if (!!gqlError) {\n      return gqlError.message;\n    }\n    return \"\";\n  }, [entryType, error, touched, gqlError]);\n\n  const disabled = useMemo(\n    () =>\n      loading ||\n      formikStatus?.type === FormikStatusType.FATAL_ERROR ||\n      (entryType ?? NULLISH) === NULLISH ||\n      disabledFromProps ||\n      (value.length > 0 && options.length === 0),\n    [\n      disabledFromProps,\n      entryType,\n      formikStatus,\n      loading,\n      options.length,\n      value.length,\n    ]\n  );\n\n  const renderInput = useCallback(\n    (params: RenderInputParams) => {\n      return (\n        <TextField\n          {...(textFieldProps as any)}\n          variant={textFieldProps.variant || \"filled\"}\n          {...params}\n          error={(touched && !!error) || !!gqlError}\n          disabled={disabled}\n          helperText={helperText}\n          name=\"category\"\n          label=\"Category\"\n        />\n      );\n    },\n    [textFieldProps, touched, error, gqlError, disabled, helperText]\n  );\n\n  const [hasFocus, setHasFocus] = useState(false);\n\n  const onFocus = useCallback((event?) => setHasFocus(true), [setHasFocus]);\n  const onBlur = useCallback(\n    (event) => {\n      setHasFocus(false);\n      // Fixes formik validate called with wrong version of value\n      event.persist();\n      setTimeout(() => void onBlurField(event), 0);\n    },\n    [setHasFocus, onBlurField]\n  );\n\n  const onChange = useCallback<NonNullable<AutocompleteProps[\"onChange\"]>>(\n    (event, value) => {\n      setValue({ inputValue, value });\n    },\n    [setValue, inputValue]\n  );\n\n  const onInputChange = useCallback<\n    NonNullable<AutocompleteProps[\"onInputChange\"]>\n  >(\n    (event, inputValue: string, reason) => {\n      inputValue = (inputValue || \"\").trimStart();\n      setValue({\n        inputValue,\n        value,\n      });\n    },\n    [setValue, value]\n  );\n\n  const autoCompleteProps = useMemo<AutocompleteProps>(() => {\n    return {\n      ...field,\n      open: hasFocus && options.length > 0,\n      onFocus,\n      onBlur,\n      options,\n      renderTags,\n      forcePopupIcon: false,\n      disabled,\n      value,\n      renderInput,\n      loading,\n      autoSelect: true,\n      multiple: true,\n      getOptionLabel,\n      onInputChange,\n      inputValue,\n      onChange,\n      name: \"category\",\n    };\n  }, [\n    field,\n    hasFocus,\n    options,\n    onFocus,\n    onBlur,\n    loading,\n    disabled,\n    value,\n    renderInput,\n    onInputChange,\n    inputValue,\n    onChange,\n  ]);\n\n  return <Autocomplete {...autoCompleteProps} />;\n};\n\nexport default Category;\n","import React, { useCallback, useMemo, useState } from \"react\";\nimport Autocomplete, {\n  AutocompleteProps as AutocompletePropsRaw,\n  RenderInputParams,\n} from \"@material-ui/lab/Autocomplete\";\nimport { UseAutocompleteMultipleProps } from \"@material-ui/lab/useAutocomplete\";\nimport { useField } from \"formik\";\nimport gql from \"graphql-tag\";\nimport { useQuery, QueryHookOptions } from \"@apollo/react-hooks\";\nimport { TextFieldProps, TextField, Box, Chip } from \"@material-ui/core\";\nimport { ChevronRight } from \"@material-ui/icons\";\n\nimport {\n  DeptEntryOptFragment as DeptValue,\n  DeptEntryOptsQuery,\n  DeptEntryOptsQueryVariables as DeptEntryOptsQueryVars,\n} from \"../../../../apollo/graphTypes\";\nimport { DEPT_ENTRY_OPT_FRAGMENT } from \"../upsertEntry.gql\";\nimport {\n  // TransmutationValue,\n  useFormikStatus,\n  FormikStatusType,\n} from \"../../../../formik/utils\";\n\nconst DEPT_OPTS_QUERY = gql`\n  query DeptEntryOpts($fromParent: ID) {\n    deptOpts: departments(fromParent: $fromParent) {\n      ...DeptEntryOptFragment\n    }\n  }\n  ${DEPT_ENTRY_OPT_FRAGMENT}\n`;\n\nconst businessId = \"5dc4b09bcf96e166daaa0090\";\n\ntype AutocompleteProps = AutocompletePropsRaw<DeptValue> &\n  UseAutocompleteMultipleProps<DeptValue>;\n\nconst getOptionLabel = (opt: DeptValue) => opt.name;\nconst renderTags: AutocompleteProps[\"renderTags\"] = (\n  values: DeptValue[],\n  getTagProps\n) => {\n  const lastIndex = values.length - 1;\n  return values.map((dept: any, index: number) => {\n    const isLastIndex = lastIndex === index;\n    const { key, ...props } = getTagProps({ index }) as any;\n    return (\n      <Box\n        key={key}\n        display=\"flex\"\n        flexDirection=\"row\"\n        alignItems=\"center\"\n        justifyContent=\"flex-start\"\n      >\n        <Chip\n          color={isLastIndex ? \"primary\" : \"default\"}\n          variant={isLastIndex ? \"default\" : \"outlined\"}\n          label={dept.name}\n          size=\"medium\"\n          {...props}\n          disabled={!isLastIndex}\n        />{\" \"}\n        {!isLastIndex && <ChevronRight fontSize=\"small\" />}\n      </Box>\n    );\n  });\n};\nexport type DepartmentProps = {\n  variant?: \"filled\" | \"outlined\";\n  autoFocus?: boolean;\n} & Omit<TextFieldProps, \"value\">;\n\nconst Department = function (props: DepartmentProps) {\n  const { disabled: disabledFromProps = false, required } = props;\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const onError = useCallback<\n    NonNullable<\n      QueryHookOptions<DeptEntryOptsQuery, DeptEntryOptsQueryVars>[\"onError\"]\n    >\n  >(\n    (error) =>\n      void setFormikStatus({\n        msg: error.message,\n        type: FormikStatusType.FATAL_ERROR,\n      }),\n    [setFormikStatus]\n  );\n\n  const { loading, error: gqlError, data } = useQuery<\n    DeptEntryOptsQuery,\n    DeptEntryOptsQueryVars\n  >(DEPT_OPTS_QUERY, { onError, variables: { fromParent: businessId } });\n\n  const depts = data?.deptOpts || [];\n\n  const [hasFocus, setHasFocus] = useState(false);\n\n  // Input must be controlled to stop input when leaf option is selected.\n  const [inputValue, setInputValue] = useState(\"\");\n\n  const validate = useCallback(\n    (value: DeptValue | null) => {\n      if (!value) {\n        if (required) {\n          return \"Department Required\";\n        }\n        return;\n      } else if (\n        depts.some(\n          ({ parent }) =>\n            parent.__typename === \"Department\" && parent.id === value.id\n        )\n      ) {\n        return \"Sub-department Required\";\n      }\n    },\n    [depts, required]\n  );\n\n  const [field, meta, helpers] = useField<DeptValue | null>({\n    name: \"department\",\n    validate,\n  });\n\n  const { value: deptValue, onBlur: onBlurField } = field;\n  const { error, touched } = meta;\n  const { setValue } = helpers;\n\n  const idDeptMap = useMemo(\n    () =>\n      new Map(\n        depts.reduce((idDepts, dept) => {\n          idDepts.push([dept.id, dept]);\n          return idDepts;\n        }, [] as [string, DeptValue][])\n      ),\n    [depts]\n  );\n\n  const value = useMemo(() => {\n    if (!deptValue) {\n      return [];\n    }\n\n    const value: DeptValue[] = [deptValue];\n\n    let { __typename, id } = deptValue.parent;\n\n    while (__typename !== \"Business\" && idDeptMap.has(id)) {\n      const parentDept = idDeptMap.get(id) as DeptValue;\n      value.unshift(parentDept);\n      ({ __typename, id } = parentDept.parent);\n    }\n\n    return value;\n  }, [deptValue, idDeptMap]);\n\n  const options = useMemo(() => {\n    const deptId = value[value.length - 1]?.id;\n    return depts.filter((opt) =>\n      deptId ? opt.parent.id === deptId : opt.parent.__typename === \"Business\"\n    );\n  }, [depts, value]);\n\n  const disableTextInput = useMemo(() => {\n    return value.length > 0 && options.length === 0;\n  }, [value, options]);\n\n  const helperText = useMemo(() => {\n    if (!!error && touched) {\n      return error;\n    } else if (!!gqlError) {\n      return gqlError.message;\n    }\n    return \"\";\n  }, [error, touched, gqlError]);\n\n  const disabled = useMemo(\n    () =>\n      loading ||\n      disableTextInput ||\n      formikStatus?.type === FormikStatusType.FATAL_ERROR ||\n      disabledFromProps,\n    [disableTextInput, disabledFromProps, formikStatus, loading]\n  );\n\n  const renderInput = useCallback(\n    (params: RenderInputParams) => {\n      return (\n        <TextField\n          {...(props as any)}\n          variant={props.variant || \"filled\"}\n          {...params}\n          error={touched && !!error}\n          helperText={helperText}\n          name=\"department\"\n          label=\"Department\"\n          disabled={disabled}\n        />\n      );\n    },\n    [props, touched, error, helperText, disabled]\n  );\n\n  const onFocus = useCallback((event?) => setHasFocus(true), [setHasFocus]);\n  const onBlur = useCallback(\n    (event) => {\n      setHasFocus(false);\n      onBlurField(event);\n    },\n    [setHasFocus, onBlurField]\n  );\n\n  const onChange = useCallback<NonNullable<AutocompleteProps[\"onChange\"]>>(\n    (event, value) => {\n      if (!value) {\n        setValue(null);\n      } else if (Array.isArray(value)) {\n        const len = value.length;\n        setValue(len === 0 ? null : value[len - 1]);\n      } else {\n        setValue(value);\n      }\n    },\n    [setValue]\n  );\n\n  const onInputChange = useCallback<\n    NonNullable<AutocompleteProps[\"onInputChange\"]>\n  >(\n    (event, value: string, reason) => {\n      setInputValue((value || \"\").trimStart());\n    },\n    [setInputValue]\n  );\n\n  const autoCompleteProps = useMemo<AutocompleteProps>(() => {\n    return {\n      ...field,\n      open: hasFocus && options.length > 0,\n      onFocus,\n      onBlur,\n      options,\n      renderTags,\n      forcePopupIcon: false,\n      disabled,\n      value,\n      renderInput,\n      loading,\n      autoSelect: true,\n      multiple: true,\n      getOptionLabel,\n      onChange,\n      onInputChange,\n      inputValue: disableTextInput ? \"\" : inputValue,\n      name: \"department\",\n    };\n  }, [\n    field,\n    hasFocus,\n    options,\n    onFocus,\n    onBlur,\n    disableTextInput,\n    disabled,\n    value,\n    renderInput,\n    loading,\n    onChange,\n    onInputChange,\n    inputValue,\n  ]);\n\n  if (gqlError) {\n    return <pre>{JSON.stringify(gqlError, null, 2)}</pre>;\n  }\n\n  return <Autocomplete {...autoCompleteProps} />;\n};\n\nexport default Department;\n","import React, { useCallback, useMemo, useState, useRef } from \"react\";\nimport Autocomplete, {\n  AutocompleteProps as AutocompletePropsRaw,\n  RenderInputParams,\n} from \"@material-ui/lab/Autocomplete\";\nimport { UseAutocompleteMultipleProps } from \"@material-ui/lab/useAutocomplete\";\nimport { useField } from \"formik\";\nimport { useQuery, QueryHookOptions } from \"@apollo/react-hooks\";\nimport { TextFieldProps, TextField, Box, Chip } from \"@material-ui/core\";\nimport { ChevronRight } from \"@material-ui/icons\";\nimport { parseName } from \"humanparser\";\nimport * as namecase from \"namecase\";\nimport gql from \"graphql-tag\";\n\nimport {\n  JournalEntrySourceType,\n  SrcEntryOptsQuery,\n  SrcEntryOptsQueryVariables as SrcEntryOptsQueryVars,\n  SrcEntryBizOptFragment as BizOpt,\n  SrcEntryDeptOptFragment as DeptOpt,\n  SrcEntryPersonOptFragment as PersonOpt,\n} from \"../../../../apollo/graphTypes\";\nimport {\n  SRC_ENTRY_PERSON_OPT_FRAGMENT,\n  SRC_ENTRY_BIZ_OPT_FRAGMENT,\n  SRC_ENTRY_DEPT_OPT_FRAGMENT,\n} from \"../upsertEntry.gql\";\nimport {\n  TransmutationValue,\n  useFormikStatus,\n  FormikStatusType,\n} from \"../../../../formik/utils\";\n\nconst SRC_ENTRY_OPTS_QUERY = gql`\n  query SrcEntryOpts($name: String!, $isBiz: Boolean!) {\n    businesses(searchByName: $name) @include(if: $isBiz) {\n      ...SrcEntryBizOptFragment\n    }\n    people(searchByName: { first: $name, last: $name }) @skip(if: $isBiz) {\n      ...SrcEntryPersonOptFragment\n    }\n  }\n  ${SRC_ENTRY_PERSON_OPT_FRAGMENT}\n  ${SRC_ENTRY_BIZ_OPT_FRAGMENT}\n  ${SRC_ENTRY_DEPT_OPT_FRAGMENT}\n`;\n\nexport type SourceProps = {\n  variant?: \"filled\" | \"outlined\";\n  autoFocus?: boolean;\n} & Omit<TextFieldProps, \"value\">;\n\nexport type SrcObjectValue = BizOpt | DeptOpt | PersonOpt;\nexport type SourceValue = SrcObjectValue | string;\nexport type Value = SourceValue | JournalEntrySourceType;\ntype Options = Value[];\nexport type FieldValue = TransmutationValue<string, Value[]>;\n\ntype AutocompleteProps = AutocompletePropsRaw<Value> &\n  UseAutocompleteMultipleProps<Value>;\n\nexport const isFreeSoloOpt = (opt: Value) => {\n  switch (opt) {\n    case JournalEntrySourceType.Business:\n    case JournalEntrySourceType.Department:\n    case JournalEntrySourceType.Person:\n      break;\n    default:\n      return typeof opt === \"string\";\n  }\n  return false;\n};\n\nconst getOptionLabel: AutocompleteProps[\"getOptionLabel\"] = (opt): string => {\n  switch (opt) {\n    case JournalEntrySourceType.Business:\n      return \"Vendor\";\n    case JournalEntrySourceType.Department:\n      return \"Department\";\n    case JournalEntrySourceType.Person:\n      return \"Person\";\n    default:\n      if (typeof opt === \"string\") {\n        return opt;\n      }\n  }\n\n  if (opt.__typename === \"Person\") {\n    return `${opt.personName.first} ${opt.personName.last}`;\n  }\n\n  return opt.name;\n};\n\nconst renderTags: AutocompleteProps[\"renderTags\"] = (values, getTagProps) => {\n  const lastIndex = values.length - 1;\n  return values.map((value: Value, index: number) => {\n    const isLastIndex = lastIndex === index;\n    const { key, ...props } = getTagProps({ index }) as any;\n\n    if (isFreeSoloOpt(value)) {\n      return value;\n    }\n\n    return (\n      <Box\n        key={key}\n        display=\"flex\"\n        flexDirection=\"row\"\n        alignItems=\"center\"\n        justifyContent=\"flex-start\"\n      >\n        <Chip\n          color={isLastIndex ? \"primary\" : \"default\"}\n          variant={isLastIndex ? \"default\" : \"outlined\"}\n          label={getOptionLabel(value)}\n          size=\"medium\"\n          {...props}\n          disabled={!isLastIndex}\n        />{\" \"}\n        {!isLastIndex && <ChevronRight fontSize=\"small\" />}\n      </Box>\n    );\n  });\n};\n\nconst filterOptions: AutocompleteProps[\"filterOptions\"] = (\n  options,\n  { inputValue }\n) => {\n  const regex = new RegExp(`(^|\\\\s)${inputValue}`, \"i\");\n  return options.filter((opt) => regex.test(getOptionLabel(opt)));\n};\nconst validate = (transmutationVal?: FieldValue) => {\n  const value = transmutationVal?.value || [];\n  const srcType = (value[0] ?? null) as JournalEntrySourceType | null;\n  const srcValue = value.length > 1 ? value[value.length - 1] : null;\n\n  if (srcType === null || srcValue === null || srcValue === \"\") {\n    return \"Source Required\";\n  } else if (\n    isFreeSoloOpt(srcValue) &&\n    srcType === JournalEntrySourceType.Person\n  ) {\n    // Validate Free Solo Person name\n    const parsedName = parseName(srcValue as string);\n    if (!parsedName.firstName.trim()) {\n      return \"First Name Required\";\n    } else if (!parsedName.lastName.trim()) {\n      return \"Last Name Required\";\n    }\n  }\n};\n\nconst Source = function (props: SourceProps) {\n  const { disabled: disabledFromProps = false } = props;\n\n  const [hasFocus, setHasFocus] = useState(false);\n\n  const [field, meta, helpers] = useField<FieldValue | null | undefined>({\n    name: \"source\",\n    validate,\n  });\n\n  const { onBlur: onBlurField } = field;\n  const value = field.value?.value ?? [];\n  const inputValue = field.value?.inputValue ?? \"\";\n  const { error, touched } = meta;\n  const { setValue } = helpers;\n\n  const srcType = (value[0] ?? null) as JournalEntrySourceType | null;\n  const srcValue = value.length > 1 ? value[value.length - 1] : null;\n\n  const searchedName = useRef(\"\");\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const onError = useCallback<\n    NonNullable<\n      QueryHookOptions<SrcEntryOptsQuery, SrcEntryOptsQueryVars>[\"onError\"]\n    >\n  >(\n    (error) =>\n      void setFormikStatus({\n        msg: error.message,\n        type: FormikStatusType.FATAL_ERROR,\n      }),\n    [setFormikStatus]\n  );\n\n  const { loading, error: gqlError, data } = useQuery<\n    SrcEntryOptsQuery,\n    SrcEntryOptsQueryVars\n  >(SRC_ENTRY_OPTS_QUERY, {\n    skip: !searchedName.current && !value[1],\n    variables: {\n      name: searchedName.current,\n      isBiz: srcType !== JournalEntrySourceType.Person,\n    },\n    onError,\n  });\n\n  const idDeptMap = useMemo(() => {\n    const idDeptMap = new Map<string, DeptOpt>();\n    for (const bizOpt of data?.businesses || []) {\n      for (const deptOpt of bizOpt.departments) {\n        idDeptMap.set(deptOpt.id, deptOpt);\n      }\n    }\n    return idDeptMap;\n  }, [data]);\n\n  const options = useMemo<Options>(() => {\n    if (srcType === null) {\n      return [JournalEntrySourceType.Business, JournalEntrySourceType.Person];\n      // Person ONLY person options\n    } else if (srcType === JournalEntrySourceType.Person) {\n      return srcValue === null ? data?.people || [] : [];\n      // Only Business options\n    } else if (!srcValue) {\n      return data?.businesses || [];\n      // Free solo no options\n    } else if (typeof srcValue === \"string\") {\n      return [] as Options;\n    }\n\n    const options: DeptOpt[] = [];\n\n    for (const deptOpt of idDeptMap.values()) {\n      if (\n        deptOpt.parent.__typename === srcValue.__typename &&\n        deptOpt.parent.id === srcValue.id\n      ) {\n        options.push(deptOpt);\n      }\n    }\n\n    return options;\n  }, [srcType, data, idDeptMap, srcValue]);\n\n  const freeSolo = useMemo(() => {\n    return srcType !== null && srcValue === null;\n  }, [srcType, srcValue]);\n\n  const disableTextInput = useMemo(() => {\n    return value.length > 0 && options.length === 0 && !freeSolo;\n  }, [value, options, freeSolo]);\n\n  const label = useMemo(() => {\n    if (srcType === null) {\n      return \"Source Type\";\n    } else if (srcType === JournalEntrySourceType.Person) {\n      return \"Person Name\";\n    } else if (value.length === 1) {\n      return \"Vendor\";\n    } else if (value.length === 2 && options.length > 0) {\n      return \"Department\";\n    } else if (options.length > 0) {\n      return \"Sub-Department\";\n    }\n\n    return \"Vendor\";\n  }, [value, options, srcType]);\n\n  const disabled = useMemo(\n    () =>\n      // loading || CANNOT disable on loading bc input loses focus on first char\n      disabledFromProps ||\n      disableTextInput ||\n      formikStatus?.type === FormikStatusType.FATAL_ERROR,\n    [disableTextInput, disabledFromProps, formikStatus]\n  );\n\n  const renderInput = useCallback(\n    (\n      params: RenderInputParams & { inputProps?: TextFieldProps[\"inputProps\"] }\n    ) => {\n      // Disable input?\n      if (\n        srcValue &&\n        typeof srcValue !== \"string\" &&\n        srcValue.__typename !== \"Person\" &&\n        options.length === 0\n      ) {\n        params = {\n          ...params,\n          inputProps: {\n            ...(params?.inputProps || {}),\n            style: {\n              ...(params?.inputProps?.style || {}),\n              display: \"none\",\n            },\n          },\n        };\n      }\n\n      return (\n        <TextField\n          {...(props as any)}\n          variant={props.variant || \"filled\"}\n          {...params}\n          error={touched && !!error}\n          helperText={touched ? error : undefined}\n          name=\"source\"\n          label={label}\n          disabled={disabled}\n        />\n      );\n    },\n    [srcValue, options.length, props, touched, error, label, disabled]\n  );\n\n  const onFocus = useCallback((event?) => setHasFocus(true), [setHasFocus]);\n  const onBlur = useCallback<NonNullable<AutocompleteProps[\"onBlur\"]>>(\n    (event) => {\n      setHasFocus(false);\n      // Fixes formik validate called with wrong version of value\n      event.persist();\n      setTimeout(() => onBlurField(event), 0);\n    },\n    [setHasFocus, onBlurField]\n  );\n\n  const onChange = useCallback<NonNullable<AutocompleteProps[\"onChange\"]>>(\n    (event, value) => {\n      const srcValueIndex = value.length - 1;\n      const srcValue = value[srcValueIndex];\n      if (isFreeSoloOpt(srcValue)) {\n        const formattedSrcStrs: string[] = [];\n\n        for (let str of (srcValue as string).split(\" \")) {\n          if (str) {\n            if (namecase.checkName(str)) {\n              str = namecase(str);\n            }\n\n            formattedSrcStrs.push(str);\n          }\n        }\n\n        const formattedStr = formattedSrcStrs.join(\" \").trim();\n\n        value[srcValueIndex] =\n          formattedStr.charAt(0).toUpperCase() + formattedStr.substring(1);\n      }\n      setValue({ inputValue, value });\n    },\n    [setValue, inputValue]\n  );\n\n  const onInputChange = useCallback<\n    NonNullable<AutocompleteProps[\"onInputChange\"]>\n  >(\n    (event, inputValue: string, reason) => {\n      inputValue = (inputValue || \"\").trimStart();\n\n      if (!disableTextInput) {\n        setValue({ inputValue, value });\n      }\n\n      if (srcType !== null && srcValue === null && inputValue) {\n        searchedName.current = inputValue[0].toLowerCase();\n      }\n    },\n    [setValue, srcType, srcValue, value, disableTextInput, searchedName]\n  );\n\n  const autoCompleteProps = useMemo<AutocompleteProps>(() => {\n    return {\n      ...field,\n      inputValue: disableTextInput ? \"\" : inputValue,\n      open: hasFocus && options.length > 0,\n      onFocus,\n      onBlur,\n      options,\n      renderTags,\n      forcePopupIcon: false,\n      freeSolo,\n      value,\n      renderInput,\n      loading,\n      autoSelect: true,\n      multiple: true,\n      getOptionLabel,\n      onInputChange,\n      onChange,\n      filterOptions,\n      name: \"source\",\n      disabled,\n    };\n  }, [\n    field,\n    disableTextInput,\n    inputValue,\n    hasFocus,\n    options,\n    onFocus,\n    onBlur,\n    freeSolo,\n    value,\n    renderInput,\n    loading,\n    onInputChange,\n    onChange,\n    disabled,\n  ]);\n\n  if (gqlError) {\n    return <pre>{JSON.stringify(gqlError, null, 2)}</pre>;\n  }\n\n  return <Autocomplete {...autoCompleteProps} />;\n};\n\nexport default Source;\n","import React, { useMemo } from \"react\";\nimport { useField, useFormikContext } from \"formik\";\nimport ToggleButtonGroup, {\n  ToggleButtonGroupProps,\n} from \"@material-ui/lab/ToggleButtonGroup\";\nimport ToggleButton from \"@material-ui/lab/ToggleButton\";\nimport { BankPlus, BankMinus } from \"mdi-material-ui\";\nimport {\n  Tooltip,\n  Box,\n  FormControlLabel,\n  FormControlLabelProps,\n  FormControl,\n  FormHelperText,\n} from \"@material-ui/core\";\nimport { JournalEntryType } from \"../../../../apollo/graphTypes\";\nimport { useFormikStatus, FormikStatusType } from \"../../../../formik/utils\";\n\nconst NULLISH: unique symbol = Symbol();\n\nconst validate = (value?: JournalEntryType) => {\n  if (((value ?? NULLISH) as any) === NULLISH) {\n    return \"Type Required\";\n  }\n};\n\nconst Type = function (\n  props: {\n    label?: boolean | FormControlLabelProps[\"labelPlacement\"];\n  } & ToggleButtonGroupProps & { disabled?: boolean }\n) {\n  const { disabled: disabledFromProps = false } = props;\n\n  const [formikStatus] = useFormikStatus();\n\n  const { label = false } = props;\n\n  const { isSubmitting } = useFormikContext();\n\n  const [field, meta, helpers] = useField<JournalEntryType | null>({\n    name: \"type\",\n    validate,\n  });\n\n  const { error, touched } = meta;\n  const { setValue, setTouched } = helpers;\n\n  const toggleButtonGroupProps: ToggleButtonGroupProps = useMemo(\n    () => ({\n      size: \"small\",\n      exclusive: true,\n      disabled: isSubmitting,\n      ...field,\n      onChange: async (event, value: JournalEntryType) => {\n        if (((value ?? NULLISH) as any) === NULLISH) {\n          return;\n        }\n\n        setValue(value);\n        await new Promise((resolve) => setTimeout(resolve, 0)); //Avoid pres\n        setTouched(true);\n      },\n    }),\n    [field, isSubmitting, setValue, setTouched]\n  );\n\n  const disabled =\n    isSubmitting ||\n    disabledFromProps ||\n    formikStatus?.type === FormikStatusType.FATAL_ERROR;\n\n  const control = useMemo(\n    () => (\n      <Box pl={1} clone>\n        <ToggleButtonGroup {...(props as any)} {...toggleButtonGroupProps}>\n          <ToggleButton disabled={disabled} value={JournalEntryType.Credit}>\n            <Tooltip arrow placement=\"top\" title=\"Credit\">\n              <BankPlus />\n            </Tooltip>\n          </ToggleButton>\n          <ToggleButton disabled={disabled} value={JournalEntryType.Debit}>\n            <Tooltip arrow placement=\"top\" title=\"Debit\">\n              <BankMinus />\n            </Tooltip>\n          </ToggleButton>\n        </ToggleButtonGroup>\n      </Box>\n    ),\n    [props, toggleButtonGroupProps, disabled]\n  );\n\n  if (label) {\n    return (\n      <FormControl>\n        <FormControlLabel\n          {...(props as any)}\n          labelPlacement={typeof label === \"boolean\" ? undefined : label}\n          control={control}\n          label=\"Type\"\n        />\n        {touched && !!error && <FormHelperText error>{error}</FormHelperText>}\n      </FormControl>\n    );\n  }\n\n  return (\n    <FormControl>\n      {control}\n      {!!error && <FormHelperText error>{error}</FormHelperText>}\n    </FormControl>\n  );\n};\n\nexport default Type;\n","import React, { useMemo, useCallback } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  Box,\n  DialogContent,\n  DialogContentText,\n  PaperProps,\n  Grid,\n  DialogActions,\n  Button,\n  useTheme,\n  GridProps,\n} from \"@material-ui/core\";\nimport {\n  Add as AddIcon,\n  Cancel as CancelIcon,\n  Queue as QueueIcon,\n} from \"@material-ui/icons\";\nimport { Formik, FormikConfig, FormikProps, useFormikContext } from \"formik\";\nimport { useApolloClient, useQuery } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\n\nimport {\n  DeptIniValueForAddEntryQuery as DeptIniValueForAddEntry,\n  DeptIniValueForAddEntryQueryVariables as DeptIniValueForAddEntryVars,\n} from \"../../../../apollo/graphTypes\";\nimport submitAdd, { AddValues } from \"./submitAdd\";\nimport {\n  FormikStatusType,\n  FormikStatus,\n  useFormikStatus,\n} from \"../../../../formik/utils\";\nimport { DEPT_ENTRY_OPT_FRAGMENT } from \"../upsertEntry.gql\";\nimport OverlayLoading from \"../../../utils/OverlayLoading\";\nimport Overlay from \"../../../utils/Overlay\";\nimport DateEntry from \"../EntryFields/DateEntry\";\nimport Description from \"../EntryFields/Description\";\nimport Total from \"../EntryFields/Total\";\nimport Reconcile from \"../EntryFields/Reconcile\";\nimport PaymentMethod from \"../EntryFields/PaymentMethod\";\nimport Category from \"../EntryFields/Category\";\nimport Department from \"../EntryFields/Department\";\nimport Source from \"../EntryFields/Source\";\nimport Type from \"../EntryFields/Type\";\n\nexport interface AddEntryProps {\n  deptId?: string | null;\n  open: boolean;\n  onClose: () => void;\n}\n\nconst gridEntryResponsiveProps: GridProps = {\n  item: true,\n  lg: 4,\n  sm: 6,\n  xs: 12,\n} as const;\n\nconst DEPT_INI_VALUE = gql`\n  query DeptIniValueForAddEntry($id: ID!) {\n    department(id: $id) {\n      ...DeptEntryOptFragment\n    }\n  }\n  ${DEPT_ENTRY_OPT_FRAGMENT}\n`;\n\nconst AddEntryDialog = (\n  props: AddEntryProps & {\n    loading: boolean;\n  }\n) => {\n  const { open, onClose, loading } = props;\n\n  const { resetForm, isSubmitting, isValid, submitForm } = useFormikContext<\n    AddValues\n  >();\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const [generalError, fatalError] = useMemo<\n    [string | null, boolean | null]\n  >(() => {\n    if (\n      formikStatus &&\n      (formikStatus.type === FormikStatusType.FATAL_ERROR ||\n        formikStatus.type === FormikStatusType.ERROR)\n    ) {\n      return [\n        formikStatus.msg,\n        formikStatus.type === FormikStatusType.FATAL_ERROR,\n      ];\n    }\n    return [null, null];\n  }, [formikStatus]);\n\n  const onExited = useCallback(() => {\n    resetForm();\n    setFormikStatus(null);\n  }, [resetForm, setFormikStatus]);\n\n  const title = useMemo<string>(() => {\n    if (fatalError) {\n      return \"Fatal Error\";\n    } else if (isSubmitting) {\n      return \"Submitting Add Entry...\";\n    } else if (loading) {\n      return \"Loading Add Entry...\";\n    }\n    return \"Add Entry\";\n  }, [fatalError, isSubmitting, loading]);\n\n  const theme = useTheme();\n\n  const onClickAdd = useCallback(async () => {\n    try {\n      setFormikStatus(null);\n      await submitForm();\n      onClose();\n    } catch (error) {\n      setFormikStatus({\n        msg: error.message ?? `${error}`,\n        type: FormikStatusType.ERROR,\n      } as FormikStatus);\n    }\n  }, [submitForm, onClose, setFormikStatus]);\n\n  const onClickAddAndNew = useCallback(async () => {\n    try {\n      setFormikStatus(null);\n      await submitForm();\n      resetForm();\n    } catch (error) {\n      setFormikStatus({\n        msg: error.message ?? `${error}`,\n        type: FormikStatusType.ERROR,\n      } as FormikStatus);\n    }\n  }, [submitForm, resetForm, setFormikStatus]);\n\n  const handleSubmit = useCallback(\n    (event: React.FormEvent<HTMLFormElement>) => event.preventDefault(),\n    []\n  );\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      onExited={onExited}\n      disableBackdropClick={isSubmitting}\n      disableEscapeKeyDown={isSubmitting}\n      fullWidth\n      maxWidth=\"lg\"\n      PaperProps={\n        {\n          component: \"form\",\n          onSubmit: handleSubmit,\n        } as PaperProps & { onSubmit: FormikProps<AddValues>[\"handleSubmit\"] }\n      }\n    >\n      <DialogTitle\n        style={generalError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {(isSubmitting || loading) && !generalError && (\n          <OverlayLoading zIndex=\"modal\" />\n        )}\n        {!!generalError && fatalError && (\n          <Overlay opacity={0.78} zIndex=\"modal\" padding={2}>\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          </Overlay>\n        )}\n        <DialogContent dividers>\n          {!!generalError && !fatalError && (\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          )}\n          <Grid container spacing={2}>\n            <Grid {...gridEntryResponsiveProps} justify=\"center\" container>\n              <Type\n                style={{ margin: theme.spacing(1) }}\n                label=\"start\"\n                disabled={loading || isSubmitting || !!fatalError}\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <DateEntry\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Source\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Category\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n                required\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Department\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n                required\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Description\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <PaymentMethod\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Total\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid\n              container\n              justify=\"center\"\n              alignItems=\"flex-start\"\n              {...gridEntryResponsiveProps}\n            >\n              <Reconcile\n                disabled={loading || isSubmitting || !!fatalError}\n                label\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!fatalError && (\n          <React.Fragment>\n            <Button\n              onClick={onClickAdd}\n              disabled={loading || isSubmitting || !isValid}\n              type=\"submit\"\n              startIcon={<AddIcon />}\n              color=\"primary\"\n              variant=\"contained\"\n            >\n              Add\n            </Button>\n            <Button\n              onClick={onClickAddAndNew}\n              disabled={loading || isSubmitting || !isValid}\n              type=\"submit\"\n              startIcon={<QueueIcon />}\n              variant=\"outlined\"\n            >\n              Add & New\n            </Button>\n          </React.Fragment>\n        )}\n        <Button\n          disabled={isSubmitting}\n          color={fatalError ? \"primary\" : \"default\"}\n          startIcon={!fatalError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {fatalError ? \"Ok\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst AddEntry = (props: AddEntryProps) => {\n  const { open, onClose, deptId } = props;\n\n  const { loading, error, data } = useQuery<\n    DeptIniValueForAddEntry,\n    DeptIniValueForAddEntryVars\n  >(DEPT_INI_VALUE, {\n    skip: !deptId,\n    variables: {\n      id: deptId as string,\n    },\n  });\n\n  const department = data?.department;\n  const initialValues = useMemo<Partial<AddValues>>(\n    () => (department ? { department } : {}),\n    [department]\n  );\n  const initialStatus = useMemo<FormikStatus | null>(\n    () =>\n      error ? { msg: error.message, type: FormikStatusType.FATAL_ERROR } : null,\n    [error]\n  );\n\n  const client = useApolloClient();\n  const onSubmit = useCallback<FormikConfig<AddValues>[\"onSubmit\"]>(\n    (values, formikHelpers) => submitAdd(client, values, formikHelpers),\n    [client]\n  );\n\n  const children = useCallback(\n    (props: FormikProps<AddValues>) => (\n      <AddEntryDialog open={open} onClose={onClose} loading={loading} />\n    ),\n    [open, onClose, loading]\n  );\n\n  return (\n    <Formik\n      initialValues={initialValues as AddValues}\n      initialStatus={initialStatus}\n      enableReinitialize={true}\n      onSubmit={onSubmit}\n      children={children}\n    />\n  );\n};\n\nexport default AddEntry;\n","import { O, U } from \"ts-toolbelt\";\nimport { FormikConfig } from \"formik\";\nimport gql from \"graphql-tag\";\nimport ApolloClient from \"apollo-client\";\nimport { isEqual } from \"date-fns\";\nimport { parseName } from \"humanparser\";\n\nimport {\n  JournalEntryUpdateFields,\n  PayMethodEntryOptFragment,\n  DeptEntryOptFragment,\n  CatEntryOptFragment,\n  JournalEntrySourceType,\n  UpdateEntryMutation as UpdateEntry,\n  UpdateEntryMutationVariables as UpdateEntryVars,\n} from \"../../../../apollo/graphTypes\";\nimport { TransmutationValue } from \"../../../../formik/utils\";\nimport { CHECK_ID } from \"../../constants\";\nimport { JOURNAL_ENTRY_FRAGMENT } from \"../../Table/JournalEntries.gql\";\nimport { SourceValue } from \"./submitAdd\";\nimport { rationalToFraction } from \"../../../../utils/rational\";\n\nexport type UpdateValues = O.NonNullable<\n  O.Overwrite<\n    O.Required<\n      JournalEntryUpdateFields,\n      keyof JournalEntryUpdateFields,\n      \"deep\"\n    >,\n    {\n      category: TransmutationValue<string, CatEntryOptFragment[]>;\n      date: TransmutationValue<\n        Date,\n        NonNullable<JournalEntryUpdateFields[\"date\"]>\n      >;\n      total: TransmutationValue<\n        string,\n        NonNullable<JournalEntryUpdateFields[\"total\"]>\n      >;\n      paymentMethod: TransmutationValue<\n        string,\n        (PayMethodEntryOptFragment | string)[]\n      >;\n      department: DeptEntryOptFragment;\n      source: TransmutationValue<\n        string,\n        (JournalEntrySourceType | SourceValue)[]\n      >;\n    }\n  >,\n  keyof Omit<JournalEntryUpdateFields, \"description\">\n>;\n\nexport type IniUpdateValues = O.Overwrite<\n  UpdateValues,\n  {\n    paymentMethod: TransmutationValue<string, PayMethodEntryOptFragment[]>;\n    source: TransmutationValue<\n      string,\n      (JournalEntrySourceType | U.Exclude<SourceValue, string>)[]\n    >;\n  }\n>;\n\nconst NULLISH = Symbol();\n\nconst UPDATE_ENTRY = gql`\n  mutation UpdateEntry(\n    $id: ID!\n    $fields: JournalEntryUpdateFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $paymentMethodUpdate: JournalEntryUpdatePaymentMethod\n    $personAdd: PersonAddFields\n    $businessAdd: BusinessAddFields\n  ) {\n    journalEntryUpdate(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      paymentMethodUpdate: $paymentMethodUpdate\n      personAdd: $personAdd\n      businessAdd: $businessAdd\n    ) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst submitUpdate: (\n  client: ApolloClient<any>,\n  iniValues: IniUpdateValues,\n  id: string,\n  ...rest: Parameters<FormikConfig<UpdateValues>[\"onSubmit\"]>\n) => ReturnType<FormikConfig<UpdateValues>[\"onSubmit\"]> = async (\n  client,\n  iniValues,\n  id,\n  values\n) => {\n  // Category\n  const category = (() => {\n    const category =\n      values.category.value[values.category.value.length - 1]?.id ?? null;\n\n    return category ===\n      (iniValues.category.value[iniValues.category.value.length - 1]?.id ??\n        null)\n      ? null\n      : category;\n  })();\n\n  // Date\n  const date = isEqual(iniValues.date.inputValue, values.date.inputValue)\n    ? null\n    : values.date.value;\n\n  // Department\n  const department =\n    values.department.id === iniValues.department.id\n      ? null\n      : values.department.id;\n\n  // Description\n  const description =\n    values.description?.trim() && values.description !== iniValues.description\n      ? (values.description as string).trim()\n      : null;\n\n  // Total\n  const total =\n    rationalToFraction(values.total.value).compare(\n      rationalToFraction(iniValues.total.value)\n    ) === 0\n      ? null\n      : values.total.value;\n\n  // Type\n  const type = values.type === iniValues.type ? null : values.type;\n\n  // Reconciled\n  const reconciled =\n    values.reconciled === iniValues.reconciled ? null : values.reconciled;\n\n  // Payment Method\n  const { paymentMethod, paymentMethodAdd, paymentMethodUpdate } = (() => {\n    const iniPayMethod =\n      iniValues.paymentMethod.value[iniValues.paymentMethod.value.length - 1];\n\n    const [payMethod, parent] = values.paymentMethod.value\n      .slice(-2)\n      .reverse() as [\n      string | PayMethodEntryOptFragment,\n      PayMethodEntryOptFragment\n    ];\n\n    // Currently CHECK Numbers only\n    if (typeof payMethod === \"string\") {\n      // Update check number on payment method\n      if (iniPayMethod.parent && iniPayMethod.parent.id === CHECK_ID) {\n        return {\n          paymentMethod: null,\n          paymentMethodAdd: null,\n          paymentMethodUpdate: {\n            id: iniPayMethod.id,\n            fields: {\n              active: null,\n              refId: payMethod,\n              name: payMethod,\n            },\n          },\n        };\n\n        // Add new check number payment method\n      } else {\n        return {\n          paymentMethod: null,\n          paymentMethodAdd: {\n            parent: parent.id,\n            refId: payMethod,\n            name: payMethod,\n            active: false,\n          },\n          paymentMethodUpdate: null,\n        };\n      }\n      // Update payment method\n    } else if (payMethod.id !== iniPayMethod.id) {\n      return {\n        paymentMethod: payMethod.id,\n        paymentMethodAdd: null,\n        paymentMethodUpdate: null,\n      };\n    }\n\n    return {\n      paymentMethod: null,\n      paymentMethodAdd: null,\n      paymentMethodUpdate: null,\n    };\n  })();\n\n  // Source\n  const { source, personAdd, businessAdd } = (() => {\n    const srcType = values.source.value[0] as JournalEntrySourceType;\n    const src = values.source.value[\n      values.source.value.length - 1\n    ] as SourceValue;\n\n    const iniSrcType = iniValues.source.value[0] as JournalEntrySourceType;\n    const iniSrc = iniValues.source.value[\n      iniValues.source.value.length - 1\n    ] as Exclude<SourceValue, string>;\n\n    if (typeof src === \"string\") {\n      if (srcType === JournalEntrySourceType.Person) {\n        const parsedName = parseName(src);\n\n        return {\n          source: {\n            sourceType: JournalEntrySourceType.Person,\n            id: \"\",\n          },\n          businessAdd: null,\n          personAdd: {\n            name: {\n              first: parsedName.firstName,\n              last: parsedName.lastName,\n            },\n          },\n        };\n      } else {\n        return {\n          source: {\n            sourceType: JournalEntrySourceType.Business,\n            id: \"\",\n          },\n          businessAdd: {\n            name: src,\n          },\n          personAdd: null,\n        };\n      }\n    } else if (srcType === iniSrcType && src.id === iniSrc.id) {\n      // No Updates\n      return {\n        source: null,\n        businessAdd: null,\n        personAdd: null,\n      };\n    }\n\n    return {\n      source: {\n        sourceType: (() => {\n          switch (src.__typename) {\n            case \"Business\":\n              return JournalEntrySourceType.Business;\n            case \"Department\":\n              return JournalEntrySourceType.Department;\n            case \"Person\":\n              return JournalEntrySourceType.Person;\n          }\n        })(),\n        id: src.id,\n      },\n      personAdd: null,\n      businessAdd: null,\n    };\n  })();\n\n  const variables: O.Required<\n    UpdateEntryVars,\n    keyof UpdateEntryVars,\n    \"deep\"\n  > = {\n    id,\n    fields: {\n      category,\n      date,\n      department,\n      description,\n      total,\n      type,\n      source,\n      reconciled,\n      paymentMethod,\n    },\n    paymentMethodAdd,\n    paymentMethodUpdate,\n    personAdd,\n    businessAdd,\n  };\n\n  console.log(variables);\n\n  await client.mutate<UpdateEntry, UpdateEntryVars>({\n    mutation: UPDATE_ENTRY,\n    variables,\n  });\n};\n\nexport default submitUpdate;\n","import React, { useMemo, useCallback } from \"react\";\nimport gql from \"graphql-tag\";\nimport { Formik, FormikConfig, FormikProps, useFormikContext } from \"formik\";\nimport { useQuery, useApolloClient } from \"@apollo/react-hooks\";\nimport {\n  Dialog,\n  DialogTitle,\n  Box,\n  DialogContent,\n  DialogContentText,\n  PaperProps,\n  Grid,\n  DialogActions,\n  Button,\n  useTheme,\n  GridProps,\n} from \"@material-ui/core\";\nimport { Add as AddIcon, Cancel as CancelIcon } from \"@material-ui/icons\";\nimport Fraction from \"fraction.js\";\n\nimport {\n  UpdateEntryIniStateQuery as UpdateEntryIniState,\n  UpdateEntryIniStateQueryVariables as UpdateEntryIniStateVars,\n  JournalEntrySourceType,\n  SrcEntryDeptOptFragment,\n  SrcEntryBizOptFragment,\n} from \"../../../../apollo/graphTypes\";\nimport {\n  FormikStatus,\n  FormikStatusType,\n  useFormikStatus,\n} from \"../../../../formik/utils\";\nimport submitUpdate, { UpdateValues, IniUpdateValues } from \"./submitUpdate\";\nimport {\n  PAY_METHOD_ENTRY_OPT_FRAGMENT,\n  DEPT_ENTRY_OPT_FRAGMENT,\n  CAT_ENTRY_OPT_FRAGMENT,\n  SRC_ENTRY_PERSON_OPT_FRAGMENT,\n  SRC_ENTRY_BIZ_OPT_FRAGMENT,\n  SRC_ENTRY_DEPT_OPT_FRAGMENT,\n} from \"../upsertEntry.gql\";\nimport { min } from \"date-fns/esm\";\n\nimport OverlayLoading from \"../../../utils/OverlayLoading\";\nimport Overlay from \"../../../utils/Overlay\";\nimport DateEntry from \"../EntryFields/DateEntry\";\nimport Description from \"../EntryFields/Description\";\nimport Total from \"../EntryFields/Total\";\nimport Reconcile from \"../EntryFields/Reconcile\";\nimport PaymentMethod from \"../EntryFields/PaymentMethod\";\nimport Category from \"../EntryFields/Category\";\nimport Department from \"../EntryFields/Department\";\nimport Source from \"../EntryFields/Source\";\nimport Type from \"../EntryFields/Type\";\nimport { rationalToFraction } from \"../../../../utils/rational\";\n\nexport interface UpdateEntryProps {\n  entryId: string | null;\n  open: boolean;\n  onClose: () => void;\n  onExited: () => void;\n}\n\nconst UPDATE_ENTRY_INI_STATE = gql`\n  query UpdateEntryIniState($id: ID!) {\n    journalEntry(id: $id) {\n      id\n      __typename\n      type\n      date\n      department {\n        ...DeptEntryOptFragment\n      }\n      category {\n        ...CatEntryOptFragment\n        ancestors {\n          ...CatEntryOptFragment\n        }\n      }\n      source {\n        ...SrcEntryPersonOptFragment\n        ...SrcEntryBizOptFragment\n        ...SrcEntryDeptOptFragment\n        ... on Department {\n          ancestors {\n            ...SrcEntryDeptOptFragment\n            ...SrcEntryBizOptFragment\n          }\n        }\n      }\n      paymentMethod {\n        ...PayMethodEntryOptFragment\n        ancestors {\n          ...PayMethodEntryOptFragment\n        }\n      }\n      description\n      total {\n        n\n        d\n        s\n      }\n      refunds {\n        id\n        __typename\n        deleted\n        date\n        total {\n          n\n          d\n          s\n        }\n      }\n      reconciled\n    }\n  }\n  ${DEPT_ENTRY_OPT_FRAGMENT}\n  ${CAT_ENTRY_OPT_FRAGMENT}\n  ${SRC_ENTRY_PERSON_OPT_FRAGMENT}\n  ${SRC_ENTRY_BIZ_OPT_FRAGMENT}\n  ${SRC_ENTRY_DEPT_OPT_FRAGMENT}\n  ${PAY_METHOD_ENTRY_OPT_FRAGMENT}\n`;\n\nconst MAX_DATE = new Date(8640000000000000);\n\nconst gridEntryResponsiveProps: GridProps = {\n  item: true,\n  lg: 4,\n  sm: 6,\n  xs: 12,\n} as const;\n\nconst UpdateEntryDialog = (\n  props: Omit<UpdateEntryProps, \"entryId\"> & {\n    journalEntry: NonNullable<UpdateEntryIniState[\"journalEntry\"]> | null;\n    loading: boolean;\n    handleSubmit: FormikProps<UpdateValues>[\"handleSubmit\"];\n  }\n) => {\n  const {\n    open,\n    onClose,\n    onExited: onExitedCb,\n    journalEntry,\n    loading,\n    handleSubmit,\n  } = props;\n\n  const { resetForm, isSubmitting, isValid } = useFormikContext<UpdateValues>();\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const refunds = journalEntry?.refunds || [];\n\n  // Updates to total cannot be less than current refunds.\n  const [minTotal, maxDate] = useMemo(\n    () =>\n      refunds.reduce(\n        ([minTotal, maxDate], { id, deleted, total, date }) => [\n          deleted ? minTotal : minTotal.add(rationalToFraction(total)),\n          deleted ? maxDate : min([maxDate, new Date(date)]),\n        ],\n        [new Fraction(0), MAX_DATE]\n      ),\n    [refunds]\n  );\n\n  const onExited = useCallback(() => {\n    onExitedCb();\n    resetForm();\n    setFormikStatus(null);\n  }, [resetForm, onExitedCb, setFormikStatus]);\n\n  const [generalError, fatalError] = useMemo<\n    [string | null, boolean | null]\n  >(() => {\n    if (\n      formikStatus &&\n      (formikStatus.type === FormikStatusType.FATAL_ERROR ||\n        formikStatus.type === FormikStatusType.ERROR)\n    ) {\n      return [\n        formikStatus.msg,\n        formikStatus.type === FormikStatusType.FATAL_ERROR,\n      ];\n    }\n    return [null, null];\n  }, [formikStatus]);\n\n  const title = useMemo(() => {\n    const title = \"Entry Update\";\n\n    if (fatalError) {\n      return \"Fatal Error\";\n    } else if (loading) {\n      return `Loading ${title}...`;\n    } else if (isSubmitting) {\n      return `Submitting ${title}`;\n    }\n    return title;\n  }, [loading, fatalError, isSubmitting]);\n\n  const theme = useTheme();\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      onExited={onExited}\n      fullWidth\n      disableBackdropClick={isSubmitting}\n      disableEscapeKeyDown={isSubmitting}\n      maxWidth=\"lg\"\n      PaperProps={\n        {\n          component: \"form\",\n          onSubmit: handleSubmit,\n        } as PaperProps & {\n          onSubmit: FormikProps<UpdateValues>[\"handleSubmit\"];\n        }\n      }\n    >\n      <DialogTitle\n        style={generalError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {(isSubmitting || loading) && !generalError && (\n          <OverlayLoading zIndex=\"modal\" />\n        )}\n        {!!generalError && fatalError && (\n          <Overlay opacity={0.78} zIndex=\"modal\" padding={2}>\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          </Overlay>\n        )}\n        <DialogContent dividers>\n          {!!generalError && !fatalError && (\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          )}\n          <Grid container spacing={2}>\n            <Grid {...gridEntryResponsiveProps} justify=\"center\" container>\n              <Type\n                style={{ margin: theme.spacing(1) }}\n                label=\"start\"\n                disabled={isSubmitting || loading || !!fatalError}\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <DateEntry\n                disabled={isSubmitting || loading || !!fatalError}\n                maxDate={maxDate === MAX_DATE ? undefined : maxDate}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Source\n                disabled={isSubmitting || loading || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Category\n                disabled={isSubmitting || loading || !!fatalError}\n                fullWidth\n                required\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Department\n                disabled={isSubmitting || loading || !!fatalError}\n                fullWidth\n                required\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Description\n                disabled={isSubmitting || loading || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <PaymentMethod\n                disabled={isSubmitting || loading || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Total\n                disabled={isSubmitting || loading || !!fatalError}\n                minTotal={minTotal}\n                fullWidth\n              />\n            </Grid>\n            <Grid\n              container\n              justify=\"center\"\n              alignItems=\"flex-start\"\n              {...gridEntryResponsiveProps}\n            >\n              <Reconcile\n                disabled={isSubmitting || loading || !!fatalError}\n                label\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!fatalError && (\n          <Button\n            disabled={isSubmitting || !isValid || loading}\n            type=\"submit\"\n            startIcon={<AddIcon />}\n            color=\"primary\"\n            variant=\"contained\"\n          >\n            Update\n          </Button>\n        )}\n        <Button\n          disabled={isSubmitting}\n          color={fatalError ? \"primary\" : \"default\"}\n          startIcon={!fatalError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {fatalError ? \"Ok\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst UpdateEntry = (props: UpdateEntryProps) => {\n  const { entryId, open, onClose, onExited } = props;\n\n  const { loading, error, data } = useQuery<\n    UpdateEntryIniState,\n    UpdateEntryIniStateVars\n  >(UPDATE_ENTRY_INI_STATE, {\n    skip: !entryId,\n    variables: {\n      id: entryId as string,\n    },\n  });\n\n  if (error) {\n    console.log(entryId, UPDATE_ENTRY_INI_STATE);\n    console.error(error);\n  }\n\n  const initialStatus = useMemo(\n    () =>\n      error\n        ? ({\n            msg: error.message,\n            type: FormikStatusType.FATAL_ERROR,\n          } as FormikStatus)\n        : null,\n    [error]\n  );\n\n  const journalEntry = data?.journalEntry;\n  const initialValues = useMemo<IniUpdateValues>(() => {\n    if (!journalEntry) {\n      return {} as any;\n    }\n\n    const date = {\n      inputValue: new Date(journalEntry.date),\n      value: journalEntry.date,\n    };\n\n    const category = (() => {\n      const { ancestors, ...category } = journalEntry.category;\n\n      // Array.prototype.sort mutates the array, create copy.\n      const value = [...ancestors].sort((a, b) => {\n        // a is the parent of b\n        if (a.id === b.parent?.id) {\n          return -1;\n          // b is the parent of a\n        } else if (b.id === a.parent?.id) {\n          return 1;\n        }\n        return 0;\n      });\n\n      value.push(category);\n\n      return {\n        inputValue: \"\",\n        value,\n      };\n    })();\n\n    const paymentMethod = (() => {\n      const { ancestors, ...paymentMethod } = journalEntry.paymentMethod;\n\n      // Array.prototype.sort mutates the array, create copy.\n      const value = [...ancestors].sort((a, b) => {\n        // a is the parent of b\n        if (a.id === b.parent?.id) {\n          return -1;\n          // b is the parent of a\n        } else if (b.id === a.parent?.id) {\n          return 1;\n        }\n        return 0;\n      });\n\n      value.push(paymentMethod);\n\n      return {\n        inputValue: \"\",\n        value,\n      };\n    })();\n\n    const total = {\n      inputValue: rationalToFraction(journalEntry.total).round(2).toString(),\n      value: journalEntry.total,\n    };\n\n    const department = journalEntry.department;\n\n    const reconciled = journalEntry.reconciled;\n\n    const description = journalEntry.description ?? null;\n\n    const type = journalEntry.type;\n\n    const source = (() => {\n      const value: IniUpdateValues[\"source\"][\"value\"] = [];\n\n      const src = journalEntry?.source;\n\n      switch (src?.__typename) {\n        case \"Person\":\n          value.push(JournalEntrySourceType.Person, src);\n          break;\n        case \"Business\":\n          value.push(JournalEntrySourceType.Business, src);\n          break;\n        case \"Department\":\n          // The source type is the root, for Dept is always a business.\n          value.push(JournalEntrySourceType.Business);\n          const ancestorDeptQueue: string[] = [];\n          for (const ancestor of src.ancestors) {\n            if (ancestor.__typename === \"Business\") {\n              value.push(ancestor);\n            } else {\n              ancestorDeptQueue.push(ancestor.id);\n            }\n          }\n\n          const bizAncestor = value[1] as SrcEntryBizOptFragment;\n\n          if (ancestorDeptQueue.length > 0) {\n            const ancestorDepts: SrcEntryDeptOptFragment[] = [];\n            for (const dept of bizAncestor.departments) {\n              const index = ancestorDeptQueue.indexOf(dept.id);\n\n              if (index === -1) {\n                continue;\n              }\n\n              // Be lazy about finding depts\n              if (ancestorDepts.push(dept) === ancestorDeptQueue.length) {\n                break;\n              }\n            }\n\n            // Ensure order\n            ancestorDepts.sort((a, b) => {\n              if (a.id === b.parent.id || bizAncestor.id || a.parent.id) {\n                return -1;\n              } else if (b.id === a.parent.id) {\n                return 1;\n              } else {\n                return 0;\n              }\n            });\n\n            value.push(...ancestorDepts, src);\n          }\n      }\n\n      return {\n        inputValue: \"\",\n        value,\n      };\n    })();\n\n    const iniUpdateValues: IniUpdateValues = {\n      date,\n      category,\n      paymentMethod,\n      department,\n      total,\n      reconciled,\n      description,\n      type,\n      source,\n    };\n\n    return iniUpdateValues;\n  }, [journalEntry]);\n\n  const client = useApolloClient();\n  const onSubmit = useCallback<FormikConfig<UpdateValues>[\"onSubmit\"]>(\n    async (values, formikHelpers) => {\n      try {\n        formikHelpers.setStatus(null);\n        await submitUpdate(\n          client,\n          initialValues,\n          entryId as string,\n          values,\n          formikHelpers\n        );\n        onClose();\n      } catch (error) {\n        console.error(error);\n        formikHelpers.setStatus({\n          msg: error.message ?? `${error}`,\n          type: FormikStatusType.ERROR,\n        } as FormikStatus);\n      }\n    },\n    [client, initialValues, entryId, onClose]\n  );\n\n  const children = useCallback(\n    (props: FormikProps<UpdateValues>) => (\n      <UpdateEntryDialog\n        open={open}\n        onClose={onClose}\n        onExited={onExited}\n        loading={loading}\n        journalEntry={journalEntry ?? null}\n        handleSubmit={props.handleSubmit}\n      />\n    ),\n    [open, onClose, onExited, loading, journalEntry]\n  );\n\n  return (\n    <Formik\n      initialValues={initialValues as UpdateValues}\n      initialStatus={initialStatus}\n      journalEntry={data?.journalEntry ?? null}\n      loading={loading}\n      onSubmit={onSubmit}\n      enableReinitialize={true}\n      children={children}\n    />\n  );\n};\n\nexport default UpdateEntry;\n","import React, { useCallback, useMemo } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  Button,\n  Box,\n  useTheme,\n} from \"@material-ui/core\";\nimport { Delete as DeleteIcon, Cancel as CancelIcon } from \"@material-ui/icons\";\nimport gql from \"graphql-tag\";\nimport { useMutation } from \"@apollo/react-hooks\";\n\nimport { JOURNAL_ENTRY_FRAGMENT } from \"../../Table/JournalEntries.gql\";\nimport {\n  DeleteEntryMutation,\n  DeleteEntryMutationVariables as DeleteEntryVars,\n} from \"../../../../apollo/graphTypes\";\nimport OverlayLoading from \"../../../utils/OverlayLoading\";\n\nconst DELETE_ENTRY = gql`\n  mutation DeleteEntry($id: ID!) {\n    journalEntryDelete(id: $id) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst DeleteEntry = (props: {\n  entryId: string | null;\n  onClose: () => void;\n}) => {\n  const { entryId, onClose } = props;\n\n  const [deleteEntry, { loading, error }] = useMutation<\n    DeleteEntryMutation,\n    DeleteEntryVars\n  >(DELETE_ENTRY);\n\n  const hasError = !!error;\n\n  const onDelete = useCallback(\n    (event) => {\n      deleteEntry({ variables: { id: entryId as string } }).then(() =>\n        onClose()\n      );\n    },\n    [entryId, deleteEntry, onClose]\n  );\n\n  const title = useMemo(() => {\n    if (hasError) {\n      return \"Error\";\n    } else if (loading) {\n      return \"Deleting Entry...\";\n    }\n    return \"Delete Entry\";\n  }, [hasError, loading]);\n\n  const theme = useTheme();\n\n  return (\n    <Dialog\n      open={!!entryId}\n      maxWidth=\"sm\"\n      fullWidth\n      disableBackdropClick={loading}\n      disableEscapeKeyDown={loading}\n      onClose={onClose}\n    >\n      <DialogTitle\n        style={hasError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {loading && <OverlayLoading zIndex=\"modal\" />}\n        <DialogContent>\n          {hasError && (\n            <DialogContentText color=\"error\">\n              {error?.message as string}\n            </DialogContentText>\n          )}\n          {!hasError && (\n            <DialogContentText>\n              Are you sure you want to delete this entry?\n            </DialogContentText>\n          )}\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!hasError && (\n          <Button\n            disabled={loading}\n            onClick={onDelete}\n            startIcon={<DeleteIcon />}\n            color=\"primary\"\n            variant=\"contained\"\n          >\n            Delete\n          </Button>\n        )}\n        <Button\n          disabled={loading}\n          startIcon={!hasError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {hasError ? \"Close\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default DeleteEntry;\n","import React, { useCallback, useMemo } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  Button,\n  Box,\n  useTheme,\n} from \"@material-ui/core\";\nimport { Delete as DeleteIcon, Cancel as CancelIcon } from \"@material-ui/icons\";\nimport gql from \"graphql-tag\";\nimport { useMutation } from \"@apollo/react-hooks\";\n\nimport { JOURNAL_ENTRY_FRAGMENT } from \"../../Table/JournalEntries.gql\";\nimport {\n  DeleteRefundMutation,\n  DeleteRefundMutationVariables as DeleteRefundVars,\n} from \"../../../../apollo/graphTypes\";\nimport OverlayLoading from \"../../../utils/OverlayLoading\";\n\nconst DELETE_REFUND = gql`\n  mutation DeleteRefund($id: ID!) {\n    journalEntryDeleteRefund(id: $id) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst DeleteRefund = (props: {\n  refundId: string | null;\n  onClose: () => void;\n}) => {\n  const { refundId, onClose } = props;\n\n  const [deleteRefund, { loading, error }] = useMutation<\n    DeleteRefundMutation,\n    DeleteRefundVars\n  >(DELETE_REFUND);\n  const hasError = !!error;\n\n  const onDelete = useCallback(\n    (event) => {\n      deleteRefund({ variables: { id: refundId as string } }).then(() =>\n        onClose()\n      );\n    },\n    [refundId, deleteRefund, onClose]\n  );\n\n  const title = useMemo(() => {\n    if (hasError) {\n      return \"Error\";\n    } else if (loading) {\n      return \"Deleting Refund...\";\n    }\n    return \"Delete Refund\";\n  }, [hasError, loading]);\n\n  const theme = useTheme();\n\n  return (\n    <Dialog\n      open={!!refundId}\n      maxWidth=\"sm\"\n      fullWidth\n      disableBackdropClick={loading}\n      disableEscapeKeyDown={loading}\n      onClose={onClose}\n    >\n      <DialogTitle\n        style={hasError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {loading && <OverlayLoading zIndex=\"modal\" />}\n        <DialogContent>\n          {hasError && (\n            <DialogContentText color=\"error\">\n              {error?.message as string}\n            </DialogContentText>\n          )}\n          {!hasError && (\n            <DialogContentText>\n              Are you sure you want to delete this refund?\n            </DialogContentText>\n          )}\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!hasError && (\n          <Button\n            disabled={loading}\n            onClick={onDelete}\n            startIcon={<DeleteIcon />}\n            color=\"primary\"\n            variant=\"contained\"\n          >\n            Delete\n          </Button>\n        )}\n        <Button\n          disabled={loading}\n          startIcon={!hasError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {hasError ? \"Close\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default DeleteRefund;\n","import { O } from \"ts-toolbelt\";\nimport { FormikConfig } from \"formik\";\nimport gql from \"graphql-tag\";\nimport ApolloClient from \"apollo-client\";\n\nimport {\n  JournalEntryAddItemFields,\n  DeptEntryOptFragment,\n  CatEntryOptFragment,\n  AddEntryItemMutation as AddItem,\n  AddEntryItemMutationVariables as AddItemVars,\n} from \"../../../../apollo/graphTypes\";\nimport { TransmutationValue } from \"../../../../formik/utils\";\nimport { JOURNAL_ENTRY_FRAGMENT } from \"../../Table/JournalEntries.gql\";\n\nexport type AddValues = O.Overwrite<\n  O.Required<\n    JournalEntryAddItemFields,\n    keyof JournalEntryAddItemFields,\n    \"deep\"\n  >,\n  {\n    total: TransmutationValue<string, JournalEntryAddItemFields[\"total\"]>;\n    units: number;\n    category: TransmutationValue<string, CatEntryOptFragment[]> | null;\n    department: DeptEntryOptFragment | null;\n  }\n>;\n\nconst ADD_ENTRY_ITEM = gql`\n  mutation AddEntryItem($id: ID!, $fields: JournalEntryAddItemFields!) {\n    journalEntryAddItem(id: $id, fields: $fields) {\n      journalEntry {\n        ...JournalEntry_1Fragment\n      }\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst submitAdd: (\n  client: ApolloClient<any>,\n  id: string,\n  ...rest: Parameters<FormikConfig<AddValues>[\"onSubmit\"]>\n) => ReturnType<FormikConfig<AddValues>[\"onSubmit\"]> = async (\n  client,\n  id,\n  values\n) => {\n  const category = (() => {\n    const value = values.category?.value || [];\n\n    return value[value.length - 1]?.id ?? null;\n  })();\n\n  const department = (() => {\n    return values.department?.id || null;\n  })();\n\n  const units = values.units;\n\n  const variables: O.Required<AddItemVars, keyof AddItemVars, \"deep\"> = {\n    id,\n    fields: {\n      units,\n      category,\n      department,\n      description: values.description?.trim() || null,\n      total: values.total.value,\n    },\n  };\n\n  await client.mutate<AddItem, AddItemVars>({\n    mutation: ADD_ENTRY_ITEM,\n    variables,\n  });\n};\n\nexport default submitAdd;\n","import React, { useCallback, useMemo } from \"react\";\nimport { TextField, TextFieldProps } from \"@material-ui/core\";\nimport { useField, FieldInputProps } from \"formik\";\n\nimport { useFormikStatus, FormikStatusType } from \"../../../../../formik/utils\";\n\nconst inputProps = {\n  min: \"1\",\n  step: \"1\",\n  type: \"number\",\n} as const;\n\nconst NULLISH = Symbol();\n\nconst Units = (\n  props: {\n    variant?: \"filled\" | \"outlined\";\n  } & Omit<\n    TextFieldProps,\n    | \"variant\"\n    | \"type\"\n    | \"value\"\n    | \"error\"\n    | \"helperText\"\n    | \"placeholder\"\n    | \"label\"\n    | \"name\"\n    | \"required\"\n    | \"variant\"\n    | \"inputProps\"\n    | \"InputProps\"\n    | \"onChange\"\n    | keyof FieldInputProps<any>\n  >\n) => {\n  const {\n    autoFocus = false,\n    disabled = false,\n    variant = \"filled\",\n    ...textFieldProps\n  } = props;\n\n  const validate = useCallback((value: number | string | undefined | null) => {\n    value = value || null;\n\n    if ((value ?? NULLISH) === NULLISH) {\n      return \"Units Required\";\n    } else if (value === 0) {\n      return \"Cannot be 0\";\n    } else if ((value as number) < 0) {\n      return \"Units must be 1 or greater\";\n    }\n  }, []);\n\n  const [field, meta, { setValue }] = useField<number | undefined>({\n    name: \"units\",\n    validate,\n  });\n\n  const value = field.value ?? \"\";\n\n  const { error, touched } = meta;\n\n  const [formikStatus] = useFormikStatus();\n\n  const InputProps = useMemo(\n    () => ({\n      type: \"number\",\n      autoFocus,\n    }),\n    [autoFocus]\n  );\n\n  const onChange = useCallback<NonNullable<TextFieldProps[\"onChange\"]>>(\n    (event) => {\n      const value = event?.target?.value || 0;\n      setValue(\n        Math.max(typeof value === \"number\" ? value : Number.parseInt(value), 0)\n      );\n    },\n    [setValue]\n  );\n\n  return (\n    <TextField\n      {...textFieldProps}\n      {...field}\n      disabled={disabled || formikStatus?.type === FormikStatusType.FATAL_ERROR}\n      type=\"number\"\n      value={value}\n      error={touched && !!error}\n      helperText={touched && error ? error : undefined}\n      placeholder={\"1\"}\n      label={\"Units\"}\n      name={\"units\"}\n      required\n      variant={variant as any}\n      inputProps={inputProps}\n      InputProps={InputProps}\n      onChange={onChange}\n    />\n  );\n};\n\nexport default Units;\n","import gql from \"graphql-tag\";\n\nexport const JOURNAL_FRAGMENT = gql`\n  fragment JournalEntry_3Fragment on JournalEntry {\n    __typename\n    id\n    type\n    total {\n      n\n      d\n      s\n    }\n    items {\n      id\n      __typename\n      deleted\n      total {\n        n\n        d\n        s\n      }\n    }\n  }\n`;\n","import React, { useCallback, useMemo } from \"react\";\nimport { Formik, FormikConfig, useFormikContext, FormikProps } from \"formik\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  PaperProps,\n  Grid,\n  DialogContentText,\n  useTheme,\n  Box,\n  GridProps,\n} from \"@material-ui/core\";\nimport {\n  useApolloClient,\n  useQuery,\n  QueryHookOptions,\n} from \"@apollo/react-hooks\";\nimport {\n  Add as AddIcon,\n  Cancel as CancelIcon,\n  Queue as QueueIcon,\n} from \"@material-ui/icons\";\nimport gql from \"graphql-tag\";\nimport Fraction from \"fraction.js\";\n\nimport submitAdd, { AddValues } from \"./submitAdd\";\nimport {\n  GetEntryItemState_1Query as GetEntryItemState,\n  GetEntryItemState_1QueryVariables as GetEntryItemStateVars,\n} from \"../../../../apollo/graphTypes\";\nimport Description from \"../EntryFields/Description\";\nimport Total from \"../EntryFields/Total\";\nimport Category from \"../EntryFields/Category\";\nimport Department from \"../EntryFields/Department\";\nimport Units from \"./ItemFields/Units\";\nimport {\n  FormikStatusType,\n  useFormikStatus,\n  FormikStatus,\n} from \"../../../../formik/utils\";\nimport OverlayLoading from \"../../../utils/OverlayLoading\";\nimport Overlay from \"../../../utils/Overlay\";\nimport { JOURNAL_FRAGMENT } from \"./items.gql\";\nimport { rationalToFraction } from \"../../../../utils/rational\";\n\nconst ENTRY_ITEM_STATE = gql`\n  query GetEntryItemState_1($id: ID!) {\n    journalEntry(id: $id) {\n      ...JournalEntry_3Fragment\n    }\n  }\n  ${JOURNAL_FRAGMENT}\n`;\n\nexport interface AddItemProps {\n  entryId: string | null;\n  open: boolean;\n  onClose: () => void;\n  onExited: () => void;\n}\n\nconst gridEntryResponsiveProps: GridProps = {\n  item: true,\n  lg: 4,\n  sm: 6,\n  xs: 12,\n} as const;\n\n// Must be in separate component to access FormikContext.\nconst AddItemDialog = (\n  props: AddItemProps & {\n    handleSubmit: FormikProps<AddValues>[\"handleSubmit\"];\n  }\n) => {\n  const { entryId, open, onClose, onExited: onExitedCb } = props;\n\n  const { resetForm, isSubmitting, isValid, submitForm } = useFormikContext<\n    AddValues\n  >();\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const onError = useCallback<\n    NonNullable<\n      QueryHookOptions<GetEntryItemState, GetEntryItemStateVars>[\"onError\"]\n    >\n  >(\n    (error) =>\n      setFormikStatus({\n        msg: error.message,\n        type: FormikStatusType.FATAL_ERROR,\n      }),\n    [setFormikStatus]\n  );\n\n  const { loading, data } = useQuery<GetEntryItemState, GetEntryItemStateVars>(\n    ENTRY_ITEM_STATE,\n    {\n      skip: !entryId,\n      variables: { id: entryId as string },\n      onError,\n    }\n  );\n\n  const type = data?.journalEntry?.type ?? null;\n\n  const total = data?.journalEntry?.total;\n  const items = data?.journalEntry?.items || [];\n  const maxTotal = useMemo(() => {\n    if (total) {\n      const totalItems = items.reduce((totalItems, { deleted, total }) => {\n        return deleted ? totalItems : totalItems.add(rationalToFraction(total));\n      }, new Fraction(0));\n      return rationalToFraction(total).sub(totalItems);\n    }\n    return new Fraction(Number.MAX_SAFE_INTEGER);\n  }, [total, items]);\n\n  const onExited = useCallback(() => {\n    onExitedCb();\n    resetForm();\n    setFormikStatus(null);\n  }, [resetForm, onExitedCb, setFormikStatus]);\n\n  const [generalError, fatalError] = useMemo<\n    [string | null, boolean | null]\n  >(() => {\n    if (\n      formikStatus &&\n      (formikStatus.type === FormikStatusType.FATAL_ERROR ||\n        formikStatus.type === FormikStatusType.ERROR)\n    ) {\n      return [\n        formikStatus.msg,\n        formikStatus.type === FormikStatusType.FATAL_ERROR,\n      ];\n    }\n    return [null, null];\n  }, [formikStatus]);\n\n  const title = useMemo(() => {\n    const title = \"Add Item\";\n\n    if (fatalError) {\n      return \"Fatal Error\";\n    } else if (loading) {\n      return `Loading ${title}...`;\n    } else if (isSubmitting) {\n      return `Submitting ${title}`;\n    }\n    return title;\n  }, [loading, fatalError, isSubmitting]);\n\n  const theme = useTheme();\n\n  const onClickAdd = useCallback(async () => {\n    try {\n      setFormikStatus(null);\n      await submitForm();\n      onClose();\n    } catch (error) {\n      setFormikStatus({\n        msg: error.message ?? `${error}`,\n        type: FormikStatusType.ERROR,\n      } as FormikStatus);\n    }\n  }, [submitForm, onClose, setFormikStatus]);\n\n  const onClickAddAndNew = useCallback(async () => {\n    try {\n      setFormikStatus(null);\n      await submitForm();\n      resetForm();\n    } catch (error) {\n      setFormikStatus({\n        msg: error.message ?? `${error}`,\n        type: FormikStatusType.ERROR,\n      } as FormikStatus);\n    }\n  }, [submitForm, resetForm, setFormikStatus]);\n\n  const handleSubmit = useCallback(\n    (event: React.FormEvent<HTMLFormElement>) => event.preventDefault(),\n    []\n  );\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      onExited={onExited}\n      disableBackdropClick={isSubmitting}\n      disableEscapeKeyDown={isSubmitting}\n      fullWidth\n      maxWidth=\"lg\"\n      PaperProps={\n        {\n          component: \"form\",\n          onSubmit: handleSubmit,\n        } as PaperProps & { onSubmit: FormikProps<AddValues>[\"handleSubmit\"] }\n      }\n    >\n      <DialogTitle\n        style={generalError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {(loading || isSubmitting) && !generalError && (\n          <OverlayLoading zIndex=\"modal\" />\n        )}\n        {!!generalError && fatalError && (\n          <Overlay opacity={0.78} zIndex=\"modal\" padding={2}>\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          </Overlay>\n        )}\n        <DialogContent dividers>\n          {!!generalError && !fatalError && (\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          )}\n          <Grid container spacing={2}>\n            <Grid {...gridEntryResponsiveProps}>\n              <Total\n                disabled={loading || isSubmitting}\n                fullWidth\n                maxTotal={maxTotal}\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Units disabled={loading || isSubmitting} fullWidth />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Description disabled={loading || isSubmitting} fullWidth />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Category\n                disabled={loading || isSubmitting || !!fatalError}\n                entryType={type}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Department\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!fatalError && (\n          <React.Fragment>\n            <Button\n              onClick={onClickAdd}\n              disabled={loading || isSubmitting || !isValid}\n              type=\"submit\"\n              startIcon={<AddIcon />}\n              color=\"primary\"\n              variant=\"contained\"\n            >\n              Add\n            </Button>\n            <Button\n              onClick={onClickAddAndNew}\n              disabled={loading || isSubmitting || !isValid}\n              type=\"submit\"\n              startIcon={<QueueIcon />}\n              variant=\"outlined\"\n            >\n              Add & New\n            </Button>\n          </React.Fragment>\n        )}\n        <Button\n          disabled={loading || isSubmitting}\n          color={fatalError ? \"primary\" : \"default\"}\n          startIcon={!fatalError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {fatalError ? \"Ok\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst AddItem = (props: AddItemProps) => {\n  const { entryId, open, onClose, onExited } = props;\n\n  const initialValues = useMemo<Partial<AddValues>>(() => ({}), []);\n\n  const client = useApolloClient();\n  const onSubmit = useCallback<FormikConfig<AddValues>[\"onSubmit\"]>(\n    (values, formikHelpers) =>\n      submitAdd(client, entryId || \"\", values, formikHelpers),\n    [client, entryId]\n  );\n\n  const children = useCallback(\n    (props: FormikProps<AddValues>) => (\n      <AddItemDialog\n        entryId={entryId}\n        open={open}\n        onClose={onClose}\n        onExited={onExited}\n        handleSubmit={props.handleSubmit}\n      />\n    ),\n    [entryId, open, onClose, onExited]\n  );\n\n  return (\n    <Formik\n      initialValues={initialValues as AddValues}\n      initialStatus={null}\n      enableReinitialize={true}\n      onSubmit={onSubmit}\n      children={children}\n    />\n  );\n};\n\nexport default AddItem;\n","import { O } from \"ts-toolbelt\";\nimport { FormikConfig } from \"formik\";\nimport gql from \"graphql-tag\";\nimport ApolloClient from \"apollo-client\";\n\nimport {\n  JournalEntryUpdateItemFields,\n  DeptEntryOptFragment,\n  CatEntryOptFragment,\n  UpdateEntryItemMutation as UpdateItem,\n  UpdateEntryItemMutationVariables as UpdateItemVars,\n} from \"../../../../apollo/graphTypes\";\nimport { TransmutationValue } from \"../../../../formik/utils\";\nimport { JOURNAL_ENTRY_ITEM } from \"../../Table/JournalEntries.gql\";\nimport { rationalToFraction } from \"../../../../utils/rational\";\n\nexport type UpdateValues = O.NonNullable<\n  O.Overwrite<\n    O.Required<JournalEntryUpdateItemFields>,\n    {\n      total: TransmutationValue<\n        string,\n        NonNullable<JournalEntryUpdateItemFields[\"total\"]>\n      >;\n      category: TransmutationValue<string, CatEntryOptFragment[]>;\n      department: DeptEntryOptFragment | null;\n    }\n  >,\n  keyof Pick<JournalEntryUpdateItemFields, \"total\">,\n  \"deep\"\n>;\n\nconst UPDATE_ITEM = gql`\n  mutation UpdateEntryItem($id: ID!, $fields: JournalEntryUpdateItemFields!) {\n    journalEntryUpdateItem(id: $id, fields: $fields) {\n      journalEntryItem {\n        ...JournalEntryItem_1Fragment\n      }\n    }\n  }\n  ${JOURNAL_ENTRY_ITEM}\n`;\n\nconst submitUpdate: (\n  client: ApolloClient<any>,\n  iniValues: UpdateValues,\n  id: string,\n  ...rest: Parameters<FormikConfig<UpdateValues>[\"onSubmit\"]>\n) => ReturnType<FormikConfig<UpdateValues>[\"onSubmit\"]> = async (\n  client,\n  iniValues,\n  id,\n  values\n) => {\n  // Description\n  const description =\n    values.description !== iniValues.description\n      ? values.description?.trim() || null\n      : null;\n\n  // Department\n  const department =\n    values.department?.id === iniValues.department?.id\n      ? null\n      : values.department?.id ?? null;\n\n  // Category\n  const category = (() => {\n    const category =\n      values.category.value[values.category.value.length - 1]?.id ?? null;\n\n    return category ===\n      (iniValues.category.value[iniValues.category.value.length - 1]?.id ??\n        null)\n      ? null\n      : category;\n  })();\n\n  // Units\n  const units = values.units === iniValues.units ? null : values.units;\n\n  // Total\n  const total =\n    rationalToFraction(values.total.value).compare(\n      rationalToFraction(iniValues.total.value)\n    ) === 0\n      ? null\n      : values.total.value;\n\n  const variables: O.Required<UpdateItemVars, keyof UpdateItemVars, \"deep\"> = {\n    id,\n    fields: {\n      units,\n      description,\n      department,\n      category,\n      total,\n    },\n  };\n\n  await client.mutate<UpdateItem, UpdateItemVars>({\n    mutation: UPDATE_ITEM,\n    variables,\n  });\n};\n\nexport default submitUpdate;\n","import React, { useMemo, useCallback } from \"react\";\nimport { useQuery, useApolloClient } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\nimport { Formik, FormikConfig, FormikProps, useFormikContext } from \"formik\";\nimport {\n  useTheme,\n  Dialog,\n  DialogTitle,\n  PaperProps,\n  Box,\n  DialogContent,\n  DialogContentText,\n  Grid,\n  DialogActions,\n  Button,\n  GridProps,\n} from \"@material-ui/core\";\nimport { Add as AddIcon, Cancel as CancelIcon } from \"@material-ui/icons\";\nimport Fraction from \"fraction.js\";\n\nimport {\n  UpdateItemIniStateQuery as UpdateItemIniState,\n  UpdateItemIniStateQueryVariables as UpdateItemIniStateVars,\n  JournalEntry_3Fragment as JournalEntryFragment,\n} from \"../../../../apollo/graphTypes\";\nimport submitUpdate, { UpdateValues } from \"./submitUpdate\";\nimport { JOURNAL_FRAGMENT } from \"./items.gql\";\nimport {\n  DEPT_ENTRY_OPT_FRAGMENT,\n  CAT_ENTRY_OPT_FRAGMENT,\n} from \"../upsertEntry.gql\";\nimport {\n  FormikStatus,\n  FormikStatusType,\n  useFormikStatus,\n} from \"../../../../formik/utils\";\nimport OverlayLoading from \"../../../utils/OverlayLoading\";\nimport Overlay from \"../../../utils/Overlay\";\nimport Description from \"../EntryFields/Description\";\nimport Department from \"../EntryFields/Department\";\nimport Total from \"../EntryFields/Total\";\nimport Category from \"../EntryFields/Category\";\nimport Units from \"./ItemFields/Units\";\nimport { rationalToFraction } from \"../../../../utils/rational\";\n\nexport interface UpdateItemProps {\n  entryId: string | null;\n  itemId: string | null;\n  open: boolean;\n  onClose: () => void;\n  onExited: () => void;\n}\n\nconst UPDATE_ITEM_INI_STATE = gql`\n  query UpdateItemIniState($entryId: ID!, $itemId: ID!) {\n    journalEntry(id: $entryId) {\n      ...JournalEntry_3Fragment\n    }\n    journalEntryItem(id: $itemId) {\n      __typename\n      id\n      department {\n        ...DeptEntryOptFragment\n      }\n      category {\n        ...CatEntryOptFragment\n        ancestors {\n          ...CatEntryOptFragment\n        }\n      }\n      description\n      units\n      total {\n        n\n        d\n        s\n      }\n    }\n  }\n  ${JOURNAL_FRAGMENT}\n  ${DEPT_ENTRY_OPT_FRAGMENT}\n  ${CAT_ENTRY_OPT_FRAGMENT}\n`;\n\nconst gridEntryResponsiveProps: GridProps = {\n  item: true,\n  lg: 4,\n  sm: 6,\n  xs: 12,\n} as const;\n\nconst UpdateItemDialog = (\n  props: UpdateItemProps & {\n    journalEntry: JournalEntryFragment | null;\n    loading: boolean;\n    handleSubmit: FormikProps<UpdateValues>[\"handleSubmit\"];\n  }\n) => {\n  const {\n    itemId,\n    open,\n    onClose,\n    onExited: onExitedCb,\n    journalEntry,\n    loading,\n    handleSubmit,\n  } = props;\n\n  const { resetForm, isSubmitting, isValid } = useFormikContext<UpdateValues>();\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const type = journalEntry?.type ?? null;\n\n  const total = journalEntry?.total;\n  const items = journalEntry?.items || [];\n  const maxTotal = useMemo(() => {\n    if (total) {\n      const totalItems = items.reduce(\n        (totalItems, { id, deleted, total }) =>\n          // Do NOT include item being updated in max total calculation\n          deleted || id === itemId\n            ? totalItems\n            : totalItems.add(rationalToFraction(total)),\n        new Fraction(0)\n      );\n      return rationalToFraction(total).sub(totalItems);\n    }\n    return new Fraction(Number.MAX_SAFE_INTEGER);\n  }, [total, items, itemId]);\n\n  const onExited = useCallback(() => {\n    onExitedCb();\n    resetForm();\n    setFormikStatus(null);\n  }, [resetForm, onExitedCb, setFormikStatus]);\n\n  const [generalError, fatalError] = useMemo<\n    [string | null, boolean | null]\n  >(() => {\n    if (\n      formikStatus &&\n      (formikStatus.type === FormikStatusType.FATAL_ERROR ||\n        formikStatus.type === FormikStatusType.ERROR)\n    ) {\n      return [\n        formikStatus.msg,\n        formikStatus.type === FormikStatusType.FATAL_ERROR,\n      ];\n    }\n    return [null, null];\n  }, [formikStatus]);\n\n  const title = useMemo(() => {\n    const title = \"Item Update\";\n\n    if (fatalError) {\n      return \"Fatal Error\";\n    } else if (loading) {\n      return `Loading ${title}...`;\n    } else if (isSubmitting) {\n      return `Submitting ${title}`;\n    }\n    return title;\n  }, [loading, fatalError, isSubmitting]);\n\n  const theme = useTheme();\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      onExited={onExited}\n      disableBackdropClick={isSubmitting}\n      disableEscapeKeyDown={isSubmitting}\n      fullWidth\n      maxWidth=\"lg\"\n      PaperProps={\n        {\n          component: \"form\",\n          onSubmit: handleSubmit,\n        } as PaperProps & {\n          onSubmit: FormikProps<UpdateValues>[\"handleSubmit\"];\n        }\n      }\n    >\n      <DialogTitle\n        style={generalError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {(loading || isSubmitting) && !generalError && (\n          <OverlayLoading zIndex=\"modal\" />\n        )}\n        {!!generalError && fatalError && (\n          <Overlay opacity={0.78} zIndex=\"modal\" padding={2}>\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          </Overlay>\n        )}\n        <DialogContent dividers>\n          {!!generalError && !fatalError && (\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          )}\n          <Grid container spacing={2}>\n            <Grid {...gridEntryResponsiveProps}>\n              <Total\n                disabled={loading || isSubmitting}\n                fullWidth\n                maxTotal={maxTotal}\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Units disabled={loading || isSubmitting} fullWidth />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Description disabled={loading || isSubmitting} fullWidth />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Category\n                disabled={loading || isSubmitting || !!fatalError}\n                entryType={type}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Department\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!fatalError && (\n          <Button\n            disabled={loading || isSubmitting || !isValid}\n            type=\"submit\"\n            startIcon={<AddIcon />}\n            color=\"primary\"\n            variant=\"contained\"\n          >\n            Update\n          </Button>\n        )}\n        <Button\n          disabled={loading || isSubmitting || !!fatalError}\n          color={fatalError ? \"primary\" : \"default\"}\n          startIcon={!fatalError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {fatalError ? \"Ok\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst UpdateItem = (props: UpdateItemProps) => {\n  const { entryId, itemId, open, onClose, onExited } = props;\n\n  const { loading, error, data } = useQuery<\n    UpdateItemIniState,\n    UpdateItemIniStateVars\n  >(UPDATE_ITEM_INI_STATE, {\n    skip: !entryId,\n    variables: {\n      entryId: entryId as string,\n      itemId: itemId as string,\n    },\n  });\n\n  const initialStatus = useMemo(\n    () =>\n      error\n        ? ({\n            msg: error.message,\n            type: FormikStatusType.FATAL_ERROR,\n          } as FormikStatus)\n        : null,\n    [error]\n  );\n\n  const journalEntryItem = data?.journalEntryItem;\n  const initialValues = useMemo<UpdateValues>(() => {\n    if (!journalEntryItem) {\n      return {} as any;\n    }\n\n    const total = {\n      inputValue: rationalToFraction(journalEntryItem.total)\n        .round(2)\n        .toString(),\n      value: journalEntryItem.total,\n    };\n\n    const category = (() => {\n      if (!journalEntryItem.category) {\n        return {\n          inputValue: \"\",\n          value: [],\n        };\n      }\n\n      const { ancestors, ...category } = journalEntryItem.category;\n\n      // Array.prototype.sort mutates the array, create copy.\n      const value = [...ancestors].sort((a, b) => {\n        // a is the parent of b\n        if (a.id === b.parent?.id) {\n          return -1;\n          // b is the parent of a\n        } else if (b.id === a.parent?.id) {\n          return 1;\n        }\n        return 0;\n      });\n\n      value.push(category);\n\n      return {\n        inputValue: \"\",\n        value,\n      };\n    })();\n\n    const department = journalEntryItem.department ?? null;\n\n    const description = journalEntryItem.description ?? null;\n\n    const units = journalEntryItem.units;\n\n    return {\n      total,\n      units,\n      category,\n      department,\n      description,\n    };\n  }, [journalEntryItem]);\n\n  const client = useApolloClient();\n  const onSubmit = useCallback<FormikConfig<UpdateValues>[\"onSubmit\"]>(\n    async (values, formikHelpers) => {\n      if (!initialValues) {\n        formikHelpers.setStatus({\n          msg: `Failed to load initial values for item \"${itemId}\".`,\n          type: FormikStatusType.FATAL_ERROR,\n        } as FormikStatus);\n        return;\n      } else if (!itemId) {\n        formikHelpers.setStatus({\n          msg: `No item ID.`,\n          type: FormikStatusType.FATAL_ERROR,\n        } as FormikStatus);\n        return;\n      }\n\n      try {\n        formikHelpers.setStatus(null);\n        await submitUpdate(\n          client,\n          initialValues,\n          itemId,\n          values,\n          formikHelpers\n        );\n        onClose();\n      } catch (error) {\n        formikHelpers.setStatus({\n          msg: error?.message ?? `${error}`,\n          type: FormikStatusType.FATAL_ERROR,\n        } as FormikStatus);\n      }\n    },\n    [client, initialValues, onClose, itemId]\n  );\n\n  const children = useCallback(\n    (props: FormikProps<UpdateValues>) => {\n      return (\n        <UpdateItemDialog\n          entryId={entryId}\n          itemId={itemId}\n          open={open}\n          onClose={onClose}\n          onExited={onExited}\n          journalEntry={data?.journalEntry ?? null}\n          loading={loading}\n          handleSubmit={props.handleSubmit}\n        />\n      );\n    },\n    [data, entryId, loading, onClose, onExited, open, itemId]\n  );\n\n  return (\n    <Formik\n      initialValues={(initialValues ?? {}) as UpdateValues}\n      initialStatus={initialStatus}\n      enableReinitialize={true}\n      onSubmit={onSubmit}\n      children={children}\n    />\n  );\n};\n\nexport default UpdateItem;\n","import React, { useCallback, useMemo } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  Button,\n  Box,\n  useTheme,\n} from \"@material-ui/core\";\nimport { Delete as DeleteIcon, Cancel as CancelIcon } from \"@material-ui/icons\";\nimport gql from \"graphql-tag\";\nimport { useMutation } from \"@apollo/react-hooks\";\n\nimport {\n  DeleteItemMutation,\n  DeleteItemMutationVariables as DeleteItemVars,\n} from \"../../../../apollo/graphTypes\";\nimport OverlayLoading from \"../../../utils/OverlayLoading\";\n\nconst DELETE_ITEM = gql`\n  mutation DeleteItem($id: ID!) {\n    journalEntryDeleteItem(id: $id) {\n      journalEntryItem {\n        id\n        __typename\n        deleted\n      }\n    }\n  }\n`;\n\nconst DeleteItem = (props: { itemId: string | null; onClose: () => void }) => {\n  const { itemId, onClose } = props;\n\n  const [deleteItem, { loading, error }] = useMutation<\n    DeleteItemMutation,\n    DeleteItemVars\n  >(DELETE_ITEM);\n  const hasError = !!error;\n\n  const onDelete = useCallback(\n    (event) => {\n      deleteItem({ variables: { id: itemId as string } }).then(() => onClose());\n    },\n    [itemId, deleteItem, onClose]\n  );\n\n  const title = useMemo(() => {\n    if (hasError) {\n      return \"Error\";\n    } else if (loading) {\n      return \"Deleting Item...\";\n    }\n    return \"Delete Item\";\n  }, [hasError, loading]);\n\n  const theme = useTheme();\n\n  return (\n    <Dialog\n      open={!!itemId}\n      maxWidth=\"sm\"\n      fullWidth\n      disableBackdropClick={loading}\n      disableEscapeKeyDown={loading}\n      onClose={onClose}\n    >\n      <DialogTitle\n        style={hasError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {loading && <OverlayLoading zIndex=\"modal\" />}\n        <DialogContent>\n          {hasError && (\n            <DialogContentText color=\"error\">\n              {error?.message as string}\n            </DialogContentText>\n          )}\n          {!hasError && (\n            <DialogContentText>\n              Are you sure you want to delete this item?\n            </DialogContentText>\n          )}\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!hasError && (\n          <Button\n            disabled={loading}\n            onClick={onDelete}\n            startIcon={<DeleteIcon />}\n            color=\"primary\"\n            variant=\"contained\"\n          >\n            Delete\n          </Button>\n        )}\n        <Button\n          disabled={loading}\n          startIcon={!hasError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {hasError ? \"Close\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default DeleteItem;\n","import React, { useMemo, useCallback, useState } from \"react\";\nimport {\n  Popover,\n  Box,\n  Select,\n  InputAdornment,\n  TextField,\n  SelectProps,\n  InputProps as InputPropsType,\n  TextFieldProps,\n  MenuItem,\n  Grid,\n  IconButton,\n  IconButtonProps,\n  Tooltip,\n} from \"@material-ui/core\";\nimport {\n  FilterList as FilterListIcon,\n  ArrowDropDown as ArrowDropDownIcon,\n  Clear as ClearIcon,\n} from \"@material-ui/icons\";\nimport {\n  Equal as EqualIcon,\n  GreaterThan as GreaterThanIcon,\n  LessThan as LessThanIcon,\n  GreaterThanOrEqual as GreaterThanOrEqualIcon,\n  LessThanOrEqual as LessThanOrEqualIcon,\n} from \"mdi-material-ui\";\nimport {\n  KeyboardDatePicker,\n  KeyboardDatePickerProps,\n  MuiPickersUtilsProvider,\n} from \"@material-ui/pickers\";\nimport DateFnsUtils from \"@date-io/date-fns\";\nimport {\n  format as dateFormat,\n  startOfDay,\n  addDays,\n  subDays,\n  isValid as isDateValid,\n} from \"date-fns\";\n\nenum Op {\n  None = 1,\n  Equal,\n  GreaterThan,\n  LessThan,\n  GreaterThanOrEqual,\n  LessThanOrEqual,\n}\n\nconst op2ValidOptions = (\n  date1: Date | null,\n  op1: Op\n): [Date | undefined, Date | undefined, Op[]] => {\n  if (!date1) {\n    return [undefined, undefined, [Op.None]];\n  }\n\n  switch (op1) {\n    case Op.None:\n    case Op.Equal:\n      return [undefined, undefined, [Op.None]];\n    case Op.GreaterThan:\n    case Op.GreaterThanOrEqual:\n      return [\n        addDays(date1, 1),\n        undefined,\n        [Op.None, Op.LessThan, Op.LessThanOrEqual],\n      ];\n    case Op.LessThan:\n    case Op.LessThanOrEqual:\n      return [\n        undefined,\n        subDays(date1, 1),\n        [Op.None, Op.GreaterThan, Op.GreaterThanOrEqual],\n      ];\n  }\n};\n\nconst MAX_DATE = new Date(8640000000000000);\nconst MIN_DATE = new Date(-8640000000000000);\n\nconst DateFilter = (props: { setFilter: (filter) => void }) => {\n  const { setFilter: setFilterCb } = props;\n\n  const [value, setValue] = useState(\"\");\n\n  const [op1, setOp1] = useState(Op.Equal);\n  const [date1, setDate1] = useState<Date | null>(null);\n\n  const [op2, setOp2] = useState(Op.None);\n  const [date2, setDate2] = useState<Date | null>(null);\n\n  const [minDate, maxDate, validOp2s] = useMemo(\n    () => op2ValidOptions(date1, op1),\n    [date1, op1]\n  );\n\n  const setFilter = useCallback(\n    (queries: { op: Op; date: Date }[]) => {\n      if (queries.length === 0) {\n        setValue(\"\");\n        setFilterCb({});\n        return;\n      }\n\n      const $and: object[] = [];\n\n      const values: string[] = [];\n\n      for (const { op, date } of queries) {\n        const [mongoOp, opSym] = (() => {\n          switch (op) {\n            case Op.Equal:\n              return [\"$eq\", \"=\"];\n            case Op.GreaterThan:\n              return [\"$gt\", \">\"];\n            case Op.GreaterThanOrEqual:\n              return [\"$gte\", \">=\"];\n            case Op.LessThan:\n              return [\"$lt\", \"<\"];\n            case Op.LessThanOrEqual:\n              return [\"$lte\", \"<=\"];\n          }\n        })();\n        $and.push({\n          date: { [mongoOp]: startOfDay(date) },\n        });\n\n        values.push(`${opSym}[${dateFormat(date, \"d/M/yy\")}]`);\n      }\n\n      setValue(values.join(\" & \"));\n      setFilterCb({ $and });\n    },\n    [setFilterCb]\n  );\n\n  const onChangeOp1 = useCallback<NonNullable<SelectProps[\"onChange\"]>>(\n    (event) => {\n      const op = (event.target.value ?? Op.Equal) as Op;\n      setOp1(op);\n\n      // If op2 is no longer valid given op1, clear op2 and date2\n      const [, , validOps] = op2ValidOptions(date1, op);\n      const op2Valid = validOps.includes(op2);\n      if (!op2Valid) {\n        setOp2(Op.None);\n        setDate2(null);\n      }\n\n      // If date1 is set update filters\n      if (date1) {\n        const filters = [\n          {\n            op,\n            date: date1,\n          },\n        ];\n\n        // Include op2 if exists and valid\n        if (op2Valid && op2 !== Op.None && op2 !== Op.Equal && date2) {\n          filters.push({\n            op: op2,\n            date: date2,\n          });\n        }\n\n        setFilter(filters);\n      }\n    },\n    [date1, date2, op2, setFilter]\n  );\n\n  const onChangeOp2 = useCallback<NonNullable<SelectProps[\"onChange\"]>>(\n    (event) => {\n      const op = (event.target.value ?? Op.None) as Op;\n      setOp2(op);\n      // If op2 is set to non clear date2 and update filter\n      if (op === Op.None) {\n        setDate2(null);\n        if (date1) {\n          setFilter([\n            {\n              op: op1,\n              date: date1,\n            },\n          ]);\n        } else {\n          setFilter([]);\n        }\n      } else if (date2) {\n        setFilter([\n          {\n            op: op1,\n            date: date1 as Date,\n          },\n          {\n            op,\n            date: date2,\n          },\n        ]);\n      }\n    },\n    [date1, date2, op1, setFilter]\n  );\n\n  const onChangeDate1 = useCallback<KeyboardDatePickerProps[\"onChange\"]>(\n    (date, value) => {\n      if (date && !isDateValid(date)) {\n        return;\n      }\n\n      setDate1(date);\n\n      if (date) {\n        const filters = [\n          {\n            op: op1,\n            date,\n          },\n        ];\n\n        // If date2 insure is still valid\n        if (date2) {\n          const [minDate, maxDate] = op2ValidOptions(date, op1);\n\n          if (\n            (op2 !== Op.None &&\n              op2 !== Op.Equal &&\n              minDate &&\n              date2 >= minDate) ||\n            (maxDate && date2 <= maxDate)\n          ) {\n            filters.push({\n              op: op2,\n              date: date2,\n            });\n            // Clear date2 if no longer valid\n          } else {\n            setOp2(Op.None);\n            setDate2(null);\n          }\n        }\n\n        setFilter(filters);\n      } else {\n        setFilter([]); // Clear filters\n        // Clear op2 and date2\n        setOp2(Op.None);\n        setDate2(null);\n      }\n    },\n    [date2, op1, op2, setFilter]\n  );\n\n  const onChangeDate2 = useCallback<KeyboardDatePickerProps[\"onChange\"]>(\n    (date, value) => {\n      if (date && !isDateValid(date)) {\n        return;\n      }\n\n      setDate2(date);\n\n      if (date) {\n        setFilter([\n          { op: op1, date: date1 as Date },\n          { op: op2, date },\n        ]);\n      } else {\n        setFilter(date1 ? [{ op: op1, date: date1 as Date }] : []); // Clear filters\n        // Clear date2\n        setDate2(null);\n      }\n    },\n    [date1, op1, op2, setFilter]\n  );\n\n  const onClickClear = useCallback<NonNullable<IconButtonProps[\"onClick\"]>>(\n    (event) => {\n      event.stopPropagation();\n      setOp1(Op.Equal);\n      setDate1(null);\n      setOp2(Op.None);\n      setDate2(null);\n      setFilter([]);\n    },\n    [setFilter]\n  );\n\n  const InputProps = useMemo<InputPropsType>(\n    () => ({\n      startAdornment: (\n        <InputAdornment disablePointerEvents position=\"start\">\n          <FilterListIcon />\n        </InputAdornment>\n      ),\n      endAdornment: date1 ? (\n        <InputAdornment position=\"end\">\n          <IconButton onClick={onClickClear}>\n            <ClearIcon />\n          </IconButton>\n        </InputAdornment>\n      ) : (\n        <InputAdornment disablePointerEvents position=\"end\">\n          <ArrowDropDownIcon />\n        </InputAdornment>\n      ),\n    }),\n    [date1, onClickClear]\n  );\n\n  const [anchorEl, setAnchorEl] = useState<Element | null>(null);\n\n  const onClick = useCallback<NonNullable<TextFieldProps[\"onClick\"]>>(\n    (event) => void setAnchorEl(event.currentTarget),\n    []\n  );\n\n  const onClose = useCallback((event) => void setAnchorEl(null), []);\n\n  return (\n    <Box>\n      <Tooltip title={value || \"No Filter\"}>\n        <Box maxWidth={250}>\n          <TextField\n            fullWidth\n            value={value}\n            InputProps={InputProps}\n            onClick={onClick}\n          ></TextField>\n        </Box>\n      </Tooltip>\n\n      <Popover onClose={onClose} open={!!anchorEl} anchorEl={anchorEl}>\n        <Box maxWidth={350} margin={2} clone>\n          <Grid container spacing={2}>\n            <Grid xs={12} item>\n              <Box marginTop={1}>\n                <Select value={op1} onChange={onChangeOp1}>\n                  <MenuItem value={Op.Equal}>\n                    <EqualIcon />\n                  </MenuItem>\n                  <MenuItem value={Op.GreaterThan}>\n                    <GreaterThanIcon />\n                  </MenuItem>\n                  <MenuItem value={Op.LessThan}>\n                    <LessThanIcon />\n                  </MenuItem>\n                  <MenuItem value={Op.GreaterThanOrEqual}>\n                    <GreaterThanOrEqualIcon />\n                  </MenuItem>\n                  <MenuItem value={Op.LessThanOrEqual}>\n                    <LessThanOrEqualIcon />\n                  </MenuItem>\n                </Select>\n              </Box>\n              <MuiPickersUtilsProvider utils={DateFnsUtils}>\n                <KeyboardDatePicker\n                  onChange={onChangeDate1}\n                  value={date1}\n                  format=\"MM/dd/yyyy\"\n                  placeholder={\"mm/dd/yyyy\"}\n                  margin=\"none\"\n                  label=\"Date\"\n                  animateYearScrolling={true}\n                  disableToolbar={true}\n                  autoOk={true}\n                  variant={\"inline\"}\n                />\n              </MuiPickersUtilsProvider>\n            </Grid>\n            {!!date1 && op1 !== Op.Equal && (\n              <Grid xs={12} item>\n                <Box marginTop={1}>\n                  <Select value={op2} onChange={onChangeOp2}>\n                    <MenuItem value={Op.None}>{\"None\"}</MenuItem>\n                    <MenuItem style={{ display: \"None\" }} value={Op.Equal}>\n                      <EqualIcon />\n                    </MenuItem>\n                    <MenuItem\n                      style={\n                        validOp2s.includes(Op.GreaterThan)\n                          ? undefined\n                          : { display: \"none\" }\n                      }\n                      disabled={!validOp2s.includes(Op.GreaterThan)}\n                      value={Op.GreaterThan}\n                    >\n                      <GreaterThanIcon />\n                    </MenuItem>\n                    <MenuItem\n                      style={\n                        validOp2s.includes(Op.LessThan)\n                          ? undefined\n                          : { display: \"none\" }\n                      }\n                      disabled={!validOp2s.includes(Op.LessThan)}\n                      value={Op.LessThan}\n                    >\n                      <LessThanIcon />\n                    </MenuItem>\n                    <MenuItem\n                      style={\n                        validOp2s.includes(Op.GreaterThanOrEqual)\n                          ? undefined\n                          : { display: \"none\" }\n                      }\n                      disabled={!validOp2s.includes(Op.GreaterThanOrEqual)}\n                      value={Op.GreaterThanOrEqual}\n                    >\n                      <GreaterThanOrEqualIcon />\n                    </MenuItem>\n                    <MenuItem\n                      style={\n                        validOp2s.includes(Op.LessThanOrEqual)\n                          ? undefined\n                          : { display: \"none\" }\n                      }\n                      disabled={!validOp2s.includes(Op.LessThanOrEqual)}\n                      value={Op.LessThanOrEqual}\n                    >\n                      <LessThanOrEqualIcon />\n                    </MenuItem>\n                  </Select>\n                </Box>\n                <MuiPickersUtilsProvider utils={DateFnsUtils}>\n                  <KeyboardDatePicker\n                    disabled={op2 === Op.None}\n                    minDate={minDate || MIN_DATE}\n                    maxDate={maxDate || MAX_DATE}\n                    onChange={onChangeDate2}\n                    value={date2}\n                    format=\"MM/dd/yyyy\"\n                    placeholder={\"mm/dd/yyyy\"}\n                    margin=\"none\"\n                    label=\"Date\"\n                    animateYearScrolling={true}\n                    disableToolbar={true}\n                    autoOk={true}\n                    variant={\"inline\"}\n                  />\n                </MuiPickersUtilsProvider>\n              </Grid>\n            )}\n          </Grid>\n        </Box>\n      </Popover>\n    </Box>\n  );\n};\n\nexport default DateFilter;\n","import React, { useMemo, useState, useCallback } from \"react\";\nimport MaterialTable, {\n  Column,\n  Options,\n  MaterialTableProps,\n} from \"material-table\";\nimport { capitalCase } from \"change-case\";\nimport numeral from \"numeral\";\nimport { Box, useTheme, Divider } from \"@material-ui/core\";\n\nimport {\n  JournalEntry_1Fragment as JournalEntryFragment,\n  JournalEntryItem_1Fragment as JournalEntryItemFragment,\n} from \"../../../apollo/graphTypes\";\nimport tableIcons from \"../../utils/materialTableIcons\";\nimport AddItem from \"../Upsert/Items/AddItem\";\nimport UpdateItem from \"../Upsert/Items/UpdateItem\";\nimport DeleteItem from \"../Upsert/Items/DeleteItem\";\nimport {\n  Delete as DeleteIcon,\n  AddCircle as AddCircleIcon,\n  Edit as EditIcon,\n} from \"@material-ui/icons\";\nimport { rationalToFraction } from \"../../../utils/rational\";\n\nexport interface ItemsProps {\n  entry: JournalEntryFragment;\n}\n\nconst Items = (props: ItemsProps) => {\n  const { items, category, description, department, id: entryId } = props.entry;\n\n  // Add Item\n  const [addItemOpen, setAddItemOpen] = useState<boolean>(false);\n  const [addItemToEntry, setAddItemToEntry] = useState<string | null>(null);\n\n  const addItemOnClose = useCallback(() => void setAddItemOpen(false), [\n    setAddItemOpen,\n  ]);\n  const addItemOnExited = useCallback(() => void setAddItemToEntry(null), [\n    setAddItemToEntry,\n  ]);\n\n  // Update Item\n  const [updateItemOpen, setUpdateItemOpen] = useState<boolean>(false);\n  const [updateItem, setUpdateItem] = useState<{\n    entryId: string;\n    itemId: string;\n  } | null>(null);\n\n  // Delete Item\n  const [deleteItem, setDeleteItem] = useState<string | null>(null);\n  const deleteItemOnClose = useCallback(() => void setDeleteItem(null), [\n    setDeleteItem,\n  ]);\n\n  const updateItemOnClose = useCallback(() => void setUpdateItemOpen(false), [\n    setUpdateItemOpen,\n  ]);\n  const updateItemOnExited = useCallback(() => void setUpdateItem(null), [\n    setUpdateItem,\n  ]);\n\n  const actions = useMemo<\n    MaterialTableProps<JournalEntryItemFragment>[\"actions\"]\n  >(() => {\n    return [\n      {\n        icon: DeleteIcon as any,\n        tooltip: \"Delete Item\",\n        onClick: (event, rowData) =>\n          setDeleteItem((rowData as JournalEntryItemFragment).id),\n      },\n      {\n        icon: EditIcon as any,\n        tooltip: \"Edit Item\",\n        onClick: (event, rowData) => {\n          setUpdateItemOpen(true);\n          setUpdateItem({\n            entryId,\n            itemId: (rowData as JournalEntryItemFragment).id,\n          });\n        },\n      },\n      {\n        icon: ((props) => <AddCircleIcon {...props} />) as any,\n        iconProps: {\n          color: \"secondary\",\n          fontSize: \"large\",\n        },\n        tooltip: \"Add Item\",\n        isFreeAction: true,\n        onClick: () => {\n          setAddItemOpen(true);\n          setAddItemToEntry(entryId);\n        },\n      },\n    ];\n  }, [entryId]);\n\n  const columns = useMemo<Column<JournalEntryItemFragment>[]>(() => {\n    return [\n      {\n        field: \"total\",\n        title: \"Total\",\n        render: ({ total }) =>\n          numeral(rationalToFraction(total).valueOf()).format(\"$0,0.00\"),\n      },\n      {\n        field: \"units\",\n        title: \"Units\",\n      },\n      {\n        field: \"description\",\n        title: \"Description\",\n        render: (data) => data.description?.trim() || description,\n      },\n      {\n        field: \"category\",\n        title: \"Category\",\n        render: (data, type) => {\n          const name = data.category?.name ?? category.name;\n          return capitalCase(name);\n        },\n      },\n      {\n        field: \"department\",\n        title: \"Department\",\n        render: (data) => {\n          const name = data.department?.name ?? department.name;\n          return capitalCase(name);\n        },\n      },\n    ];\n  }, [category, description, department]);\n\n  const options = useMemo<Options>(\n    () => ({ search: false, emptyRowsWhenPaging: false /* paging: false */ }),\n    []\n  );\n\n  const data = useMemo(() => items.filter((item) => !item.deleted), [items]);\n\n  const theme = useTheme();\n\n  const tableStyle = useMemo(() => ({ boxShadow: theme.shadows[0] }), [\n    theme.shadows,\n  ]);\n\n  const dividerStyle = useMemo(\n    () => ({ backgroundColor: theme.palette.primary.main }),\n    [theme.palette.primary.main]\n  );\n\n  return (\n    <Box>\n      <MaterialTable\n        title=\"Items\"\n        actions={actions}\n        options={options}\n        columns={columns}\n        icons={tableIcons}\n        data={data}\n        style={tableStyle}\n      />\n      <AddItem\n        entryId={addItemToEntry}\n        open={addItemOpen}\n        onClose={addItemOnClose}\n        onExited={addItemOnExited}\n      />\n      <UpdateItem\n        entryId={updateItem?.entryId ?? null}\n        itemId={updateItem?.itemId ?? null}\n        open={updateItemOpen}\n        onClose={updateItemOnClose}\n        onExited={updateItemOnExited}\n      />\n      <DeleteItem itemId={deleteItem} onClose={deleteItemOnClose} />\n      <Divider style={dividerStyle} />\n    </Box>\n  );\n};\n\nexport default Items;\n","import React, { useCallback, useState } from \"react\";\nimport {\n  Select,\n  InputAdornment,\n  MenuItem,\n  SelectProps,\n  Tooltip,\n} from \"@material-ui/core\";\nimport { FilterList as FilterListIcon } from \"@material-ui/icons\";\n\ntype Values = \"None\" | \"Reconciled\" | \"Unreconciled\";\n\nconst Reconciled = (props: { setFilter: (filter: object) => void }) => {\n  const { setFilter } = props;\n\n  const [value, setValue] = useState<Values>(\"None\");\n\n  const onChange = useCallback<NonNullable<SelectProps[\"onChange\"]>>(\n    (event) => {\n      const value = event.target.value as Values;\n\n      switch (value) {\n        case \"Reconciled\":\n          setFilter({\n            reconciled: {\n              $eq: true,\n            },\n          });\n          break;\n        case \"Unreconciled\":\n          setFilter({\n            reconciled: { $eq: false },\n          });\n          break;\n        case \"None\":\n          setFilter({});\n          break;\n      }\n      setValue(value);\n    },\n    [setFilter, setValue]\n  );\n\n  return (\n    <Tooltip title={value === \"None\" ? \"No Filter\" : value}>\n      <Select\n        startAdornment={\n          <InputAdornment disablePointerEvents position=\"start\">\n            <FilterListIcon />\n          </InputAdornment>\n        }\n        onChange={onChange}\n        fullWidth\n        value={value === \"None\" ? \"\" : value}\n      >\n        <MenuItem value=\"None\">None</MenuItem>\n        <MenuItem value=\"Reconciled\">Reconciled</MenuItem>\n        <MenuItem value=\"Unreconciled\">Unreconciled</MenuItem>\n      </Select>\n    </Tooltip>\n  );\n};\n\nexport default Reconciled;\n","import React, { useMemo, useCallback, useState } from \"react\";\nimport {\n  Select,\n  MenuItem,\n  ListItemText,\n  Input,\n  Checkbox,\n  InputAdornment,\n  Box,\n  Tooltip,\n} from \"@material-ui/core\";\nimport { FilterList as FilterListIcon } from \"@material-ui/icons\";\n\nimport { Entry } from \"../Journal\";\n\nconst Category = (props: {\n  options: Iterable<Entry[\"category\"]>;\n  setFilter: (filter: any) => void;\n}) => {\n  const { setFilter, options } = props;\n\n  const [value, setValue] = useState<string[]>([]);\n\n  const [items, idNameMap] = useMemo(() => {\n    const items: JSX.Element[] = [];\n    const idNameMap = new Map<string, string>();\n\n    for (const category of options) {\n      idNameMap.set(category.id, category.name);\n\n      items.push(\n        <MenuItem key={category.id} value={category.id}>\n          <Checkbox checked={value.includes(category.id)} />\n          <ListItemText primary={category.name} />\n        </MenuItem>\n      );\n    }\n\n    return [items, idNameMap] as const;\n  }, [options, value]);\n\n  const renderValue = useCallback(\n    (renderValues: string[]) =>\n      renderValues.map((v) => idNameMap.get(v) ?? \"\").join(\", \"),\n    [idNameMap]\n  );\n\n  const onChange = useCallback(\n    (event) => {\n      const values = event.target.value || ([] as string[]);\n      if (values.length === 0) {\n        setFilter({});\n      } else {\n        setFilter({\n          \"category.id\": { $in: values },\n        });\n      }\n      setValue(values);\n    },\n    [setFilter]\n  );\n\n  return (\n    <Tooltip title={value.length === 0 ? \"No Filter\" : renderValue(value)}>\n      <Box maxWidth={250}>\n        <Select\n          startAdornment={\n            <InputAdornment disablePointerEvents position=\"start\">\n              <FilterListIcon />\n            </InputAdornment>\n          }\n          fullWidth\n          multiple\n          value={value}\n          onChange={onChange}\n          input={<Input />}\n          renderValue={renderValue as any}\n        >\n          {items}\n        </Select>\n      </Box>\n    </Tooltip>\n  );\n};\n\nexport default Category;\n","import React, { useMemo, useCallback, useState } from \"react\";\nimport {\n  Select,\n  MenuItem,\n  ListItemText,\n  Input,\n  Checkbox,\n  InputAdornment,\n  Box,\n  Tooltip,\n} from \"@material-ui/core\";\nimport { FilterList as FilterListIcon } from \"@material-ui/icons\";\n\nimport { Entry } from \"../Journal\";\n\nconst PaymentMethod = (props: {\n  options: Iterable<Entry[\"paymentMethod\"]>;\n  setFilter: (filter: any) => void;\n}) => {\n  const { setFilter, options } = props;\n\n  const [value, setValue] = useState<string[]>([]);\n\n  const [items, idNameMap] = useMemo(() => {\n    const items: JSX.Element[] = [];\n    const idNameMap = new Map<string, string>();\n\n    for (const paymentMethod of options) {\n      idNameMap.set(paymentMethod.id, paymentMethod.name);\n\n      items.push(\n        <MenuItem key={paymentMethod.id} value={paymentMethod.id}>\n          <Checkbox checked={value.includes(paymentMethod.id)} />\n          <ListItemText primary={paymentMethod.name} />\n        </MenuItem>\n      );\n    }\n\n    return [items, idNameMap] as const;\n  }, [options, value]);\n\n  const renderValue = useCallback(\n    (renderValues: string[]) =>\n      renderValues.map((v) => idNameMap.get(v) ?? \"\").join(\", \"),\n    [idNameMap]\n  );\n\n  const onChange = useCallback(\n    (event) => {\n      const values = event.target.value || ([] as string[]);\n      if (values.length === 0) {\n        setFilter({});\n      } else {\n        setFilter({\n          $or: [\n            { \"paymentMethod.id\": { $in: values } },\n            { \"paymentMethod.parent.id\": { $in: values } },\n          ],\n        });\n      }\n      setValue(values);\n    },\n    [setFilter]\n  );\n\n  return (\n    <Tooltip title={value.length === 0 ? \"No Filter\" : renderValue(value)}>\n      <Box maxWidth={250}>\n        <Select\n          startAdornment={\n            <InputAdornment disablePointerEvents position=\"start\">\n              <FilterListIcon />\n            </InputAdornment>\n          }\n          fullWidth\n          multiple\n          value={value}\n          onChange={onChange}\n          input={<Input />}\n          renderValue={renderValue as any}\n        >\n          {items}\n        </Select>\n      </Box>\n    </Tooltip>\n  );\n};\n\nexport default PaymentMethod;\n","import React, { useMemo, useCallback, useState } from \"react\";\nimport {\n  Select,\n  MenuItem,\n  ListItemText,\n  Input,\n  Checkbox,\n  InputAdornment,\n  Box,\n  Tooltip,\n} from \"@material-ui/core\";\nimport { FilterList as FilterListIcon } from \"@material-ui/icons\";\n\nimport { Entry } from \"../Journal\";\n\nconst Department = (props: {\n  options: Iterable<Entry[\"department\"]>;\n  setFilter: (filter: any) => void;\n}) => {\n  const { setFilter, options } = props;\n\n  const [value, setValue] = useState<string[]>([]);\n\n  const [items, idNameMap] = useMemo(() => {\n    const items: JSX.Element[] = [];\n    const idNameMap = new Map<string, string>();\n\n    for (const department of options) {\n      idNameMap.set(department.id, department.name);\n\n      items.push(\n        <MenuItem key={department.id} value={department.id}>\n          <Checkbox checked={value.includes(department.id)} />\n          <ListItemText primary={department.name} />\n        </MenuItem>\n      );\n    }\n\n    return [items, idNameMap] as const;\n  }, [options, value]);\n\n  const renderValue = useCallback(\n    (renderValues: string[]) =>\n      renderValues.map((v) => idNameMap.get(v) ?? \"\").join(\", \"),\n    [idNameMap]\n  );\n\n  const onChange = useCallback(\n    (event) => {\n      const values = event.target.value || ([] as string[]);\n      if (values.length === 0) {\n        setFilter({});\n      } else {\n        setFilter({\n          \"department.id\": { $in: values },\n        });\n      }\n      setValue(values);\n    },\n    [setFilter]\n  );\n\n  return (\n    <Tooltip title={value.length === 0 ? \"No Filter\" : renderValue(value)}>\n      <Box maxWidth={250}>\n        <Select\n          startAdornment={\n            <InputAdornment disablePointerEvents position=\"start\">\n              <FilterListIcon />\n            </InputAdornment>\n          }\n          fullWidth\n          multiple\n          value={value}\n          onChange={onChange}\n          input={<Input />}\n          renderValue={renderValue as any}\n        >\n          {items}\n        </Select>\n      </Box>\n    </Tooltip>\n  );\n};\n\nexport default Department;\n","import React, { useMemo, useCallback, useState } from \"react\";\nimport {\n  Select,\n  MenuItem,\n  ListItemText,\n  Input,\n  Checkbox,\n  InputAdornment,\n  Box,\n  Tooltip,\n} from \"@material-ui/core\";\nimport { FilterList as FilterListIcon } from \"@material-ui/icons\";\n\nimport { Entry } from \"../Journal\";\n\nconst Source = (props: {\n  options: Iterable<Entry[\"source\"]>;\n  setFilter: (filter: any) => void;\n}) => {\n  const { setFilter, options } = props;\n\n  const [value, setValue] = useState<string[]>([]);\n\n  const [items, idNameMap] = useMemo(() => {\n    const items: JSX.Element[] = [];\n    const idNameMap = new Map<string, string>();\n\n    for (const source of options) {\n      const name = (() => {\n        switch (source.__typename) {\n          case \"Person\":\n            return `${source.name.first} ${source.name.last}`;\n          case \"Business\":\n            return source.bizName;\n          case \"Department\":\n            return source.deptName;\n        }\n      })();\n\n      const id = `${source.__typename}-${source.id}`;\n\n      idNameMap.set(id, name);\n\n      items.push(\n        <MenuItem key={id} value={id}>\n          <Checkbox checked={value.includes(id)} />\n          <ListItemText primary={name} />\n        </MenuItem>\n      );\n    }\n\n    return [items, idNameMap] as const;\n  }, [options, value]);\n\n  const renderValue = useCallback(\n    (renderValues: string[]) =>\n      renderValues.map((v) => idNameMap.get(v) ?? \"\").join(\", \"),\n    [idNameMap]\n  );\n\n  const onChange = useCallback(\n    (event) => {\n      const values = (event.target.value || []) as string[];\n      if (values.length === 0) {\n        setFilter({});\n      } else {\n        setFilter({\n          $or: values.map((v) => {\n            const [type, id] = v.split(\"-\");\n\n            return {\n              \"source.id\": id,\n              \"source.__typename\": type,\n            };\n          }),\n        });\n      }\n      setValue(values);\n    },\n    [setFilter]\n  );\n\n  return (\n    <Tooltip title={value.length === 0 ? \"No Filter\" : renderValue(value)}>\n      <Box maxWidth={250}>\n        <Select\n          startAdornment={\n            <InputAdornment disablePointerEvents position=\"start\">\n              <FilterListIcon />\n            </InputAdornment>\n          }\n          fullWidth\n          multiple\n          value={value}\n          onChange={onChange}\n          input={<Input />}\n          renderValue={renderValue as any}\n        >\n          {items}\n        </Select>\n      </Box>\n    </Tooltip>\n  );\n};\n\nexport default Source;\n","import React, { useMemo, useCallback, useState } from \"react\";\nimport {\n  Popover,\n  Box,\n  Select,\n  InputAdornment,\n  TextField,\n  SelectProps,\n  InputProps as InputPropsType,\n  TextFieldProps,\n  MenuItem,\n  Grid,\n  IconButton,\n  IconButtonProps,\n  Tooltip,\n} from \"@material-ui/core\";\nimport {\n  FilterList as FilterListIcon,\n  ArrowDropDown as ArrowDropDownIcon,\n  Clear as ClearIcon,\n} from \"@material-ui/icons\";\nimport {\n  Equal as EqualIcon,\n  GreaterThan as GreaterThanIcon,\n  LessThan as LessThanIcon,\n  GreaterThanOrEqual as GreaterThanOrEqualIcon,\n  LessThanOrEqual as LessThanOrEqualIcon,\n} from \"mdi-material-ui\";\nimport Fraction from \"fraction.js\";\n\nenum Op {\n  None = 1,\n  Equal,\n  GreaterThan,\n  LessThan,\n  GreaterThanOrEqual,\n  LessThanOrEqual,\n}\n\nconst op2ValidOptions = (\n  total1: Fraction | null,\n  op1: Op\n): [Fraction | undefined, Fraction | undefined, Op[]] => {\n  if (!total1) {\n    return [undefined, undefined, [Op.None]];\n  }\n\n  switch (op1) {\n    case Op.None:\n    case Op.Equal:\n      return [undefined, undefined, [Op.None]];\n    case Op.GreaterThan:\n    case Op.GreaterThanOrEqual:\n      return [\n        total1.add(new Fraction({ n: 1, d: 100 })),\n        undefined,\n        [Op.None, Op.LessThan, Op.LessThanOrEqual],\n      ];\n    case Op.LessThan:\n    case Op.LessThanOrEqual:\n      return [\n        undefined,\n        total1.sub(new Fraction({ n: 1, d: 100 })),\n        [Op.None, Op.GreaterThan, Op.GreaterThanOrEqual],\n      ];\n  }\n};\n\nconst TotalInputProps = {\n  type: \"number\",\n  startAdornment: <InputAdornment position=\"start\">$</InputAdornment>,\n} as const;\n\nconst Total = (props: { setFilter: (filter) => void }) => {\n  const { setFilter: setFilterCb } = props;\n\n  const [value, setValue] = useState(\"\");\n\n  const [op1, setOp1] = useState(Op.Equal);\n  const [total1, setTotal1] = useState<string>(\"\");\n\n  const [op2, setOp2] = useState(Op.None);\n  const [total2, setTotal2] = useState<string>(\"\");\n\n  const [minTotal, maxTotal, validOp2s] = useMemo(\n    () => op2ValidOptions(total1 ? new Fraction(total1) : null, op1),\n    [total1, op1]\n  );\n\n  const inputProps = useMemo(\n    () => ({\n      min: minTotal ? minTotal.toString() : \"0.00\",\n      max: maxTotal ? maxTotal.toString() : undefined,\n      step: \"0.01\",\n    }),\n    [minTotal, maxTotal]\n  );\n\n  const setFilter = useCallback(\n    (queries: { op: Op; total: number }[]) => {\n      if (queries.length === 0) {\n        setValue(\"\");\n        setFilterCb({});\n        return;\n      }\n\n      const $and: object[] = [];\n\n      const values: string[] = [];\n\n      for (const { op, total } of queries) {\n        const [mongoOp, opSym] = (() => {\n          switch (op) {\n            case Op.Equal:\n              return [\"$eq\", \"=\"];\n            case Op.GreaterThan:\n              return [\"$gt\", \">\"];\n            case Op.GreaterThanOrEqual:\n              return [\"$gte\", \">=\"];\n            case Op.LessThan:\n              return [\"$lt\", \"<\"];\n            case Op.LessThanOrEqual:\n              return [\"$lte\", \"<=\"];\n          }\n        })();\n        $and.push({\n          total: { [mongoOp]: total },\n        });\n\n        values.push(`${opSym}[${total}]`);\n      }\n\n      setValue(values.join(\" & \"));\n      setFilterCb({ $and });\n    },\n    [setFilterCb]\n  );\n\n  const onChangeOp1 = useCallback<NonNullable<SelectProps[\"onChange\"]>>(\n    (event) => {\n      const op = (event.target.value ?? Op.Equal) as Op;\n      setOp1(op);\n\n      // If op2 is no longer valid given op1, clear op2 and total2\n      const [, , validOps] = op2ValidOptions(\n        total1 ? new Fraction(total1) : null,\n        op\n      );\n      const op2Valid = validOps.includes(op2);\n      if (!op2Valid) {\n        setOp2(Op.None);\n        setTotal2(\"\");\n      }\n\n      // If total1 is set update filters\n      if (total1) {\n        const total1Fraction = new Fraction(total1);\n\n        const filters = [\n          {\n            op,\n            total: total1Fraction.valueOf(),\n          },\n        ];\n\n        // Include op2 if exists and valid\n        if (op2Valid && op2 !== Op.None && op2 !== Op.Equal && total2) {\n          const total2Fraction = new Fraction(total2);\n\n          filters.push({\n            op: op2,\n            total: total2Fraction.valueOf(),\n          });\n        }\n\n        setFilter(filters);\n      }\n    },\n    [total1, total2, op2, setFilter]\n  );\n\n  const onChangeOp2 = useCallback<NonNullable<SelectProps[\"onChange\"]>>(\n    (event) => {\n      const op = (event.target.value ?? Op.None) as Op;\n      setOp2(op);\n      // If op2 is set to non clear total2 and update filter\n      if (op === Op.None) {\n        setTotal2(\"\");\n        if (total1) {\n          const total1Fraction = new Fraction(total1);\n\n          setFilter([\n            {\n              op: op1,\n              total: total1Fraction.valueOf(),\n            },\n          ]);\n        } else {\n          setFilter([]);\n        }\n      } else if (total2) {\n        const total1Fraction = new Fraction(total1);\n        const total2Fraction = new Fraction(total2);\n\n        setFilter([\n          {\n            op: op1,\n            total: total1Fraction.valueOf(),\n          },\n          {\n            op,\n            total: total2Fraction.valueOf(),\n          },\n        ]);\n      }\n    },\n    [total1, total2, op1, setFilter]\n  );\n\n  const onChangeTotal1 = useCallback<NonNullable<TextFieldProps[\"onChange\"]>>(\n    (event) => {\n      const value = event.target.value.trim();\n\n      if (value) {\n        const total = new Fraction(value).round(2);\n\n        setValue(total.toString());\n\n        setTotal1(value);\n\n        const filters = [\n          {\n            op: op1,\n            total: total.valueOf(),\n          },\n        ];\n\n        // If total2 insure is still valid\n        if (total2) {\n          const [minTotal, maxTotal] = op2ValidOptions(total, op1);\n\n          const total2Faction = new Fraction(total2);\n\n          if (\n            (op2 !== Op.None &&\n              op2 !== Op.Equal &&\n              minTotal &&\n              total2Faction.compare(minTotal) >= 0) ||\n            (maxTotal && total2Faction.compare(maxTotal) <= 0)\n          ) {\n            filters.push({\n              op: op2,\n              total: total2Faction.valueOf(),\n            });\n          } else {\n            // Clear total2 if no longer valid\n            setOp2(Op.None);\n            setTotal2(\"\");\n          }\n        }\n\n        setFilter(filters);\n      } else {\n        setValue(value);\n\n        setFilter([]); // Clear filters\n        // Clear op2 and total2\n        setOp2(Op.None);\n        setTotal2(\"\");\n      }\n    },\n    [op1, total2, setFilter, op2]\n  );\n\n  const onChangeTotal2 = useCallback<NonNullable<TextFieldProps[\"onChange\"]>>(\n    (event) => {\n      const value = event.target.value.trim();\n\n      if (value) {\n        const total1Faction = new Fraction(total1);\n\n        const total = new Fraction(value).round(2);\n\n        setTotal2(value);\n\n        setFilter([\n          { op: op1, total: total1Faction.valueOf() },\n          { op: op2, total: total.valueOf() },\n        ]);\n      } else {\n        if (total1) {\n          const total1Faction = new Fraction(total1);\n          setFilter([{ op: op1, total: total1Faction.valueOf() }]);\n        } else {\n          setFilter([]);\n        }\n\n        // Clear filters\n        // Clear total2\n        setTotal2(\"\");\n      }\n    },\n    [total1, op1, op2, setFilter]\n  );\n\n  const onClickClear = useCallback<NonNullable<IconButtonProps[\"onClick\"]>>(\n    (event) => {\n      event.stopPropagation();\n      setOp1(Op.Equal);\n      setTotal1(\"\");\n      setOp2(Op.None);\n      setTotal2(\"\");\n      setFilter([]);\n    },\n    [setFilter]\n  );\n\n  const InputProps = useMemo<InputPropsType>(\n    () => ({\n      startAdornment: (\n        <InputAdornment disablePointerEvents position=\"start\">\n          <FilterListIcon />\n        </InputAdornment>\n      ),\n      endAdornment: total1 ? (\n        <InputAdornment position=\"end\">\n          <IconButton onClick={onClickClear}>\n            <ClearIcon />\n          </IconButton>\n        </InputAdornment>\n      ) : (\n        <InputAdornment disablePointerEvents position=\"end\">\n          <ArrowDropDownIcon />\n        </InputAdornment>\n      ),\n    }),\n    [total1, onClickClear]\n  );\n\n  const [anchorEl, setAnchorEl] = useState<Element | null>(null);\n\n  const onClick = useCallback<NonNullable<TextFieldProps[\"onClick\"]>>(\n    (event) => void setAnchorEl(event.currentTarget),\n    []\n  );\n\n  const onClose = useCallback((event) => void setAnchorEl(null), []);\n\n  return (\n    <Box>\n      <Tooltip title={value || \"No Filter\"}>\n        <Box maxWidth={250}>\n          <TextField\n            fullWidth\n            value={value}\n            InputProps={InputProps}\n            onClick={onClick}\n          ></TextField>\n        </Box>\n      </Tooltip>\n\n      <Popover onClose={onClose} open={!!anchorEl} anchorEl={anchorEl}>\n        <Box maxWidth={350} margin={2} clone>\n          <Grid container spacing={2}>\n            <Grid xs={12} item>\n              <Select value={op1} onChange={onChangeOp1}>\n                <MenuItem value={Op.Equal}>\n                  <EqualIcon />\n                </MenuItem>\n                <MenuItem value={Op.GreaterThan}>\n                  <GreaterThanIcon />\n                </MenuItem>\n                <MenuItem value={Op.LessThan}>\n                  <LessThanIcon />\n                </MenuItem>\n                <MenuItem value={Op.GreaterThanOrEqual}>\n                  <GreaterThanOrEqualIcon />\n                </MenuItem>\n                <MenuItem value={Op.LessThanOrEqual}>\n                  <LessThanOrEqualIcon />\n                </MenuItem>\n              </Select>\n              <Box marginTop={2}>\n                <TextField\n                  placeholder=\"0.00\"\n                  label=\"Total\"\n                  type=\"number\"\n                  inputProps={inputProps}\n                  InputProps={TotalInputProps}\n                  value={total1}\n                  onChange={onChangeTotal1}\n                />\n              </Box>\n            </Grid>\n            {!!total1 && op1 !== Op.Equal && (\n              <Grid xs={12} item>\n                <Select value={op2} onChange={onChangeOp2}>\n                  <MenuItem value={Op.None}>{\"None\"}</MenuItem>\n                  <MenuItem style={{ display: \"None\" }} value={Op.Equal}>\n                    <EqualIcon />\n                  </MenuItem>\n                  <MenuItem\n                    style={\n                      validOp2s.includes(Op.GreaterThan)\n                        ? undefined\n                        : { display: \"none\" }\n                    }\n                    disabled={!validOp2s.includes(Op.GreaterThan)}\n                    value={Op.GreaterThan}\n                  >\n                    <GreaterThanIcon />\n                  </MenuItem>\n                  <MenuItem\n                    style={\n                      validOp2s.includes(Op.LessThan)\n                        ? undefined\n                        : { display: \"none\" }\n                    }\n                    disabled={!validOp2s.includes(Op.LessThan)}\n                    value={Op.LessThan}\n                  >\n                    <LessThanIcon />\n                  </MenuItem>\n                  <MenuItem\n                    style={\n                      validOp2s.includes(Op.GreaterThanOrEqual)\n                        ? undefined\n                        : { display: \"none\" }\n                    }\n                    disabled={!validOp2s.includes(Op.GreaterThanOrEqual)}\n                    value={Op.GreaterThanOrEqual}\n                  >\n                    <GreaterThanOrEqualIcon />\n                  </MenuItem>\n                  <MenuItem\n                    style={\n                      validOp2s.includes(Op.LessThanOrEqual)\n                        ? undefined\n                        : { display: \"none\" }\n                    }\n                    disabled={!validOp2s.includes(Op.LessThanOrEqual)}\n                    value={Op.LessThanOrEqual}\n                  >\n                    <LessThanOrEqualIcon />\n                  </MenuItem>\n                </Select>\n                <Box marginTop={2}>\n                  <TextField\n                    disabled={op2 === Op.None}\n                    placeholder=\"0.00\"\n                    label=\"Total\"\n                    type=\"number\"\n                    inputProps={inputProps}\n                    InputProps={TotalInputProps}\n                    value={total2}\n                    onChange={onChangeTotal2}\n                  />\n                </Box>\n                {/* <MuiPickersUtilsProvider utils={DateFnsUtils}>\n                  <KeyboardDatePicker\n                    disabled={op2 === Op.None}\n                    minDate={minDate || MIN_DATE}\n                    maxDate={maxDate || MAX_DATE}\n                    onChange={onChangeTotal2}\n                    value={total2}\n                    format=\"MM/dd/yyyy\"\n                    placeholder={\"mm/dd/yyyy\"}\n                    margin=\"none\"\n                    label=\"Date\"\n                    animateYearScrolling={true}\n                    disableToolbar={true}\n                    autoOk={true}\n                    variant={\"inline\"}\n                  />\n                </MuiPickersUtilsProvider> */}\n              </Grid>\n            )}\n          </Grid>\n        </Box>\n      </Popover>\n    </Box>\n  );\n};\n\nexport default Total;\n","import React, {\n  useMemo,\n  useState,\n  useCallback,\n  useEffect,\n  useRef,\n} from \"react\";\nimport MaterialTable, {\n  Column,\n  Options,\n  Localization,\n  MaterialTableProps,\n  Components,\n  MTableBody,\n  QueryResult,\n  Query as MTQuery,\n  MTableBodyRow,\n} from \"material-table\";\nimport { useQuery, useMutation } from \"@apollo/react-hooks\";\nimport numeral from \"numeral\";\nimport { capitalCase } from \"change-case\";\nimport Fuse from \"fuse.js\";\nimport {\n  Done as DoneIcon,\n  Delete as DeleteIcon,\n  AddCircle as AddCircleIcon,\n  CheckCircle as CheckCircleIcon,\n  Edit as EditIcon,\n} from \"@material-ui/icons\";\nimport {\n  Box,\n  TableBody,\n  TableRow,\n  TableCell,\n  Typography,\n} from \"@material-ui/core\";\nimport { green, red } from \"@material-ui/core/colors\";\nimport {\n  BankTransferIn as BankTransferInIcon,\n  BankTransferOut as BankTransferOutIcon,\n  FileTree as FileTreeIcon,\n  FileTreeOutline as FileTreeOutlineIcon,\n} from \"mdi-material-ui\";\nimport gql from \"graphql-tag\";\nimport { format, startOfDay } from \"date-fns\";\nimport Fraction from \"fraction.js\";\nimport \"mingo/init/system\"; // Loads all operators.  Should config later.\nimport { Aggregator } from \"mingo/aggregator\";\n\nimport {\n  JournalEntries_1Query as JournalEntriesQuery,\n  JournalEntries_1QueryVariables as JournalEntriesQueryVars,\n  JournalEntry_1Fragment as JournalEntryFragment,\n  JournalEntryRefund_1Fragment as JournalEntryRefundFragment,\n  JournalEntryType,\n  OnEntryUpsert_1Subscription as OnEntryUpsert,\n  ReconcileEntryMutation as ReconcileEntry,\n  ReconcileEntryMutationVariables as ReconcileEntryVars,\n  ReconcileRefundMutation as ReconcileRefund,\n  ReconcileRefundMutationVariables as ReconcileRefundVars,\n} from \"../../../apollo/graphTypes\";\nimport { JOURNAL_ENTRIES, JOURNAL_ENTRY_FRAGMENT } from \"./JournalEntries.gql\";\nimport { CHECK_ID } from \"../constants\";\nimport tableIcons from \"../../utils/materialTableIcons\";\nimport AddRefund from \"../Upsert/Refunds/AddRefund\";\nimport UpdateRefund from \"../Upsert/Refunds/UpdateRefund\";\nimport AddEntry from \"../Upsert/Entries/AddEntry\";\nimport UpdateEntry from \"../Upsert/Entries/UpdateEntry\";\nimport DeleteEntry from \"../Upsert/Entries/DeleteEntry\";\nimport DeleteRefund from \"../Upsert/Refunds/DeleteRefund\";\nimport ItemsTable from \"./Items\";\nimport { rationalToFraction } from \"../../../utils/rational\";\nimport ReconciledFilter from \"./FilterFields/Reconciled\";\nimport CategoryFilter from \"./FilterFields/Category\";\nimport PaymentMethodFilter from \"./FilterFields/PaymentMethod\";\nimport DepartmentFilter from \"./FilterFields/Department\";\nimport SourceFilter from \"./FilterFields/Source\";\nimport DateFilter from \"./FilterFields/Date\";\nimport TotalFilter from \"./FilterFields/Total\";\nimport \"../../../utils/mingoUtils\";\n\nexport enum JournalMode {\n  View,\n  Reconcile,\n}\n\nexport type Entry =\n  | JournalEntryFragment\n  | (Omit<JournalEntryFragment, \"__typename\" | \"refunds\"> &\n      JournalEntryRefundFragment & { refunds: string });\n\nconst entriesGen = function* (\n  entries: Iterable<JournalEntryFragment>\n): IterableIterator<Entry> {\n  for (const entry of entries) {\n    yield entry;\n    const refundType =\n      entry.type === JournalEntryType.Credit\n        ? JournalEntryType.Debit\n        : JournalEntryType.Credit;\n    for (const refund of entry.refunds) {\n      yield {\n        ...entry,\n        ...refund,\n        type: refundType,\n        description: refund.description || entry.description,\n        refunds: entry.id,\n      };\n    }\n  }\n};\n\n// export type EntryFilter = U.Exclude<Query<Entry>, RegExp>;\n\nexport const CLEAR_FILTER = Symbol();\n\nconst ON_ENTRY_UPSERT = gql`\n  subscription OnEntryUpsert_1 {\n    journalEntryUpserted {\n      ...JournalEntry_1Fragment\n      department {\n        ancestors {\n          ... on Department {\n            __typename\n            id\n          }\n        }\n      }\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst RECONCILE_ENTRY = gql`\n  mutation ReconcileEntry($id: ID!) {\n    journalEntryUpdate(id: $id, fields: { reconciled: true }) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst RECONCILE_REFUND = gql`\n  mutation ReconcileRefund($id: ID!) {\n    journalEntryUpdateRefund(id: $id, fields: { reconciled: true }) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst Journal = (props: {\n  journalTitle?: string;\n  deptId?: string;\n  mode: JournalMode;\n}) => {\n  const { deptId = null, journalTitle = null, mode } = props;\n\n  // Add Entry\n  const [addEntryOpen, setAddEntryOpen] = useState<boolean>(false);\n  const addEntryOnClose = useCallback(() => void setAddEntryOpen(false), [\n    setAddEntryOpen,\n  ]);\n\n  // Update Entry\n  const [updateEntryOpen, setUpdateEntryOpen] = useState<boolean>(false);\n  const [updateEntry, setUpdateEntry] = useState<string | null>(null);\n\n  const updateEntryOnClose = useCallback(() => void setUpdateEntryOpen(false), [\n    setUpdateEntryOpen,\n  ]);\n  const updateEntryOnExited = useCallback(() => void setUpdateEntry(null), [\n    setUpdateEntry,\n  ]);\n\n  // Delete Entry\n  const [deleteEntry, setDeleteEntry] = useState<string | null>(null);\n  const deleteEntryOnClose = useCallback(() => void setDeleteEntry(null), [\n    setDeleteEntry,\n  ]);\n\n  // Add Refund\n  const [addRefundOpen, setAddRefundOpen] = useState<boolean>(false);\n  const [addRefundToEntry, setAddRefundToEntry] = useState<string | null>(null);\n\n  const addRefundOnClose = useCallback(() => void setAddRefundOpen(false), [\n    setAddRefundOpen,\n  ]);\n  const addRefundOnExited = useCallback(() => void setAddRefundToEntry(null), [\n    setAddRefundToEntry,\n  ]);\n\n  // Update Refund\n  const [updateRefundOpen, setUpdateRefundOpen] = useState<boolean>(false);\n  const [updateRefund, setUpdateRefund] = useState<{\n    entryId: string;\n    refundId: string;\n  } | null>(null);\n\n  const updateRefundOnClose = useCallback(\n    () => void setUpdateRefundOpen(false),\n    [setUpdateRefundOpen]\n  );\n  const updateRefundOnExited = useCallback(() => void setUpdateRefund(null), [\n    setUpdateRefund,\n  ]);\n\n  // Delete Refund\n  const [deleteRefund, setDeleteRefund] = useState<string | null>(null);\n  const deleteRefundOnClose = useCallback(() => void setDeleteRefund(null), [\n    setDeleteRefund,\n  ]);\n\n  // Reconcile Entry\n  const [reconcileEntry, { loading: reconcilingEntry }] = useMutation<\n    ReconcileEntry,\n    ReconcileEntryVars\n  >(RECONCILE_ENTRY);\n  // Reconcile Refund\n  const [reconcileRefund, { loading: reconcilingRefund }] = useMutation<\n    ReconcileRefund,\n    ReconcileRefundVars\n  >(RECONCILE_REFUND);\n\n  const variables = useMemo<JournalEntriesQueryVars | undefined>(() => {\n    return deptId\n      ? {\n          where: { department: { eq: deptId, matchDecedentTree: true } },\n        }\n      : undefined;\n  }, [deptId]);\n\n  const { loading, error, data, subscribeToMore } = useQuery<\n    JournalEntriesQuery,\n    JournalEntriesQueryVars\n  >(JOURNAL_ENTRIES, {\n    variables,\n    fetchPolicy: \"cache-and-network\",\n  });\n\n  const isLoading = loading && !data?.journalEntries;\n\n  // Subscribe to updates\n  useEffect(() => {\n    return subscribeToMore<OnEntryUpsert>({\n      document: ON_ENTRY_UPSERT,\n      updateQuery: (prev, { subscriptionData }) => {\n        if (!subscriptionData.data) {\n          return prev;\n        }\n\n        const upsertEntry = subscriptionData.data.journalEntryUpserted;\n\n        const ancestors = upsertEntry.department.ancestors;\n\n        if (\n          deptId &&\n          upsertEntry.department.id !== deptId &&\n          ancestors.every((dept) => (dept as any).id !== deptId)\n        ) {\n          // Filter entry out of query results if department changes.\n          const journalEntriesFiltered = prev.journalEntries.filter(\n            (entry) => entry.id !== upsertEntry.id\n          );\n\n          if (journalEntriesFiltered.length === prev.journalEntries.length) {\n            return prev;\n          }\n\n          return Object.assign({}, prev, {\n            journalEntries: journalEntriesFiltered,\n          });\n        }\n\n        // Apollo will take care of updating if entry already exists in cache.\n        if (prev.journalEntries.some((entry) => entry.id === upsertEntry.id)) {\n          return prev;\n        }\n\n        return Object.assign({}, prev, {\n          journalEntries: [upsertEntry, ...prev.journalEntries],\n        });\n      },\n    });\n  }, [deptId, subscribeToMore]);\n\n  const journalEntries = data?.journalEntries || [];\n\n  const [entries, filterOptions] = useMemo(() => {\n    const filterOptions = {\n      category: new Map<string, Entry[\"category\"]>(),\n      paymentMethod: new Map<string, Entry[\"paymentMethod\"]>(),\n      source: new Map<string, Entry[\"source\"]>(),\n      department: new Map<string, Entry[\"department\"]>(),\n    };\n\n    const entries: Entry[] = [];\n\n    for (let entry of entriesGen(journalEntries)) {\n      if (\n        entry.deleted ||\n        (mode === JournalMode.Reconcile && entry.reconciled)\n      ) {\n        continue;\n      }\n\n      filterOptions.category.set(entry.category.id, entry.category);\n      filterOptions.department.set(entry.department.id, entry.department);\n      filterOptions.paymentMethod.set(\n        entry.paymentMethod.id,\n        entry.paymentMethod\n      );\n      filterOptions.source.set(\n        `${entry.source.__typename}-${entry.source.id}`,\n        entry.source\n      );\n\n      entries.push(entry);\n    }\n\n    return [\n      entries,\n      {\n        category: [...filterOptions.category.values()],\n        department: [...filterOptions.department.values()],\n        // Do not include individual check numbers\n        paymentMethod: [...filterOptions.paymentMethod.values()].filter(\n          (p) => p.parent?.id !== \"5dc46d0af74afb2c2805bd54\"\n        ),\n        source: [...filterOptions.source.values()],\n      },\n    ] as const;\n  }, [journalEntries, mode]);\n\n  const columns = useMemo<Column<Entry>[]>(() => {\n    return [\n      {\n        field: \"reconciled\",\n        title: \"Reconciled\",\n        render: ({ reconciled }) => (reconciled ? <DoneIcon /> : null),\n        searchable: false,\n        filterComponent: ({ columnDef, onFilterChanged }) => (\n          <ReconciledFilter\n            setFilter={(filter) =>\n              onFilterChanged((columnDef as any).tableData?.id ?? \"0\", filter)\n            }\n          />\n        ),\n        hidden: mode === JournalMode.Reconcile,\n        filtering: true,\n      },\n      {\n        field: \"total\",\n        title: \"Total\",\n        render: ({ total }) =>\n          numeral(rationalToFraction(total).valueOf()).format(\"$0,0.00\"),\n        searchable: false,\n        filterComponent: ({ columnDef, onFilterChanged }) => (\n          <TotalFilter\n            setFilter={(filter) => {\n              onFilterChanged((columnDef as any).tableData?.id ?? \"1\", filter);\n            }}\n          />\n        ),\n      },\n      {\n        field: \"date\",\n        title: \"Date\",\n        render: ({ date }) => format(new Date(date), \"MMM dd, yyyy\"),\n        searchable: false,\n        filterComponent: ({ columnDef, onFilterChanged }) => (\n          <DateFilter\n            setFilter={(filter) => {\n              onFilterChanged((columnDef as any).tableData?.id ?? \"2\", filter);\n            }}\n          />\n        ),\n        defaultSort: \"desc\",\n      },\n      {\n        field: \"category\",\n        title: \"Category\",\n        render: (data, type) => {\n          const name =\n            type === \"group\"\n              ? ((data as any) as JournalEntryFragment[\"category\"]).name\n              : data.category.name;\n          return capitalCase(name);\n        },\n        searchable: false,\n        filterComponent: ({ columnDef, onFilterChanged }) => (\n          <CategoryFilter\n            options={filterOptions.category}\n            setFilter={(filter) =>\n              onFilterChanged((columnDef as any).tableData?.id ?? \"3\", filter)\n            }\n          />\n        ),\n      },\n      {\n        field: \"source\",\n        title: \"Source\",\n        render: ({ source }) => {\n          switch (source.__typename) {\n            case \"Person\":\n              return `${source.name.first} ${source.name.last}`;\n            case \"Business\":\n              return source.bizName;\n            case \"Department\":\n              return source.deptName;\n          }\n        },\n        searchable: false,\n        filterComponent: ({ columnDef, onFilterChanged }) => (\n          <SourceFilter\n            options={filterOptions.source}\n            setFilter={(filter) =>\n              onFilterChanged((columnDef as any).tableData?.id ?? \"4\", filter)\n            }\n          />\n        ),\n      },\n      {\n        field: \"paymentMethod\",\n        title: \"Payment Method\",\n        render: ({ paymentMethod }) =>\n          paymentMethod.parent?.id === CHECK_ID\n            ? `CK-${paymentMethod.name}`\n            : paymentMethod.name,\n        searchable: false,\n        filterComponent: ({ columnDef, onFilterChanged }) => (\n          <PaymentMethodFilter\n            options={filterOptions.paymentMethod}\n            setFilter={(filter) =>\n              onFilterChanged((columnDef as any).tableData?.id ?? \"5\", filter)\n            }\n          />\n        ),\n      },\n      {\n        field: \"description\",\n        title: \"Description\",\n        render: ({ description }) => description,\n        searchable: false,\n        filtering: false,\n        sorting: false,\n      },\n      {\n        field: \"department\",\n        title: \"Department\",\n        render: ({ department }) => capitalCase(department.name),\n        searchable: false,\n        filterComponent: ({ columnDef, onFilterChanged }) => (\n          <DepartmentFilter\n            options={filterOptions.department}\n            setFilter={(filter) =>\n              onFilterChanged((columnDef as any).tableData?.id ?? \"5\", filter)\n            }\n          />\n        ),\n      },\n    ];\n  }, [\n    filterOptions.category,\n    filterOptions.department,\n    filterOptions.paymentMethod,\n    filterOptions.source,\n    mode,\n  ]);\n\n  const localization = useMemo<Localization>(\n    () => ({\n      toolbar: {\n        searchTooltip: (\n          <Box fontSize={12} component=\"span\">\n            [abc] | [efg] = \"abc\" OR \"efg\"\n            <br />\n            '[abc] = EXACTLY \"abc\"\n            <br />\n            ![abc] = NOT \"abc\"\n            <br />\n            ^[abc] = STARTS WITH \"abc\"\n            <br />\n            !^[abc] = DOES NOT START WITH \"abc\"\n            <br />\n            [abc]$ = ENDS WITH \"abc\"\n            <br />\n            ![abc]$ = DOES NOT END WITH \"abc\"\n          </Box>\n        ) as any,\n        nRowsSelected: \"Reconcile {0} Entry(s)\",\n      },\n    }),\n    []\n  );\n\n  const options = useMemo<Options>(\n    () => ({\n      rowStyle: (data: Entry) => {\n        const style = {} as React.CSSProperties;\n\n        style.color =\n          data.type === JournalEntryType.Credit ? green[900] : red[900];\n\n        return style;\n      },\n      maxBodyHeight: \"calc(100vh - 53px - 64px)\",\n      headerStyle: { position: \"sticky\", top: 0 },\n      pageSize: 25,\n      pageSizeOptions: [25, 50, 100],\n      showTitle: !!journalTitle,\n      selection: mode === JournalMode.Reconcile,\n      showSelectAllCheckbox: false,\n      debounceInterval: 500,\n      emptyRowsWhenPaging: false,\n      columnsButton: true,\n      filtering: true,\n      sorting: true,\n      thirdSortClick: false,\n    }),\n    [journalTitle, mode]\n  );\n\n  const actions = useMemo<MaterialTableProps<Entry>[\"actions\"]>(() => {\n    if (mode === JournalMode.Reconcile) {\n      return [\n        {\n          icon: ((props) => <CheckCircleIcon {...props} />) as any,\n          tooltip: \"Reconcile Selected\",\n          position: \"toolbarOnSelect\",\n          iconProps: {\n            color: \"secondary\",\n            fontSize: \"large\",\n          },\n          onClick: async (event, rowData) => {\n            await Promise.all(\n              (Array.isArray(rowData) ? rowData : [rowData]).map(\n                async (entry) => {\n                  if (entry.reconciled) {\n                    return;\n                  }\n\n                  try {\n                    if (entry.__typename === \"JournalEntryRefund\") {\n                      await reconcileRefund({ variables: { id: entry.id } });\n                    } else {\n                      await reconcileEntry({ variables: { id: entry.id } });\n                    }\n                  } catch (error) {\n                    console.error(error);\n                  }\n                }\n              )\n            );\n          },\n        },\n      ];\n    }\n\n    return [\n      (rowData) => {\n        const { tooltip, onClick } = (() => {\n          switch (rowData.__typename) {\n            case \"JournalEntry\":\n              return {\n                tooltip: \"Delete Entry\",\n                onClick: (event, rowData) => setDeleteEntry(rowData.id),\n              };\n            // case \"JournalEntryItem\":\n            //   return {\n            //     tooltip: \"Delete Item\",\n            //     onClick: (event, rowData) => {\n            //       // setDeleteItem(rowData.id)\n            //     },\n            //   };\n            case \"JournalEntryRefund\":\n              return {\n                tooltip: \"Delete Refund\",\n                onClick: (event, rowData) => setDeleteRefund(rowData.id),\n              };\n          }\n        })();\n\n        return {\n          icon: DeleteIcon as any,\n          tooltip,\n          onClick,\n        };\n      },\n      (rowData) => {\n        const { tooltip, onClick } = (() => {\n          switch (rowData.__typename) {\n            case \"JournalEntry\":\n              return {\n                tooltip: \"Edit Entry\",\n                onClick: (event, rowData) => {\n                  setUpdateEntryOpen(true);\n                  setUpdateEntry((rowData as Entry).id);\n                },\n              };\n            // case \"JournalEntryItem\":\n            //   return {\n            //     tooltip: \"Edit Item\",\n            //     onClick: (event, rowData) => {\n            //       setUpdateItemOpen(true);\n            //       setUpdateItem({\n            //         entryId: (rowData as Entry).items as string,\n            //         itemId: (rowData as Entry).id,\n            //       });\n            //     },\n            //   };\n            case \"JournalEntryRefund\":\n              return {\n                tooltip: \"Edit Refund\",\n                onClick: (event, rowData) => {\n                  setUpdateRefundOpen(true);\n                  setUpdateRefund({\n                    entryId: (rowData as Entry).refunds as string,\n                    refundId: (rowData as Entry).id,\n                  });\n                },\n              };\n          }\n        })();\n\n        return {\n          icon: EditIcon as any,\n          tooltip,\n          onClick,\n        };\n      },\n      (rowData) => {\n        if (rowData.__typename !== \"JournalEntry\") {\n          return null as any;\n        }\n\n        const isCredit = rowData.type === JournalEntryType.Credit;\n\n        return {\n          icon: ((props) =>\n            isCredit ? (\n              <BankTransferOutIcon {...props} />\n            ) : (\n              <BankTransferInIcon {...props} />\n            )) as any,\n          tooltip: isCredit ? \"Give Refund\" : \"Add Refund\",\n          iconProps: {\n            style: { color: isCredit ? red[900] : green[900] },\n            // color: \"secondary\",\n            // fontSize: \"large\",\n          } as any,\n          onClick: (event, rowData) => {\n            setAddRefundOpen(true);\n            setAddRefundToEntry((rowData as JournalEntryFragment).id);\n          },\n        };\n      },\n      {\n        icon: ((props) => <AddCircleIcon {...props} />) as any,\n        iconProps: {\n          color: \"secondary\",\n          fontSize: \"large\",\n        },\n        tooltip: \"Add Entry\",\n        isFreeAction: true,\n        onClick: () => {\n          setAddEntryOpen(true);\n        },\n      },\n    ];\n  }, [mode, reconcileRefund, reconcileEntry, setDeleteRefund, setDeleteEntry]);\n\n  // https://github.com/mbrn/material-table/issues/563\n  const detailPanelState = useMemo(() => new Map<string, any>(), []);\n\n  const components = useMemo<Components>(\n    () => ({\n      Body: error\n        ? (props) => (\n            <TableBody {...props}>\n              <TableRow>\n                <TableCell\n                  colSpan={\n                    columns.length +\n                    (Array.isArray(actions) && actions.length > 0 ? 1 : 0)\n                  }\n                  align=\"left\"\n                >\n                  <Typography align=\"center\" color=\"error\" variant=\"h4\">\n                    Error Loading Entries\n                  </Typography>\n                  <Typography variant=\"body1\">{error.message}</Typography>\n                </TableCell>\n              </TableRow>\n            </TableBody>\n          )\n        : (props) => <MTableBody {...props} />,\n      Row: (p) => {\n        const props = {\n          ...p,\n          onToggleDetailPanel: (path, render, ...args) => {\n            if (detailPanelState.has(p.data.id)) {\n              detailPanelState.delete(p.data.id);\n            } else {\n              detailPanelState.set(p.data.id, render);\n            }\n            return p.onToggleDetailPanel(path, render, ...args);\n          },\n        };\n        return <MTableBodyRow {...props} />;\n      },\n    }),\n    [error, columns.length, actions, detailPanelState]\n  );\n\n  const detailPanel = useMemo<\n    NonNullable<MaterialTableProps<Entry>[\"detailPanel\"]>\n  >(\n    () => [\n      (rowData) => {\n        const isJournalEntry = rowData.__typename === \"JournalEntry\";\n        const hasItems = isJournalEntry ? rowData.items.length > 0 : false;\n        return {\n          icon: (props) =>\n            isJournalEntry ? (\n              hasItems ? (\n                <FileTreeIcon {...props} />\n              ) : (\n                <FileTreeOutlineIcon {...props} />\n              )\n            ) : null,\n          openIcon: (props) =>\n            hasItems ? (\n              <FileTreeIcon {...props} color=\"primary\" />\n            ) : (\n              <FileTreeOutlineIcon {...props} color=\"primary\" />\n            ),\n          disabled: !isJournalEntry,\n          tooltip: isJournalEntry ? \"Itemize\" : undefined,\n          render: (rowData) => {\n            if (rowData.__typename !== \"JournalEntry\") {\n              return null;\n            }\n            return <ItemsTable entry={rowData} />;\n          },\n        };\n      },\n    ],\n    []\n  );\n\n  const [aggregate, setAggregate] = useState<Fraction>(new Fraction(0));\n\n  const title = useMemo(() => {\n    const compare = aggregate.compare(new Fraction(0));\n\n    const aggregateSpan = (\n      <Box\n        color={compare === 0 ? undefined : compare > 0 ? green[900] : red[900]}\n        component=\"span\"\n      >\n        {numeral(aggregate.valueOf()).format(\"$0,0.00\")}\n      </Box>\n    );\n\n    if (journalTitle) {\n      return (\n        <Typography variant=\"h6\">\n          {`${journalTitle}: `}\n          {aggregateSpan}\n        </Typography>\n      );\n    }\n    return <Typography variant=\"h6\">{aggregateSpan}</Typography>;\n  }, [aggregate, journalTitle]);\n\n  const tableRef = useRef<any>(null);\n\n  const mTData = useCallback(\n    async (query: MTQuery<Entry>): Promise<QueryResult<Entry>> => {\n      const { filters, page, pageSize, orderBy, orderDirection } = query;\n\n      const search = query.search?.trim();\n\n      const collection = (() => {\n        if (!search) {\n          return entries;\n        }\n\n        return new Fuse(entries, {\n          keys: [\n            \"date\",\n            \"total\",\n            \"description\",\n            \"department\",\n            \"category\",\n            \"paymentMethod\",\n            \"source\",\n          ],\n          threshold: 0.4,\n          useExtendedSearch: true,\n          getFn: (entry, key) => {\n            switch (key) {\n              case \"date\": {\n                const date = new Date(entry.date);\n\n                return [\n                  entry.date,\n                  format(date, \"M/d/yy\"),\n                  format(date, \"MM/d/yy\"),\n                  format(date, \"M/d/yyyy\"),\n                  format(date, \"MM/d/yyyy\"),\n                  format(date, \"MMM dd, yyyy\"),\n                ];\n              }\n              case \"total\": {\n                const total = rationalToFraction(entry.total).valueOf();\n\n                return [numeral(total).format(\"$0,0.00\"), total.toFixed(2)];\n              }\n              case \"description\":\n                return entry.description?.trim() || \"\";\n              case \"department\":\n                return entry.department.name;\n              case \"category\":\n                return entry.category.name;\n              case \"paymentMethod\":\n                return entry.paymentMethod.name;\n              case \"source\":\n                switch (entry.source.__typename) {\n                  case \"Person\":\n                    return [entry.source.name.first, entry.source.name.last];\n                  case \"Business\":\n                    return entry.source.bizName;\n                  case \"Department\":\n                    return entry.source.deptName;\n                }\n                break;\n              default:\n                return \"\";\n            }\n          },\n        })\n          .search(search)\n          .map((result) => result.item);\n      })();\n\n      const pipeline: Object[] = [];\n\n      const $match = { $and: [] as object[] };\n\n      if (filters.length > 0) {\n        const { $and } = $match;\n        for (const filter of filters) {\n          if (Object.keys(filter.value).length > 0) {\n            $and.push(filter.value);\n          }\n          // Object.assign($match, filter.value ?? {});\n        }\n      }\n\n      if ($match.$and.length > 0) {\n        pipeline.push(\n          // Convert fields for filtering\n          {\n            $addFields: {\n              // Cache date as string\n              _dateStr_: \"$date\",\n              date: {\n                $expressionCb: (obj: Entry) => startOfDay(new Date(obj.date)),\n              },\n              // Cache total as rational\n              _totalRational_: \"$total\",\n              total: {\n                $expressionCb: (obj: Entry) =>\n                  rationalToFraction(obj.total).valueOf(),\n              },\n            },\n          },\n          { $match },\n          // Replace with original values from cached keys\n          {\n            $addFields: {\n              date: \"$_dateStr_\",\n              total: \"$_totalRational_\",\n            },\n          },\n          // Remove cache keys\n          {\n            $project: {\n              _dateStr_: false,\n              _totalRational_: false,\n            },\n          }\n        );\n      }\n\n      const $facet = {\n        data: [] as object[],\n        raw: [],\n      };\n\n      // Sorting\n      if (orderBy) {\n        const { field } = orderBy;\n\n        switch (field) {\n          case \"date\":\n            $facet.data.push({\n              $addFields: {\n                _sortBy_: { $toDate: \"$date\" },\n              },\n            });\n            break;\n          case \"total\":\n            $facet.data.push({\n              $addFields: {\n                _sortBy_: {\n                  $expressionCb: (entry: Entry) =>\n                    rationalToFraction(entry.total).valueOf(),\n                },\n              },\n            });\n            break;\n          case \"reconciled\":\n            $facet.data.push({\n              $addFields: {\n                _sortBy_: \"$reconciled\",\n              },\n            });\n            break;\n          case \"department\":\n            $facet.data.push({\n              $addFields: {\n                _sortBy_: \"$department.name\",\n              },\n            });\n            break;\n          case \"category\":\n            $facet.data.push({\n              $addFields: {\n                _sortBy_: \"$category.name\",\n              },\n            });\n            break;\n          case \"paymentMethod\":\n            $facet.data.push({\n              $addFields: {\n                _sortBy_: \"$paymentMethod.name\",\n              },\n            });\n            break;\n          case \"source\":\n            // var t:Entry;\n            $facet.data.push({\n              $addFields: {\n                _sortBy_: {\n                  $cond: {\n                    if: {\n                      $eq: [{ $ifNull: [\"$source.name.first\", null] }, null],\n                    },\n                    then: \"$source.name\",\n                    else: {\n                      $concat: [\"$source.name.first\", \" \", \"$source.name.last\"],\n                    },\n                  },\n                },\n              },\n            });\n            break;\n          default:\n            $facet.data.push({\n              $addFields: {\n                _sortBy_: { $toDate: \"$date\" },\n              },\n            });\n        }\n\n        $facet.data.push(\n          {\n            $sort: {\n              _sortBy_: orderDirection === \"asc\" ? 1 : -1,\n            },\n          },\n          {\n            $project: { _sortBy_: false },\n          }\n        );\n      }\n\n      // paging\n      $facet.data.push({ $skip: page * pageSize }, { $limit: pageSize });\n\n      pipeline.push({ $facet });\n\n      const [result] = new Aggregator(pipeline).run(collection);\n\n      // https://github.com/mbrn/material-table/issues/563\n      const data = result.data.map((entry: Entry) => {\n        if (detailPanelState.has(entry.id)) {\n          return {\n            ...entry,\n            tableData: {\n              showDetailPanel: detailPanelState.get(entry.id),\n            },\n          } as any;\n        }\n\n        return entry;\n      });\n\n      const raw = result.raw;\n\n      // Cleanup detailPanelState\n      // https://github.com/mbrn/material-table/issues/563\n      (() => {\n        const copyShowDetailPanel = new Map(detailPanelState);\n        detailPanelState.clear();\n        for (const { id } of raw as Entry[]) {\n          if (copyShowDetailPanel.has(id)) {\n            detailPanelState.set(id, copyShowDetailPanel.get(id));\n          }\n        }\n      })();\n\n      const totalCount = raw.length;\n\n      const newAggregate = raw.reduce(\n        (aggregate: Fraction, entry: Entry) =>\n          entry.type === JournalEntryType.Credit\n            ? aggregate.add(rationalToFraction(entry.total))\n            : aggregate.sub(rationalToFraction(entry.total)),\n        new Fraction(0)\n      );\n\n      if (aggregate.compare(newAggregate) !== 0) {\n        setAggregate(newAggregate);\n      }\n\n      return {\n        data,\n        page,\n        totalCount,\n      };\n    },\n    [aggregate, entries, detailPanelState]\n  );\n\n  useEffect(() => {\n    if (tableRef.current) {\n      tableRef.current.onQueryChange(null);\n    }\n  }, [tableRef, entries]);\n  return (\n    <React.Fragment>\n      <MaterialTable\n        icons={tableIcons}\n        isLoading={isLoading || reconcilingEntry || reconcilingRefund}\n        columns={columns}\n        data={mTData}\n        options={options}\n        localization={localization}\n        actions={actions}\n        components={components}\n        title={title}\n        detailPanel={detailPanel}\n        tableRef={tableRef}\n      />\n      <AddEntry deptId={deptId} open={addEntryOpen} onClose={addEntryOnClose} />\n      <UpdateEntry\n        entryId={updateEntry}\n        open={updateEntryOpen}\n        onClose={updateEntryOnClose}\n        onExited={updateEntryOnExited}\n      />\n      <DeleteEntry entryId={deleteEntry} onClose={deleteEntryOnClose} />\n      <AddRefund\n        entryId={addRefundToEntry}\n        open={addRefundOpen}\n        onClose={addRefundOnClose}\n        onExited={addRefundOnExited}\n      />\n      <UpdateRefund\n        entryId={updateRefund?.entryId ?? null}\n        refundId={updateRefund?.refundId ?? null}\n        open={updateRefundOpen}\n        onClose={updateRefundOnClose}\n        onExited={updateRefundOnExited}\n      />\n      <DeleteRefund refundId={deleteRefund} onClose={deleteRefundOnClose} />\n    </React.Fragment>\n  );\n};\n\nexport default Journal;\n","import { addOperators, OperatorType, Options } from \"mingo/core\";\n\nexport interface CustomOperatorHelpers {\n  resolve(obj: object, selector: string): any;\n  computeValue(obj: object, expr: any, operator: string, options: Options): any;\n}\n\naddOperators(OperatorType.EXPRESSION, (helpers: CustomOperatorHelpers) => ({\n  $expressionCb: (\n    obj: object,\n    expr: (\n      obj: object,\n      options?: Options,\n      helpers?: CustomOperatorHelpers\n    ) => unknown,\n    options: Options\n  ) => expr(obj, options, helpers),\n}));\n\naddOperators(OperatorType.QUERY, (helpers: CustomOperatorHelpers) => ({\n  $queryCb: (\n    selector: string,\n    lhs: unknown,\n    rhs: (\n      selector: string,\n      lhs: unknown,\n      options?: Options,\n      helpers?: CustomOperatorHelpers\n    ) => boolean,\n    options: Options\n  ) => rhs(selector, lhs, options, helpers),\n}));\n","import gql from \"graphql-tag\";\n\nexport const GET_REPORT_DATA_DEPT_FRAGMENT = gql`\n  fragment GetReportDataDept_1Fragment on Department {\n    __typename\n    id\n    name\n    budget {\n      id\n      __typename\n      amount {\n        n\n        d\n        s\n      }\n    }\n  }\n`;\n\nexport const GET_REPORT_DATA_ENTRY_FRAGMENT = gql`\n  fragment GetReportDataEntry_1Fragment on JournalEntry {\n    id\n    __typename\n    category {\n      __typename\n      id\n      name\n    }\n    type\n    total {\n      n\n      d\n      s\n    }\n    department {\n      __typename\n      id\n      ancestors {\n        __typename\n        ... on Business {\n          id\n        }\n        ... on Department {\n          id\n        }\n      }\n    }\n    refunds {\n      __typename\n      id\n      total {\n        n\n        d\n        s\n      }\n      deleted\n      lastUpdate\n    }\n    lastUpdate\n    deleted\n  }\n`;\n\nexport const GET_REPORT_DATA = gql`\n  query GetReportData($deptId:ID!, $where:JournalEntiresWhereInput!) {\n    department(id:$deptId) {\n      ...GetReportDataDept_1Fragment\n      descendants {\n        ...GetReportDataDept_1Fragment\n      }\n    }\n    journalEntries(where:$where) {\n      ...GetReportDataEntry_1Fragment\n    }\n  }\n  ${GET_REPORT_DATA_DEPT_FRAGMENT},\n  ${GET_REPORT_DATA_ENTRY_FRAGMENT}\n`;\n\nexport const JOURNAL_ENTRY_ADDED_SUB = gql`\n  subscription JournalEntryAdded_2 {\n    journalEntryAdded {\n      ...GetReportDataEntry_1Fragment\n    }\n  }\n  ${GET_REPORT_DATA_ENTRY_FRAGMENT}\n`;\n\nexport const JOURNAL_ENTRY_UPDATED_SUB = gql`\n  subscription JournalEntryUpdated_2 {\n    journalEntryUpdated {\n      ...GetReportDataEntry_1Fragment\n    }\n  }\n  ${GET_REPORT_DATA_ENTRY_FRAGMENT}\n`;\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { useQuery } from \"@apollo/react-hooks\";\nimport { Link } from \"react-router-dom\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Container from \"@material-ui/core/Container\";\nimport Box from \"@material-ui/core/Box\";\nimport Button from \"@material-ui/core/Button\";\nimport Typography from \"@material-ui/core/Typography\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport DoneAllIcon from \"@material-ui/icons/DoneAll\";\nimport TableChartIcon from \"@material-ui/icons/TableChart\";\nimport AssessmentIcon from \"@material-ui/icons/Assessment\";\nimport Card from \"@material-ui/core/Card\";\nimport CardHeader from \"@material-ui/core/CardHeader\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport numeral from \"numeral\";\nimport { red, green, orange, grey } from \"@material-ui/core/colors\";\nimport gql from \"graphql-tag\";\nimport Fraction from \"fraction.js\";\n\nimport {\n  GetReportDataQuery,\n  GetReportDataQueryVariables,\n  JournalEntryType,\n  OnEntryUpsert_2Subscription as OnEntryUpsert,\n} from \"../../apollo/graphTypes\";\nimport {\n  GET_REPORT_DATA,\n  GET_REPORT_DATA_ENTRY_FRAGMENT,\n} from \"./ReportData.gql\";\nimport { DEPT_ENTRY_OPT_FRAGMENT } from \"../Journal/Upsert/upsertEntry.gql\";\nimport AddEntry from \"../Journal/Upsert/Entries/AddEntry\";\nimport { rationalToFraction } from \"../../utils/rational\";\n\nconst colorMeter = (percentSpent: number, shade = 800) => {\n  if (percentSpent < 0.75) {\n    return green[shade];\n  } else if (percentSpent < 0.9) {\n    return orange[shade];\n  } else {\n    return red[shade];\n  }\n};\n\nconst BudgetMeter = (props: { spentPercentage: number; height: number }) => {\n  const { spentPercentage, height } = props;\n\n  return (\n    <Box\n      height={height}\n      bgcolor={colorMeter(spentPercentage)}\n      display=\"flex\"\n      justifyContent=\"flex-start\"\n    >\n      <Box\n        height=\"100%\"\n        width={`${100 * spentPercentage}%`}\n        bgcolor={grey[400]}\n      />\n    </Box>\n  );\n};\n\ninterface DeptReportObj {\n  name: string;\n  spent: Fraction;\n  budget: Fraction | null;\n}\n\nexport const DEPT_FOR_UPSERT_ADD = gql`\n  query DeptForUpsertAdd($id: ID!) {\n    department(id: $id) {\n      ...DeptEntryOptFragment\n    }\n  }\n  ${DEPT_ENTRY_OPT_FRAGMENT}\n`;\n\nconst ON_ENTRY_UPSERT = gql`\n  subscription OnEntryUpsert_2 {\n    journalEntryUpserted {\n      ...GetReportDataEntry_1Fragment\n      department {\n        ancestors {\n          ... on Department {\n            __typename\n            id\n          }\n        }\n      }\n    }\n  }\n  ${GET_REPORT_DATA_ENTRY_FRAGMENT}\n`;\n\nconst Dashboard = function (props: { deptId: string }) {\n  const { deptId } = props;\n\n  const [addEntryOpen, setAddEntryOpen] = useState<boolean>(false);\n  const addEntryOnClose = useCallback(() => void setAddEntryOpen(false), [\n    setAddEntryOpen,\n  ]);\n\n  const variables = useMemo(\n    () => ({\n      deptId,\n      where: {\n        department: { eq: deptId, matchDecedentTree: true },\n        deleted: false,\n      },\n    }),\n    [deptId]\n  );\n\n  const { loading, error, data, subscribeToMore } = useQuery<\n    GetReportDataQuery,\n    GetReportDataQueryVariables\n  >(GET_REPORT_DATA, {\n    variables,\n    fetchPolicy: \"cache-and-network\",\n  });\n\n  const isLoading = loading && !data?.journalEntries;\n\n  // Subscribe to updates\n  useEffect(() => {\n    return subscribeToMore<OnEntryUpsert>({\n      document: ON_ENTRY_UPSERT,\n      updateQuery: (prev, { subscriptionData }) => {\n        if (!subscriptionData.data) {\n          return prev;\n        }\n\n        const upsertEntry = subscriptionData.data.journalEntryUpserted;\n\n        const ancestors = upsertEntry.department.ancestors;\n\n        if (\n          deptId &&\n          upsertEntry.department.id !== deptId &&\n          ancestors.every((dept) => (dept as any).id !== deptId)\n        ) {\n          // Filter entry out of query results if department changes.\n          const journalEntriesFiltered = prev.journalEntries.filter(\n            (entry) => entry.id !== upsertEntry.id\n          );\n\n          if (journalEntriesFiltered.length === prev.journalEntries.length) {\n            return prev;\n          }\n\n          return Object.assign({}, prev, {\n            journalEntries: journalEntriesFiltered,\n          });\n        }\n\n        // Apollo will take care of updating if entry already exists in cache.\n        if (prev.journalEntries.some((entry) => entry.id === upsertEntry.id)) {\n          return prev;\n        }\n\n        return Object.assign({}, prev, {\n          journalEntries: [upsertEntry, ...prev.journalEntries],\n        });\n      },\n    });\n  }, [deptId, subscribeToMore]);\n\n  const entries = useMemo(() => {\n    return (data?.journalEntries || []).filter((entry) => !entry.deleted);\n  }, [data]);\n  const deptName = data?.department?.name || \"\";\n\n  useEffect(() => {\n    document.title = deptName;\n  }, [deptName]);\n\n  const department = data?.department || null;\n\n  const {\n    totalRemaining,\n    budget,\n    spentToBudgetRatio,\n    deptReport,\n  } = useMemo(() => {\n    // Generate department report objects\n    const deptReport = new Map<string, DeptReportObj>();\n    let subDeptBudgetAg = new Fraction(0);\n\n    if (department) {\n      const budget = department.budget\n        ? rationalToFraction(department.budget.amount)\n        : null;\n\n      deptReport.set(department.id, {\n        name: department.name,\n        spent: new Fraction(0),\n        budget,\n      });\n\n      for (const subDept of department.descendants) {\n        let budget: null | Fraction = null;\n\n        if (subDept.budget) {\n          const subBudget = rationalToFraction(subDept.budget.amount);\n          subDeptBudgetAg = subDeptBudgetAg.add(subBudget);\n          budget = subBudget;\n        }\n\n        deptReport.set(subDept.id, {\n          name: subDept.name,\n          spent: new Fraction(0),\n          budget,\n        });\n      }\n    }\n\n    // Calculating aggregate depts and credits\n    let spent = new Fraction(0);\n    for (const entry of entries) {\n      if (entry.deleted) {\n        continue;\n      }\n      const deptReportObj = deptReport.get(\n        entry.department.id\n      ) as DeptReportObj;\n\n      let entryTotal = rationalToFraction(entry.total);\n\n      // Aggregate refunds\n      for (const refund of entry.refunds) {\n        if (refund.deleted) {\n          continue;\n        }\n        entryTotal = entryTotal.sub(rationalToFraction(refund.total));\n      }\n\n      if (entry.type === JournalEntryType.Credit) {\n        spent = spent.sub(entryTotal);\n        deptReportObj.spent = deptReportObj.spent.sub(entryTotal);\n      } else {\n        spent = spent.add(entryTotal);\n        deptReportObj.spent = deptReportObj.spent.add(entryTotal);\n      }\n    }\n\n    // Format values\n    const budgetF = department?.budget\n      ? rationalToFraction(department.budget.amount)\n      : subDeptBudgetAg;\n\n    const totalRemaining = numeral(budgetF.sub(spent).valueOf()).format(\n      \"$0,0.00\"\n    );\n    const budget = numeral(budgetF.valueOf()).format(\"$0,0.00\");\n    const spentToBudgetRatio =\n      budgetF.n === 0 ? new Fraction(1) : spent.div(budgetF);\n\n    return {\n      totalRemaining,\n      budget,\n      spentToBudgetRatio,\n      deptReport,\n    };\n  }, [entries, department]);\n\n  const subDeptCards = useMemo(() => {\n    const subDeptCards: JSX.Element[] = [];\n\n    for (const [id, { budget, spent, name }] of deptReport) {\n      // Do not include root department\n      if (id === department?.id) {\n        continue;\n      }\n\n      const card = (\n        <Grid key={id} item xs={12} md={4} lg={3}>\n          <Card>\n            <CardHeader\n              titleTypographyProps={{\n                noWrap: true,\n              }}\n              title={name}\n            />\n            <CardContent>\n              {(() => {\n                if (budget === null) {\n                  return (\n                    <Box\n                      color={\n                        spent.compare(new Fraction(0)) > 0\n                          ? red[900]\n                          : green[900]\n                      }\n                      clone\n                    >\n                      <Typography variant=\"h6\">\n                        {`Spent: ${numeral(spent.abs().valueOf()).format(\n                          \"$0,0.00\"\n                        )}`}\n                      </Typography>\n                    </Box>\n                  );\n                }\n\n                const totalRemaining = budget.sub(spent);\n\n                return (\n                  <React.Fragment>\n                    <Box\n                      color={colorMeter(spent.div(budget).valueOf(), 900)}\n                      clone\n                    >\n                      <Typography variant=\"h6\">{`${numeral(\n                        totalRemaining.valueOf()\n                      ).format(\"$0,0.00\")} Remaining`}</Typography>\n                    </Box>\n                    <Typography variant=\"body1\">{`of ${numeral(\n                      budget.valueOf()\n                    ).format(\"$0,0.00\")}`}</Typography>\n                    <BudgetMeter\n                      spentPercentage={spent.div(budget).valueOf()}\n                      height={5}\n                    />\n                  </React.Fragment>\n                );\n              })()}\n            </CardContent>\n          </Card>\n        </Grid>\n      );\n\n      subDeptCards.push(card);\n    }\n\n    return subDeptCards;\n  }, [deptReport, department]);\n\n  const onClickAddEntry = useCallback((event?) => setAddEntryOpen(true), [\n    setAddEntryOpen,\n  ]);\n\n  if (isLoading) {\n    return <p>Loading...</p>;\n  } else if (error) {\n    console.error(error);\n    return <p>{error.message}</p>;\n  }\n\n  return (\n    <Box display=\"flex\" flexDirection=\"column\" overflow=\"hidden\" clone>\n      <Container>\n        <Box padding={8}>\n          <Grid container alignItems=\"center\" justify=\"center\" spacing={4}>\n            <Grid item>\n              <Button\n                variant=\"contained\"\n                color=\"secondary\"\n                startIcon={<AddIcon />}\n                children={\"New Entry\"}\n                onClick={onClickAddEntry}\n              />\n            </Grid>\n            <Grid item>\n              <Button\n                component={Link}\n                to={`/journal/${deptId}/reconcile`}\n                variant=\"contained\"\n                startIcon={<DoneAllIcon />}\n                children={\"Reconcile\"}\n              />\n            </Grid>\n            <Grid item>\n              <Button\n                variant=\"contained\"\n                startIcon={<AssessmentIcon />}\n                children={\"Reports\"}\n              />\n            </Grid>\n            <Grid item>\n              <Button\n                component={Link}\n                to={`/journal/${deptId}`}\n                variant=\"contained\"\n                startIcon={<TableChartIcon />}\n                children={\"Journal\"}\n              />\n            </Grid>\n          </Grid>\n        </Box>\n        <Box flexGrow={1} overflow=\"auto\">\n          <Grid justify=\"center\" container spacing={2}>\n            <Grid item xs={12}>\n              <Typography align=\"center\" variant=\"h3\">\n                {deptName}\n              </Typography>\n              <Box color={colorMeter(spentToBudgetRatio.valueOf())}>\n                <Typography align=\"center\" variant=\"h4\">\n                  {`${totalRemaining} Remaining`}\n                </Typography>\n              </Box>\n              <Typography align=\"center\" variant=\"subtitle1\">\n                {`of ${budget}`}\n              </Typography>\n              <BudgetMeter\n                spentPercentage={spentToBudgetRatio.valueOf()}\n                height={10}\n              />\n            </Grid>\n            {subDeptCards}\n          </Grid>\n        </Box>\n        <AddEntry\n          deptId={deptId}\n          open={addEntryOpen}\n          onClose={addEntryOnClose}\n        />\n      </Container>\n    </Box>\n  );\n};\n\nexport default Dashboard;\n","import React, {useCallback, useEffect, useState, useMemo} from \"react\";\nimport {useQuery} from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Container from \"@material-ui/core/Container\";\nimport Box from \"@material-ui/core/Box\";\nimport {Link} from \"react-router-dom\";\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\n\nimport {DeptsForNav_1Query as DeptsForNavQuery} from \"../apollo/graphTypes\";\n\nconst DEPTS_FOR_NAV = gql`\n  query DeptsForNav_1 {\n    departments {\n      __typename\n      id\n      name\n      parent {\n        __typename\n        ...on Business {\n          id\n        }\n        ...on Department {\n          id\n        }\n      }\n      virtualRoot\n    }\n  }\n`;\n\nconst TopNav = function(props) {\n\n  const {loading, error, data} = useQuery<DeptsForNavQuery>(DEPTS_FOR_NAV);\n\n  const [value, setValue] = useState<string | null>(null);\n\n  const depts = (data?.departments || []);\n\n  type Department = typeof depts[0];\n\n  const {rootDepts, virtualRoots} = useMemo(() => {\n    \n    const rootDepts:Department[] = [];\n    const virtualRoots = new Set<string>();\n\n    for(const dept of depts) {\n      \n      if(dept.parent.__typename === \"Business\") {\n        rootDepts.push(dept);\n      }\n\n      if(dept.virtualRoot) {\n        virtualRoots.add(dept.id);\n      }\n\n    }\n\n    return {rootDepts, virtualRoots};\n\n  },[depts]);\n\n  const subDepts =  useMemo(() => {\n\n    const subDepts:Department[] = [];\n\n    if(value && virtualRoots.has(value)) {\n      \n      for(const dept of depts) {\n  \n        if(dept.parent.id === value) {\n  \n          subDepts.push(dept);\n  \n        }\n  \n      }\n\n    }\n\n    return subDepts;\n\n  }, [virtualRoots, value, depts]);\n\n  useEffect(() => { document.title = \"Select Department\"; });\n\n  const onChange = useCallback((event?) => {\n    setValue(event?.target?.value || null);\n  },[setValue]);\n  \n  if(loading) {\n    return <p>Loading...</p>;\n  } else if(error) {\n    return <p>{error.message}</p>;\n  }\n\n\n  const showSubDepts = subDepts.length > 0;\n\n  return <Box\n    flexGrow={1}\n    display=\"flex\"\n    justifyContent=\"center\"\n    alignItems=\"center\"\n    flexDirection=\"column\"\n    clone\n  >\n    <Container>\n      <Box padding={4} clone>\n        <Typography align=\"center\" color=\"primary\" variant=\"h3\">\n          Select Department\n        </Typography>\n      </Box>\n      <Box minWidth=\"250px !important\" clone>\n        <FormControl variant=\"filled\">\n          <InputLabel>Department</InputLabel>\n          <Select\n            value={value} \n            onChange={onChange}\n            autoWidth\n          >{rootDepts.map((dept) => {\n            \n            const props = {\n              component:Link,\n              to:`/department/${dept.id}`,\n              key:dept.id,\n              value:dept.id,\n              children:dept.name\n            }  as any;\n\n            if(dept.virtualRoot) {\n              delete props.component;\n              delete props.to;\n            }\n\n            return <MenuItem {...props}/>;\n          \n          })}</Select>\n        </FormControl>\n      </Box>\n      {showSubDepts &&\n        <Box pt={2}>\n          <Box pt={2} minWidth=\"250px !important\" clone>\n            <FormControl variant=\"filled\">\n              <InputLabel>Sub Department</InputLabel>\n              <Select autoWidth>{subDepts.map((dept) => {\n                  const props = {\n                    component:Link,\n                    to:`/department/${dept.id}`,\n                    key:dept.id,\n                    value:dept.id,\n                    children:dept.name\n                  }  as any;\n      \n                  return <MenuItem {...props}/>;\n              })}</Select>\n            </FormControl>\n        </Box>\n      </Box>}\n        \n    </Container>\n   </Box>;\n\n}\n\nexport default TopNav;","import React from \"react\";\nimport { Route, Switch, useParams } from \"react-router-dom\";\n\n// import Journal from \"./components/Journal/Table/Journal\";\nimport Journal from \"./components/Journal/Table/Journal\";\nimport { JournalMode } from \"./components/Journal/Table/Journal\";\nimport Dashboard from \"./components/Dashboard/Dashboard\";\nimport TopNav from \"./components/TopNav\";\nimport { useQuery } from \"@apollo/react-hooks\";\nimport { DepartmentName_1Query as DepartmentName } from \"./apollo/graphTypes\";\nimport gql from \"graphql-tag\";\n\nconst DashBoardRender = (props) => {\n  const { id } = useParams();\n  return id ? <Dashboard deptId={id} /> : <div>Error: No Dept ID!</div>;\n};\n\nconst DEPARTMENT_NAME = gql`\n  query DepartmentName_1($id: ID!) {\n    department(id: $id) {\n      id\n      __typename\n      name\n    }\n  }\n`;\n\nconst JournalViewRender = (props) => {\n  const { id } = useParams();\n  const { loading, error, data } = useQuery<DepartmentName>(DEPARTMENT_NAME, {\n    variables: { id },\n  });\n  const journalTitle = data?.department?.name\n    ? data.department.name\n    : undefined;\n  return (\n    <Journal mode={JournalMode.View} deptId={id} journalTitle={journalTitle} />\n  );\n};\n\nconst JournalReconcileRender = (props) => {\n  const { id } = useParams();\n  const { loading, error, data } = useQuery<DepartmentName>(DEPARTMENT_NAME, {\n    variables: { id },\n  });\n  const journalTitle = data?.department?.name\n    ? `Reconcile ${data.department.name}`\n    : \"Reconcile\";\n  return (\n    <Journal\n      mode={JournalMode.Reconcile}\n      deptId={id}\n      journalTitle={journalTitle}\n    />\n  );\n};\n\nconst Routes = (props) => {\n  return (\n    <Switch>\n      <Route exact path=\"/\" component={TopNav} />\n      <Route exact path=\"/department/:id\" component={DashBoardRender} />\n      <Route exact path=\"/journal\" component={Journal} />\n      <Route exact path=\"/journal/:id\" component={JournalViewRender} />\n      <Route\n        exact\n        path=\"/journal/:id/reconcile\"\n        component={JournalReconcileRender}\n      />\n    </Switch>\n  );\n};\n\nexport default Routes;\n","import React, { Fragment } from \"react\";\nimport { ApolloProvider } from \"@apollo/react-hooks\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\n\nimport client from \"./apollo/apollo\";\nimport Routes from \"./Routes\";\n\nexport default function App() {\n  return (\n    <Fragment>\n      <CssBaseline />\n      <ApolloProvider client={client}>\n        <Router>\n          <Routes />\n        </Router>\n      </ApolloProvider>\n    </Fragment>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\n    \nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n\n"],"sourceRoot":""}