{"version":3,"sources":["apollo/inMemoryCache.ts","apollo/schema/upsertJournalEntry.gql.ts","apollo/graphTypes.ts","apollo/typeDefs.ts","apollo/resolvers.ts","apollo/link.ts","apollo/apollo.ts","components/Journal/Table/JournalEntries.gql.ts","components/Journal/constants.ts","components/Journal/Upsert/Refunds/submitAdd.ts","formik/utils.ts","components/Journal/Upsert/EntryFields/DateEntry.tsx","components/Journal/Upsert/EntryFields/Description.tsx","components/Journal/Upsert/EntryFields/Total.tsx","utils/transmutations.ts","components/Journal/Upsert/EntryFields/Reconcile.tsx","components/Journal/Upsert/upsertEntry.gql.ts","components/Journal/Upsert/EntryFields/PaymentMethod.tsx","components/Utils/Overlay.tsx","components/Utils/OverlayLoading.tsx","components/Journal/Upsert/Refunds/refunds.gql.ts","components/Journal/Upsert/Refunds/AddRefund.tsx","components/Journal/Upsert/Refunds/submitUpdate.ts","components/Journal/Upsert/Refunds/UpdateRefund.tsx","components/Journal/Upsert/Entries/submitAdd.ts","components/Journal/Upsert/EntryFields/Category.tsx","components/Journal/Upsert/EntryFields/Department.tsx","components/Journal/Upsert/EntryFields/Source.tsx","components/Journal/Upsert/EntryFields/Type.tsx","components/Journal/Upsert/Entries/AddEntry.tsx","components/Journal/Upsert/Entries/submitUpdate.ts","components/Journal/Upsert/Entries/UpdateEntry.tsx","components/Journal/Upsert/Entries/DeleteEntry.tsx","components/Journal/Upsert/Refunds/DeleteRefund.tsx","components/Journal/Upsert/Items/submitAdd.ts","components/Journal/Upsert/Items/items.gql.ts","components/Journal/Upsert/Items/AddItem.tsx","components/Journal/Upsert/Items/submitUpdate.ts","components/Journal/Upsert/Items/UpdateItem.tsx","components/Journal/Upsert/Items/DeleteItem.tsx","components/Journal/Table/Journal.tsx","components/Dashboard/ReportData.gql.ts","components/Dashboard/Dashboard.tsx","components/TopNav.tsx","Routes.tsx","redux/reducers/journalEntryUpserts.ts","redux/actionTypes/journalEntryUpsert.ts","redux/reducers/utils.ts","redux/actionTypes/tableRow.ts","redux/reducers/tableRows.ts","redux/actionTypes/journal.ts","redux/reducers/journal.ts","redux/reducers/root.ts","redux/store.ts","App.tsx","serviceWorker.js","index.js"],"names":["fragmentMatcher","IntrospectionFragmentMatcher","introspectionQueryResultData","inMemoryCache","InMemoryCache","addTypename","gql","CacheControlScope","FilterType","JournalEntrySourceType","JournalEntryType","Lc_JournalEntryUpsertSubmitStatus","Lc_JournalEntryUpsertType","SortDirection","resolvers","batchHttpLink","BatchHttpLink","uri","credentials","wsLink","WebSocketLink","window","location","host","options","reconnect","link","ApolloLink","from","onError","graphQLErrors","networkError","forEach","message","locations","path","console","error","log","split","query","def","getMainDefinition","kind","operation","ApolloClient","cache","typeDefs","JOURNAL_ENTRY_PAY_METHOD_FRAGMENT","JOURNAL_ENTRY_CATEGORY_FRAGMENT","JOURNAL_ENTRY_DEPT_FRAGMENT","JOURNAL_ENTRY_REFUND","JOURNAL_ENTRY_ITEM","JOURNAL_ENTRY_FRAGMENT","JOURNAL_ENTRIES","CHECK_ID","FormikStatusType","ADD_REFUND","submitAdd","client","id","values","a","payMethod","paymentMethod","value","length","paymentMethodAdd","parent","refId","name","active","variables","fields","date","description","trim","total","reconciled","mutate","mutation","createValueTransmutator","transMutator","inputValue","rest","useFormikStatus","useFormikContext","setStatusNative","setStatus","status","useCallback","args","Object","keys","some","key","inputProps","inputMode","keyboardButtonProps","tabIndex","dateValueTransmutator","isValid","formatISO","DateField","props","variant","inputVariant","autoFocus","disabled","maxDate","Date","minDate","isSubmitting","validate","dateStr","parseISO","format","useField","field","meta","helpers","touched","setValue","setTouched","initialInputValue","initialValue","initialFocusedDate","useMemo","InputProps","calOpen","useRef","onBlur","setTimeout","current","onOpen","onClose","onChange","min","formikStatus","dataPickerProps","type","FATAL_ERROR","helperText","undefined","animateYearScrolling","disableToolbar","disableFuture","margin","label","autoOk","placeholder","KeyboardButtonProps","utils","DateFnsUtils","Description","textFieldProps","event","target","trimLeft","TextField","step","totalValueTransmutator","number","fractionDigits","Fraction","Number","parseFloat","toFixed","num","n","den","d","getRational","Total","maxTotal","MAX_SAFE_INTEGER","minTotal","minTotalProp","Math","max","isNaN","numeral","startAdornment","InputAdornment","position","required","Reconcile","customProps","FormControlLabel","control","Checkbox","DEPT_ENTRY_OPT_FRAGMENT","CAT_ENTRY_OPT_FRAGMENT","SRC_ENTRY_PERSON_OPT_FRAGMENT","SRC_ENTRY_DEPT_OPT_FRAGMENT","SRC_ENTRY_BIZ_OPT_FRAGMENT","PAY_METHOD_ENTRY_OPT_FRAGMENT","PAY_METHOD_ENTRY_OPTS","payMethodValue","numValues","curValue","match","join","getOptionLabel","opt","renderTags","getTagProps","lastIndex","map","index","endAdornment","isLastIndex","isString","ChevronRight","fontSize","Box","display","flexDirection","alignItems","justifyContent","Chip","color","size","PaymentMethod","useState","hasFocus","setHasFocus","onBlurField","where","hasParent","eq","setFormikStatus","msg","useQuery","skip","loading","gqlError","data","paymentMethods","hasOptions","freeSolo","disableTextInput","renderInput","params","onFocus","persist","onInputChange","reason","trimStart","autoCompleteProps","multiple","open","autoSelect","Autocomplete","Overlay","theme","useTheme","opacity","boxProps","overflow","width","top","bottom","bgcolor","fade","palette","background","paper","OverlayLoading","children","CircularProgress","JOURNAL_FRAGMENT","GET_ENTRY_REFUND_INFO","NULLISH","Symbol","AddRefundDialog","entryId","onExitedCb","onExited","handleSubmit","resetForm","journalEntry","refunds","totalRefunds","reduce","deleted","ERROR","generalError","fatalError","journalEntryType","title","Credit","Dialog","disableBackdropClick","disableEscapeKeyDown","fullWidth","maxWidth","PaperProps","component","onSubmit","DialogTitle","style","main","zIndex","padding","DialogContentText","DialogContent","dividers","Grid","container","spacing","item","lg","sm","xs","DateEntry","justify","md","DialogActions","Button","startIcon","Add","Cancel","onClick","AddRefund","initialValues","useApolloClient","formikHelpers","initialStatus","enableReinitialize","UPDATE_REFUND","submitUpdate","iniValues","isEqual","iniPayMethod","slice","reverse","paymentMethodUpdate","UPDATE_REFUND_INI_STATE","UpdateRefundDialog","refundId","UpdateRefund","journalEntryRefund","ancestors","sort","b","push","ADD_ENTRY","srcType","source","src","Person","parsedName","parseName","sourceType","businessAdd","personAdd","first","firstName","last","lastName","Business","__typename","Department","department","category","CAT_OPTS_QUERY","dept","Category","formikContext","disabledFromProps","entryTypeFromProps","entryType","catValue","onCompleted","validateField","catOpts","transmutationVal","useEffect","forcePopupIcon","DEPT_OPTS_QUERY","fromParent","depts","deptOpts","setInputValue","deptValue","idDeptMap","Map","idDepts","has","parentDept","get","unshift","deptId","filter","Array","isArray","len","JSON","stringify","SRC_ENTRY_OPTS_QUERY","isFreeSoloOpt","personName","filterOptions","regex","RegExp","test","srcValue","Source","searchedName","isBiz","businesses","bizOpt","departments","deptOpt","set","people","srcValueIndex","formattedSrcStrs","str","namecase","formattedStr","charAt","toUpperCase","substring","toLowerCase","Type","toggleButtonGroupProps","exclusive","Promise","resolve","pl","clone","ToggleButtonGroup","ToggleButton","Tooltip","arrow","placement","Debit","FormControl","labelPlacement","FormHelperText","gridEntryResponsiveProps","DEPT_INI_VALUE","AddEntryDialog","submitForm","onClickAdd","onClickAddAndNew","preventDefault","Fragment","Queue","AddEntry","UPDATE_ENTRY","iniSrcType","iniSrc","UPDATE_ENTRY_INI_STATE","MAX_DATE","UpdateEntryDialog","UpdateEntry","ancestorDeptQueue","ancestor","bizAncestor","ancestorDepts","indexOf","DELETE_ENTRY","DeleteEntry","useMutation","deleteEntry","hasError","onDelete","then","Delete","DELETE_REFUND","DeleteRefund","deleteRefund","ADD_ENTRY_ITEM","ENTRY_ITEM_STATE","AddItemDialog","items","totalItems","sum","add","rational","addRational","toString","rationalToDecimal","sub","subRational","AddItem","UPDATE_ITEM","UPDATE_ITEM_INI_STATE","UpdateItemDialog","itemId","UpdateItem","journalEntryItem","JournalMode","DELETE_ITEM","DeleteItem","deleteItem","tableIcons","forwardRef","ref","AddBox","Check","Clear","DeleteOutline","DetailPanel","Edit","Export","SaveAlt","Filter","FilterList","FirstPage","LastPage","NextPage","PreviousPage","ChevronLeft","ResetSearch","Search","SortArrow","ArrowDownward","ThirdStateCheck","Remove","ViewColumn","entriesGen","entry","mode","refundType","refund","ON_ENTRY_UPSERT","RECONCILE_ENTRY","RECONCILE_REFUND","Journal","journalTitle","addEntryOpen","setAddEntryOpen","addEntryOnClose","updateEntryOpen","setUpdateEntryOpen","updateEntry","setUpdateEntry","updateEntryOnClose","updateEntryOnExited","setDeleteEntry","deleteEntryOnClose","addRefundOpen","setAddRefundOpen","addRefundToEntry","setAddRefundToEntry","addRefundOnClose","addRefundOnExited","updateRefundOpen","setUpdateRefundOpen","updateRefund","setUpdateRefund","updateRefundOnClose","updateRefundOnExited","setDeleteRefund","deleteRefundOnClose","addItemOpen","setAddItemOpen","addItemToEntry","setAddItemToEntry","addItemOnClose","addItemOnExited","updateItemOpen","setUpdateItemOpen","updateItem","setUpdateItem","setDeleteItem","deleteItemOnClose","updateItemOnClose","updateItemOnExited","reconcileEntry","reconcilingEntry","reconcileRefund","reconcilingRefund","matchDecedentTree","fetchPolicy","subscribeToMore","isLoading","journalEntries","document","updateQuery","prev","subscriptionData","upsertEntry","journalEntryUpserted","every","journalEntriesFiltered","assign","columns","render","Done","sorting","searchable","customSort","customFilterAndSearch","hidden","filtering","totalA","totalB","Fuse","threshold","useExtendedSearch","search","defaultSort","dateA","dateB","getTime","capitalCase","dataA","dataB","categoryA","categoryB","nameA","nameB","bizName","deptName","sourceA","sourceB","paymentMethodA","paymentMethodB","departmentA","departmentB","localization","toolbar","searchTooltip","nRowsSelected","parentChildData","child","parents","find","Set","expandedItems","setExpandedItems","onTreeExpandChange","isExpanded","delete","rowStyle","green","red","backgroundColor","cyan","amber","maxBodyHeight","headerStyle","pageSize","pageSizeOptions","showTitle","selection","showSelectAllCheckbox","debounceInterval","emptyRowsWhenPaging","columnsButton","actions","icon","CheckCircle","tooltip","iconProps","rowData","all","DeleteIcon","isCredit","FileTreeIcon","AddCircle","isFreeAction","components","Body","TableBody","TableRow","colSpan","align","Typography","Row","tableData","isTreeExpanded","entries","filters","icons","GET_REPORT_DATA_DEPT_FRAGMENT","GET_REPORT_DATA_ENTRY_FRAGMENT","GET_REPORT_DATA","colorMeter","percentSpent","shade","orange","BudgetMeter","spentPercentage","height","grey","Dashboard","deptReport","subDeptBudgetAg","budget","amount","spent","descendants","subDept","subBudgetDec","deptReportObj","entryTotal","budgetDec","totalRemaining","spentToBudgetRatio","subDeptCards","card","Card","CardHeader","titleTypographyProps","noWrap","CardContent","abs","onClickAddEntry","Container","Link","to","flexGrow","DEPTS_FOR_NAV","TopNav","rootDepts","virtualRoots","virtualRoot","subDepts","showSubDepts","minWidth","InputLabel","Select","autoWidth","MenuItem","pt","SubmitStatus","DashBoardRender","useParams","DEPARTMENT_NAME","JournalViewRender","View","JournalReconcileRender","Routes","exact","CREATE","CANCEL","CLEAR","SET_SUBMIT_ERROR","CLEAR_SUBMIT_ERROR","SET_DATE_INPUT","CLEAR_DATE_INPUT","SET_DATE_VALUE","CLEAR_DATE_VALUE","SET_DATE_ERROR","CLEAR_DATE_ERROR","SET_DEPT_INPUT","CLEAR_DEPT_INPUT","SET_DEPT_VALUE","CLEAR_DEPT_VALUE","SET_DEPT_ERROR","CLEAR_DEPT_ERROR","SET_DEPT_OPEN","SET_TYPE_VALUE","SET_TYPE_ERROR","CLEAR_TYPE_ERROR","SET_CAT_INPUT","CLEAR_CAT_INPUT","SET_CAT_VALUE","CLEAR_CAT_VALUE","SET_CAT_ERROR","CLEAR_CAT_ERROR","SET_CAT_OPEN","SET_SRC_TYPE","SET_SRC_INPUT","CLEAR_SRC_INPUT","SET_SRC_VALUE","CLEAR_SRC_VALUE","SET_SRC_ERROR","CLEAR_SRC_ERROR","SET_SRC_OPEN","SET_PAY_METHOD_VALUE","CLEAR_PAY_METHOD_VALUE","SET_PAY_METHOD_ERROR","CLEAR_PAY_METHOD_ERROR","SET_DSCRPT_VALUE","CLEAR_DSCRPT_VALUE","SET_TOTAL_INPUT","CLEAR_TOTAL_INPUT","SET_TOTAL_VALUE","CLEAR_TOTAL_VALUE","SET_TOTAL_ERROR","CLEAR_TOTAL_ERROR","SET_RECONCILED_VALUE","CLEAR_RECONCILED_VALUE","InputValue","nullValue","input","this","reduceOneById","state","action","idKey","reducer","i","newEntry","combineReducers","payload","fromDept","journalEntryUpsert","upsertId","submit","NotSubmitted","SET_INDEX","SET_DEFAULT_INDEX","SET_NAME","SET_DEFAULT_NAME","SET_WIDTH","SET_DEFAULT_WIDTH","COLLAPSE","EXPAND","HIDE","SHOW","RESTORE_DEFAULTS","TableCell","ini","rowId","collapsed","tableCell","defaultState","iterateCellByIndex","row","unIndexedCells","indexedCells","nextIndex","hasOwnProperty","cell","tableRow","curIndex","newIndex","newState","curCell","newCell","OPEN_PAB","CLOSE_PAB","pab","journal","pabs","pabId","curPAB","newPAB","root","journalEntryUpserts","tableRows","curRow","newRow","store","configureStore","App","CssBaseline","Boolean","hostname","ReactDOM","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.585ca2a8.chunk.js","sourcesContent":["import {\n  InMemoryCache,\n  IntrospectionFragmentMatcher,\n} from \"apollo-cache-inmemory\";\n\nimport introspectionQueryResultData from \"./fragmentTypes.json\";\n\nconst fragmentMatcher = new IntrospectionFragmentMatcher({\n  introspectionQueryResultData,\n});\n\nconst inMemoryCache = new InMemoryCache({ fragmentMatcher, addTypename: true });\n\nexport default inMemoryCache;\n","import gql from 'graphql-tag';\n\nexport default gql`\n\n  type LC_JournalEntryUpsertSource {\n    sourceType:JournalEntrySourceType!\n    id:ID!\n  }\n\n  type LC_JournalEntryUpsertFields {\n    id:ID\n    date:String\n    department:[ID!]!\n    type:ID\n    paymentMethod:ID\n    total:Rational\n    source:[LC_JournalEntryUpsertSource!]!\n  }\n\n  type LC_JournalEntryUpsertInputValues {\n    deptInput:String\n    totalInput:String\n    srcInput:String\n    srcType:JournalEntrySourceType\n  }\n\n  type LC_JournalEntryUpsertInputErrors {\n    dateError:String\n    deptError:String\n    typeError:String\n    payMethodError:String\n    totalError:String\n    srcError:String\n  }\n\n  enum LC_JournalEntryUpsertSubmitStatus {\n    NOT_SUBMITTED\n    SUBMITTING\n    SUBMITTED\n  }\n\n  enum LC_JournalEntryUpsertType {\n    UPDATE\n    ADD\n  }\n\n  type LC_JournalEntryUpsert {\n    id:ID!\n    valid:Boolean!\n    type:LC_JournalEntryUpsertType!\n    submitStatus:LC_JournalEntryUpsertSubmitStatus!\n    submitError:String\n    inputValues:LC_JournalEntryUpsertInputValues!\n    inputErrors:LC_JournalEntryUpsertInputErrors!\n    fields:LC_JournalEntryUpsertFields!\n  }\n\n  extend type Query {\n    lc_journalEntryUpserts:[LC_JournalEntryUpsert!]!\n  }\n  \n`;","import { GraphQLResolveInfo, GraphQLScalarType, GraphQLScalarTypeConfig } from 'graphql';\nimport { Context } from './types';\nexport type Maybe<T> = T | null;\nexport type Omit<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>;\nexport type RequireFields<T, K extends keyof T> = { [X in Exclude<keyof T, K>]?: T[X] } & { [P in K]-?: NonNullable<T[P]> };\n/** All built-in and custom scalars, mapped to their actual values */\nexport type Scalars = {\n  ID: string;\n  String: string;\n  Boolean: boolean;\n  Int: number;\n  Float: number;\n  /** The `Upload` scalar type represents a file upload. */\n  Upload: any;\n};\n\nexport type Budget = {\n   __typename?: 'Budget';\n  id: Scalars['ID'];\n  amount: Rational;\n  owner: BudgetOwner;\n};\n\nexport type BudgetOwner = Department | Business;\n\nexport type Business = {\n   __typename?: 'Business';\n  id: Scalars['ID'];\n  name: Scalars['String'];\n  budget?: Maybe<Budget>;\n  departments: Array<Department>;\n  vendor?: Maybe<Vendor>;\n};\n\nexport type BusinessAddFields = {\n  name: Scalars['String'];\n};\n\nexport type ByIdFilter = {\n  eq?: Maybe<Scalars['ID']>;\n};\n\nexport enum CacheControlScope {\n  Public = 'PUBLIC',\n  Private = 'PRIVATE'\n}\n\nexport type Department = {\n   __typename?: 'Department';\n  id: Scalars['ID'];\n  name: Scalars['String'];\n  code?: Maybe<Scalars['String']>;\n  budget?: Maybe<Budget>;\n  business: Business;\n  parent: DepartmentAncestor;\n  ancestors: Array<DepartmentAncestor>;\n  descendants: Array<Department>;\n  virtualRoot?: Maybe<Scalars['Boolean']>;\n};\n\nexport type DepartmentAddFields = {\n  name: Scalars['String'];\n};\n\nexport type DepartmentAncestor = Department | Business;\n\nexport enum FilterType {\n  Include = 'INCLUDE',\n  Exclude = 'EXCLUDE'\n}\n\nexport type JournalEntiresWhereInput = {\n  department?: Maybe<JournalEntriesWhereDepartment>;\n  reconciled?: Maybe<Scalars['Boolean']>;\n  deleted?: Maybe<Scalars['Boolean']>;\n  lastUpdate?: Maybe<JournalEntriesWhereLastUpdate>;\n  lastUpdateRefund?: Maybe<JournalEntriesWhereLastUpdate>;\n  lastUpdateItem?: Maybe<JournalEntriesWhereLastUpdate>;\n  or?: Maybe<Array<Maybe<JournalEntiresWhereInput>>>;\n  and?: Maybe<Array<Maybe<JournalEntiresWhereInput>>>;\n};\n\n/** Where */\nexport type JournalEntriesWhereDepartment = {\n  eq?: Maybe<Scalars['ID']>;\n  ne?: Maybe<Scalars['ID']>;\n  in?: Maybe<Array<Maybe<Scalars['ID']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['ID']>>>;\n  matchDecedentTree?: Maybe<Scalars['Boolean']>;\n};\n\nexport type JournalEntriesWhereLastUpdate = {\n  gt?: Maybe<Scalars['String']>;\n  lt?: Maybe<Scalars['String']>;\n  gte?: Maybe<Scalars['String']>;\n  lte?: Maybe<Scalars['String']>;\n};\n\nexport type JournalEntry = {\n   __typename?: 'JournalEntry';\n  id: Scalars['ID'];\n  refunds: Array<JournalEntryRefund>;\n  items: Array<JournalEntryItem>;\n  type: JournalEntryType;\n  date: Scalars['String'];\n  department: Department;\n  category: JournalEntryCategory;\n  paymentMethod: PaymentMethod;\n  description?: Maybe<Scalars['String']>;\n  total: Rational;\n  source: JournalEntrySource;\n  reconciled: Scalars['Boolean'];\n  lastUpdate: Scalars['String'];\n  deleted: Scalars['Boolean'];\n};\n\nexport type JournalEntryAddFields = {\n  date: Scalars['String'];\n  department: Scalars['ID'];\n  type: JournalEntryType;\n  category: Scalars['ID'];\n  paymentMethod: Scalars['ID'];\n  description?: Maybe<Scalars['String']>;\n  total: RationalInput;\n  source: JournalEntrySourceInput;\n  reconciled?: Maybe<Scalars['Boolean']>;\n};\n\nexport type JournalEntryAddItemFields = {\n  department?: Maybe<Scalars['ID']>;\n  category?: Maybe<Scalars['ID']>;\n  description?: Maybe<Scalars['String']>;\n  total: RationalInput;\n};\n\nexport type JournalEntryAddRefundFields = {\n  date: Scalars['String'];\n  description?: Maybe<Scalars['String']>;\n  paymentMethod: Scalars['ID'];\n  total: RationalInput;\n  reconciled?: Maybe<Scalars['Boolean']>;\n};\n\nexport type JournalEntryCategory = {\n   __typename?: 'JournalEntryCategory';\n  id: Scalars['ID'];\n  name: Scalars['String'];\n  type: JournalEntryType;\n  parent?: Maybe<JournalEntryCategory>;\n  ancestors: Array<JournalEntryCategory>;\n  children: Array<JournalEntryCategory>;\n};\n\nexport type JournalEntryCategoryWhereInput = {\n  name?: Maybe<JournalEntryCategoryWhereNameInput>;\n  type?: Maybe<JournalEntryCategoryWhereTypeInput>;\n  hasParent?: Maybe<Scalars['Boolean']>;\n  parent?: Maybe<JournalEntryCategoryWhereParentInput>;\n  or?: Maybe<Array<Maybe<JournalEntryCategoryWhereInput>>>;\n  and?: Maybe<Array<Maybe<JournalEntryCategoryWhereInput>>>;\n};\n\nexport type JournalEntryCategoryWhereNameInput = {\n  eq?: Maybe<Scalars['String']>;\n  ne?: Maybe<Scalars['String']>;\n  in?: Maybe<Array<Maybe<Scalars['String']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['String']>>>;\n};\n\nexport type JournalEntryCategoryWhereParentInput = {\n  eq?: Maybe<Scalars['ID']>;\n  ne?: Maybe<Scalars['ID']>;\n  in?: Maybe<Array<Maybe<Scalars['ID']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['ID']>>>;\n};\n\nexport type JournalEntryCategoryWhereTypeInput = {\n  eq?: Maybe<JournalEntryType>;\n  ne?: Maybe<JournalEntryType>;\n};\n\n/** Items */\nexport type JournalEntryItem = {\n   __typename?: 'JournalEntryItem';\n  id: Scalars['ID'];\n  department?: Maybe<Department>;\n  category?: Maybe<JournalEntryCategory>;\n  description?: Maybe<Scalars['String']>;\n  total: Rational;\n  lastUpdate: Scalars['String'];\n  deleted: Scalars['Boolean'];\n};\n\nexport type JournalEntryItemUpsertResult = {\n   __typename?: 'JournalEntryItemUpsertResult';\n  journalEntryItem: JournalEntryItem;\n  journalEntry: JournalEntry;\n};\n\n/** Refunds */\nexport type JournalEntryRefund = {\n   __typename?: 'JournalEntryRefund';\n  id: Scalars['ID'];\n  date: Scalars['String'];\n  description?: Maybe<Scalars['String']>;\n  paymentMethod: PaymentMethod;\n  total: Rational;\n  reconciled: Scalars['Boolean'];\n  lastUpdate: Scalars['String'];\n  deleted: Scalars['Boolean'];\n};\n\nexport type JournalEntrySource = Person | Business | Department;\n\nexport type JournalEntrySourceInput = {\n  sourceType: JournalEntrySourceType;\n  id: Scalars['ID'];\n};\n\nexport enum JournalEntrySourceType {\n  Business = 'BUSINESS',\n  Department = 'DEPARTMENT',\n  Person = 'PERSON'\n}\n\nexport enum JournalEntryType {\n  Credit = 'CREDIT',\n  Debit = 'DEBIT'\n}\n\nexport type JournalEntryUpdateFields = {\n  date?: Maybe<Scalars['String']>;\n  department?: Maybe<Scalars['ID']>;\n  type?: Maybe<JournalEntryType>;\n  category?: Maybe<Scalars['ID']>;\n  paymentMethod?: Maybe<Scalars['ID']>;\n  description?: Maybe<Scalars['String']>;\n  total?: Maybe<RationalInput>;\n  source?: Maybe<JournalEntrySourceInput>;\n  reconciled?: Maybe<Scalars['Boolean']>;\n};\n\nexport type JournalEntryUpdateItemFields = {\n  department?: Maybe<Scalars['ID']>;\n  category?: Maybe<Scalars['ID']>;\n  description?: Maybe<Scalars['String']>;\n  total?: Maybe<RationalInput>;\n};\n\nexport type JournalEntryUpdatePaymentMethod = {\n  id: Scalars['ID'];\n  fields: PaymentMethodUpdateFields;\n};\n\nexport type JournalEntryUpdateRefundFields = {\n  date?: Maybe<Scalars['String']>;\n  description?: Maybe<Scalars['String']>;\n  paymentMethod?: Maybe<Scalars['ID']>;\n  total?: Maybe<RationalInput>;\n  reconciled?: Maybe<Scalars['Boolean']>;\n};\n\nexport type Lc_JournalEntryUpsert = {\n   __typename?: 'LC_JournalEntryUpsert';\n  id: Scalars['ID'];\n  valid: Scalars['Boolean'];\n  type: Lc_JournalEntryUpsertType;\n  submitStatus: Lc_JournalEntryUpsertSubmitStatus;\n  submitError?: Maybe<Scalars['String']>;\n  inputValues: Lc_JournalEntryUpsertInputValues;\n  inputErrors: Lc_JournalEntryUpsertInputErrors;\n  fields: Lc_JournalEntryUpsertFields;\n};\n\nexport type Lc_JournalEntryUpsertFields = {\n   __typename?: 'LC_JournalEntryUpsertFields';\n  id?: Maybe<Scalars['ID']>;\n  date?: Maybe<Scalars['String']>;\n  department: Array<Scalars['ID']>;\n  type?: Maybe<Scalars['ID']>;\n  paymentMethod?: Maybe<Scalars['ID']>;\n  total?: Maybe<Rational>;\n  source: Array<Lc_JournalEntryUpsertSource>;\n};\n\nexport type Lc_JournalEntryUpsertInputErrors = {\n   __typename?: 'LC_JournalEntryUpsertInputErrors';\n  dateError?: Maybe<Scalars['String']>;\n  deptError?: Maybe<Scalars['String']>;\n  typeError?: Maybe<Scalars['String']>;\n  payMethodError?: Maybe<Scalars['String']>;\n  totalError?: Maybe<Scalars['String']>;\n  srcError?: Maybe<Scalars['String']>;\n};\n\nexport type Lc_JournalEntryUpsertInputValues = {\n   __typename?: 'LC_JournalEntryUpsertInputValues';\n  deptInput?: Maybe<Scalars['String']>;\n  totalInput?: Maybe<Scalars['String']>;\n  srcInput?: Maybe<Scalars['String']>;\n  srcType?: Maybe<JournalEntrySourceType>;\n};\n\nexport type Lc_JournalEntryUpsertSource = {\n   __typename?: 'LC_JournalEntryUpsertSource';\n  sourceType: JournalEntrySourceType;\n  id: Scalars['ID'];\n};\n\nexport enum Lc_JournalEntryUpsertSubmitStatus {\n  NotSubmitted = 'NOT_SUBMITTED',\n  Submitting = 'SUBMITTING',\n  Submitted = 'SUBMITTED'\n}\n\nexport enum Lc_JournalEntryUpsertType {\n  Update = 'UPDATE',\n  Add = 'ADD'\n}\n\nexport type Mutation = {\n   __typename?: 'Mutation';\n  addBusiness: Business;\n  journalEntryUpdate: JournalEntry;\n  journalEntryAdd: JournalEntry;\n  journalEntryDelete: JournalEntry;\n  journalEntryAddRefund: JournalEntry;\n  journalEntryUpdateRefund: JournalEntry;\n  journalEntryDeleteRefund: JournalEntry;\n  journalEntryAddItem: JournalEntryItemUpsertResult;\n  journalEntryUpdateItem: JournalEntryItemUpsertResult;\n  journalEntryDeleteItem: JournalEntryItemUpsertResult;\n  paymentMethodUpdate: PaymentMethod;\n  paymentMethodAdd: PaymentMethod;\n  addPerson: Person;\n};\n\n\nexport type MutationAddBusinessArgs = {\n  fields: BusinessAddFields;\n};\n\n\nexport type MutationJournalEntryUpdateArgs = {\n  id: Scalars['ID'];\n  fields: JournalEntryUpdateFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n  paymentMethodUpdate?: Maybe<JournalEntryUpdatePaymentMethod>;\n  personAdd?: Maybe<PersonAddFields>;\n  businessAdd?: Maybe<BusinessAddFields>;\n};\n\n\nexport type MutationJournalEntryAddArgs = {\n  fields: JournalEntryAddFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n  personAdd?: Maybe<PersonAddFields>;\n  businessAdd?: Maybe<BusinessAddFields>;\n};\n\n\nexport type MutationJournalEntryDeleteArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type MutationJournalEntryAddRefundArgs = {\n  id: Scalars['ID'];\n  fields: JournalEntryAddRefundFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n};\n\n\nexport type MutationJournalEntryUpdateRefundArgs = {\n  id: Scalars['ID'];\n  fields: JournalEntryUpdateRefundFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n  paymentMethodUpdate?: Maybe<JournalEntryUpdatePaymentMethod>;\n};\n\n\nexport type MutationJournalEntryDeleteRefundArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type MutationJournalEntryAddItemArgs = {\n  id: Scalars['ID'];\n  fields: JournalEntryAddItemFields;\n};\n\n\nexport type MutationJournalEntryUpdateItemArgs = {\n  id: Scalars['ID'];\n  fields: JournalEntryUpdateItemFields;\n};\n\n\nexport type MutationJournalEntryDeleteItemArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type MutationPaymentMethodUpdateArgs = {\n  id: Scalars['ID'];\n  fields: PaymentMethodUpdateFields;\n};\n\n\nexport type MutationPaymentMethodAddArgs = {\n  fields: PaymentMethodAddFields;\n};\n\n\nexport type MutationAddPersonArgs = {\n  fields: PersonAddFields;\n};\n\nexport type PaginateInput = {\n  skip: Scalars['Int'];\n  limit: Scalars['Int'];\n};\n\nexport type PaymentMethod = {\n   __typename?: 'PaymentMethod';\n  id: Scalars['ID'];\n  active: Scalars['Boolean'];\n  refId?: Maybe<Scalars['String']>;\n  name: Scalars['String'];\n  parent?: Maybe<PaymentMethod>;\n  ancestors: Array<PaymentMethod>;\n  children: Array<PaymentMethod>;\n  allowChildren: Scalars['Boolean'];\n  authorization: Array<PaymentMethodAuthorization>;\n};\n\nexport type PaymentMethodAddFields = {\n  active: Scalars['Boolean'];\n  refId?: Maybe<Scalars['String']>;\n  name: Scalars['String'];\n  parent: Scalars['ID'];\n};\n\nexport type PaymentMethodAuthorization = {\n   __typename?: 'PaymentMethodAuthorization';\n  owner: Scalars['Boolean'];\n  entity?: Maybe<PaymentMethodAuthorizedEntity>;\n};\n\nexport type PaymentMethodAuthorizedEntity = Person | Business | Department;\n\nexport type PaymentMethodUpdateFields = {\n  active?: Maybe<Scalars['Boolean']>;\n  refId?: Maybe<Scalars['String']>;\n  name?: Maybe<Scalars['String']>;\n};\n\nexport type PaymentMethodWhereInput = {\n  active?: Maybe<Scalars['Boolean']>;\n  refId?: Maybe<PaymentMethodWhereRefIdInput>;\n  name?: Maybe<PaymentMethodWhereNameInput>;\n  hasParent?: Maybe<Scalars['Boolean']>;\n  parent?: Maybe<PaymentMethodWhereParentInput>;\n  or?: Maybe<Array<Maybe<PaymentMethodWhereInput>>>;\n  and?: Maybe<Array<Maybe<PaymentMethodWhereInput>>>;\n};\n\nexport type PaymentMethodWhereNameInput = {\n  eq?: Maybe<Scalars['String']>;\n  ne?: Maybe<Scalars['String']>;\n  in?: Maybe<Array<Maybe<Scalars['String']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['String']>>>;\n};\n\nexport type PaymentMethodWhereParentInput = {\n  eq?: Maybe<Scalars['ID']>;\n  ne?: Maybe<Scalars['ID']>;\n  in?: Maybe<Array<Maybe<Scalars['ID']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['ID']>>>;\n};\n\nexport type PaymentMethodWhereRefIdInput = {\n  eq?: Maybe<Scalars['String']>;\n  ne?: Maybe<Scalars['String']>;\n  in?: Maybe<Array<Maybe<Scalars['String']>>>;\n  nin?: Maybe<Array<Maybe<Scalars['String']>>>;\n};\n\nexport type Person = {\n   __typename?: 'Person';\n  id: Scalars['ID'];\n  name: PersonName;\n};\n\nexport type PersonAddFields = {\n  name: PersonNameInput;\n};\n\nexport type PersonName = {\n   __typename?: 'PersonName';\n  first: Scalars['String'];\n  last: Scalars['String'];\n};\n\nexport type PersonNameInput = {\n  first: Scalars['String'];\n  last: Scalars['String'];\n};\n\nexport type Query = {\n   __typename?: 'Query';\n  budget: Budget;\n  budgets: Array<Budget>;\n  business: Business;\n  businesses: Array<Business>;\n  department?: Maybe<Department>;\n  departments: Array<Department>;\n  journalEntries: Array<JournalEntry>;\n  journalEntry?: Maybe<JournalEntry>;\n  journalEntryCategories: Array<JournalEntryCategory>;\n  journalEntryCategory: JournalEntryCategory;\n  journalEntryItem?: Maybe<JournalEntryItem>;\n  journalEntryRefund?: Maybe<JournalEntryRefund>;\n  journalEntrySources: Array<JournalEntrySource>;\n  lc_journalEntryUpserts: Array<Lc_JournalEntryUpsert>;\n  paymentMethod?: Maybe<PaymentMethod>;\n  paymentMethods: Array<PaymentMethod>;\n  people: Array<Person>;\n};\n\n\nexport type QueryBudgetArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryBusinessArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryBusinessesArgs = {\n  searchByName?: Maybe<Scalars['String']>;\n};\n\n\nexport type QueryDepartmentArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryDepartmentsArgs = {\n  fromParent?: Maybe<Scalars['ID']>;\n  searchByName?: Maybe<Scalars['String']>;\n};\n\n\nexport type QueryJournalEntriesArgs = {\n  where?: Maybe<JournalEntiresWhereInput>;\n};\n\n\nexport type QueryJournalEntryArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryJournalEntryCategoriesArgs = {\n  where?: Maybe<JournalEntryCategoryWhereInput>;\n};\n\n\nexport type QueryJournalEntryCategoryArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryJournalEntryItemArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryJournalEntryRefundArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryJournalEntrySourcesArgs = {\n  searchByName: Scalars['String'];\n};\n\n\nexport type QueryPaymentMethodArgs = {\n  id: Scalars['ID'];\n};\n\n\nexport type QueryPaymentMethodsArgs = {\n  where?: Maybe<PaymentMethodWhereInput>;\n};\n\n\nexport type QueryPeopleArgs = {\n  searchByName?: Maybe<PersonNameInput>;\n};\n\nexport type Rational = {\n   __typename?: 'Rational';\n  num: Scalars['Int'];\n  den: Scalars['Int'];\n};\n\nexport type RationalInput = {\n  num: Scalars['Int'];\n  den: Scalars['Int'];\n};\n\nexport enum SortDirection {\n  Asc = 'ASC',\n  Desc = 'DESC'\n}\n\nexport type Subscription = {\n   __typename?: 'Subscription';\n  journalEntryAdded: JournalEntry;\n  journalEntryUpdated: JournalEntry;\n  journalEntryUpserted: JournalEntry;\n};\n\n\nexport type User = {\n   __typename?: 'User';\n  id: Scalars['ID'];\n  user: Person;\n};\n\nexport type Vendor = {\n   __typename?: 'Vendor';\n  approved: Scalars['Boolean'];\n  vendorId?: Maybe<Scalars['ID']>;\n};\n\nexport type WhereRegexInput = {\n  pattern: Scalars['String'];\n  flags?: Maybe<Scalars['String']>;\n};\n\nexport type DepartmentName_1QueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type DepartmentName_1Query = { __typename?: 'Query', department?: Maybe<{ __typename: 'Department', id: string, name: string }> };\n\nexport type DeptForUpsertAddQueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type DeptForUpsertAddQuery = { __typename?: 'Query', department?: Maybe<(\n    { __typename?: 'Department' }\n    & DeptEntryOptFragment\n  )> };\n\nexport type OnEntryUpsert_2SubscriptionVariables = {};\n\n\nexport type OnEntryUpsert_2Subscription = { __typename?: 'Subscription', journalEntryUpserted: (\n    { __typename?: 'JournalEntry', department: { __typename?: 'Department', ancestors: Array<{ __typename: 'Department', id: string } | { __typename?: 'Business' }> } }\n    & GetReportDataEntry_1Fragment\n  ) };\n\nexport type GetReportDataDept_1Fragment = { __typename: 'Department', id: string, name: string, budget?: Maybe<{ __typename: 'Budget', id: string, amount: { __typename?: 'Rational', num: number, den: number } }> };\n\nexport type GetReportDataEntry_1Fragment = { __typename: 'JournalEntry', id: string, type: JournalEntryType, lastUpdate: string, deleted: boolean, category: { __typename: 'JournalEntryCategory', id: string, name: string }, total: { __typename?: 'Rational', num: number, den: number }, department: { __typename: 'Department', id: string, ancestors: Array<{ __typename: 'Department', id: string } | { __typename: 'Business', id: string }> }, refunds: Array<{ __typename: 'JournalEntryRefund', id: string, deleted: boolean, lastUpdate: string, total: { __typename?: 'Rational', num: number, den: number } }> };\n\nexport type GetReportDataQueryVariables = {\n  deptId: Scalars['ID'];\n  where: JournalEntiresWhereInput;\n};\n\n\nexport type GetReportDataQuery = { __typename?: 'Query', department?: Maybe<(\n    { __typename?: 'Department', descendants: Array<(\n      { __typename?: 'Department' }\n      & GetReportDataDept_1Fragment\n    )> }\n    & GetReportDataDept_1Fragment\n  )>, journalEntries: Array<(\n    { __typename?: 'JournalEntry' }\n    & GetReportDataEntry_1Fragment\n  )> };\n\nexport type JournalEntryAdded_2SubscriptionVariables = {};\n\n\nexport type JournalEntryAdded_2Subscription = { __typename?: 'Subscription', journalEntryAdded: (\n    { __typename?: 'JournalEntry' }\n    & GetReportDataEntry_1Fragment\n  ) };\n\nexport type JournalEntryUpdated_2SubscriptionVariables = {};\n\n\nexport type JournalEntryUpdated_2Subscription = { __typename?: 'Subscription', journalEntryUpdated: (\n    { __typename?: 'JournalEntry' }\n    & GetReportDataEntry_1Fragment\n  ) };\n\nexport type OnEntryUpsert_1SubscriptionVariables = {};\n\n\nexport type OnEntryUpsert_1Subscription = { __typename?: 'Subscription', journalEntryUpserted: (\n    { __typename?: 'JournalEntry', department: { __typename?: 'Department', ancestors: Array<{ __typename: 'Department', id: string } | { __typename?: 'Business' }> } }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type ReconcileEntryMutationVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type ReconcileEntryMutation = { __typename?: 'Mutation', journalEntryUpdate: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type ReconcileRefundMutationVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type ReconcileRefundMutation = { __typename?: 'Mutation', journalEntryUpdateRefund: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type JournalEntryPayMethod_1Fragment = { __typename: 'PaymentMethod', id: string, name: string, parent?: Maybe<{ __typename: 'PaymentMethod', id: string }> };\n\nexport type JournalEntryCategory_1Fragment = { __typename: 'JournalEntryCategory', id: string, type: JournalEntryType, name: string };\n\nexport type JournalEntryDept_1Fragment = { __typename: 'Department', id: string, name: string, ancestors: Array<{ __typename: 'Department', id: string, deptName: string } | { __typename: 'Business', id: string, bizName: string }> };\n\nexport type JournalEntryRefund_1Fragment = { __typename: 'JournalEntryRefund', id: string, date: string, description?: Maybe<string>, reconciled: boolean, lastUpdate: string, deleted: boolean, total: { __typename?: 'Rational', num: number, den: number }, paymentMethod: (\n    { __typename?: 'PaymentMethod' }\n    & JournalEntryPayMethod_1Fragment\n  ) };\n\nexport type JournalEntryItem_1Fragment = { __typename: 'JournalEntryItem', id: string, description?: Maybe<string>, lastUpdate: string, deleted: boolean, category?: Maybe<(\n    { __typename?: 'JournalEntryCategory' }\n    & JournalEntryCategory_1Fragment\n  )>, department?: Maybe<(\n    { __typename?: 'Department' }\n    & JournalEntryDept_1Fragment\n  )>, total: { __typename?: 'Rational', num: number, den: number } };\n\nexport type JournalEntry_1Fragment = { __typename: 'JournalEntry', id: string, date: string, type: JournalEntryType, description?: Maybe<string>, deleted: boolean, lastUpdate: string, reconciled: boolean, department: (\n    { __typename: 'Department', id: string, name: string, ancestors: Array<{ __typename: 'Department', id: string, deptName: string } | { __typename: 'Business', id: string, bizName: string }> }\n    & JournalEntryDept_1Fragment\n  ), category: (\n    { __typename?: 'JournalEntryCategory' }\n    & JournalEntryCategory_1Fragment\n  ), paymentMethod: (\n    { __typename?: 'PaymentMethod' }\n    & JournalEntryPayMethod_1Fragment\n  ), source: { __typename: 'Person', id: string, name: { __typename?: 'PersonName', first: string, last: string } } | { __typename: 'Business', id: string, bizName: string } | { __typename: 'Department', id: string, deptName: string }, total: { __typename?: 'Rational', num: number, den: number }, refunds: Array<(\n    { __typename?: 'JournalEntryRefund' }\n    & JournalEntryRefund_1Fragment\n  )>, items: Array<(\n    { __typename?: 'JournalEntryItem' }\n    & JournalEntryItem_1Fragment\n  )> };\n\nexport type JournalEntries_1QueryVariables = {\n  where: JournalEntiresWhereInput;\n};\n\n\nexport type JournalEntries_1Query = { __typename?: 'Query', journalEntries: Array<(\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  )> };\n\nexport type JournalEntryAdded_1SubscriptionVariables = {};\n\n\nexport type JournalEntryAdded_1Subscription = { __typename?: 'Subscription', journalEntryAdded: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type JournalEntryUpdated_1SubscriptionVariables = {};\n\n\nexport type JournalEntryUpdated_1Subscription = { __typename?: 'Subscription', journalEntryUpdated: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type DeptIniValueForAddEntryQueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type DeptIniValueForAddEntryQuery = { __typename?: 'Query', department?: Maybe<(\n    { __typename?: 'Department' }\n    & DeptEntryOptFragment\n  )> };\n\nexport type DeleteEntryMutationVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type DeleteEntryMutation = { __typename?: 'Mutation', journalEntryDelete: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type UpdateEntryIniStateQueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type UpdateEntryIniStateQuery = { __typename?: 'Query', journalEntry?: Maybe<{ __typename: 'JournalEntry', id: string, type: JournalEntryType, date: string, description?: Maybe<string>, reconciled: boolean, department: (\n      { __typename?: 'Department' }\n      & DeptEntryOptFragment\n    ), category: (\n      { __typename?: 'JournalEntryCategory', ancestors: Array<(\n        { __typename?: 'JournalEntryCategory' }\n        & CatEntryOptFragment\n      )> }\n      & CatEntryOptFragment\n    ), source: (\n      { __typename?: 'Person' }\n      & SrcEntryPersonOptFragment\n    ) | (\n      { __typename?: 'Business' }\n      & SrcEntryBizOptFragment\n    ) | (\n      { __typename?: 'Department', ancestors: Array<(\n        { __typename?: 'Department' }\n        & SrcEntryDeptOptFragment\n      ) | (\n        { __typename?: 'Business' }\n        & SrcEntryBizOptFragment\n      )> }\n      & SrcEntryDeptOptFragment\n    ), paymentMethod: (\n      { __typename?: 'PaymentMethod', ancestors: Array<(\n        { __typename?: 'PaymentMethod' }\n        & PayMethodEntryOptFragment\n      )> }\n      & PayMethodEntryOptFragment\n    ), total: { __typename?: 'Rational', num: number, den: number }, refunds: Array<{ __typename: 'JournalEntryRefund', id: string, deleted: boolean, date: string, total: { __typename?: 'Rational', num: number, den: number } }> }> };\n\nexport type AddEntryMutationVariables = {\n  fields: JournalEntryAddFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n  personAdd?: Maybe<PersonAddFields>;\n  businessAdd?: Maybe<BusinessAddFields>;\n};\n\n\nexport type AddEntryMutation = { __typename?: 'Mutation', journalEntryAdd: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type UpdateEntryMutationVariables = {\n  id: Scalars['ID'];\n  fields: JournalEntryUpdateFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n  paymentMethodUpdate?: Maybe<JournalEntryUpdatePaymentMethod>;\n  personAdd?: Maybe<PersonAddFields>;\n  businessAdd?: Maybe<BusinessAddFields>;\n};\n\n\nexport type UpdateEntryMutation = { __typename?: 'Mutation', journalEntryUpdate: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type CatEntryOptsQueryVariables = {\n  where: JournalEntryCategoryWhereInput;\n};\n\n\nexport type CatEntryOptsQuery = { __typename?: 'Query', catOpts: Array<(\n    { __typename?: 'JournalEntryCategory' }\n    & CatEntryOptFragment\n  )> };\n\nexport type DeptEntryOptsQueryVariables = {\n  fromParent?: Maybe<Scalars['ID']>;\n};\n\n\nexport type DeptEntryOptsQuery = { __typename?: 'Query', deptOpts: Array<(\n    { __typename?: 'Department' }\n    & DeptEntryOptFragment\n  )> };\n\nexport type PayMethodEntryOptsQueryVariables = {\n  where: PaymentMethodWhereInput;\n};\n\n\nexport type PayMethodEntryOptsQuery = { __typename?: 'Query', paymentMethods: Array<(\n    { __typename?: 'PaymentMethod' }\n    & PayMethodEntryOptFragment\n  )> };\n\nexport type SrcEntryOptsQueryVariables = {\n  name: Scalars['String'];\n  isBiz: Scalars['Boolean'];\n};\n\n\nexport type SrcEntryOptsQuery = { __typename?: 'Query', businesses: Array<(\n    { __typename?: 'Business' }\n    & SrcEntryBizOptFragment\n  )>, people: Array<(\n    { __typename?: 'Person' }\n    & SrcEntryPersonOptFragment\n  )> };\n\nexport type GetEntryItemState_1QueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type GetEntryItemState_1Query = { __typename?: 'Query', journalEntry?: Maybe<(\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_3Fragment\n  )> };\n\nexport type DeleteItemMutationVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type DeleteItemMutation = { __typename?: 'Mutation', journalEntryDeleteItem: { __typename?: 'JournalEntryItemUpsertResult', journalEntryItem: { __typename: 'JournalEntryItem', id: string, deleted: boolean } } };\n\nexport type UpdateItemIniStateQueryVariables = {\n  entryId: Scalars['ID'];\n  itemId: Scalars['ID'];\n};\n\n\nexport type UpdateItemIniStateQuery = { __typename?: 'Query', journalEntry?: Maybe<(\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_3Fragment\n  )>, journalEntryItem?: Maybe<{ __typename: 'JournalEntryItem', id: string, description?: Maybe<string>, department?: Maybe<(\n      { __typename?: 'Department' }\n      & DeptEntryOptFragment\n    )>, category?: Maybe<(\n      { __typename?: 'JournalEntryCategory', ancestors: Array<(\n        { __typename?: 'JournalEntryCategory' }\n        & CatEntryOptFragment\n      )> }\n      & CatEntryOptFragment\n    )>, total: { __typename?: 'Rational', num: number, den: number } }> };\n\nexport type JournalEntry_3Fragment = { __typename: 'JournalEntry', id: string, type: JournalEntryType, total: { __typename?: 'Rational', num: number, den: number }, items: Array<{ __typename: 'JournalEntryItem', id: string, deleted: boolean, total: { __typename?: 'Rational', num: number, den: number } }> };\n\nexport type AddEntryItemMutationVariables = {\n  id: Scalars['ID'];\n  fields: JournalEntryAddItemFields;\n};\n\n\nexport type AddEntryItemMutation = { __typename?: 'Mutation', journalEntryAddItem: { __typename?: 'JournalEntryItemUpsertResult', journalEntry: (\n      { __typename?: 'JournalEntry' }\n      & JournalEntry_1Fragment\n    ) } };\n\nexport type UpdateEntryItemMutationVariables = {\n  id: Scalars['ID'];\n  fields: JournalEntryUpdateItemFields;\n};\n\n\nexport type UpdateEntryItemMutation = { __typename?: 'Mutation', journalEntryUpdateItem: { __typename?: 'JournalEntryItemUpsertResult', journalEntryItem: (\n      { __typename?: 'JournalEntryItem' }\n      & JournalEntryItem_1Fragment\n    ) } };\n\nexport type GetEntryRefundInfo_1QueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type GetEntryRefundInfo_1Query = { __typename?: 'Query', journalEntry?: Maybe<(\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_2Fragment\n  )> };\n\nexport type DeleteRefundMutationVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type DeleteRefundMutation = { __typename?: 'Mutation', journalEntryDeleteRefund: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type UpdateRefundIniStateQueryVariables = {\n  entryId: Scalars['ID'];\n  refundId: Scalars['ID'];\n};\n\n\nexport type UpdateRefundIniStateQuery = { __typename?: 'Query', journalEntry?: Maybe<(\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_2Fragment\n  )>, journalEntryRefund?: Maybe<{ __typename: 'JournalEntryRefund', id: string, date: string, description?: Maybe<string>, reconciled: boolean, paymentMethod: (\n      { __typename?: 'PaymentMethod', ancestors: Array<(\n        { __typename?: 'PaymentMethod' }\n        & PayMethodEntryOptFragment\n      )> }\n      & PayMethodEntryOptFragment\n    ), total: { __typename?: 'Rational', num: number, den: number } }> };\n\nexport type JournalEntry_2Fragment = { __typename: 'JournalEntry', id: string, date: string, type: JournalEntryType, total: { __typename?: 'Rational', num: number, den: number }, refunds: Array<{ __typename: 'JournalEntryRefund', id: string, deleted: boolean, total: { __typename?: 'Rational', num: number, den: number } }> };\n\nexport type AddEntryRefundMutationVariables = {\n  id: Scalars['ID'];\n  fields: JournalEntryAddRefundFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n};\n\n\nexport type AddEntryRefundMutation = { __typename?: 'Mutation', journalEntryAddRefund: { __typename: 'JournalEntry', id: string, refunds: Array<(\n      { __typename?: 'JournalEntryRefund' }\n      & JournalEntryRefund_1Fragment\n    )> } };\n\nexport type UpdateRefundMutationVariables = {\n  id: Scalars['ID'];\n  fields: JournalEntryUpdateRefundFields;\n  paymentMethodAdd?: Maybe<PaymentMethodAddFields>;\n  paymentMethodUpdate?: Maybe<JournalEntryUpdatePaymentMethod>;\n};\n\n\nexport type UpdateRefundMutation = { __typename?: 'Mutation', journalEntryUpdateRefund: { __typename: 'JournalEntry', id: string, refunds: Array<(\n      { __typename?: 'JournalEntryRefund' }\n      & JournalEntryRefund_1Fragment\n    )> } };\n\nexport type DeptEntryOptFragment = { __typename: 'Department', id: string, name: string, parent: { __typename: 'Department', id: string } | { __typename: 'Business', id: string } };\n\nexport type CatEntryOptFragment = { __typename: 'JournalEntryCategory', id: string, name: string, type: JournalEntryType, parent?: Maybe<{ __typename: 'JournalEntryCategory', id: string }> };\n\nexport type SrcEntryPersonOptFragment = { __typename: 'Person', id: string, personName: { __typename?: 'PersonName', first: string, last: string } };\n\nexport type SrcEntryDeptOptFragment = { __typename: 'Department', id: string, name: string, parent: { __typename: 'Department', id: string } | { __typename: 'Business', id: string } };\n\nexport type SrcEntryBizOptFragment = { __typename: 'Business', id: string, name: string, vendor?: Maybe<{ __typename?: 'Vendor', approved: boolean, vendorId?: Maybe<string> }>, departments: Array<(\n    { __typename?: 'Department' }\n    & SrcEntryDeptOptFragment\n  )> };\n\nexport type PayMethodEntryOptFragment = { __typename: 'PaymentMethod', id: string, refId?: Maybe<string>, name: string, active: boolean, parent?: Maybe<{ __typename: 'PaymentMethod', id: string }> };\n\nexport type DeptsForNav_1QueryVariables = {};\n\n\nexport type DeptsForNav_1Query = { __typename?: 'Query', departments: Array<{ __typename: 'Department', id: string, name: string, virtualRoot?: Maybe<boolean>, parent: { __typename: 'Department', id: string } | { __typename: 'Business', id: string } }> };\n\nexport type AddPerson_1MutationVariables = {\n  fields: PersonAddFields;\n};\n\n\nexport type AddPerson_1Mutation = { __typename?: 'Mutation', addPerson: { __typename: 'Person', id: string, name: { __typename?: 'PersonName', first: string, last: string } } };\n\nexport type AddBusiness_1MutationVariables = {\n  fields: BusinessAddFields;\n};\n\n\nexport type AddBusiness_1Mutation = { __typename?: 'Mutation', addBusiness: { __typename: 'Business', id: string, name: string } };\n\nexport type AddJournalEntry_2MutationVariables = {\n  fields: JournalEntryAddFields;\n};\n\n\nexport type AddJournalEntry_2Mutation = { __typename?: 'Mutation', journalEntryAdd: { __typename: 'JournalEntry', id: string } };\n\nexport type UpdateJournalEntry_2MutationVariables = {\n  id: Scalars['ID'];\n  fields: JournalEntryUpdateFields;\n};\n\n\nexport type UpdateJournalEntry_2Mutation = { __typename?: 'Mutation', journalEntryUpdate: (\n    { __typename?: 'JournalEntry' }\n    & JournalEntry_1Fragment\n  ) };\n\nexport type CategoryTypeValidation_1QueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type CategoryTypeValidation_1Query = { __typename?: 'Query', journalEntryCategory: { __typename: 'JournalEntryCategory', id: string, type: JournalEntryType } };\n\nexport type ValidateDeptIsLeaf_1QueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type ValidateDeptIsLeaf_1Query = { __typename?: 'Query', department?: Maybe<{ __typename: 'Department', id: string, descendants: Array<{ __typename: 'Department', id: string }> }> };\n\nexport type CheckValidVendor_1QueryVariables = {\n  id: Scalars['ID'];\n};\n\n\nexport type CheckValidVendor_1Query = { __typename?: 'Query', business: { __typename: 'Business', id: string, vendor?: Maybe<{ __typename?: 'Vendor', approved: boolean }> } };\n\n\n\nexport type ResolverTypeWrapper<T> = Promise<T> | T;\n\nexport type Resolver<TResult, TParent = {}, TContext = {}, TArgs = {}> = ResolverFn<TResult, TParent, TContext, TArgs>;\n\nexport type ResolverFn<TResult, TParent, TContext, TArgs> = (\n  parent: TParent,\n  args: TArgs,\n  context: TContext,\n  info: GraphQLResolveInfo\n) => Promise<TResult> | TResult;\n\nexport type SubscriptionSubscribeFn<TResult, TParent, TContext, TArgs> = (\n  parent: TParent,\n  args: TArgs,\n  context: TContext,\n  info: GraphQLResolveInfo\n) => AsyncIterator<TResult> | Promise<AsyncIterator<TResult>>;\n\nexport type SubscriptionResolveFn<TResult, TParent, TContext, TArgs> = (\n  parent: TParent,\n  args: TArgs,\n  context: TContext,\n  info: GraphQLResolveInfo\n) => TResult | Promise<TResult>;\n\nexport interface SubscriptionSubscriberObject<TResult, TKey extends string, TParent, TContext, TArgs> {\n  subscribe: SubscriptionSubscribeFn<{ [key in TKey]: TResult }, TParent, TContext, TArgs>;\n  resolve?: SubscriptionResolveFn<TResult, { [key in TKey]: TResult }, TContext, TArgs>;\n}\n\nexport interface SubscriptionResolverObject<TResult, TParent, TContext, TArgs> {\n  subscribe: SubscriptionSubscribeFn<any, TParent, TContext, TArgs>;\n  resolve: SubscriptionResolveFn<TResult, any, TContext, TArgs>;\n}\n\nexport type SubscriptionObject<TResult, TKey extends string, TParent, TContext, TArgs> =\n  | SubscriptionSubscriberObject<TResult, TKey, TParent, TContext, TArgs>\n  | SubscriptionResolverObject<TResult, TParent, TContext, TArgs>;\n\nexport type SubscriptionResolver<TResult, TKey extends string, TParent = {}, TContext = {}, TArgs = {}> =\n  | ((...args: any[]) => SubscriptionObject<TResult, TKey, TParent, TContext, TArgs>)\n  | SubscriptionObject<TResult, TKey, TParent, TContext, TArgs>;\n\nexport type TypeResolveFn<TTypes, TParent = {}, TContext = {}> = (\n  parent: TParent,\n  context: TContext,\n  info: GraphQLResolveInfo\n) => Maybe<TTypes> | Promise<Maybe<TTypes>>;\n\nexport type isTypeOfResolverFn<T = {}> = (obj: T, info: GraphQLResolveInfo) => boolean | Promise<boolean>;\n\nexport type NextResolverFn<T> = () => Promise<T>;\n\nexport type DirectiveResolverFn<TResult = {}, TParent = {}, TContext = {}, TArgs = {}> = (\n  next: NextResolverFn<TResult>,\n  parent: TParent,\n  args: TArgs,\n  context: TContext,\n  info: GraphQLResolveInfo\n) => TResult | Promise<TResult>;\n\n/** Mapping between all available schema types and the resolvers types */\nexport type ResolversTypes = {\n  Query: ResolverTypeWrapper<{}>,\n  ID: ResolverTypeWrapper<Scalars['ID']>,\n  Budget: ResolverTypeWrapper<Omit<Budget, 'owner'> & { owner: ResolversTypes['BudgetOwner'] }>,\n  Rational: ResolverTypeWrapper<Rational>,\n  Int: ResolverTypeWrapper<Scalars['Int']>,\n  BudgetOwner: ResolversTypes['Department'] | ResolversTypes['Business'],\n  Department: ResolverTypeWrapper<Omit<Department, 'parent' | 'ancestors'> & { parent: ResolversTypes['DepartmentAncestor'], ancestors: Array<ResolversTypes['DepartmentAncestor']> }>,\n  String: ResolverTypeWrapper<Scalars['String']>,\n  Business: ResolverTypeWrapper<Business>,\n  Vendor: ResolverTypeWrapper<Vendor>,\n  Boolean: ResolverTypeWrapper<Scalars['Boolean']>,\n  DepartmentAncestor: ResolversTypes['Department'] | ResolversTypes['Business'],\n  JournalEntiresWhereInput: JournalEntiresWhereInput,\n  JournalEntriesWhereDepartment: JournalEntriesWhereDepartment,\n  JournalEntriesWhereLastUpdate: JournalEntriesWhereLastUpdate,\n  JournalEntry: ResolverTypeWrapper<Omit<JournalEntry, 'source'> & { source: ResolversTypes['JournalEntrySource'] }>,\n  JournalEntryRefund: ResolverTypeWrapper<JournalEntryRefund>,\n  PaymentMethod: ResolverTypeWrapper<PaymentMethod>,\n  PaymentMethodAuthorization: ResolverTypeWrapper<Omit<PaymentMethodAuthorization, 'entity'> & { entity?: Maybe<ResolversTypes['PaymentMethodAuthorizedEntity']> }>,\n  PaymentMethodAuthorizedEntity: ResolversTypes['Person'] | ResolversTypes['Business'] | ResolversTypes['Department'],\n  Person: ResolverTypeWrapper<Person>,\n  PersonName: ResolverTypeWrapper<PersonName>,\n  JournalEntryItem: ResolverTypeWrapper<JournalEntryItem>,\n  JournalEntryCategory: ResolverTypeWrapper<JournalEntryCategory>,\n  JournalEntryType: JournalEntryType,\n  JournalEntrySource: ResolversTypes['Person'] | ResolversTypes['Business'] | ResolversTypes['Department'],\n  JournalEntryCategoryWhereInput: JournalEntryCategoryWhereInput,\n  JournalEntryCategoryWhereNameInput: JournalEntryCategoryWhereNameInput,\n  JournalEntryCategoryWhereTypeInput: JournalEntryCategoryWhereTypeInput,\n  JournalEntryCategoryWhereParentInput: JournalEntryCategoryWhereParentInput,\n  LC_JournalEntryUpsert: ResolverTypeWrapper<Lc_JournalEntryUpsert>,\n  LC_JournalEntryUpsertType: Lc_JournalEntryUpsertType,\n  LC_JournalEntryUpsertSubmitStatus: Lc_JournalEntryUpsertSubmitStatus,\n  LC_JournalEntryUpsertInputValues: ResolverTypeWrapper<Lc_JournalEntryUpsertInputValues>,\n  JournalEntrySourceType: JournalEntrySourceType,\n  LC_JournalEntryUpsertInputErrors: ResolverTypeWrapper<Lc_JournalEntryUpsertInputErrors>,\n  LC_JournalEntryUpsertFields: ResolverTypeWrapper<Lc_JournalEntryUpsertFields>,\n  LC_JournalEntryUpsertSource: ResolverTypeWrapper<Lc_JournalEntryUpsertSource>,\n  PaymentMethodWhereInput: PaymentMethodWhereInput,\n  PaymentMethodWhereRefIdInput: PaymentMethodWhereRefIdInput,\n  PaymentMethodWhereNameInput: PaymentMethodWhereNameInput,\n  PaymentMethodWhereParentInput: PaymentMethodWhereParentInput,\n  PersonNameInput: PersonNameInput,\n  Mutation: ResolverTypeWrapper<{}>,\n  BusinessAddFields: BusinessAddFields,\n  JournalEntryUpdateFields: JournalEntryUpdateFields,\n  RationalInput: RationalInput,\n  JournalEntrySourceInput: JournalEntrySourceInput,\n  PaymentMethodAddFields: PaymentMethodAddFields,\n  JournalEntryUpdatePaymentMethod: JournalEntryUpdatePaymentMethod,\n  PaymentMethodUpdateFields: PaymentMethodUpdateFields,\n  PersonAddFields: PersonAddFields,\n  JournalEntryAddFields: JournalEntryAddFields,\n  JournalEntryAddRefundFields: JournalEntryAddRefundFields,\n  JournalEntryUpdateRefundFields: JournalEntryUpdateRefundFields,\n  JournalEntryAddItemFields: JournalEntryAddItemFields,\n  JournalEntryItemUpsertResult: ResolverTypeWrapper<JournalEntryItemUpsertResult>,\n  JournalEntryUpdateItemFields: JournalEntryUpdateItemFields,\n  Subscription: ResolverTypeWrapper<{}>,\n  DepartmentAddFields: DepartmentAddFields,\n  SortDirection: SortDirection,\n  FilterType: FilterType,\n  PaginateInput: PaginateInput,\n  ByIdFilter: ByIdFilter,\n  WhereRegexInput: WhereRegexInput,\n  User: ResolverTypeWrapper<User>,\n  CacheControlScope: CacheControlScope,\n  Upload: ResolverTypeWrapper<Scalars['Upload']>,\n};\n\n/** Mapping between all available schema types and the resolvers parents */\nexport type ResolversParentTypes = {\n  Query: {},\n  ID: Scalars['ID'],\n  Budget: Omit<Budget, 'owner'> & { owner: ResolversParentTypes['BudgetOwner'] },\n  Rational: Rational,\n  Int: Scalars['Int'],\n  BudgetOwner: ResolversParentTypes['Department'] | ResolversParentTypes['Business'],\n  Department: Omit<Department, 'parent' | 'ancestors'> & { parent: ResolversParentTypes['DepartmentAncestor'], ancestors: Array<ResolversParentTypes['DepartmentAncestor']> },\n  String: Scalars['String'],\n  Business: Business,\n  Vendor: Vendor,\n  Boolean: Scalars['Boolean'],\n  DepartmentAncestor: ResolversParentTypes['Department'] | ResolversParentTypes['Business'],\n  JournalEntiresWhereInput: JournalEntiresWhereInput,\n  JournalEntriesWhereDepartment: JournalEntriesWhereDepartment,\n  JournalEntriesWhereLastUpdate: JournalEntriesWhereLastUpdate,\n  JournalEntry: Omit<JournalEntry, 'source'> & { source: ResolversParentTypes['JournalEntrySource'] },\n  JournalEntryRefund: JournalEntryRefund,\n  PaymentMethod: PaymentMethod,\n  PaymentMethodAuthorization: Omit<PaymentMethodAuthorization, 'entity'> & { entity?: Maybe<ResolversParentTypes['PaymentMethodAuthorizedEntity']> },\n  PaymentMethodAuthorizedEntity: ResolversParentTypes['Person'] | ResolversParentTypes['Business'] | ResolversParentTypes['Department'],\n  Person: Person,\n  PersonName: PersonName,\n  JournalEntryItem: JournalEntryItem,\n  JournalEntryCategory: JournalEntryCategory,\n  JournalEntryType: JournalEntryType,\n  JournalEntrySource: ResolversParentTypes['Person'] | ResolversParentTypes['Business'] | ResolversParentTypes['Department'],\n  JournalEntryCategoryWhereInput: JournalEntryCategoryWhereInput,\n  JournalEntryCategoryWhereNameInput: JournalEntryCategoryWhereNameInput,\n  JournalEntryCategoryWhereTypeInput: JournalEntryCategoryWhereTypeInput,\n  JournalEntryCategoryWhereParentInput: JournalEntryCategoryWhereParentInput,\n  LC_JournalEntryUpsert: Lc_JournalEntryUpsert,\n  LC_JournalEntryUpsertType: Lc_JournalEntryUpsertType,\n  LC_JournalEntryUpsertSubmitStatus: Lc_JournalEntryUpsertSubmitStatus,\n  LC_JournalEntryUpsertInputValues: Lc_JournalEntryUpsertInputValues,\n  JournalEntrySourceType: JournalEntrySourceType,\n  LC_JournalEntryUpsertInputErrors: Lc_JournalEntryUpsertInputErrors,\n  LC_JournalEntryUpsertFields: Lc_JournalEntryUpsertFields,\n  LC_JournalEntryUpsertSource: Lc_JournalEntryUpsertSource,\n  PaymentMethodWhereInput: PaymentMethodWhereInput,\n  PaymentMethodWhereRefIdInput: PaymentMethodWhereRefIdInput,\n  PaymentMethodWhereNameInput: PaymentMethodWhereNameInput,\n  PaymentMethodWhereParentInput: PaymentMethodWhereParentInput,\n  PersonNameInput: PersonNameInput,\n  Mutation: {},\n  BusinessAddFields: BusinessAddFields,\n  JournalEntryUpdateFields: JournalEntryUpdateFields,\n  RationalInput: RationalInput,\n  JournalEntrySourceInput: JournalEntrySourceInput,\n  PaymentMethodAddFields: PaymentMethodAddFields,\n  JournalEntryUpdatePaymentMethod: JournalEntryUpdatePaymentMethod,\n  PaymentMethodUpdateFields: PaymentMethodUpdateFields,\n  PersonAddFields: PersonAddFields,\n  JournalEntryAddFields: JournalEntryAddFields,\n  JournalEntryAddRefundFields: JournalEntryAddRefundFields,\n  JournalEntryUpdateRefundFields: JournalEntryUpdateRefundFields,\n  JournalEntryAddItemFields: JournalEntryAddItemFields,\n  JournalEntryItemUpsertResult: JournalEntryItemUpsertResult,\n  JournalEntryUpdateItemFields: JournalEntryUpdateItemFields,\n  Subscription: {},\n  DepartmentAddFields: DepartmentAddFields,\n  SortDirection: SortDirection,\n  FilterType: FilterType,\n  PaginateInput: PaginateInput,\n  ByIdFilter: ByIdFilter,\n  WhereRegexInput: WhereRegexInput,\n  User: User,\n  CacheControlScope: CacheControlScope,\n  Upload: Scalars['Upload'],\n};\n\nexport type BudgetResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Budget'] = ResolversParentTypes['Budget']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  amount?: Resolver<ResolversTypes['Rational'], ParentType, ContextType>,\n  owner?: Resolver<ResolversTypes['BudgetOwner'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type BudgetOwnerResolvers<ContextType = Context, ParentType extends ResolversParentTypes['BudgetOwner'] = ResolversParentTypes['BudgetOwner']> = {\n  __resolveType: TypeResolveFn<'Department' | 'Business', ParentType, ContextType>\n};\n\nexport type BusinessResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Business'] = ResolversParentTypes['Business']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  name?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  budget?: Resolver<Maybe<ResolversTypes['Budget']>, ParentType, ContextType>,\n  departments?: Resolver<Array<ResolversTypes['Department']>, ParentType, ContextType>,\n  vendor?: Resolver<Maybe<ResolversTypes['Vendor']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type DepartmentResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Department'] = ResolversParentTypes['Department']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  name?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  code?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  budget?: Resolver<Maybe<ResolversTypes['Budget']>, ParentType, ContextType>,\n  business?: Resolver<ResolversTypes['Business'], ParentType, ContextType>,\n  parent?: Resolver<ResolversTypes['DepartmentAncestor'], ParentType, ContextType>,\n  ancestors?: Resolver<Array<ResolversTypes['DepartmentAncestor']>, ParentType, ContextType>,\n  descendants?: Resolver<Array<ResolversTypes['Department']>, ParentType, ContextType>,\n  virtualRoot?: Resolver<Maybe<ResolversTypes['Boolean']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type DepartmentAncestorResolvers<ContextType = Context, ParentType extends ResolversParentTypes['DepartmentAncestor'] = ResolversParentTypes['DepartmentAncestor']> = {\n  __resolveType: TypeResolveFn<'Department' | 'Business', ParentType, ContextType>\n};\n\nexport type JournalEntryResolvers<ContextType = Context, ParentType extends ResolversParentTypes['JournalEntry'] = ResolversParentTypes['JournalEntry']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  refunds?: Resolver<Array<ResolversTypes['JournalEntryRefund']>, ParentType, ContextType>,\n  items?: Resolver<Array<ResolversTypes['JournalEntryItem']>, ParentType, ContextType>,\n  type?: Resolver<ResolversTypes['JournalEntryType'], ParentType, ContextType>,\n  date?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  department?: Resolver<ResolversTypes['Department'], ParentType, ContextType>,\n  category?: Resolver<ResolversTypes['JournalEntryCategory'], ParentType, ContextType>,\n  paymentMethod?: Resolver<ResolversTypes['PaymentMethod'], ParentType, ContextType>,\n  description?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  total?: Resolver<ResolversTypes['Rational'], ParentType, ContextType>,\n  source?: Resolver<ResolversTypes['JournalEntrySource'], ParentType, ContextType>,\n  reconciled?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  lastUpdate?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  deleted?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type JournalEntryCategoryResolvers<ContextType = Context, ParentType extends ResolversParentTypes['JournalEntryCategory'] = ResolversParentTypes['JournalEntryCategory']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  name?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  type?: Resolver<ResolversTypes['JournalEntryType'], ParentType, ContextType>,\n  parent?: Resolver<Maybe<ResolversTypes['JournalEntryCategory']>, ParentType, ContextType>,\n  ancestors?: Resolver<Array<ResolversTypes['JournalEntryCategory']>, ParentType, ContextType>,\n  children?: Resolver<Array<ResolversTypes['JournalEntryCategory']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type JournalEntryItemResolvers<ContextType = Context, ParentType extends ResolversParentTypes['JournalEntryItem'] = ResolversParentTypes['JournalEntryItem']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  department?: Resolver<Maybe<ResolversTypes['Department']>, ParentType, ContextType>,\n  category?: Resolver<Maybe<ResolversTypes['JournalEntryCategory']>, ParentType, ContextType>,\n  description?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  total?: Resolver<ResolversTypes['Rational'], ParentType, ContextType>,\n  lastUpdate?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  deleted?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type JournalEntryItemUpsertResultResolvers<ContextType = Context, ParentType extends ResolversParentTypes['JournalEntryItemUpsertResult'] = ResolversParentTypes['JournalEntryItemUpsertResult']> = {\n  journalEntryItem?: Resolver<ResolversTypes['JournalEntryItem'], ParentType, ContextType>,\n  journalEntry?: Resolver<ResolversTypes['JournalEntry'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type JournalEntryRefundResolvers<ContextType = Context, ParentType extends ResolversParentTypes['JournalEntryRefund'] = ResolversParentTypes['JournalEntryRefund']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  date?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  description?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  paymentMethod?: Resolver<ResolversTypes['PaymentMethod'], ParentType, ContextType>,\n  total?: Resolver<ResolversTypes['Rational'], ParentType, ContextType>,\n  reconciled?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  lastUpdate?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  deleted?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type JournalEntrySourceResolvers<ContextType = Context, ParentType extends ResolversParentTypes['JournalEntrySource'] = ResolversParentTypes['JournalEntrySource']> = {\n  __resolveType: TypeResolveFn<'Person' | 'Business' | 'Department', ParentType, ContextType>\n};\n\nexport type Lc_JournalEntryUpsertResolvers<ContextType = Context, ParentType extends ResolversParentTypes['LC_JournalEntryUpsert'] = ResolversParentTypes['LC_JournalEntryUpsert']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  valid?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  type?: Resolver<ResolversTypes['LC_JournalEntryUpsertType'], ParentType, ContextType>,\n  submitStatus?: Resolver<ResolversTypes['LC_JournalEntryUpsertSubmitStatus'], ParentType, ContextType>,\n  submitError?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  inputValues?: Resolver<ResolversTypes['LC_JournalEntryUpsertInputValues'], ParentType, ContextType>,\n  inputErrors?: Resolver<ResolversTypes['LC_JournalEntryUpsertInputErrors'], ParentType, ContextType>,\n  fields?: Resolver<ResolversTypes['LC_JournalEntryUpsertFields'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type Lc_JournalEntryUpsertFieldsResolvers<ContextType = Context, ParentType extends ResolversParentTypes['LC_JournalEntryUpsertFields'] = ResolversParentTypes['LC_JournalEntryUpsertFields']> = {\n  id?: Resolver<Maybe<ResolversTypes['ID']>, ParentType, ContextType>,\n  date?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  department?: Resolver<Array<ResolversTypes['ID']>, ParentType, ContextType>,\n  type?: Resolver<Maybe<ResolversTypes['ID']>, ParentType, ContextType>,\n  paymentMethod?: Resolver<Maybe<ResolversTypes['ID']>, ParentType, ContextType>,\n  total?: Resolver<Maybe<ResolversTypes['Rational']>, ParentType, ContextType>,\n  source?: Resolver<Array<ResolversTypes['LC_JournalEntryUpsertSource']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type Lc_JournalEntryUpsertInputErrorsResolvers<ContextType = Context, ParentType extends ResolversParentTypes['LC_JournalEntryUpsertInputErrors'] = ResolversParentTypes['LC_JournalEntryUpsertInputErrors']> = {\n  dateError?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  deptError?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  typeError?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  payMethodError?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  totalError?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  srcError?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type Lc_JournalEntryUpsertInputValuesResolvers<ContextType = Context, ParentType extends ResolversParentTypes['LC_JournalEntryUpsertInputValues'] = ResolversParentTypes['LC_JournalEntryUpsertInputValues']> = {\n  deptInput?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  totalInput?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  srcInput?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  srcType?: Resolver<Maybe<ResolversTypes['JournalEntrySourceType']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type Lc_JournalEntryUpsertSourceResolvers<ContextType = Context, ParentType extends ResolversParentTypes['LC_JournalEntryUpsertSource'] = ResolversParentTypes['LC_JournalEntryUpsertSource']> = {\n  sourceType?: Resolver<ResolversTypes['JournalEntrySourceType'], ParentType, ContextType>,\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type MutationResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Mutation'] = ResolversParentTypes['Mutation']> = {\n  addBusiness?: Resolver<ResolversTypes['Business'], ParentType, ContextType, RequireFields<MutationAddBusinessArgs, 'fields'>>,\n  journalEntryUpdate?: Resolver<ResolversTypes['JournalEntry'], ParentType, ContextType, RequireFields<MutationJournalEntryUpdateArgs, 'id' | 'fields'>>,\n  journalEntryAdd?: Resolver<ResolversTypes['JournalEntry'], ParentType, ContextType, RequireFields<MutationJournalEntryAddArgs, 'fields'>>,\n  journalEntryDelete?: Resolver<ResolversTypes['JournalEntry'], ParentType, ContextType, RequireFields<MutationJournalEntryDeleteArgs, 'id'>>,\n  journalEntryAddRefund?: Resolver<ResolversTypes['JournalEntry'], ParentType, ContextType, RequireFields<MutationJournalEntryAddRefundArgs, 'id' | 'fields'>>,\n  journalEntryUpdateRefund?: Resolver<ResolversTypes['JournalEntry'], ParentType, ContextType, RequireFields<MutationJournalEntryUpdateRefundArgs, 'id' | 'fields'>>,\n  journalEntryDeleteRefund?: Resolver<ResolversTypes['JournalEntry'], ParentType, ContextType, RequireFields<MutationJournalEntryDeleteRefundArgs, 'id'>>,\n  journalEntryAddItem?: Resolver<ResolversTypes['JournalEntryItemUpsertResult'], ParentType, ContextType, RequireFields<MutationJournalEntryAddItemArgs, 'id' | 'fields'>>,\n  journalEntryUpdateItem?: Resolver<ResolversTypes['JournalEntryItemUpsertResult'], ParentType, ContextType, RequireFields<MutationJournalEntryUpdateItemArgs, 'id' | 'fields'>>,\n  journalEntryDeleteItem?: Resolver<ResolversTypes['JournalEntryItemUpsertResult'], ParentType, ContextType, RequireFields<MutationJournalEntryDeleteItemArgs, 'id'>>,\n  paymentMethodUpdate?: Resolver<ResolversTypes['PaymentMethod'], ParentType, ContextType, RequireFields<MutationPaymentMethodUpdateArgs, 'id' | 'fields'>>,\n  paymentMethodAdd?: Resolver<ResolversTypes['PaymentMethod'], ParentType, ContextType, RequireFields<MutationPaymentMethodAddArgs, 'fields'>>,\n  addPerson?: Resolver<ResolversTypes['Person'], ParentType, ContextType, RequireFields<MutationAddPersonArgs, 'fields'>>,\n};\n\nexport type PaymentMethodResolvers<ContextType = Context, ParentType extends ResolversParentTypes['PaymentMethod'] = ResolversParentTypes['PaymentMethod']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  active?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  refId?: Resolver<Maybe<ResolversTypes['String']>, ParentType, ContextType>,\n  name?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  parent?: Resolver<Maybe<ResolversTypes['PaymentMethod']>, ParentType, ContextType>,\n  ancestors?: Resolver<Array<ResolversTypes['PaymentMethod']>, ParentType, ContextType>,\n  children?: Resolver<Array<ResolversTypes['PaymentMethod']>, ParentType, ContextType>,\n  allowChildren?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  authorization?: Resolver<Array<ResolversTypes['PaymentMethodAuthorization']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type PaymentMethodAuthorizationResolvers<ContextType = Context, ParentType extends ResolversParentTypes['PaymentMethodAuthorization'] = ResolversParentTypes['PaymentMethodAuthorization']> = {\n  owner?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  entity?: Resolver<Maybe<ResolversTypes['PaymentMethodAuthorizedEntity']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type PaymentMethodAuthorizedEntityResolvers<ContextType = Context, ParentType extends ResolversParentTypes['PaymentMethodAuthorizedEntity'] = ResolversParentTypes['PaymentMethodAuthorizedEntity']> = {\n  __resolveType: TypeResolveFn<'Person' | 'Business' | 'Department', ParentType, ContextType>\n};\n\nexport type PersonResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Person'] = ResolversParentTypes['Person']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  name?: Resolver<ResolversTypes['PersonName'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type PersonNameResolvers<ContextType = Context, ParentType extends ResolversParentTypes['PersonName'] = ResolversParentTypes['PersonName']> = {\n  first?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  last?: Resolver<ResolversTypes['String'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type QueryResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Query'] = ResolversParentTypes['Query']> = {\n  budget?: Resolver<ResolversTypes['Budget'], ParentType, ContextType, RequireFields<QueryBudgetArgs, 'id'>>,\n  budgets?: Resolver<Array<ResolversTypes['Budget']>, ParentType, ContextType>,\n  business?: Resolver<ResolversTypes['Business'], ParentType, ContextType, RequireFields<QueryBusinessArgs, 'id'>>,\n  businesses?: Resolver<Array<ResolversTypes['Business']>, ParentType, ContextType, RequireFields<QueryBusinessesArgs, never>>,\n  department?: Resolver<Maybe<ResolversTypes['Department']>, ParentType, ContextType, RequireFields<QueryDepartmentArgs, 'id'>>,\n  departments?: Resolver<Array<ResolversTypes['Department']>, ParentType, ContextType, RequireFields<QueryDepartmentsArgs, never>>,\n  journalEntries?: Resolver<Array<ResolversTypes['JournalEntry']>, ParentType, ContextType, RequireFields<QueryJournalEntriesArgs, never>>,\n  journalEntry?: Resolver<Maybe<ResolversTypes['JournalEntry']>, ParentType, ContextType, RequireFields<QueryJournalEntryArgs, 'id'>>,\n  journalEntryCategories?: Resolver<Array<ResolversTypes['JournalEntryCategory']>, ParentType, ContextType, RequireFields<QueryJournalEntryCategoriesArgs, never>>,\n  journalEntryCategory?: Resolver<ResolversTypes['JournalEntryCategory'], ParentType, ContextType, RequireFields<QueryJournalEntryCategoryArgs, 'id'>>,\n  journalEntryItem?: Resolver<Maybe<ResolversTypes['JournalEntryItem']>, ParentType, ContextType, RequireFields<QueryJournalEntryItemArgs, 'id'>>,\n  journalEntryRefund?: Resolver<Maybe<ResolversTypes['JournalEntryRefund']>, ParentType, ContextType, RequireFields<QueryJournalEntryRefundArgs, 'id'>>,\n  journalEntrySources?: Resolver<Array<ResolversTypes['JournalEntrySource']>, ParentType, ContextType, RequireFields<QueryJournalEntrySourcesArgs, 'searchByName'>>,\n  lc_journalEntryUpserts?: Resolver<Array<ResolversTypes['LC_JournalEntryUpsert']>, ParentType, ContextType>,\n  paymentMethod?: Resolver<Maybe<ResolversTypes['PaymentMethod']>, ParentType, ContextType, RequireFields<QueryPaymentMethodArgs, 'id'>>,\n  paymentMethods?: Resolver<Array<ResolversTypes['PaymentMethod']>, ParentType, ContextType, RequireFields<QueryPaymentMethodsArgs, never>>,\n  people?: Resolver<Array<ResolversTypes['Person']>, ParentType, ContextType, RequireFields<QueryPeopleArgs, never>>,\n};\n\nexport type RationalResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Rational'] = ResolversParentTypes['Rational']> = {\n  num?: Resolver<ResolversTypes['Int'], ParentType, ContextType>,\n  den?: Resolver<ResolversTypes['Int'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type SubscriptionResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Subscription'] = ResolversParentTypes['Subscription']> = {\n  journalEntryAdded?: SubscriptionResolver<ResolversTypes['JournalEntry'], \"journalEntryAdded\", ParentType, ContextType>,\n  journalEntryUpdated?: SubscriptionResolver<ResolversTypes['JournalEntry'], \"journalEntryUpdated\", ParentType, ContextType>,\n  journalEntryUpserted?: SubscriptionResolver<ResolversTypes['JournalEntry'], \"journalEntryUpserted\", ParentType, ContextType>,\n};\n\nexport interface UploadScalarConfig extends GraphQLScalarTypeConfig<ResolversTypes['Upload'], any> {\n  name: 'Upload'\n}\n\nexport type UserResolvers<ContextType = Context, ParentType extends ResolversParentTypes['User'] = ResolversParentTypes['User']> = {\n  id?: Resolver<ResolversTypes['ID'], ParentType, ContextType>,\n  user?: Resolver<ResolversTypes['Person'], ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type VendorResolvers<ContextType = Context, ParentType extends ResolversParentTypes['Vendor'] = ResolversParentTypes['Vendor']> = {\n  approved?: Resolver<ResolversTypes['Boolean'], ParentType, ContextType>,\n  vendorId?: Resolver<Maybe<ResolversTypes['ID']>, ParentType, ContextType>,\n  __isTypeOf?: isTypeOfResolverFn<ParentType>,\n};\n\nexport type Resolvers<ContextType = Context> = {\n  Budget?: BudgetResolvers<ContextType>,\n  BudgetOwner?: BudgetOwnerResolvers,\n  Business?: BusinessResolvers<ContextType>,\n  Department?: DepartmentResolvers<ContextType>,\n  DepartmentAncestor?: DepartmentAncestorResolvers,\n  JournalEntry?: JournalEntryResolvers<ContextType>,\n  JournalEntryCategory?: JournalEntryCategoryResolvers<ContextType>,\n  JournalEntryItem?: JournalEntryItemResolvers<ContextType>,\n  JournalEntryItemUpsertResult?: JournalEntryItemUpsertResultResolvers<ContextType>,\n  JournalEntryRefund?: JournalEntryRefundResolvers<ContextType>,\n  JournalEntrySource?: JournalEntrySourceResolvers,\n  LC_JournalEntryUpsert?: Lc_JournalEntryUpsertResolvers<ContextType>,\n  LC_JournalEntryUpsertFields?: Lc_JournalEntryUpsertFieldsResolvers<ContextType>,\n  LC_JournalEntryUpsertInputErrors?: Lc_JournalEntryUpsertInputErrorsResolvers<ContextType>,\n  LC_JournalEntryUpsertInputValues?: Lc_JournalEntryUpsertInputValuesResolvers<ContextType>,\n  LC_JournalEntryUpsertSource?: Lc_JournalEntryUpsertSourceResolvers<ContextType>,\n  Mutation?: MutationResolvers<ContextType>,\n  PaymentMethod?: PaymentMethodResolvers<ContextType>,\n  PaymentMethodAuthorization?: PaymentMethodAuthorizationResolvers<ContextType>,\n  PaymentMethodAuthorizedEntity?: PaymentMethodAuthorizedEntityResolvers,\n  Person?: PersonResolvers<ContextType>,\n  PersonName?: PersonNameResolvers<ContextType>,\n  Query?: QueryResolvers<ContextType>,\n  Rational?: RationalResolvers<ContextType>,\n  Subscription?: SubscriptionResolvers<ContextType>,\n  Upload?: GraphQLScalarType,\n  User?: UserResolvers<ContextType>,\n  Vendor?: VendorResolvers<ContextType>,\n};\n\n\n/**\n * @deprecated\n * Use \"Resolvers\" root object instead. If you wish to get \"IResolvers\", add \"typesPrefix: I\" to your config.\n*/\nexport type IResolvers<ContextType = Context> = Resolvers<ContextType>;\n","\nimport {DocumentNode} from 'graphql';\n\nimport upsertJournalEntry from './schema/upsertJournalEntry.gql';\n\nexport default <DocumentNode[]>[\n  upsertJournalEntry\n];","import {Resolvers} from \"apollo-client\";\n\nconst resolvers:Resolvers = {};\n\nexport default resolvers;","import { BatchHttpLink } from 'apollo-link-batch-http';\nimport { WebSocketLink } from 'apollo-link-ws';\nimport { ApolloLink } from 'apollo-link';\nimport { onError } from 'apollo-link-error';\nimport { getMainDefinition } from 'apollo-utilities';\n\nconst batchHttpLink = new BatchHttpLink({\n  uri: '/graphql',\n  credentials: 'same-origin',\n});\n\nconst wsLink = new WebSocketLink({\n  uri: `ws://${window.location.host}/graphql`,\n  options: {\n    reconnect: true\n  }\n});\n\nconst link = ApolloLink.from([\n  onError(({ graphQLErrors, networkError }) => {\n    if (graphQLErrors)\n      graphQLErrors.forEach(({ message, locations, path }) =>\n        console.error(\n          `[GraphQL error]: Message: ${message}, Location: ${locations}, Path: ${path}`,\n        ),\n      );\n    if (networkError) console.log(`[Network error]: ${networkError}`);\n  }),\n  ApolloLink.split(({query}) => {\n    const def = getMainDefinition(query);\n    return def.kind === 'OperationDefinition'\n      && def.operation === 'subscription';\n  },wsLink, batchHttpLink)\n\n]);\n\nexport default link;","import { ApolloClient } from 'apollo-client';\n\nimport cache from './inMemoryCache';\nimport typeDefs from './typeDefs';\nimport resolvers from './resolvers';\nimport link from './link';\n\nexport default new ApolloClient({\n  link,\n  cache,\n  typeDefs,\n  resolvers\n});","import gql from \"graphql-tag\";\n\nexport const JOURNAL_ENTRY_PAY_METHOD_FRAGMENT = gql`\n  fragment JournalEntryPayMethod_1Fragment on PaymentMethod {\n    __typename\n    id\n    name\n    parent {\n      __typename\n      id\n    }\n  }\n`;\n\nexport const JOURNAL_ENTRY_CATEGORY_FRAGMENT = gql`\n  fragment JournalEntryCategory_1Fragment on JournalEntryCategory {\n    __typename\n    id\n    type\n    name\n  }\n`;\n\nexport const JOURNAL_ENTRY_DEPT_FRAGMENT = gql`\n  fragment JournalEntryDept_1Fragment on Department {\n    __typename\n    id\n    name\n    ancestors {\n      __typename\n      ... on Business {\n        id\n        bizName: name\n      }\n      ... on Department {\n        id\n        deptName: name\n      }\n    }\n  }\n`;\n\nexport const JOURNAL_ENTRY_REFUND = gql`\n  fragment JournalEntryRefund_1Fragment on JournalEntryRefund {\n    __typename\n    id\n    date\n    description\n    total {\n      num\n      den\n    }\n    paymentMethod {\n      ...JournalEntryPayMethod_1Fragment\n    }\n    reconciled\n    lastUpdate\n    deleted\n  }\n  ${JOURNAL_ENTRY_PAY_METHOD_FRAGMENT}\n`;\n\nexport const JOURNAL_ENTRY_ITEM = gql`\n  fragment JournalEntryItem_1Fragment on JournalEntryItem {\n    __typename\n    id\n    category {\n      ...JournalEntryCategory_1Fragment\n    }\n    department {\n      ...JournalEntryDept_1Fragment\n    }\n    total {\n      num\n      den\n    }\n    description\n    lastUpdate\n    deleted\n  }\n  ${JOURNAL_ENTRY_CATEGORY_FRAGMENT}\n  ${JOURNAL_ENTRY_DEPT_FRAGMENT}\n`;\n\nexport const JOURNAL_ENTRY_FRAGMENT = gql`\n  fragment JournalEntry_1Fragment on JournalEntry {\n    __typename\n    id\n    date\n    department {\n      __typename\n      id\n      name\n      ancestors {\n        __typename\n        ... on Business {\n          id\n          bizName: name\n        }\n        ... on Department {\n          id\n          deptName: name\n        }\n      }\n    }\n    type\n    category {\n      ...JournalEntryCategory_1Fragment\n    }\n    department {\n      ...JournalEntryDept_1Fragment\n    }\n    description\n    paymentMethod {\n      ...JournalEntryPayMethod_1Fragment\n    }\n    source {\n      __typename\n      ... on Person {\n        id\n        name {\n          first\n          last\n        }\n      }\n      ... on Business {\n        id\n        bizName: name\n      }\n      ... on Department {\n        id\n        deptName: name\n      }\n    }\n    total {\n      num\n      den\n    }\n    refunds {\n      ...JournalEntryRefund_1Fragment\n    }\n    items {\n      ...JournalEntryItem_1Fragment\n    }\n    deleted\n    lastUpdate\n    reconciled\n  }\n  ${JOURNAL_ENTRY_PAY_METHOD_FRAGMENT}\n  ${JOURNAL_ENTRY_DEPT_FRAGMENT}\n  ${JOURNAL_ENTRY_CATEGORY_FRAGMENT}\n  ${JOURNAL_ENTRY_REFUND}\n  ${JOURNAL_ENTRY_ITEM}\n`;\n\nexport const JOURNAL_ENTRIES = gql`\n  query JournalEntries_1($where: JournalEntiresWhereInput!) {\n    journalEntries(where: $where)\n      @connection(key: \"JournalEntries_1\", filter: [\"where\"]) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nexport const JOURNAL_ENTRY_ADDED_SUB = gql`\n  subscription JournalEntryAdded_1 {\n    journalEntryAdded {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nexport const JOURNAL_ENTRY_UPDATED_SUB = gql`\n  subscription JournalEntryUpdated_1 {\n    journalEntryUpdated {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n","export const CHECK_ID = \"5dc46d0af74afb2c2805bd54\";\nexport const CREDIT_ID = \"5dc46d0af74afb2c2805bd55\";\n","import { O } from \"ts-toolbelt\";\nimport { FormikConfig } from \"formik\";\nimport gql from \"graphql-tag\";\nimport ApolloClient from \"apollo-client\";\n\nimport {\n  JournalEntryAddRefundFields,\n  PayMethodEntryOptFragment,\n  AddEntryRefundMutation as AddRefund,\n  AddEntryRefundMutationVariables as AddRefundVars,\n} from \"../../../../apollo/graphTypes\";\nimport { TransmutationValue } from \"../../../../formik/utils\";\nimport { JOURNAL_ENTRY_REFUND } from \"../../Table/JournalEntries.gql\";\n\nexport type AddValues = O.Overwrite<\n  O.Required<\n    JournalEntryAddRefundFields,\n    keyof JournalEntryAddRefundFields,\n    \"deep\"\n  >,\n  {\n    date: TransmutationValue<Date | null, JournalEntryAddRefundFields[\"date\"]>;\n    total: TransmutationValue<string, JournalEntryAddRefundFields[\"total\"]>;\n    paymentMethod: TransmutationValue<\n      string,\n      (PayMethodEntryOptFragment | string)[]\n    >;\n  }\n>;\n\nconst ADD_REFUND = gql`\n  mutation AddEntryRefund(\n    $id: ID!\n    $fields: JournalEntryAddRefundFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n  ) {\n    journalEntryAddRefund(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n    ) {\n      id\n      __typename\n      refunds {\n        ...JournalEntryRefund_1Fragment\n      }\n    }\n  }\n  ${JOURNAL_ENTRY_REFUND}\n`;\n\nconst submitAdd: (\n  client: ApolloClient<any>,\n  id: string,\n  ...rest: Parameters<FormikConfig<AddValues>[\"onSubmit\"]>\n) => ReturnType<FormikConfig<AddValues>[\"onSubmit\"]> = async (\n  client,\n  id,\n  values\n) => {\n  const { paymentMethod, paymentMethodAdd } = (() => {\n    const payMethod =\n      values.paymentMethod.value[values.paymentMethod.value.length - 1];\n\n    // New Payment Method\n    if (typeof payMethod === \"string\") {\n      const parent = (values.paymentMethod.value[\n        values.paymentMethod.value.length - 2\n      ] as PayMethodEntryOptFragment).id;\n\n      return {\n        paymentMethod: \"\",\n        paymentMethodAdd: {\n          parent,\n          refId: payMethod,\n          name: payMethod,\n          active: false,\n        },\n      };\n    }\n\n    return {\n      paymentMethod: payMethod.id,\n      paymentMethodAdd: null,\n    };\n  })();\n\n  const variables: O.Required<AddRefundVars, keyof AddRefundVars, \"deep\"> = {\n    id,\n    fields: {\n      date: values.date.value,\n      description: values.description?.trim()\n        ? values.description.trim()\n        : null,\n      paymentMethod,\n      total: values.total.value,\n      reconciled: values.reconciled ?? null,\n    },\n    paymentMethodAdd,\n  };\n\n  await client.mutate<AddRefund, AddRefundVars>({\n    mutation: ADD_REFUND,\n    variables,\n  });\n};\n\nexport default submitAdd;\n","import { useFormikContext } from \"formik\";\nimport { useCallback } from \"react\";\n\nexport type TransmutationValue<TinputValue, Tvalue> = {\n  inputValue: TinputValue;\n  value: Tvalue;\n};\n\nexport const createValueTransmutator = <\n  TinputValue,\n  Tvalue,\n  Trest extends any[]\n>(\n  transMutator: (inputValue: TinputValue, ...rest: Trest) => Tvalue\n) => (inputValue: TinputValue, ...rest: Trest) =>\n  ({\n    inputValue,\n    value: transMutator(inputValue, ...rest),\n  } as TransmutationValue<TinputValue, Tvalue>);\n\nexport enum FormikStatusType {\n  NOTIFICATION,\n  ERROR,\n  FATAL_ERROR,\n}\n\nexport interface FormikStatus {\n  msg: string;\n  type: FormikStatusType;\n}\n\nexport const useFormikStatus = <Values = any>() => {\n  const { setStatus: setStatusNative, status } = useFormikContext<Values>();\n\n  const setStatus = useCallback(\n    (args: FormikStatus | null) => {\n      if (status) {\n        if (\n          !args ||\n          Object.keys(args).some((key) => args[key] !== status[key])\n        ) {\n          setStatusNative(args);\n        }\n      } else if (args) {\n        setStatusNative(args);\n      }\n    },\n    [setStatusNative, status]\n  );\n\n  return [status ?? null, setStatus] as [FormikStatus | null, typeof setStatus];\n};\n","import React, { useMemo, useCallback, useRef } from \"react\";\nimport {\n  KeyboardDatePicker,\n  KeyboardDatePickerProps,\n  MuiPickersUtilsProvider,\n} from \"@material-ui/pickers\";\nimport DateFnsUtils from \"@date-io/date-fns\";\nimport { useField, useFormikContext, FieldInputProps } from \"formik\";\nimport { TextFieldProps } from \"@material-ui/core\";\nimport { parseISO, min, isValid, formatISO, format } from \"date-fns\";\n\nimport {\n  TransmutationValue,\n  createValueTransmutator,\n  useFormikStatus,\n  FormikStatusType,\n} from \"../../../../formik/utils\";\n\nconst inputProps = {\n  inputMode: \"numeric\",\n} as const;\n\nconst keyboardButtonProps = {\n  tabIndex: -1,\n} as const;\n\nconst dateValueTransmutator = createValueTransmutator(\n  (...args: Parameters<KeyboardDatePickerProps[\"onChange\"]>) => {\n    const [date, value] = args;\n    if (date && isValid(date)) {\n      return formatISO(date);\n    }\n    return value || \"\";\n  }\n);\nexport type DateValue = TransmutationValue<Date | null, string>;\n\nconst DateField = (\n  props: {\n    variant?: \"filled\" | \"outlined\";\n    maxDate?: Date;\n    minDate?: Date;\n  } & Omit<\n    TextFieldProps,\n    | \"value\"\n    | \"variant\"\n    | \"error\"\n    | \"helperText\"\n    | \"animateYearScrolling\"\n    | \"disableToolbar\"\n    | \"disableFuture\"\n    | \"inputVariant\"\n    | \"variant\"\n    | \"format\"\n    | \"margin\"\n    | \"label\"\n    | \"maxDate\"\n    | \"initialFocusedDate\"\n    | \"autoOk\"\n    | \"InputProps\"\n    | \"inputProps\"\n    | \"placeholder\"\n    | \"KeyboardButtonProps\"\n    | \"onBlur\"\n    | \"onOpen\"\n    | \"onClose\"\n    | \"onChange\"\n    | keyof FieldInputProps<any>\n  >\n) => {\n  const {\n    variant: inputVariant = \"filled\",\n    autoFocus = false,\n    disabled = false,\n    maxDate = new Date(),\n    minDate,\n  } = props;\n\n  const { isSubmitting } = useFormikContext();\n\n  const validate = useCallback(\n    (\n      value: TransmutationValue<Date | null, string> | undefined\n    ): string | undefined => {\n      const dateStr = (value?.value || \"\").trim();\n      if (dateStr) {\n        const date = parseISO(dateStr);\n        if (!isValid(date)) {\n          return \"Invalid Date\";\n        } else if (minDate && date < minDate) {\n          return `Cannot be before ${format(minDate, \"MM/dd/yyyy\")}`;\n        } else if (maxDate < date) {\n          return `Cannot be after ${format(maxDate, \"MM/dd/yyyy\")}`;\n        }\n      } else {\n        return \"Date is Required\";\n      }\n    },\n    [minDate, maxDate]\n  );\n\n  const [field, meta, helpers] = useField<\n    TransmutationValue<Date | null, string> | undefined\n  >({\n    name: \"date\",\n    validate,\n  });\n\n  const value = field.value?.inputValue ?? null;\n  const { error, touched } = meta;\n  const { setValue, setTouched } = helpers;\n\n  const initialInputValue = meta.initialValue?.inputValue;\n  const initialFocusedDate = useMemo(\n    () =>\n      initialInputValue && isValid(initialInputValue)\n        ? initialInputValue\n        : new Date(),\n    [initialInputValue]\n  );\n\n  const InputProps = useMemo(\n    () => ({\n      autoFocus,\n    }),\n    [autoFocus]\n  );\n\n  // Handle touched\n  const calOpen = useRef(false);\n  const onBlur = useCallback(\n    () =>\n      setTimeout(() => {\n        if (calOpen.current) {\n          return;\n        }\n        setTouched(true);\n      }, 0),\n    [setTouched, calOpen]\n  );\n  const onOpen = useCallback(() => (calOpen.current = true), [calOpen]);\n  const onClose = useCallback(() => {\n    calOpen.current = false;\n    onBlur();\n  }, [calOpen, onBlur]);\n\n  const onChange = useCallback<KeyboardDatePickerProps[\"onChange\"]>(\n    (date, value) => {\n      setValue(\n        dateValueTransmutator(\n          // limit max date\n          date && isValid(date) ? min([new Date(), date]) : date,\n          value\n        )\n      );\n    },\n    [setValue]\n  );\n\n  const [formikStatus] = useFormikStatus();\n\n  const dataPickerProps: KeyboardDatePickerProps = useMemo(\n    () => ({\n      ...field,\n      disabled:\n        isSubmitting ||\n        disabled ||\n        formikStatus?.type === FormikStatusType.FATAL_ERROR,\n      value,\n      error: touched && !!error,\n      helperText: touched ? error : undefined,\n      animateYearScrolling: true,\n      disableToolbar: true,\n      disableFuture: true,\n      inputVariant,\n      variant: \"inline\",\n      format: \"MM/dd/yyyy\",\n      margin: \"none\",\n      label: \"Date\",\n      initialFocusedDate,\n      autoOk: true,\n      InputProps,\n      inputProps,\n      placeholder: \"mm/dd/yyyy\",\n      KeyboardButtonProps: keyboardButtonProps,\n      onBlur,\n      onOpen,\n      onClose,\n      onChange,\n    }),\n    [\n      value,\n      initialFocusedDate,\n      onBlur,\n      error,\n      inputVariant,\n      InputProps,\n      isSubmitting,\n      field,\n      onOpen,\n      onClose,\n      onChange,\n      touched,\n      disabled,\n      formikStatus,\n    ]\n  );\n\n  return (\n    <MuiPickersUtilsProvider utils={DateFnsUtils}>\n      <KeyboardDatePicker\n        maxDate={maxDate}\n        {...(props as any)}\n        {...dataPickerProps}\n      />\n    </MuiPickersUtilsProvider>\n  );\n};\n\nexport default DateField;\n","import React, { useMemo, useCallback } from \"react\";\nimport { TextField, TextFieldProps } from \"@material-ui/core\";\nimport { useField, FieldInputProps } from \"formik\";\nimport { useFormikStatus, FormikStatusType } from \"../../../../formik/utils\";\n\nconst Description = (\n  props: {\n    variant?: \"filled\" | \"outlined\";\n  } & Omit<\n    TextFieldProps,\n    | \"variant\"\n    | \"onChange\"\n    | \"value\"\n    | \"variant\"\n    | \"label\"\n    | \"name\"\n    | \"InputProps\"\n    | keyof FieldInputProps<any>\n  >\n) => {\n  const {\n    autoFocus = false,\n    disabled = false,\n    variant = \"filled\",\n    ...textFieldProps\n  } = props;\n\n  const [field, , { setValue }] = useField<string | null | undefined>({\n    name: \"description\",\n  });\n\n  const onChange = useCallback<NonNullable<TextFieldProps[\"onChange\"]>>(\n    (event) => void setValue(event?.target?.value?.trimLeft() || null),\n    [setValue]\n  );\n\n  const InputProps = useMemo(\n    () => ({\n      type: \"text\",\n      autoFocus,\n    }),\n    [autoFocus]\n  );\n\n  const [formikStatus] = useFormikStatus();\n\n  return (\n    <TextField\n      {...textFieldProps}\n      {...field}\n      disabled={disabled || formikStatus?.type === FormikStatusType.FATAL_ERROR}\n      onChange={onChange}\n      value={field.value ?? \"\"}\n      variant={variant as any}\n      label={\"Description\"}\n      name={\"description\"}\n      InputProps={InputProps}\n    />\n  );\n};\n\nexport default Description;\n","import React, { useMemo, useCallback } from \"react\";\nimport { TextField, TextFieldProps, InputAdornment } from \"@material-ui/core\";\nimport { useField, FieldInputProps } from \"formik\";\nimport numeral from \"numeral\";\n\nimport {\n  createValueTransmutator,\n  TransmutationValue,\n  useFormikStatus,\n  FormikStatusType,\n} from \"../../../../formik/utils\";\nimport { RationalInput } from \"../../../../apollo/graphTypes\";\nimport { getRational } from \"../../../../utils/transmutations\";\n\nexport type TotalValue = TransmutationValue<string, RationalInput>;\n\nconst inputProps = {\n  min: \"0.00\",\n  step: \"0.01\",\n} as const;\n\nexport const totalValueTransmutator = createValueTransmutator(\n  (inputValue: string) => getRational(inputValue, 2)\n);\n\nconst Total = (\n  props: {\n    variant?: \"filled\" | \"outlined\";\n    minTotal?: number;\n    maxTotal?: number;\n  } & Omit<\n    TextFieldProps,\n    | \"variant\"\n    | \"type\"\n    | \"value\"\n    | \"error\"\n    | \"helperText\"\n    | \"placeholder\"\n    | \"label\"\n    | \"name\"\n    | \"required\"\n    | \"variant\"\n    | \"inputProps\"\n    | \"InputProps\"\n    | \"onChange\"\n    | keyof FieldInputProps<any>\n  >\n) => {\n  const {\n    autoFocus = false,\n    disabled = false,\n    variant = \"filled\",\n    maxTotal = Number.MAX_SAFE_INTEGER,\n    minTotal: minTotalProp = 0,\n    ...textFieldProps\n  } = props;\n\n  const minTotal = Math.max(0.01, minTotalProp);\n\n  const validate = useCallback(\n    (value: TotalValue | undefined) => {\n      const inputValue = (value?.inputValue || \"\").trim();\n\n      if (inputValue === \"\") {\n        return \"Total Required\";\n      }\n\n      const num =\n        typeof inputValue === \"string\"\n          ? Number.parseFloat(inputValue)\n          : inputValue;\n      console.log(\"num\", num, \"maxTotal\", maxTotal);\n      if (Number.isNaN(num)) {\n        return \"Invalid Number\";\n      } else if (num > maxTotal) {\n        return `Cannot be greater than ${numeral(maxTotal).format(\"$0,0.00\")}`;\n      } else if (num === 0) {\n        return \"Cannot be 0\";\n      } else if (num < minTotal) {\n        return `Cannot be less than ${numeral(minTotal).format(\"$0,0.00\")}`;\n      }\n    },\n    [minTotal, maxTotal]\n  );\n\n  const [field, meta, { setValue }] = useField<TotalValue | undefined>({\n    name: \"total\",\n    validate,\n  });\n\n  const inputValue = field.value?.inputValue ?? \"\";\n\n  const { error, touched } = meta;\n\n  const InputProps = useMemo(\n    () => ({\n      type: \"number\",\n      autoFocus,\n      startAdornment: <InputAdornment position=\"start\">$</InputAdornment>,\n    }),\n    [autoFocus]\n  );\n\n  const onChange = useCallback<NonNullable<TextFieldProps[\"onChange\"]>>(\n    (event) => {\n      setValue(totalValueTransmutator(event?.target?.value || \"\"));\n    },\n    [setValue]\n  );\n\n  const helperText = useMemo(() => {\n    if (touched && error) {\n      return error;\n    } else if (maxTotal !== Number.MAX_SAFE_INTEGER && minTotal > 0.01) {\n      return `Max ${numeral(maxTotal).format(\"$0,0.00\")} & Min ${numeral(\n        minTotal\n      ).format(\"$0,0.00\")}`;\n    } else if (maxTotal !== Number.MAX_SAFE_INTEGER) {\n      return `Max ${numeral(maxTotal).format(\"$0,0.00\")}`;\n    } else if (minTotal > 0.01) {\n      return `Min ${numeral(minTotal).format(\"$0,0.00\")}`;\n    } else {\n      return \"\";\n    }\n  }, [touched, error, maxTotal, minTotal]);\n\n  const [formikStatus] = useFormikStatus();\n\n  return (\n    <TextField\n      {...textFieldProps}\n      {...field}\n      disabled={disabled || formikStatus?.type === FormikStatusType.FATAL_ERROR}\n      type=\"number\"\n      value={inputValue}\n      error={touched && !!error}\n      helperText={helperText}\n      placeholder={\"0.00\"}\n      label={\"Total\"}\n      name={\"total\"}\n      required\n      variant={variant as any}\n      inputProps={inputProps}\n      InputProps={InputProps}\n      onChange={onChange}\n    />\n  );\n};\n\nexport default Total;\n","import Fraction from \"fraction.js\";\n\nexport const getRational = (\n  number: string | number,\n  fractionDigits = 2\n): { num: number; den: number } => {\n  const { n: num, d: den } = new Fraction(\n    (typeof number === \"string\"\n      ? Number.parseFloat(number.trim() || \"0\")\n      : number\n    ).toFixed(fractionDigits)\n  );\n\n  return { num, den };\n};\n\nexport const addRational = (\n  a: { num: number; den: number },\n  b: { num: number; den: number },\n  ...rest: { num: number; den: number }[]\n): { num: number; den: number } => {\n  let sum = new Fraction({\n    n: a.num,\n    d: a.den,\n  }).add({\n    n: b.num,\n    d: b.den,\n  });\n\n  for (const rational of rest) {\n    sum = sum.add(\n      new Fraction({\n        n: rational.num,\n        d: rational.den,\n      })\n    );\n  }\n\n  return {\n    num: sum.n,\n    den: sum.d,\n  };\n};\n\nexport const subRational = (\n  a: { num: number; den: number },\n  b: { num: number; den: number },\n  ...rest: { num: number; den: number }[]\n): { num: number; den: number } => {\n  let sum = new Fraction({\n    n: a.num,\n    d: a.den,\n  }).sub({\n    n: b.num,\n    d: b.den,\n  });\n\n  for (const rational of rest) {\n    sum = sum.sub(\n      new Fraction({\n        n: rational.num,\n        d: rational.den,\n      })\n    );\n  }\n\n  return {\n    num: sum.n,\n    den: sum.d,\n  };\n};\n\nexport const rationalToDecimal = (rational: {\n  num: number;\n  den: number;\n}): number => {\n  return Number.parseFloat(\n    new Fraction({\n      n: rational.num,\n      d: rational.den,\n    }).toString()\n  );\n};\n","import React from \"react\";\nimport {\n  Checkbox,\n  FormControlLabel,\n  FormControlLabelProps,\n  CheckboxProps,\n} from \"@material-ui/core\";\nimport { useField, FieldInputProps } from \"formik\";\nimport { useFormikStatus, FormikStatusType } from \"../../../../formik/utils\";\n\nconst inputProps = {\n  type: \"checkbox\",\n} as const;\n\nconst Reconcile = (\n  props:\n    | ({ label: true } & Partial<\n        Omit<\n          FormControlLabelProps,\n          | \"inputProps\"\n          | \"control\"\n          | \"checked\"\n          | \"label\"\n          | keyof FieldInputProps<any>\n        >\n      >)\n    | ({ label?: false } & Partial<\n        Omit<\n          CheckboxProps,\n          \"inputProps\" | \"checked\" | keyof FieldInputProps<any>\n        >\n      >)\n) => {\n  const { label, disabled = false, ...customProps } = props;\n\n  const [field] = useField<boolean | undefined>({\n    name: \"reconciled\",\n    type: \"checkbox\",\n  });\n\n  const value = field.value ?? false;\n\n  const [formikStatus] = useFormikStatus();\n\n  if (label) {\n    return (\n      <FormControlLabel\n        {...customProps}\n        {...(field as any)}\n        value={value}\n        disabled={\n          disabled || formikStatus?.type === FormikStatusType.FATAL_ERROR\n        }\n        label=\"Reconcile\"\n        control={<Checkbox inputProps={inputProps} />}\n      />\n    );\n  }\n\n  return (\n    <Checkbox\n      {...(customProps as any)}\n      {...field}\n      value={value}\n      disabled={disabled || formikStatus?.type === FormikStatusType.FATAL_ERROR}\n      inputProps={inputProps}\n    />\n  );\n};\n\nexport default Reconcile;\n","import gql from \"graphql-tag\";\n\nexport const DEPT_ENTRY_OPT_FRAGMENT = gql`\n  fragment DeptEntryOptFragment on Department {\n    __typename\n    id\n    name\n    parent {\n      __typename\n      ... on Business {\n        id\n      }\n      ... on Department {\n        id\n      }\n    }\n  }\n`;\n\nexport const CAT_ENTRY_OPT_FRAGMENT = gql`\n  fragment CatEntryOptFragment on JournalEntryCategory {\n    __typename\n    id\n    name\n    type\n    parent {\n      __typename\n      id\n    }\n  }\n`;\n\nexport const SRC_ENTRY_PERSON_OPT_FRAGMENT = gql`\n  fragment SrcEntryPersonOptFragment on Person {\n    __typename\n    id\n    personName: name {\n      first\n      last\n    }\n  }\n`;\n\nexport const SRC_ENTRY_DEPT_OPT_FRAGMENT = gql`\n  fragment SrcEntryDeptOptFragment on Department {\n    __typename\n    id\n    name\n    parent {\n      ... on Business {\n        __typename\n        id\n      }\n      ... on Department {\n        __typename\n        id\n      }\n    }\n  }\n`;\n\nexport const SRC_ENTRY_BIZ_OPT_FRAGMENT = gql`\n  fragment SrcEntryBizOptFragment on Business {\n    __typename\n    id\n    name\n    vendor {\n      approved\n      vendorId\n    }\n    departments {\n      ...SrcEntryDeptOptFragment\n    }\n  }\n  ${SRC_ENTRY_DEPT_OPT_FRAGMENT}\n`;\n\nexport const PAY_METHOD_ENTRY_OPT_FRAGMENT = gql`\n  fragment PayMethodEntryOptFragment on PaymentMethod {\n    __typename\n    id\n    refId\n    name\n    active\n    parent {\n      __typename\n      id\n    }\n  }\n`;\n","import React, { useMemo, useState, useCallback } from \"react\";\nimport { TextField, TextFieldProps, Box, Chip } from \"@material-ui/core\";\nimport gql from \"graphql-tag\";\nimport { useQuery, QueryHookOptions } from \"@apollo/react-hooks\";\nimport { useField, FieldInputProps } from \"formik\";\n\nimport { PAY_METHOD_ENTRY_OPT_FRAGMENT } from \"../upsertEntry.gql\";\nimport {\n  PayMethodEntryOptsQuery as PayMethodEntryOpts,\n  PayMethodEntryOptsQueryVariables as PayMethodEntryOptsQueryVars,\n  PayMethodEntryOptFragment,\n} from \"../../../../apollo/graphTypes\";\nimport Autocomplete, {\n  AutocompleteProps as AutocompletePropsRaw,\n  RenderInputParams,\n} from \"@material-ui/lab/Autocomplete\";\nimport { UseAutocompleteMultipleProps } from \"@material-ui/lab/useAutocomplete\";\nimport { ChevronRight } from \"@material-ui/icons\";\nimport { CHECK_ID } from \"../../constants\";\nimport {\n  TransmutationValue,\n  useFormikStatus,\n  FormikStatusType,\n} from \"../../../../formik/utils\";\n\ntype Value = PayMethodEntryOptFragment | string;\n\ntype AutocompleteProps = AutocompletePropsRaw<Value> &\n  UseAutocompleteMultipleProps<Value>;\n\nconst PAY_METHOD_ENTRY_OPTS = gql`\n  query PayMethodEntryOpts($where: PaymentMethodWhereInput!) {\n    paymentMethods(where: $where) {\n      ...PayMethodEntryOptFragment\n    }\n  }\n  ${PAY_METHOD_ENTRY_OPT_FRAGMENT}\n`;\n\nexport type PaymentMethodValue = TransmutationValue<string, Value[]>;\n\nconst validate = (payMethodValue: PaymentMethodValue | undefined) => {\n  const value = payMethodValue?.value ?? [];\n  const numValues = value.length;\n  const curValue = value[numValues - 1];\n  const parent = value[numValues - 2] as PayMethodEntryOptFragment | undefined;\n\n  if (curValue === undefined) {\n    return \"Method Required\";\n  } else if (typeof curValue === \"string\") {\n    if (parent?.id === CHECK_ID) {\n      const checkNumber = (curValue.match(/[0-9]/g) ?? []).join(\"\");\n      if (!checkNumber) {\n        return \"Check # Required\";\n      }\n    }\n  } else if (curValue.id === CHECK_ID) {\n    return \"Check # Required\";\n  }\n};\n\nconst getOptionLabel: AutocompleteProps[\"getOptionLabel\"] = (opt): string => {\n  return typeof opt === \"string\" ? opt : opt.name;\n};\n\nconst renderTags: AutocompleteProps[\"renderTags\"] = (values, getTagProps) => {\n  const lastIndex = values.length - 1;\n  return values.map((value: Value, index: number) => {\n    const isLastIndex = lastIndex === index;\n    const { key, ...props } = getTagProps({ index }) as any;\n\n    const parent = values[index - 1] as PayMethodEntryOptFragment | undefined;\n\n    const isString = typeof value === \"string\";\n\n    let label: string;\n    switch (parent?.id) {\n      case CHECK_ID:\n        label =\n          \"CK-\" +\n          (isString ? value : (value as PayMethodEntryOptFragment).name);\n        break;\n      default:\n        label = getOptionLabel(value);\n    }\n\n    let endAdornment: JSX.Element | undefined;\n    if (!isLastIndex) {\n      endAdornment = <ChevronRight fontSize=\"small\" />;\n    } else if (!isString) {\n      // Add Prefixes\n      switch ((value as PayMethodEntryOptFragment).id) {\n        case CHECK_ID:\n          endAdornment = <span>CK-</span>;\n          break;\n      }\n    }\n\n    return (\n      <Box\n        key={key}\n        display=\"flex\"\n        flexDirection=\"row\"\n        alignItems=\"center\"\n        justifyContent=\"flex-start\"\n      >\n        <Chip\n          color={isLastIndex ? \"primary\" : \"default\"}\n          variant={isLastIndex ? \"default\" : \"outlined\"}\n          label={label}\n          size=\"medium\"\n          {...props}\n          disabled={!isLastIndex}\n        />{\" \"}\n        {endAdornment}\n      </Box>\n    );\n  });\n};\n\nconst PaymentMethod = (\n  props: {\n    variant?: \"filled\" | \"outlined\";\n  } & {} & Omit<\n      TextFieldProps,\n      | \"value\"\n      | \"variant\"\n      | \"error\"\n      | \"helperText\"\n      | \"name\"\n      | \"label\"\n      | keyof FieldInputProps<any>\n      | keyof Omit<RenderInputParams, \"id\" | \"disabled\">\n    >\n) => {\n  const { disabled = false, ...textFieldProps } = props;\n\n  const [hasFocus, setHasFocus] = useState(false);\n\n  const [field, meta, helpers] = useField<PaymentMethodValue | undefined>({\n    name: \"paymentMethod\",\n    validate,\n  });\n\n  const onBlurField = field.onBlur;\n  const value = field.value?.value ?? [];\n  const inputValue = field.value?.inputValue ?? \"\";\n  const { error, touched } = meta;\n  const { setValue } = helpers;\n\n  const curValue = value[value.length - 1] ?? null;\n\n  const variables = useMemo<PayMethodEntryOptsQueryVars>(\n    () =>\n      curValue === null\n        ? {\n            where: {\n              hasParent: false,\n            },\n          }\n        : {\n            where: {\n              parent: {\n                eq: (curValue as PayMethodEntryOptFragment).id,\n              },\n            },\n          },\n    [curValue]\n  );\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const onError = useCallback<\n    NonNullable<\n      QueryHookOptions<\n        PayMethodEntryOpts,\n        PayMethodEntryOptsQueryVars\n      >[\"onError\"]\n    >\n  >(\n    (error) =>\n      void setFormikStatus({\n        msg: error.message,\n        type: FormikStatusType.FATAL_ERROR,\n      }),\n    [setFormikStatus]\n  );\n\n  const { loading, error: gqlError, data } = useQuery<\n    PayMethodEntryOpts,\n    PayMethodEntryOptsQueryVars\n  >(PAY_METHOD_ENTRY_OPTS, {\n    skip: typeof curValue === \"string\",\n    variables,\n    onError,\n  });\n\n  const options = useMemo<PayMethodEntryOptFragment[]>(\n    () =>\n      !data?.paymentMethods ||\n      typeof curValue === \"string\" ||\n      curValue?.id === CHECK_ID\n        ? []\n        : data.paymentMethods,\n    [data, curValue]\n  );\n\n  const hasOptions = options.length > 0;\n\n  const freeSolo = useMemo<boolean>(\n    () => (curValue as PayMethodEntryOptFragment | null)?.id === CHECK_ID,\n    [curValue]\n  );\n\n  const disableTextInput = useMemo(() => !hasOptions && !freeSolo, [\n    hasOptions,\n    freeSolo,\n  ]);\n\n  const label = useMemo(() => {\n    if (\n      typeof curValue === \"string\" ||\n      (curValue as PayMethodEntryOptFragment | null)?.id === CHECK_ID\n    ) {\n      return \"Check #\";\n    }\n\n    return \"Payment Method\";\n  }, [curValue]);\n\n  const InputProps = useMemo(() => {\n    if ((curValue as PayMethodEntryOptFragment | null)?.id === CHECK_ID) {\n      return {\n        type: \"number\",\n      };\n    }\n\n    return {};\n  }, [curValue]);\n\n  const inputProps = useMemo(() => {\n    if ((curValue as PayMethodEntryOptFragment | null)?.id === CHECK_ID) {\n      return {\n        min: \"0\",\n        step: \"1\",\n      };\n    }\n\n    return {};\n  }, [curValue]);\n\n  const renderInput = useCallback(\n    (params: RenderInputParams) => {\n      params.InputProps = {\n        ...(params.InputProps ?? {}),\n        ...InputProps,\n      };\n\n      params.inputProps = {\n        ...(params.inputProps ?? {}),\n        ...inputProps,\n      };\n\n      const helperText = (() => {\n        if (gqlError) {\n          return gqlError.message;\n        } else if (touched) {\n          return error;\n        }\n      })();\n\n      return (\n        <TextField\n          {...textFieldProps}\n          {...params}\n          variant={(textFieldProps.variant || \"filled\") as any}\n          error={(touched && !!error) || !!gqlError}\n          helperText={helperText}\n          name=\"paymentMethod\"\n          label={label}\n        />\n      );\n    },\n    [textFieldProps, touched, gqlError, error, label, InputProps, inputProps]\n  );\n\n  const onFocus = useCallback((event?) => setHasFocus(true), [setHasFocus]);\n  const onBlur = useCallback<NonNullable<AutocompleteProps[\"onBlur\"]>>(\n    (event) => {\n      setHasFocus(false);\n      // Fixes formik validate called with wrong version of value\n      event.persist();\n      setTimeout(() => void onBlurField(event), 0);\n    },\n    [setHasFocus, onBlurField]\n  );\n\n  const onChange = useCallback<NonNullable<AutocompleteProps[\"onChange\"]>>(\n    (event, value) => {\n      setValue({ inputValue, value });\n    },\n    [setValue, inputValue]\n  );\n\n  const onInputChange = useCallback<\n    NonNullable<AutocompleteProps[\"onInputChange\"]>\n  >(\n    (event, inputValue: string, reason) => {\n      inputValue = (inputValue || \"\").trimStart();\n      if (!disableTextInput) {\n        setValue({ inputValue, value });\n      }\n    },\n    [setValue, value, disableTextInput]\n  );\n\n  const autoCompleteProps = useMemo<AutocompleteProps>(\n    () => ({\n      value,\n      disabled:\n        !!gqlError ||\n        loading ||\n        formikStatus?.type === FormikStatusType.FATAL_ERROR ||\n        disabled,\n      multiple: true,\n      options,\n      renderInput,\n      renderTags,\n      freeSolo,\n      getOptionLabel,\n      onChange,\n      onInputChange,\n      inputValue: disableTextInput ? \"\" : inputValue,\n      onFocus,\n      onBlur,\n      open:\n        hasFocus &&\n        hasOptions &&\n        formikStatus?.type !== FormikStatusType.FATAL_ERROR,\n      loading,\n      autoSelect: true,\n      name: \"paymentMethod\",\n    }),\n    [\n      options,\n      value,\n      renderInput,\n      freeSolo,\n      onChange,\n      onInputChange,\n      inputValue,\n      disableTextInput,\n      onFocus,\n      onBlur,\n      hasFocus,\n      hasOptions,\n      loading,\n      gqlError,\n      disabled,\n      formikStatus,\n    ]\n  );\n\n  return <Autocomplete {...autoCompleteProps} />;\n};\n\nexport default PaymentMethod;\n","import React from \"react\";\nimport { useTheme, Box, BoxProps, Theme } from \"@material-ui/core\";\nimport { fade } from \"@material-ui/core/styles/colorManipulator\";\n\nconst Overlay = (\n  props: {\n    children: React.ReactNode;\n    zIndex: keyof Theme[\"zIndex\"] | number;\n    opacity?: number;\n  } & Pick<\n    BoxProps,\n    | \"p\"\n    | \"pt\"\n    | \"pr\"\n    | \"pb\"\n    | \"pl\"\n    | \"px\"\n    | \"py\"\n    | \"padding\"\n    | \"paddingTop\"\n    | \"paddingRight\"\n    | \"paddingBottom\"\n    | \"paddingLeft\"\n    | \"paddingX\"\n    | \"paddingY\"\n  >\n) => {\n  const theme = useTheme();\n\n  const { opacity = 0.62, ...boxProps } = props;\n\n  return (\n    <Box\n      {...boxProps}\n      overflow=\"auto\"\n      position=\"absolute\"\n      display=\"flex\"\n      alignItems=\"center\"\n      justifyContent=\"center\"\n      width=\"100%\"\n      top=\"0px\"\n      bottom=\"0px\"\n      bgcolor={fade(theme.palette.background.paper, opacity)}\n    />\n  );\n};\n\nexport default Overlay;\n","import React from \"react\";\nimport { CircularProgress, Theme } from \"@material-ui/core\";\n\nimport Overlay from \"./Overlay\";\n\nconst OverlayLoading = (props: { zIndex: keyof Theme[\"zIndex\"] | number }) => {\n  return <Overlay {...props} children={<CircularProgress />} />;\n};\n\nexport default OverlayLoading;\n","import gql from \"graphql-tag\";\n\nexport const JOURNAL_FRAGMENT = gql`\n  fragment JournalEntry_2Fragment on JournalEntry {\n    __typename\n    id\n    date\n    type\n    total {\n      num\n      den\n    }\n    refunds {\n      id\n      __typename\n      deleted\n      total {\n        num\n        den\n      }\n    }\n  }\n`;\n","import React, { useCallback, useMemo } from \"react\";\nimport { Formik, FormikConfig, useFormikContext, FormikProps } from \"formik\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  PaperProps,\n  Grid,\n  DialogContentText,\n  useTheme,\n  Box,\n} from \"@material-ui/core\";\nimport {\n  useApolloClient,\n  useQuery,\n  QueryHookOptions,\n} from \"@apollo/react-hooks\";\nimport { Add as AddIcon, Cancel as CancelIcon } from \"@material-ui/icons\";\nimport gql from \"graphql-tag\";\n\nimport submitAdd, { AddValues } from \"./submitAdd\";\nimport {\n  GetEntryRefundInfo_1Query as GetEntryRefundInfo,\n  GetEntryRefundInfo_1QueryVariables as GetEntryRefundInfoVars,\n  JournalEntryType,\n} from \"../../../../apollo/graphTypes\";\nimport DateEntry from \"../EntryFields/DateEntry\";\nimport Description from \"../EntryFields/Description\";\nimport Total from \"../EntryFields/Total\";\nimport Reconcile from \"../EntryFields/Reconcile\";\nimport PaymentMethod from \"../EntryFields/PaymentMethod\";\nimport {\n  FormikStatusType,\n  useFormikStatus,\n  FormikStatus,\n} from \"../../../../formik/utils\";\nimport OverlayLoading from \"../../../Utils/OverlayLoading\";\nimport Overlay from \"../../../Utils/Overlay\";\nimport { JOURNAL_FRAGMENT } from \"./refunds.gql\";\n\nconst GET_ENTRY_REFUND_INFO = gql`\n  query GetEntryRefundInfo_1($id: ID!) {\n    journalEntry(id: $id) {\n      ...JournalEntry_2Fragment\n    }\n  }\n  ${JOURNAL_FRAGMENT}\n`;\n\nconst NULLISH = Symbol();\n\nexport interface AddRefundProps {\n  entryId: string | null;\n  open: boolean;\n  onClose: () => void;\n  onExited: () => void;\n}\n\n// Must be in separate component to access FormikContext.\nconst AddRefundDialog = (\n  props: AddRefundProps & {\n    handleSubmit: FormikProps<AddValues>[\"handleSubmit\"];\n  }\n) => {\n  const { entryId, open, onClose, onExited: onExitedCb, handleSubmit } = props;\n\n  const { resetForm, isSubmitting, isValid } = useFormikContext<AddValues>();\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const onError = useCallback<\n    NonNullable<\n      QueryHookOptions<GetEntryRefundInfo, GetEntryRefundInfoVars>[\"onError\"]\n    >\n  >(\n    (error) =>\n      setFormikStatus({\n        msg: error.message,\n        type: FormikStatusType.FATAL_ERROR,\n      }),\n    [setFormikStatus]\n  );\n\n  const { loading, error, data } = useQuery<\n    GetEntryRefundInfo,\n    GetEntryRefundInfoVars\n  >(GET_ENTRY_REFUND_INFO, {\n    skip: !entryId,\n    variables: { id: entryId as string },\n    onError,\n  });\n\n  const total = data?.journalEntry?.total;\n  const refunds = data?.journalEntry?.refunds || [];\n  const maxTotal = useMemo(() => {\n    if (total) {\n      const totalRefunds = refunds.reduce(\n        (totalRefunds, { deleted, total }) =>\n          deleted ? totalRefunds : totalRefunds + total.num / total.den,\n        0\n      );\n      return total.num / total.den - totalRefunds;\n    }\n    return Number.MAX_SAFE_INTEGER;\n  }, [total, refunds]);\n\n  const date = data?.journalEntry?.date;\n  const minDate = useMemo<Date | undefined>(\n    () => (date ? new Date(date) : undefined),\n    [date]\n  );\n\n  const onExited = useCallback(() => {\n    onExitedCb();\n    resetForm();\n    setFormikStatus(null);\n  }, [resetForm, onExitedCb, setFormikStatus]);\n\n  const [generalError, fatalError] = useMemo<\n    [string | null, boolean | null]\n  >(() => {\n    if (\n      formikStatus &&\n      (formikStatus.type === FormikStatusType.FATAL_ERROR ||\n        formikStatus.type === FormikStatusType.ERROR)\n    ) {\n      return [\n        formikStatus.msg,\n        formikStatus.type === FormikStatusType.FATAL_ERROR,\n      ];\n    }\n    return [null, null];\n  }, [formikStatus]);\n\n  const journalEntryType = data?.journalEntry?.type;\n  const title = useMemo(() => {\n    const title =\n      !loading && !error && (journalEntryType ?? NULLISH) !== NULLISH\n        ? `${\n            journalEntryType === JournalEntryType.Credit ? \"Give\" : \"Add\"\n          } Refund`\n        : \"Refund\";\n\n    if (fatalError) {\n      return \"Fatal Error\";\n    } else if (loading) {\n      return `Loading ${title}...`;\n    } else if (isSubmitting) {\n      return `Submitting ${title}`;\n    }\n    return title;\n  }, [loading, error, journalEntryType, fatalError, isSubmitting]);\n\n  const theme = useTheme();\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      onExited={onExited}\n      disableBackdropClick={isSubmitting}\n      disableEscapeKeyDown={isSubmitting}\n      fullWidth\n      maxWidth=\"lg\"\n      PaperProps={\n        {\n          component: \"form\",\n          onSubmit: handleSubmit,\n        } as PaperProps & { onSubmit: FormikProps<AddValues>[\"handleSubmit\"] }\n      }\n    >\n      <DialogTitle\n        style={generalError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {(loading || isSubmitting) && !generalError && (\n          <OverlayLoading zIndex=\"modal\" />\n        )}\n        {!!generalError && fatalError && (\n          <Overlay opacity={0.78} zIndex=\"modal\" padding={2}>\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          </Overlay>\n        )}\n        <DialogContent dividers>\n          {!!generalError && !fatalError && (\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          )}\n          <Grid container spacing={2}>\n            <Grid item lg={4} sm={6} xs={12}>\n              <DateEntry\n                minDate={minDate}\n                disabled={loading || isSubmitting}\n                fullWidth\n              />\n            </Grid>\n            <Grid item lg={4} sm={6} xs={12}>\n              <Description disabled={loading || isSubmitting} fullWidth />\n            </Grid>\n            <Grid item lg={4} sm={6} xs={12}>\n              <PaymentMethod disabled={loading || isSubmitting} fullWidth />\n            </Grid>\n            <Grid item lg={4} sm={6} xs={12}>\n              <Total\n                disabled={loading || isSubmitting}\n                fullWidth\n                maxTotal={maxTotal}\n              />\n            </Grid>\n            <Grid\n              item\n              container\n              justify=\"center\"\n              alignItems=\"flex-start\"\n              lg={4}\n              md={6}\n              sm={12}\n            >\n              <Reconcile disabled={loading || isSubmitting} label />\n            </Grid>\n          </Grid>\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!fatalError && (\n          <Button\n            disabled={loading || isSubmitting || !isValid}\n            type=\"submit\"\n            startIcon={<AddIcon />}\n            color=\"primary\"\n            variant=\"contained\"\n          >\n            Add\n          </Button>\n        )}\n        <Button\n          disabled={loading || isSubmitting}\n          color={fatalError ? \"primary\" : \"default\"}\n          startIcon={!fatalError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {fatalError ? \"Ok\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst AddRefund = (props: AddRefundProps) => {\n  const { entryId, open, onClose, onExited } = props;\n\n  const initialValues = useMemo<Partial<AddValues>>(() => ({}), []);\n\n  const client = useApolloClient();\n  const onSubmit = useCallback<FormikConfig<AddValues>[\"onSubmit\"]>(\n    async (values, formikHelpers) => {\n      try {\n        formikHelpers.setStatus(null);\n        await submitAdd(client, entryId || \"\", values, formikHelpers);\n        onClose();\n      } catch (error) {\n        formikHelpers.setStatus({\n          msg: error.message ?? `${error}`,\n          type: FormikStatusType.ERROR,\n        } as FormikStatus);\n      }\n    },\n    [client, entryId, onClose]\n  );\n\n  const children = useCallback(\n    (props: FormikProps<AddValues>) => (\n      <AddRefundDialog\n        entryId={entryId}\n        open={open}\n        onClose={onClose}\n        onExited={onExited}\n        handleSubmit={props.handleSubmit}\n      />\n    ),\n    [entryId, open, onClose, onExited]\n  );\n\n  return (\n    <Formik\n      initialValues={initialValues as AddValues}\n      initialStatus={null}\n      // isInitialValid={false}\n      enableReinitialize={true}\n      onSubmit={onSubmit}\n      children={children}\n    />\n  );\n};\n\nexport default AddRefund;\n","import { O } from \"ts-toolbelt\";\nimport { FormikConfig } from \"formik\";\nimport gql from \"graphql-tag\";\nimport ApolloClient from \"apollo-client\";\nimport { isEqual } from \"date-fns\";\n\nimport {\n  JournalEntryUpdateRefundFields,\n  PayMethodEntryOptFragment,\n  UpdateRefundMutation as UpdateRefund,\n  UpdateRefundMutationVariables as UpdateRefundVars,\n} from \"../../../../apollo/graphTypes\";\nimport { TransmutationValue } from \"../../../../formik/utils\";\nimport { JOURNAL_ENTRY_REFUND } from \"../../Table/JournalEntries.gql\";\nimport { CHECK_ID } from \"../../constants\";\n\nexport type UpdateValues = O.NonNullable<\n  O.Overwrite<\n    O.Required<JournalEntryUpdateRefundFields>,\n    {\n      date: TransmutationValue<\n        Date,\n        NonNullable<JournalEntryUpdateRefundFields[\"date\"]>\n      >;\n      total: TransmutationValue<\n        string,\n        NonNullable<JournalEntryUpdateRefundFields[\"total\"]>\n      >;\n      paymentMethod: TransmutationValue<\n        string,\n        (PayMethodEntryOptFragment | string)[]\n      >;\n    }\n  >,\n  keyof Omit<JournalEntryUpdateRefundFields, \"description\">\n>;\n\nexport type IniUpdateValues = O.Overwrite<\n  UpdateValues,\n  {\n    paymentMethod: TransmutationValue<string, PayMethodEntryOptFragment[]>;\n  }\n>;\n\nconst UPDATE_REFUND = gql`\n  mutation UpdateRefund(\n    $id: ID!\n    $fields: JournalEntryUpdateRefundFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $paymentMethodUpdate: JournalEntryUpdatePaymentMethod\n  ) {\n    journalEntryUpdateRefund(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      paymentMethodUpdate: $paymentMethodUpdate\n    ) {\n      id\n      __typename\n      refunds {\n        ...JournalEntryRefund_1Fragment\n      }\n    }\n  }\n  ${JOURNAL_ENTRY_REFUND}\n`;\n\nconst submitUpdate: (\n  client: ApolloClient<any>,\n  iniValues: IniUpdateValues,\n  id: string,\n  ...rest: Parameters<FormikConfig<UpdateValues>[\"onSubmit\"]>\n) => ReturnType<FormikConfig<UpdateValues>[\"onSubmit\"]> = async (\n  client,\n  iniValues,\n  id,\n  values\n) => {\n  // Date\n  const date = isEqual(iniValues.date.inputValue, values.date.inputValue)\n    ? null\n    : values.date.value;\n\n  // Description\n  const description =\n    values.description !== iniValues.description\n      ? values.description?.trim() ?? \"\"\n      : null;\n\n  // Total\n  const total =\n    values.total.value.num / values.total.value.den ===\n    iniValues.total.value.num / iniValues.total.value.den\n      ? null\n      : values.total.value;\n\n  // Reconciled\n  const reconciled =\n    values.reconciled === iniValues.reconciled ? null : values.reconciled;\n\n  // Payment Method\n  const { paymentMethod, paymentMethodAdd, paymentMethodUpdate } = (() => {\n    const iniPayMethod =\n      iniValues.paymentMethod.value[iniValues.paymentMethod.value.length - 1];\n\n    const [payMethod, parent] = values.paymentMethod.value\n      .slice(-2)\n      .reverse() as [\n      string | PayMethodEntryOptFragment,\n      PayMethodEntryOptFragment\n    ];\n\n    // Currently CHECK Numbers only\n    if (typeof payMethod === \"string\") {\n      // Update check number on payment method\n      if (iniPayMethod.parent && iniPayMethod.parent.id === CHECK_ID) {\n        return {\n          paymentMethod: null,\n          paymentMethodAdd: null,\n          paymentMethodUpdate: {\n            id: iniPayMethod.id,\n            fields: {\n              active: null,\n              refId: payMethod,\n              name: payMethod,\n            },\n          },\n        };\n\n        // Add new check number payment method\n      } else {\n        return {\n          paymentMethod: null,\n          paymentMethodAdd: {\n            parent: parent.id,\n            refId: payMethod,\n            name: payMethod,\n            active: false,\n          },\n          paymentMethodUpdate: null,\n        };\n      }\n      // Update payment method\n    } else if (payMethod.id !== iniPayMethod.id) {\n      return {\n        paymentMethod: payMethod.id,\n        paymentMethodAdd: null,\n        paymentMethodUpdate: null,\n      };\n    }\n\n    return {\n      paymentMethod: null,\n      paymentMethodAdd: null,\n      paymentMethodUpdate: null,\n    };\n  })();\n\n  const variables: O.Required<\n    UpdateRefundVars,\n    keyof UpdateRefundVars,\n    \"deep\"\n  > = {\n    id,\n    fields: {\n      date,\n      description,\n      total,\n      reconciled,\n      paymentMethod,\n    },\n    paymentMethodAdd,\n    paymentMethodUpdate,\n  };\n\n  await client.mutate<UpdateRefund, UpdateRefundVars>({\n    mutation: UPDATE_REFUND,\n    variables,\n  });\n};\n\nexport default submitUpdate;\n","import React, { useMemo, useCallback } from \"react\";\nimport { useQuery, useApolloClient } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\nimport { Formik, FormikConfig, FormikProps, useFormikContext } from \"formik\";\nimport {\n  useTheme,\n  Dialog,\n  DialogTitle,\n  PaperProps,\n  Box,\n  DialogContent,\n  DialogContentText,\n  Grid,\n  DialogActions,\n  Button,\n} from \"@material-ui/core\";\nimport { Add as AddIcon, Cancel as CancelIcon } from \"@material-ui/icons\";\n\nimport {\n  UpdateRefundIniStateQuery as UpdateRefundIniState,\n  UpdateRefundIniStateQueryVariables as UpdateRefundIniStateVars,\n  JournalEntry_2Fragment as JournalEntryFragment,\n} from \"../../../../apollo/graphTypes\";\nimport submitUpdate, { UpdateValues, IniUpdateValues } from \"./submitUpdate\";\nimport { JOURNAL_FRAGMENT } from \"./refunds.gql\";\nimport { PAY_METHOD_ENTRY_OPT_FRAGMENT } from \"../upsertEntry.gql\";\nimport {\n  FormikStatus,\n  FormikStatusType,\n  useFormikStatus,\n} from \"../../../../formik/utils\";\nimport OverlayLoading from \"../../../Utils/OverlayLoading\";\nimport Overlay from \"../../../Utils/Overlay\";\nimport Description from \"../EntryFields/Description\";\nimport PaymentMethod from \"../EntryFields/PaymentMethod\";\nimport Total from \"../EntryFields/Total\";\nimport DateEntry from \"../EntryFields/DateEntry\";\nimport Reconcile from \"../EntryFields/Reconcile\";\n\nexport interface UpdateRefundProps {\n  entryId: string | null;\n  refundId: string | null;\n  open: boolean;\n  onClose: () => void;\n  onExited: () => void;\n}\n\nconst UPDATE_REFUND_INI_STATE = gql`\n  query UpdateRefundIniState($entryId: ID!, $refundId: ID!) {\n    journalEntry(id: $entryId) {\n      ...JournalEntry_2Fragment\n    }\n    journalEntryRefund(id: $refundId) {\n      __typename\n      id\n      date\n      description\n      paymentMethod {\n        ...PayMethodEntryOptFragment\n        ancestors {\n          ...PayMethodEntryOptFragment\n        }\n      }\n      total {\n        num\n        den\n      }\n      reconciled\n    }\n  }\n  ${JOURNAL_FRAGMENT}\n  ${PAY_METHOD_ENTRY_OPT_FRAGMENT}\n`;\n\nconst UpdateRefundDialog = (\n  props: UpdateRefundProps & {\n    journalEntry: JournalEntryFragment | null;\n    loading: boolean;\n    handleSubmit: FormikProps<UpdateValues>[\"handleSubmit\"];\n  }\n) => {\n  const {\n    refundId,\n    open,\n    onClose,\n    onExited: onExitedCb,\n    journalEntry,\n    loading,\n    handleSubmit,\n  } = props;\n\n  const { resetForm, isSubmitting, isValid } = useFormikContext<UpdateValues>();\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const total = journalEntry?.total;\n  const refunds = journalEntry?.refunds || [];\n  const maxTotal = useMemo(() => {\n    if (total) {\n      const totalRefunds = refunds.reduce(\n        (totalRefunds, { id, deleted, total }) =>\n          // Do NOT include refund being updated in max total calculation\n          deleted || id === refundId\n            ? totalRefunds\n            : totalRefunds + total.num / total.den,\n        0\n      );\n      return total.num / total.den - totalRefunds;\n    }\n    return Number.MAX_SAFE_INTEGER;\n  }, [total, refunds, refundId]);\n\n  const date = journalEntry?.date;\n  const minDate = useMemo<Date | undefined>(\n    () => (date ? new Date(date) : undefined),\n    [date]\n  );\n\n  const onExited = useCallback(() => {\n    onExitedCb();\n    resetForm();\n    setFormikStatus(null);\n  }, [resetForm, onExitedCb, setFormikStatus]);\n\n  const [generalError, fatalError] = useMemo<\n    [string | null, boolean | null]\n  >(() => {\n    if (\n      formikStatus &&\n      (formikStatus.type === FormikStatusType.FATAL_ERROR ||\n        formikStatus.type === FormikStatusType.ERROR)\n    ) {\n      return [\n        formikStatus.msg,\n        formikStatus.type === FormikStatusType.FATAL_ERROR,\n      ];\n    }\n    return [null, null];\n  }, [formikStatus]);\n\n  const title = useMemo(() => {\n    const title = \"Refund Update\";\n\n    if (fatalError) {\n      return \"Fatal Error\";\n    } else if (loading) {\n      return `Loading ${title}...`;\n    } else if (isSubmitting) {\n      return `Submitting ${title}`;\n    }\n    return title;\n  }, [loading, fatalError, isSubmitting]);\n\n  const theme = useTheme();\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      onExited={onExited}\n      disableBackdropClick={isSubmitting}\n      disableEscapeKeyDown={isSubmitting}\n      fullWidth\n      maxWidth=\"lg\"\n      PaperProps={\n        {\n          component: \"form\",\n          onSubmit: handleSubmit,\n        } as PaperProps & {\n          onSubmit: FormikProps<UpdateValues>[\"handleSubmit\"];\n        }\n      }\n    >\n      <DialogTitle\n        style={generalError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {(loading || isSubmitting) && !generalError && (\n          <OverlayLoading zIndex=\"modal\" />\n        )}\n        {!!generalError && fatalError && (\n          <Overlay opacity={0.78} zIndex=\"modal\" padding={2}>\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          </Overlay>\n        )}\n        <DialogContent dividers>\n          {!!generalError && !fatalError && (\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          )}\n          <Grid container spacing={2}>\n            <Grid item lg={4} sm={6} xs={12}>\n              <DateEntry\n                minDate={minDate}\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid item lg={4} sm={6} xs={12}>\n              <Description\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid item lg={4} sm={6} xs={12}>\n              <PaymentMethod\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid item lg={4} sm={6} xs={12}>\n              <Total\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n                maxTotal={maxTotal}\n              />\n            </Grid>\n            <Grid\n              item\n              container\n              justify=\"center\"\n              alignItems=\"flex-start\"\n              lg={4}\n              md={6}\n              sm={12}\n            >\n              <Reconcile\n                disabled={loading || isSubmitting || !!fatalError}\n                label\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!fatalError && (\n          <Button\n            disabled={loading || isSubmitting || !isValid}\n            type=\"submit\"\n            startIcon={<AddIcon />}\n            color=\"primary\"\n            variant=\"contained\"\n          >\n            Update\n          </Button>\n        )}\n        <Button\n          disabled={loading || isSubmitting || !!fatalError}\n          color={fatalError ? \"primary\" : \"default\"}\n          startIcon={!fatalError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {fatalError ? \"Ok\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst UpdateRefund = (props: UpdateRefundProps) => {\n  const { entryId, refundId, open, onClose, onExited } = props;\n\n  const { loading, error, data } = useQuery<\n    UpdateRefundIniState,\n    UpdateRefundIniStateVars\n  >(UPDATE_REFUND_INI_STATE, {\n    skip: !entryId,\n    variables: {\n      entryId: entryId as string,\n      refundId: refundId as string,\n    },\n  });\n\n  const initialStatus = useMemo(\n    () =>\n      error\n        ? ({\n            msg: error.message,\n            type: FormikStatusType.FATAL_ERROR,\n          } as FormikStatus)\n        : null,\n    [error]\n  );\n\n  const journalEntryRefund = data?.journalEntryRefund;\n  const initialValues = useMemo<IniUpdateValues>(() => {\n    if (!journalEntryRefund) {\n      return {} as any;\n    }\n\n    const date = {\n      inputValue: new Date(journalEntryRefund.date),\n      value: journalEntryRefund.date,\n    };\n\n    const paymentMethod = (() => {\n      const { ancestors, ...paymentMethod } = journalEntryRefund.paymentMethod;\n\n      // Array.prototype.sort mutates the array, create copy.\n      const value = [...ancestors].sort((a, b) => {\n        // a is the parent of b\n        if (a.id === b.parent?.id) {\n          return -1;\n          // b is the parent of a\n        } else if (b.id === a.parent?.id) {\n          return 1;\n        }\n        return 0;\n      });\n\n      value.push(paymentMethod);\n\n      return {\n        inputValue: \"\",\n        value,\n      };\n    })();\n\n    const total = {\n      inputValue: (\n        journalEntryRefund.total.num / journalEntryRefund.total.den\n      ).toFixed(2),\n      value: journalEntryRefund.total,\n    };\n\n    const reconciled = journalEntryRefund.reconciled;\n\n    const description = journalEntryRefund.description ?? null;\n\n    return {\n      date,\n      paymentMethod,\n      total,\n      reconciled,\n      description,\n    };\n  }, [journalEntryRefund]);\n\n  const client = useApolloClient();\n  const onSubmit = useCallback<FormikConfig<UpdateValues>[\"onSubmit\"]>(\n    async (values, formikHelpers) => {\n      if (!initialValues) {\n        formikHelpers.setStatus({\n          msg: `Failed to load initial values for refund \"${refundId}\".`,\n          type: FormikStatusType.FATAL_ERROR,\n        } as FormikStatus);\n        return;\n      } else if (!refundId) {\n        formikHelpers.setStatus({\n          msg: `No refund ID.`,\n          type: FormikStatusType.FATAL_ERROR,\n        } as FormikStatus);\n        return;\n      }\n\n      try {\n        formikHelpers.setStatus(null);\n        await submitUpdate(\n          client,\n          initialValues,\n          refundId,\n          values,\n          formikHelpers\n        );\n        onClose();\n      } catch (error) {\n        formikHelpers.setStatus({\n          msg: error?.message ?? `${error}`,\n          type: FormikStatusType.FATAL_ERROR,\n        } as FormikStatus);\n      }\n    },\n    [client, initialValues, onClose, refundId]\n  );\n\n  const children = useCallback(\n    (props: FormikProps<UpdateValues>) => {\n      return (\n        <UpdateRefundDialog\n          entryId={entryId}\n          refundId={refundId}\n          open={open}\n          onClose={onClose}\n          onExited={onExited}\n          journalEntry={data?.journalEntry ?? null}\n          loading={loading}\n          handleSubmit={props.handleSubmit}\n        />\n      );\n    },\n    [data, entryId, loading, onClose, onExited, open, refundId]\n  );\n\n  return (\n    <Formik\n      initialValues={(initialValues ?? {}) as UpdateValues}\n      initialStatus={initialStatus}\n      // isInitialValid={false}\n      enableReinitialize={true}\n      onSubmit={onSubmit}\n      children={children}\n    />\n  );\n};\n\nexport default UpdateRefund;\n","import { O } from \"ts-toolbelt\";\nimport { FormikConfig } from \"formik\";\nimport gql from \"graphql-tag\";\nimport ApolloClient from \"apollo-client\";\nimport { parseName } from \"humanparser\";\n\nimport {\n  JournalEntryAddFields,\n  PayMethodEntryOptFragment,\n  DeptEntryOptFragment,\n  CatEntryOptFragment,\n  SrcEntryBizOptFragment,\n  SrcEntryDeptOptFragment,\n  SrcEntryPersonOptFragment,\n  JournalEntrySourceType,\n  AddEntryMutation as AddEntry,\n  AddEntryMutationVariables as AddEntryVars,\n} from \"../../../../apollo/graphTypes\";\nimport { TransmutationValue } from \"../../../../formik/utils\";\nimport { JOURNAL_ENTRY_FRAGMENT } from \"../../Table/JournalEntries.gql\";\n\nexport type SourceValue =\n  | SrcEntryBizOptFragment\n  | SrcEntryDeptOptFragment\n  | SrcEntryPersonOptFragment\n  | string;\n\nexport type AddValues = O.Overwrite<\n  O.Required<JournalEntryAddFields, keyof JournalEntryAddFields, \"deep\">,\n  {\n    category: TransmutationValue<string, CatEntryOptFragment[]>;\n    date: TransmutationValue<Date | null, JournalEntryAddFields[\"date\"]>;\n    total: TransmutationValue<string, JournalEntryAddFields[\"total\"]>;\n    paymentMethod: TransmutationValue<\n      string,\n      (PayMethodEntryOptFragment | string)[]\n    >;\n    department: DeptEntryOptFragment;\n    source: TransmutationValue<\n      string,\n      (JournalEntrySourceType | SourceValue)[]\n    >;\n  }\n>;\n\nconst ADD_ENTRY = gql`\n  mutation AddEntry(\n    $fields: JournalEntryAddFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $personAdd: PersonAddFields\n    $businessAdd: BusinessAddFields\n  ) {\n    journalEntryAdd(\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      personAdd: $personAdd\n      businessAdd: $businessAdd\n    ) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst submitAdd: (\n  client: ApolloClient<any>,\n  ...rest: Parameters<FormikConfig<AddValues>[\"onSubmit\"]>\n) => ReturnType<FormikConfig<AddValues>[\"onSubmit\"]> = async (\n  client,\n  values\n) => {\n  const { paymentMethod, paymentMethodAdd } = (() => {\n    const payMethod =\n      values.paymentMethod.value[values.paymentMethod.value.length - 1];\n\n    // New Payment Method\n    if (typeof payMethod === \"string\") {\n      const parent = (values.paymentMethod.value[\n        values.paymentMethod.value.length - 2\n      ] as PayMethodEntryOptFragment).id;\n\n      return {\n        paymentMethod: \"\",\n        paymentMethodAdd: {\n          parent,\n          refId: payMethod,\n          name: payMethod,\n          active: false,\n        },\n      };\n    }\n\n    return {\n      paymentMethod: payMethod.id,\n      paymentMethodAdd: null,\n    };\n  })();\n\n  const { source, personAdd, businessAdd } = (() => {\n    const srcType = values.source.value[0] as JournalEntrySourceType;\n    const src = values.source.value[\n      values.source.value.length - 1\n    ] as SourceValue;\n\n    if (typeof src === \"string\") {\n      if (srcType === JournalEntrySourceType.Person) {\n        const parsedName = parseName(src);\n\n        return {\n          source: {\n            sourceType: JournalEntrySourceType.Person,\n            id: \"\",\n          },\n          businessAdd: null,\n          personAdd: {\n            name: {\n              first: parsedName.firstName,\n              last: parsedName.lastName,\n            },\n          },\n        };\n      } else {\n        return {\n          source: {\n            sourceType: JournalEntrySourceType.Business,\n            id: \"\",\n          },\n          businessAdd: {\n            name: src,\n          },\n          personAdd: null,\n        };\n      }\n    }\n\n    return {\n      source: {\n        sourceType: (() => {\n          switch (src.__typename) {\n            case \"Business\":\n              return JournalEntrySourceType.Business;\n            case \"Department\":\n              return JournalEntrySourceType.Department;\n            case \"Person\":\n              return JournalEntrySourceType.Person;\n          }\n        })(),\n        id: src.id,\n      },\n      personAdd: null,\n      businessAdd: null,\n    };\n  })();\n\n  const variables: O.Required<AddEntryVars, keyof AddEntryVars, \"deep\"> = {\n    fields: {\n      date: values.date.value,\n      department: values.department.id,\n      type: values.type,\n      category: values.category.value[values.category.value.length - 1].id,\n      description: values.description?.trim() || null,\n      total: values.total.value,\n      reconciled: values.reconciled ?? null,\n      paymentMethod,\n      source,\n    },\n    paymentMethodAdd,\n    personAdd,\n    businessAdd,\n  };\n\n  await client.mutate<AddEntry, AddEntryVars>({\n    mutation: ADD_ENTRY,\n    variables,\n  });\n};\n\nexport default submitAdd;\n","import React, { useCallback, useMemo, useState, useEffect } from \"react\";\nimport Autocomplete, {\n  AutocompleteProps as AutocompletePropsRaw,\n  RenderInputParams,\n} from \"@material-ui/lab/Autocomplete\";\nimport { UseAutocompleteMultipleProps } from \"@material-ui/lab/useAutocomplete\";\nimport { useField, useFormikContext } from \"formik\";\nimport gql from \"graphql-tag\";\nimport { useQuery, QueryHookOptions } from \"@apollo/react-hooks\";\nimport { TextFieldProps, TextField, Box, Chip } from \"@material-ui/core\";\nimport { ChevronRight } from \"@material-ui/icons\";\n\nimport { CAT_ENTRY_OPT_FRAGMENT } from \"../upsertEntry.gql\";\nimport {\n  CatEntryOptsQuery as CatEntryOpts,\n  CatEntryOptsQueryVariables as CatEntryOptsVars,\n  CatEntryOptFragment as CatValue,\n  CatEntryOptFragment,\n  JournalEntryType,\n} from \"../../../../apollo/graphTypes\";\nimport {\n  TransmutationValue,\n  useFormikStatus,\n  FormikStatusType,\n} from \"../../../../formik/utils\";\n\nconst CAT_OPTS_QUERY = gql`\n  query CatEntryOpts($where: JournalEntryCategoryWhereInput!) {\n    catOpts: journalEntryCategories(where: $where) {\n      ...CatEntryOptFragment\n    }\n  }\n  ${CAT_ENTRY_OPT_FRAGMENT}\n`;\n\ntype CatValueBeta = TransmutationValue<String, CatEntryOptFragment[]>;\n\ntype AutocompleteProps = AutocompletePropsRaw<CatValue> &\n  UseAutocompleteMultipleProps<CatValue>;\n\nconst getOptionLabel = (opt: CatValue) => opt.name;\nconst renderTags: AutocompleteProps[\"renderTags\"] = (\n  values: CatValue[],\n  getTagProps\n) => {\n  const lastIndex = values.length - 1;\n\n  return values.map((dept: any, index: number) => {\n    const isLastIndex = lastIndex === index;\n    const { key, ...props } = getTagProps({ index }) as any;\n\n    return (\n      <Box\n        key={key}\n        display=\"flex\"\n        flexDirection=\"row\"\n        alignItems=\"center\"\n        justifyContent=\"flex-start\"\n      >\n        <Chip\n          color={isLastIndex ? \"primary\" : \"default\"}\n          variant={isLastIndex ? \"default\" : \"outlined\"}\n          label={dept.name}\n          size=\"medium\"\n          {...props}\n          disabled={!isLastIndex}\n        />{\" \"}\n        {!isLastIndex && <ChevronRight fontSize=\"small\" />}\n      </Box>\n    );\n  });\n};\n\nconst NULLISH = Symbol();\n\nexport type CategoryProps = {\n  entryType?: JournalEntryType | null;\n  variant?: \"filled\" | \"outlined\";\n  autoFocus?: boolean;\n} & Omit<TextFieldProps, \"value\">;\n\nconst Category = function (props: CategoryProps) {\n  const formikContext = useFormikContext<{\n    category?: CatValueBeta;\n    type?: JournalEntryType;\n  }>();\n\n  const { disabled: disabledFromProps = false, required } = props;\n\n  const { entryType: entryTypeFromProps, ...textFieldProps } = props;\n\n  const value = formikContext.values?.category?.value || [];\n  const inputValue =\n    formikContext.values?.category?.inputValue.trimLeft() || \"\";\n  const entryType = entryTypeFromProps ?? formikContext.values?.type ?? null;\n\n  const catValue = value[value.length - 1];\n\n  const variables = useMemo<CatEntryOptsVars>(\n    () =>\n      catValue?.id\n        ? {\n            where: {\n              parent: {\n                eq: catValue.id,\n              },\n              type: {\n                eq: entryType,\n              },\n            },\n          }\n        : {\n            where: {\n              hasParent: false,\n              type: {\n                eq: entryType,\n              },\n            },\n          },\n    [catValue, entryType]\n  );\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const onError = useCallback<\n    NonNullable<QueryHookOptions<CatEntryOpts, CatEntryOptsVars>[\"onError\"]>\n  >(\n    (error) =>\n      void setFormikStatus({\n        msg: error.message,\n        type: FormikStatusType.FATAL_ERROR,\n      }),\n    [setFormikStatus]\n  );\n\n  const { loading, error: gqlError, data } = useQuery<\n    CatEntryOpts,\n    CatEntryOptsVars\n  >(CAT_OPTS_QUERY, {\n    skip: (entryType ?? NULLISH) === NULLISH,\n    variables,\n    onCompleted: () =>\n      setTimeout(() => formikContext.validateField(\"category\"), 0),\n    onError,\n  });\n  const catOpts = data?.catOpts;\n  const options = useMemo<CatEntryOptFragment[]>(() => catOpts || [], [\n    catOpts,\n  ]);\n\n  const validate = useCallback(\n    (transmutationVal: CatValueBeta | null | undefined) => {\n      const values = transmutationVal?.value || [];\n      const value = values[values.length - 1] || null;\n\n      if (!value) {\n        if (required) {\n          return \"Category Required\";\n        }\n        return;\n      } else if (options.length > 0) {\n        return \"Sub-category Required\";\n      }\n    },\n    [options, required]\n  );\n\n  const [field, meta, helpers] = useField<CatValueBeta | null | undefined>({\n    name: \"category\",\n    validate,\n  });\n\n  const { onBlur: onBlurField } = field;\n  const { error, touched } = meta;\n  const { setValue } = helpers;\n\n  // Reset category value if type changes\n  useEffect(() => {\n    if (catValue && entryType !== catValue.type) {\n      setValue({\n        inputValue: \"\",\n        value: [],\n      });\n    }\n  }, [entryType, catValue, setValue]);\n\n  // const disableTextInput = useMemo(() => {\n  //   return value.length > 0 && options.length === 0;\n  // }, [value, options]);\n\n  const helperText = useMemo(() => {\n    if (!!error && touched) {\n      return error;\n    } else if ((entryType ?? NULLISH) === NULLISH) {\n      return \"Category requires entry type.\";\n    } else if (!!gqlError) {\n      return gqlError.message;\n    }\n    return \"\";\n  }, [entryType, error, touched, gqlError]);\n\n  const disabled = useMemo(\n    () =>\n      loading ||\n      formikStatus?.type === FormikStatusType.FATAL_ERROR ||\n      (entryType ?? NULLISH) === NULLISH ||\n      disabledFromProps ||\n      (value.length > 0 && options.length === 0),\n    [\n      disabledFromProps,\n      entryType,\n      formikStatus,\n      loading,\n      options.length,\n      value.length,\n    ]\n  );\n\n  const renderInput = useCallback(\n    (params: RenderInputParams) => {\n      return (\n        <TextField\n          {...(textFieldProps as any)}\n          variant={textFieldProps.variant || \"filled\"}\n          {...params}\n          error={(touched && !!error) || !!gqlError}\n          disabled={disabled}\n          helperText={helperText}\n          name=\"category\"\n          label=\"Category\"\n        />\n      );\n    },\n    [textFieldProps, touched, error, gqlError, disabled, helperText]\n  );\n\n  const [hasFocus, setHasFocus] = useState(false);\n\n  const onFocus = useCallback((event?) => setHasFocus(true), [setHasFocus]);\n  const onBlur = useCallback(\n    (event) => {\n      setHasFocus(false);\n      // Fixes formik validate called with wrong version of value\n      event.persist();\n      setTimeout(() => void onBlurField(event), 0);\n    },\n    [setHasFocus, onBlurField]\n  );\n\n  const onChange = useCallback<NonNullable<AutocompleteProps[\"onChange\"]>>(\n    (event, value) => {\n      setValue({ inputValue, value });\n    },\n    [setValue, inputValue]\n  );\n\n  const onInputChange = useCallback<\n    NonNullable<AutocompleteProps[\"onInputChange\"]>\n  >(\n    (event, inputValue: string, reason) => {\n      inputValue = (inputValue || \"\").trimStart();\n      setValue({\n        inputValue,\n        value,\n      });\n    },\n    [setValue, value]\n  );\n\n  const autoCompleteProps = useMemo<AutocompleteProps>(() => {\n    return {\n      ...field,\n      open: hasFocus && options.length > 0,\n      onFocus,\n      onBlur,\n      options,\n      renderTags,\n      forcePopupIcon: false,\n      disabled,\n      value,\n      renderInput,\n      loading,\n      autoSelect: true,\n      multiple: true,\n      getOptionLabel,\n      onInputChange,\n      inputValue,\n      onChange,\n      name: \"category\",\n    };\n  }, [\n    field,\n    hasFocus,\n    options,\n    onFocus,\n    onBlur,\n    loading,\n    disabled,\n    value,\n    renderInput,\n    onInputChange,\n    inputValue,\n    onChange,\n  ]);\n\n  return <Autocomplete {...autoCompleteProps} />;\n};\n\nexport default Category;\n","import React, { useCallback, useMemo, useState } from \"react\";\nimport Autocomplete, {\n  AutocompleteProps as AutocompletePropsRaw,\n  RenderInputParams,\n} from \"@material-ui/lab/Autocomplete\";\nimport { UseAutocompleteMultipleProps } from \"@material-ui/lab/useAutocomplete\";\nimport { useField } from \"formik\";\nimport gql from \"graphql-tag\";\nimport { useQuery, QueryHookOptions } from \"@apollo/react-hooks\";\nimport { TextFieldProps, TextField, Box, Chip } from \"@material-ui/core\";\nimport { ChevronRight } from \"@material-ui/icons\";\n\nimport {\n  DeptEntryOptFragment as DeptValue,\n  DeptEntryOptsQuery,\n  DeptEntryOptsQueryVariables as DeptEntryOptsQueryVars,\n} from \"../../../../apollo/graphTypes\";\nimport { DEPT_ENTRY_OPT_FRAGMENT } from \"../upsertEntry.gql\";\nimport {\n  // TransmutationValue,\n  useFormikStatus,\n  FormikStatusType,\n} from \"../../../../formik/utils\";\n\nconst DEPT_OPTS_QUERY = gql`\n  query DeptEntryOpts($fromParent: ID) {\n    deptOpts: departments(fromParent: $fromParent) {\n      ...DeptEntryOptFragment\n    }\n  }\n  ${DEPT_ENTRY_OPT_FRAGMENT}\n`;\n\nconst businessId = \"5dc4b09bcf96e166daaa0090\";\n\ntype AutocompleteProps = AutocompletePropsRaw<DeptValue> &\n  UseAutocompleteMultipleProps<DeptValue>;\n\nconst getOptionLabel = (opt: DeptValue) => opt.name;\nconst renderTags: AutocompleteProps[\"renderTags\"] = (\n  values: DeptValue[],\n  getTagProps\n) => {\n  const lastIndex = values.length - 1;\n  return values.map((dept: any, index: number) => {\n    const isLastIndex = lastIndex === index;\n    const { key, ...props } = getTagProps({ index }) as any;\n    return (\n      <Box\n        key={key}\n        display=\"flex\"\n        flexDirection=\"row\"\n        alignItems=\"center\"\n        justifyContent=\"flex-start\"\n      >\n        <Chip\n          color={isLastIndex ? \"primary\" : \"default\"}\n          variant={isLastIndex ? \"default\" : \"outlined\"}\n          label={dept.name}\n          size=\"medium\"\n          {...props}\n          disabled={!isLastIndex}\n        />{\" \"}\n        {!isLastIndex && <ChevronRight fontSize=\"small\" />}\n      </Box>\n    );\n  });\n};\nexport type DepartmentProps = {\n  variant?: \"filled\" | \"outlined\";\n  autoFocus?: boolean;\n} & Omit<TextFieldProps, \"value\">;\n\nconst Department = function (props: DepartmentProps) {\n  const { disabled: disabledFromProps = false, required } = props;\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const onError = useCallback<\n    NonNullable<\n      QueryHookOptions<DeptEntryOptsQuery, DeptEntryOptsQueryVars>[\"onError\"]\n    >\n  >(\n    (error) =>\n      void setFormikStatus({\n        msg: error.message,\n        type: FormikStatusType.FATAL_ERROR,\n      }),\n    [setFormikStatus]\n  );\n\n  const { loading, error: gqlError, data } = useQuery<\n    DeptEntryOptsQuery,\n    DeptEntryOptsQueryVars\n  >(DEPT_OPTS_QUERY, { onError, variables: { fromParent: businessId } });\n\n  const depts = data?.deptOpts || [];\n\n  const [hasFocus, setHasFocus] = useState(false);\n\n  // Input must be controlled to stop input when leaf option is selected.\n  const [inputValue, setInputValue] = useState(\"\");\n\n  const validate = useCallback(\n    (value: DeptValue | null) => {\n      if (!value) {\n        if (required) {\n          return \"Department Required\";\n        }\n        return;\n      } else if (\n        depts.some(\n          ({ parent }) =>\n            parent.__typename === \"Department\" && parent.id === value.id\n        )\n      ) {\n        return \"Sub-department Required\";\n      }\n    },\n    [depts, required]\n  );\n\n  const [field, meta, helpers] = useField<DeptValue | null>({\n    name: \"department\",\n    validate,\n  });\n\n  const { value: deptValue, onBlur: onBlurField } = field;\n  const { error, touched } = meta;\n  const { setValue } = helpers;\n\n  const idDeptMap = useMemo(\n    () =>\n      new Map(\n        depts.reduce((idDepts, dept) => {\n          idDepts.push([dept.id, dept]);\n          return idDepts;\n        }, [] as [string, DeptValue][])\n      ),\n    [depts]\n  );\n\n  const value = useMemo(() => {\n    if (!deptValue) {\n      return [];\n    }\n\n    const value: DeptValue[] = [deptValue];\n\n    let { __typename, id } = deptValue.parent;\n\n    while (__typename !== \"Business\" && idDeptMap.has(id)) {\n      const parentDept = idDeptMap.get(id) as DeptValue;\n      value.unshift(parentDept);\n      ({ __typename, id } = parentDept.parent);\n    }\n\n    return value;\n  }, [deptValue, idDeptMap]);\n\n  const options = useMemo(() => {\n    const deptId = value[value.length - 1]?.id;\n    return depts.filter((opt) =>\n      deptId ? opt.parent.id === deptId : opt.parent.__typename === \"Business\"\n    );\n  }, [depts, value]);\n\n  const disableTextInput = useMemo(() => {\n    return value.length > 0 && options.length === 0;\n  }, [value, options]);\n\n  const helperText = useMemo(() => {\n    if (!!error && touched) {\n      return error;\n    } else if (!!gqlError) {\n      return gqlError.message;\n    }\n    return \"\";\n  }, [error, touched, gqlError]);\n\n  const disabled = useMemo(\n    () =>\n      loading ||\n      disableTextInput ||\n      formikStatus?.type === FormikStatusType.FATAL_ERROR ||\n      disabledFromProps,\n    [disableTextInput, disabledFromProps, formikStatus, loading]\n  );\n\n  const renderInput = useCallback(\n    (params: RenderInputParams) => {\n      return (\n        <TextField\n          {...(props as any)}\n          variant={props.variant || \"filled\"}\n          {...params}\n          error={touched && !!error}\n          helperText={helperText}\n          name=\"department\"\n          label=\"Department\"\n          disabled={disabled}\n        />\n      );\n    },\n    [props, touched, error, helperText, disabled]\n  );\n\n  const onFocus = useCallback((event?) => setHasFocus(true), [setHasFocus]);\n  const onBlur = useCallback(\n    (event) => {\n      setHasFocus(false);\n      onBlurField(event);\n    },\n    [setHasFocus, onBlurField]\n  );\n\n  const onChange = useCallback<NonNullable<AutocompleteProps[\"onChange\"]>>(\n    (event, value) => {\n      if (!value) {\n        setValue(null);\n      } else if (Array.isArray(value)) {\n        const len = value.length;\n        setValue(len === 0 ? null : value[len - 1]);\n      } else {\n        setValue(value);\n      }\n    },\n    [setValue]\n  );\n\n  const onInputChange = useCallback<\n    NonNullable<AutocompleteProps[\"onInputChange\"]>\n  >(\n    (event, value: string, reason) => {\n      setInputValue((value || \"\").trimStart());\n    },\n    [setInputValue]\n  );\n\n  const autoCompleteProps = useMemo<AutocompleteProps>(() => {\n    return {\n      ...field,\n      open: hasFocus && options.length > 0,\n      onFocus,\n      onBlur,\n      options,\n      renderTags,\n      forcePopupIcon: false,\n      disabled,\n      value,\n      renderInput,\n      loading,\n      autoSelect: true,\n      multiple: true,\n      getOptionLabel,\n      onChange,\n      onInputChange,\n      inputValue: disableTextInput ? \"\" : inputValue,\n      name: \"department\",\n    };\n  }, [\n    field,\n    hasFocus,\n    options,\n    onFocus,\n    onBlur,\n    disableTextInput,\n    disabled,\n    value,\n    renderInput,\n    loading,\n    onChange,\n    onInputChange,\n    inputValue,\n  ]);\n\n  if (gqlError) {\n    return <pre>{JSON.stringify(gqlError, null, 2)}</pre>;\n  }\n\n  return <Autocomplete {...autoCompleteProps} />;\n};\n\nexport default Department;\n","import React, { useCallback, useMemo, useState, useRef } from \"react\";\nimport Autocomplete, {\n  AutocompleteProps as AutocompletePropsRaw,\n  RenderInputParams,\n} from \"@material-ui/lab/Autocomplete\";\nimport { UseAutocompleteMultipleProps } from \"@material-ui/lab/useAutocomplete\";\nimport { useField } from \"formik\";\nimport { useQuery, QueryHookOptions } from \"@apollo/react-hooks\";\nimport { TextFieldProps, TextField, Box, Chip } from \"@material-ui/core\";\nimport { ChevronRight } from \"@material-ui/icons\";\nimport { parseName } from \"humanparser\";\nimport * as namecase from \"namecase\";\nimport gql from \"graphql-tag\";\n\nimport {\n  JournalEntrySourceType,\n  SrcEntryOptsQuery,\n  SrcEntryOptsQueryVariables as SrcEntryOptsQueryVars,\n  SrcEntryBizOptFragment as BizOpt,\n  SrcEntryDeptOptFragment as DeptOpt,\n  SrcEntryPersonOptFragment as PersonOpt,\n} from \"../../../../apollo/graphTypes\";\nimport {\n  SRC_ENTRY_PERSON_OPT_FRAGMENT,\n  SRC_ENTRY_BIZ_OPT_FRAGMENT,\n  SRC_ENTRY_DEPT_OPT_FRAGMENT,\n} from \"../upsertEntry.gql\";\nimport {\n  TransmutationValue,\n  useFormikStatus,\n  FormikStatusType,\n} from \"../../../../formik/utils\";\n\nconst SRC_ENTRY_OPTS_QUERY = gql`\n  query SrcEntryOpts($name: String!, $isBiz: Boolean!) {\n    businesses(searchByName: $name) @include(if: $isBiz) {\n      ...SrcEntryBizOptFragment\n    }\n    people(searchByName: { first: $name, last: $name }) @skip(if: $isBiz) {\n      ...SrcEntryPersonOptFragment\n    }\n  }\n  ${SRC_ENTRY_PERSON_OPT_FRAGMENT}\n  ${SRC_ENTRY_BIZ_OPT_FRAGMENT}\n  ${SRC_ENTRY_DEPT_OPT_FRAGMENT}\n`;\n\nexport type SourceProps = {\n  variant?: \"filled\" | \"outlined\";\n  autoFocus?: boolean;\n} & Omit<TextFieldProps, \"value\">;\n\nexport type SrcObjectValue = BizOpt | DeptOpt | PersonOpt;\nexport type SourceValue = SrcObjectValue | string;\nexport type Value = SourceValue | JournalEntrySourceType;\ntype Options = Value[];\nexport type FieldValue = TransmutationValue<string, Value[]>;\n\ntype AutocompleteProps = AutocompletePropsRaw<Value> &\n  UseAutocompleteMultipleProps<Value>;\n\nexport const isFreeSoloOpt = (opt: Value) => {\n  switch (opt) {\n    case JournalEntrySourceType.Business:\n    case JournalEntrySourceType.Department:\n    case JournalEntrySourceType.Person:\n      break;\n    default:\n      return typeof opt === \"string\";\n  }\n  return false;\n};\n\nconst getOptionLabel: AutocompleteProps[\"getOptionLabel\"] = (opt): string => {\n  switch (opt) {\n    case JournalEntrySourceType.Business:\n      return \"Vendor\";\n    case JournalEntrySourceType.Department:\n      return \"Department\";\n    case JournalEntrySourceType.Person:\n      return \"Person\";\n    default:\n      if (typeof opt === \"string\") {\n        return opt;\n      }\n  }\n\n  if (opt.__typename === \"Person\") {\n    return `${opt.personName.first} ${opt.personName.last}`;\n  }\n\n  return opt.name;\n};\n\nconst renderTags: AutocompleteProps[\"renderTags\"] = (values, getTagProps) => {\n  const lastIndex = values.length - 1;\n  return values.map((value: Value, index: number) => {\n    const isLastIndex = lastIndex === index;\n    const { key, ...props } = getTagProps({ index }) as any;\n\n    if (isFreeSoloOpt(value)) {\n      return value;\n    }\n\n    return (\n      <Box\n        key={key}\n        display=\"flex\"\n        flexDirection=\"row\"\n        alignItems=\"center\"\n        justifyContent=\"flex-start\"\n      >\n        <Chip\n          color={isLastIndex ? \"primary\" : \"default\"}\n          variant={isLastIndex ? \"default\" : \"outlined\"}\n          label={getOptionLabel(value)}\n          size=\"medium\"\n          {...props}\n          disabled={!isLastIndex}\n        />{\" \"}\n        {!isLastIndex && <ChevronRight fontSize=\"small\" />}\n      </Box>\n    );\n  });\n};\n\nconst filterOptions: AutocompleteProps[\"filterOptions\"] = (\n  options,\n  { inputValue }\n) => {\n  const regex = new RegExp(`(^|\\\\s)${inputValue}`, \"i\");\n  return options.filter((opt) => regex.test(getOptionLabel(opt)));\n};\nconst validate = (transmutationVal?: FieldValue) => {\n  const value = transmutationVal?.value || [];\n  const srcType = (value[0] ?? null) as JournalEntrySourceType | null;\n  const srcValue = value.length > 1 ? value[value.length - 1] : null;\n\n  if (srcType === null || srcValue === null || srcValue === \"\") {\n    return \"Source Required\";\n  } else if (\n    isFreeSoloOpt(srcValue) &&\n    srcType === JournalEntrySourceType.Person\n  ) {\n    // Validate Free Solo Person name\n    const parsedName = parseName(srcValue as string);\n    if (!parsedName.firstName.trim()) {\n      return \"First Name Required\";\n    } else if (!parsedName.lastName.trim()) {\n      return \"Last Name Required\";\n    }\n  }\n};\n\nconst Source = function (props: SourceProps) {\n  const { disabled: disabledFromProps = false } = props;\n\n  const [hasFocus, setHasFocus] = useState(false);\n\n  const [field, meta, helpers] = useField<FieldValue | null | undefined>({\n    name: \"source\",\n    validate,\n  });\n\n  const { onBlur: onBlurField } = field;\n  const value = field.value?.value ?? [];\n  const inputValue = field.value?.inputValue ?? \"\";\n  const { error, touched } = meta;\n  const { setValue } = helpers;\n\n  const srcType = (value[0] ?? null) as JournalEntrySourceType | null;\n  const srcValue = value.length > 1 ? value[value.length - 1] : null;\n\n  const searchedName = useRef(\"\");\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const onError = useCallback<\n    NonNullable<\n      QueryHookOptions<SrcEntryOptsQuery, SrcEntryOptsQueryVars>[\"onError\"]\n    >\n  >(\n    (error) =>\n      void setFormikStatus({\n        msg: error.message,\n        type: FormikStatusType.FATAL_ERROR,\n      }),\n    [setFormikStatus]\n  );\n\n  const { loading, error: gqlError, data } = useQuery<\n    SrcEntryOptsQuery,\n    SrcEntryOptsQueryVars\n  >(SRC_ENTRY_OPTS_QUERY, {\n    skip: !searchedName.current && !value[1],\n    variables: {\n      name: searchedName.current,\n      isBiz: srcType !== JournalEntrySourceType.Person,\n    },\n    onError,\n  });\n\n  const idDeptMap = useMemo(() => {\n    const idDeptMap = new Map<string, DeptOpt>();\n    for (const bizOpt of data?.businesses || []) {\n      for (const deptOpt of bizOpt.departments) {\n        idDeptMap.set(deptOpt.id, deptOpt);\n      }\n    }\n    return idDeptMap;\n  }, [data]);\n\n  const options = useMemo<Options>(() => {\n    if (srcType === null) {\n      return [JournalEntrySourceType.Business, JournalEntrySourceType.Person];\n      // Person ONLY person options\n    } else if (srcType === JournalEntrySourceType.Person) {\n      return srcValue === null ? data?.people || [] : [];\n      // Only Business options\n    } else if (!srcValue) {\n      return data?.businesses || [];\n      // Free solo no options\n    } else if (typeof srcValue === \"string\") {\n      return [] as Options;\n    }\n\n    const options: DeptOpt[] = [];\n\n    for (const deptOpt of idDeptMap.values()) {\n      if (\n        deptOpt.parent.__typename === srcValue.__typename &&\n        deptOpt.parent.id === srcValue.id\n      ) {\n        options.push(deptOpt);\n      }\n    }\n\n    return options;\n  }, [srcType, data, idDeptMap, srcValue]);\n\n  const freeSolo = useMemo(() => {\n    return srcType !== null && srcValue === null;\n  }, [srcType, srcValue]);\n\n  const disableTextInput = useMemo(() => {\n    return value.length > 0 && options.length === 0 && !freeSolo;\n  }, [value, options, freeSolo]);\n\n  const label = useMemo(() => {\n    if (srcType === null) {\n      return \"Source Type\";\n    } else if (srcType === JournalEntrySourceType.Person) {\n      return \"Person Name\";\n    } else if (value.length === 1) {\n      return \"Vendor\";\n    } else if (value.length === 2 && options.length > 0) {\n      return \"Department\";\n    } else if (options.length > 0) {\n      return \"Sub-Department\";\n    }\n\n    return \"Vendor\";\n  }, [value, options, srcType]);\n\n  const disabled = useMemo(\n    () =>\n      // loading || CANNOT disable on loading bc input loses focus on first char\n      disabledFromProps ||\n      disableTextInput ||\n      formikStatus?.type === FormikStatusType.FATAL_ERROR,\n    [disableTextInput, disabledFromProps, formikStatus]\n  );\n\n  const renderInput = useCallback(\n    (\n      params: RenderInputParams & { inputProps?: TextFieldProps[\"inputProps\"] }\n    ) => {\n      // Disable input?\n      if (\n        srcValue &&\n        typeof srcValue !== \"string\" &&\n        srcValue.__typename !== \"Person\" &&\n        options.length === 0\n      ) {\n        params = {\n          ...params,\n          inputProps: {\n            ...(params?.inputProps || {}),\n            style: {\n              ...(params?.inputProps?.style || {}),\n              display: \"none\",\n            },\n          },\n        };\n      }\n\n      return (\n        <TextField\n          {...(props as any)}\n          variant={props.variant || \"filled\"}\n          {...params}\n          error={touched && !!error}\n          helperText={touched ? error : undefined}\n          name=\"source\"\n          label={label}\n          disabled={disabled}\n        />\n      );\n    },\n    [srcValue, options.length, props, touched, error, label, disabled]\n  );\n\n  const onFocus = useCallback((event?) => setHasFocus(true), [setHasFocus]);\n  const onBlur = useCallback<NonNullable<AutocompleteProps[\"onBlur\"]>>(\n    (event) => {\n      setHasFocus(false);\n      // Fixes formik validate called with wrong version of value\n      event.persist();\n      setTimeout(() => onBlurField(event), 0);\n    },\n    [setHasFocus, onBlurField]\n  );\n\n  const onChange = useCallback<NonNullable<AutocompleteProps[\"onChange\"]>>(\n    (event, value) => {\n      const srcValueIndex = value.length - 1;\n      const srcValue = value[srcValueIndex];\n      if (isFreeSoloOpt(srcValue)) {\n        const formattedSrcStrs: string[] = [];\n\n        for (let str of (srcValue as string).split(\" \")) {\n          if (str) {\n            if (namecase.checkName(str)) {\n              str = namecase(str);\n            }\n\n            formattedSrcStrs.push(str);\n          }\n        }\n\n        const formattedStr = formattedSrcStrs.join(\" \").trim();\n\n        value[srcValueIndex] =\n          formattedStr.charAt(0).toUpperCase() + formattedStr.substring(1);\n      }\n      setValue({ inputValue, value });\n    },\n    [setValue, inputValue]\n  );\n\n  const onInputChange = useCallback<\n    NonNullable<AutocompleteProps[\"onInputChange\"]>\n  >(\n    (event, inputValue: string, reason) => {\n      inputValue = (inputValue || \"\").trimStart();\n\n      if (!disableTextInput) {\n        setValue({ inputValue, value });\n      }\n\n      if (srcType !== null && srcValue === null && inputValue) {\n        searchedName.current = inputValue[0].toLowerCase();\n      }\n    },\n    [setValue, srcType, srcValue, value, disableTextInput, searchedName]\n  );\n\n  const autoCompleteProps = useMemo<AutocompleteProps>(() => {\n    return {\n      ...field,\n      inputValue: disableTextInput ? \"\" : inputValue,\n      open: hasFocus && options.length > 0,\n      onFocus,\n      onBlur,\n      options,\n      renderTags,\n      forcePopupIcon: false,\n      freeSolo,\n      value,\n      renderInput,\n      loading,\n      autoSelect: true,\n      multiple: true,\n      getOptionLabel,\n      onInputChange,\n      onChange,\n      filterOptions,\n      name: \"source\",\n      disabled,\n    };\n  }, [\n    field,\n    disableTextInput,\n    inputValue,\n    hasFocus,\n    options,\n    onFocus,\n    onBlur,\n    freeSolo,\n    value,\n    renderInput,\n    loading,\n    onInputChange,\n    onChange,\n    disabled,\n  ]);\n\n  if (gqlError) {\n    return <pre>{JSON.stringify(gqlError, null, 2)}</pre>;\n  }\n\n  return <Autocomplete {...autoCompleteProps} />;\n};\n\nexport default Source;\n","import React, { useMemo } from \"react\";\nimport { useField, useFormikContext } from \"formik\";\nimport ToggleButtonGroup, {\n  ToggleButtonGroupProps,\n} from \"@material-ui/lab/ToggleButtonGroup\";\nimport ToggleButton from \"@material-ui/lab/ToggleButton\";\nimport { BankPlus, BankMinus } from \"mdi-material-ui\";\nimport {\n  Tooltip,\n  Box,\n  FormControlLabel,\n  FormControlLabelProps,\n  FormControl,\n  FormHelperText,\n} from \"@material-ui/core\";\nimport { JournalEntryType } from \"../../../../apollo/graphTypes\";\nimport { useFormikStatus, FormikStatusType } from \"../../../../formik/utils\";\n\nconst NULLISH: unique symbol = Symbol();\n\nconst validate = (value?: JournalEntryType) => {\n  if (((value ?? NULLISH) as any) === NULLISH) {\n    return \"Type Required\";\n  }\n};\n\nconst Type = function (\n  props: {\n    label?: boolean | FormControlLabelProps[\"labelPlacement\"];\n  } & ToggleButtonGroupProps & { disabled?: boolean }\n) {\n  const { disabled: disabledFromProps = false } = props;\n\n  const [formikStatus] = useFormikStatus();\n\n  const { label = false } = props;\n\n  const { isSubmitting } = useFormikContext();\n\n  const [field, meta, helpers] = useField<JournalEntryType | null>({\n    name: \"type\",\n    validate,\n  });\n\n  const { error, touched } = meta;\n  const { setValue, setTouched } = helpers;\n\n  const toggleButtonGroupProps: ToggleButtonGroupProps = useMemo(\n    () => ({\n      size: \"small\",\n      exclusive: true,\n      disabled: isSubmitting,\n      ...field,\n      onChange: async (event, value: JournalEntryType) => {\n        if (((value ?? NULLISH) as any) === NULLISH) {\n          return;\n        }\n\n        setValue(value);\n        await new Promise((resolve) => setTimeout(resolve, 0)); //Avoid pres\n        setTouched(true);\n      },\n    }),\n    [field, isSubmitting, setValue, setTouched]\n  );\n\n  const disabled =\n    isSubmitting ||\n    disabledFromProps ||\n    formikStatus?.type === FormikStatusType.FATAL_ERROR;\n\n  const control = useMemo(\n    () => (\n      <Box pl={1} clone>\n        <ToggleButtonGroup {...(props as any)} {...toggleButtonGroupProps}>\n          <ToggleButton disabled={disabled} value={JournalEntryType.Credit}>\n            <Tooltip arrow placement=\"top\" title=\"Credit\">\n              <BankPlus />\n            </Tooltip>\n          </ToggleButton>\n          <ToggleButton disabled={disabled} value={JournalEntryType.Debit}>\n            <Tooltip arrow placement=\"top\" title=\"Debit\">\n              <BankMinus />\n            </Tooltip>\n          </ToggleButton>\n        </ToggleButtonGroup>\n      </Box>\n    ),\n    [props, toggleButtonGroupProps, disabled]\n  );\n\n  if (label) {\n    return (\n      <FormControl>\n        <FormControlLabel\n          {...(props as any)}\n          labelPlacement={typeof label === \"boolean\" ? undefined : label}\n          control={control}\n          label=\"Type\"\n        />\n        {touched && !!error && <FormHelperText error>{error}</FormHelperText>}\n      </FormControl>\n    );\n  }\n\n  return (\n    <FormControl>\n      {control}\n      {!!error && <FormHelperText error>{error}</FormHelperText>}\n    </FormControl>\n  );\n};\n\nexport default Type;\n","import React, { useMemo, useCallback } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  Box,\n  DialogContent,\n  DialogContentText,\n  PaperProps,\n  Grid,\n  DialogActions,\n  Button,\n  useTheme,\n  GridProps,\n} from \"@material-ui/core\";\nimport {\n  Add as AddIcon,\n  Cancel as CancelIcon,\n  Queue as QueueIcon,\n} from \"@material-ui/icons\";\nimport { Formik, FormikConfig, FormikProps, useFormikContext } from \"formik\";\nimport { useApolloClient, useQuery } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\n\nimport {\n  DeptIniValueForAddEntryQuery as DeptIniValueForAddEntry,\n  DeptIniValueForAddEntryQueryVariables as DeptIniValueForAddEntryVars,\n} from \"../../../../apollo/graphTypes\";\nimport submitAdd, { AddValues } from \"./submitAdd\";\nimport {\n  FormikStatusType,\n  FormikStatus,\n  useFormikStatus,\n} from \"../../../../formik/utils\";\nimport { DEPT_ENTRY_OPT_FRAGMENT } from \"../upsertEntry.gql\";\nimport OverlayLoading from \"../../../Utils/OverlayLoading\";\nimport Overlay from \"../../../Utils/Overlay\";\nimport DateEntry from \"../EntryFields/DateEntry\";\nimport Description from \"../EntryFields/Description\";\nimport Total from \"../EntryFields/Total\";\nimport Reconcile from \"../EntryFields/Reconcile\";\nimport PaymentMethod from \"../EntryFields/PaymentMethod\";\nimport Category from \"../EntryFields/Category\";\nimport Department from \"../EntryFields/Department\";\nimport Source from \"../EntryFields/Source\";\nimport Type from \"../EntryFields/Type\";\n\nexport interface AddEntryProps {\n  deptId?: string | null;\n  open: boolean;\n  onClose: () => void;\n}\n\nconst gridEntryResponsiveProps: GridProps = {\n  item: true,\n  lg: 4,\n  sm: 6,\n  xs: 12,\n} as const;\n\nconst DEPT_INI_VALUE = gql`\n  query DeptIniValueForAddEntry($id: ID!) {\n    department(id: $id) {\n      ...DeptEntryOptFragment\n    }\n  }\n  ${DEPT_ENTRY_OPT_FRAGMENT}\n`;\n\nconst AddEntryDialog = (\n  props: AddEntryProps & {\n    loading: boolean;\n  }\n) => {\n  const { open, onClose, loading } = props;\n\n  const { resetForm, isSubmitting, isValid, submitForm } = useFormikContext<\n    AddValues\n  >();\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const [generalError, fatalError] = useMemo<\n    [string | null, boolean | null]\n  >(() => {\n    if (\n      formikStatus &&\n      (formikStatus.type === FormikStatusType.FATAL_ERROR ||\n        formikStatus.type === FormikStatusType.ERROR)\n    ) {\n      return [\n        formikStatus.msg,\n        formikStatus.type === FormikStatusType.FATAL_ERROR,\n      ];\n    }\n    return [null, null];\n  }, [formikStatus]);\n\n  const onExited = useCallback(() => {\n    resetForm();\n    setFormikStatus(null);\n  }, [resetForm, setFormikStatus]);\n\n  const title = useMemo<string>(() => {\n    if (fatalError) {\n      return \"Fatal Error\";\n    } else if (isSubmitting) {\n      return \"Submitting Add Entry...\";\n    } else if (loading) {\n      return \"Loading Add Entry...\";\n    }\n    return \"Add Entry\";\n  }, [fatalError, isSubmitting, loading]);\n\n  const theme = useTheme();\n\n  const onClickAdd = useCallback(async () => {\n    try {\n      setFormikStatus(null);\n      await submitForm();\n      onClose();\n    } catch (error) {\n      setFormikStatus({\n        msg: error.message ?? `${error}`,\n        type: FormikStatusType.ERROR,\n      } as FormikStatus);\n    }\n  }, [submitForm, onClose, setFormikStatus]);\n\n  const onClickAddAndNew = useCallback(async () => {\n    try {\n      setFormikStatus(null);\n      await submitForm();\n      resetForm();\n    } catch (error) {\n      setFormikStatus({\n        msg: error.message ?? `${error}`,\n        type: FormikStatusType.ERROR,\n      } as FormikStatus);\n    }\n  }, [submitForm, resetForm, setFormikStatus]);\n\n  const handleSubmit = useCallback(\n    (event: React.FormEvent<HTMLFormElement>) => event.preventDefault(),\n    []\n  );\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      onExited={onExited}\n      disableBackdropClick={isSubmitting}\n      disableEscapeKeyDown={isSubmitting}\n      fullWidth\n      maxWidth=\"lg\"\n      PaperProps={\n        {\n          component: \"form\",\n          onSubmit: handleSubmit,\n        } as PaperProps & { onSubmit: FormikProps<AddValues>[\"handleSubmit\"] }\n      }\n    >\n      <DialogTitle\n        style={generalError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {(isSubmitting || loading) && !generalError && (\n          <OverlayLoading zIndex=\"modal\" />\n        )}\n        {!!generalError && fatalError && (\n          <Overlay opacity={0.78} zIndex=\"modal\" padding={2}>\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          </Overlay>\n        )}\n        <DialogContent dividers>\n          {!!generalError && !fatalError && (\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          )}\n          <Grid container spacing={2}>\n            <Grid {...gridEntryResponsiveProps} justify=\"center\" container>\n              <Type\n                style={{ margin: theme.spacing(1) }}\n                label=\"start\"\n                disabled={loading || isSubmitting || !!fatalError}\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <DateEntry\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Source\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Category\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n                required\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Department\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n                required\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Description\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <PaymentMethod\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Total\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid\n              container\n              justify=\"center\"\n              alignItems=\"flex-start\"\n              {...gridEntryResponsiveProps}\n            >\n              <Reconcile\n                disabled={loading || isSubmitting || !!fatalError}\n                label\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!fatalError && (\n          <React.Fragment>\n            <Button\n              onClick={onClickAdd}\n              disabled={loading || isSubmitting || !isValid}\n              type=\"submit\"\n              startIcon={<AddIcon />}\n              color=\"primary\"\n              variant=\"contained\"\n            >\n              Add\n            </Button>\n            <Button\n              onClick={onClickAddAndNew}\n              disabled={loading || isSubmitting || !isValid}\n              type=\"submit\"\n              startIcon={<QueueIcon />}\n              variant=\"outlined\"\n            >\n              Add & New\n            </Button>\n          </React.Fragment>\n        )}\n        <Button\n          disabled={isSubmitting}\n          color={fatalError ? \"primary\" : \"default\"}\n          startIcon={!fatalError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {fatalError ? \"Ok\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst AddEntry = (props: AddEntryProps) => {\n  const { open, onClose, deptId } = props;\n\n  const { loading, error, data } = useQuery<\n    DeptIniValueForAddEntry,\n    DeptIniValueForAddEntryVars\n  >(DEPT_INI_VALUE, {\n    skip: !deptId,\n    variables: {\n      id: deptId as string,\n    },\n  });\n\n  const department = data?.department;\n  const initialValues = useMemo<Partial<AddValues>>(\n    () => (department ? { department } : {}),\n    [department]\n  );\n  const initialStatus = useMemo<FormikStatus | null>(\n    () =>\n      error ? { msg: error.message, type: FormikStatusType.FATAL_ERROR } : null,\n    [error]\n  );\n\n  const client = useApolloClient();\n  const onSubmit = useCallback<FormikConfig<AddValues>[\"onSubmit\"]>(\n    (values, formikHelpers) => submitAdd(client, values, formikHelpers),\n    [client]\n  );\n\n  const children = useCallback(\n    (props: FormikProps<AddValues>) => (\n      <AddEntryDialog open={open} onClose={onClose} loading={loading} />\n    ),\n    [open, onClose, loading]\n  );\n\n  return (\n    <Formik\n      initialValues={initialValues as AddValues}\n      initialStatus={initialStatus}\n      enableReinitialize={true}\n      onSubmit={onSubmit}\n      children={children}\n    />\n  );\n};\n\nexport default AddEntry;\n","import { O, U } from \"ts-toolbelt\";\nimport { FormikConfig } from \"formik\";\nimport gql from \"graphql-tag\";\nimport ApolloClient from \"apollo-client\";\nimport { isEqual } from \"date-fns\";\nimport { parseName } from \"humanparser\";\n\nimport {\n  JournalEntryUpdateFields,\n  PayMethodEntryOptFragment,\n  DeptEntryOptFragment,\n  CatEntryOptFragment,\n  JournalEntrySourceType,\n  UpdateEntryMutation as UpdateEntry,\n  UpdateEntryMutationVariables as UpdateEntryVars,\n} from \"../../../../apollo/graphTypes\";\nimport { TransmutationValue } from \"../../../../formik/utils\";\nimport { CHECK_ID } from \"../../constants\";\nimport { JOURNAL_ENTRY_FRAGMENT } from \"../../Table/JournalEntries.gql\";\nimport { SourceValue } from \"./submitAdd\";\n\nexport type UpdateValues = O.NonNullable<\n  O.Overwrite<\n    O.Required<\n      JournalEntryUpdateFields,\n      keyof JournalEntryUpdateFields,\n      \"deep\"\n    >,\n    {\n      category: TransmutationValue<string, CatEntryOptFragment[]>;\n      date: TransmutationValue<\n        Date,\n        NonNullable<JournalEntryUpdateFields[\"date\"]>\n      >;\n      total: TransmutationValue<\n        string,\n        NonNullable<JournalEntryUpdateFields[\"total\"]>\n      >;\n      paymentMethod: TransmutationValue<\n        string,\n        (PayMethodEntryOptFragment | string)[]\n      >;\n      department: DeptEntryOptFragment;\n      source: TransmutationValue<\n        string,\n        (JournalEntrySourceType | SourceValue)[]\n      >;\n    }\n  >,\n  keyof Omit<JournalEntryUpdateFields, \"description\">\n>;\n\nexport type IniUpdateValues = O.Overwrite<\n  UpdateValues,\n  {\n    paymentMethod: TransmutationValue<string, PayMethodEntryOptFragment[]>;\n    source: TransmutationValue<\n      string,\n      (JournalEntrySourceType | U.Exclude<SourceValue, string>)[]\n    >;\n  }\n>;\n\nconst NULLISH = Symbol();\n\nconst UPDATE_ENTRY = gql`\n  mutation UpdateEntry(\n    $id: ID!\n    $fields: JournalEntryUpdateFields!\n    $paymentMethodAdd: PaymentMethodAddFields\n    $paymentMethodUpdate: JournalEntryUpdatePaymentMethod\n    $personAdd: PersonAddFields\n    $businessAdd: BusinessAddFields\n  ) {\n    journalEntryUpdate(\n      id: $id\n      fields: $fields\n      paymentMethodAdd: $paymentMethodAdd\n      paymentMethodUpdate: $paymentMethodUpdate\n      personAdd: $personAdd\n      businessAdd: $businessAdd\n    ) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst submitUpdate: (\n  client: ApolloClient<any>,\n  iniValues: IniUpdateValues,\n  id: string,\n  ...rest: Parameters<FormikConfig<UpdateValues>[\"onSubmit\"]>\n) => ReturnType<FormikConfig<UpdateValues>[\"onSubmit\"]> = async (\n  client,\n  iniValues,\n  id,\n  values\n) => {\n  // Category\n  const category = (() => {\n    const category =\n      values.category.value[values.category.value.length - 1]?.id ?? null;\n\n    return category ===\n      (iniValues.category.value[iniValues.category.value.length - 1]?.id ??\n        null)\n      ? null\n      : category;\n  })();\n\n  // Date\n  const date = isEqual(iniValues.date.inputValue, values.date.inputValue)\n    ? null\n    : values.date.value;\n\n  // Department\n  const department =\n    values.department.id === iniValues.department.id\n      ? null\n      : values.department.id;\n\n  // Description\n  const description =\n    values.description?.trim() && values.description !== iniValues.description\n      ? (values.description as string).trim()\n      : null;\n\n  // Total\n  const total =\n    values.total.value.num / values.total.value.den ===\n    iniValues.total.value.num / iniValues.total.value.den\n      ? null\n      : values.total.value;\n\n  // Type\n  const type = values.type === iniValues.type ? null : values.type;\n\n  // Reconciled\n  const reconciled =\n    values.reconciled === iniValues.reconciled ? null : values.reconciled;\n\n  // Payment Method\n  const { paymentMethod, paymentMethodAdd, paymentMethodUpdate } = (() => {\n    const iniPayMethod =\n      iniValues.paymentMethod.value[iniValues.paymentMethod.value.length - 1];\n\n    const [payMethod, parent] = values.paymentMethod.value\n      .slice(-2)\n      .reverse() as [\n      string | PayMethodEntryOptFragment,\n      PayMethodEntryOptFragment\n    ];\n\n    // Currently CHECK Numbers only\n    if (typeof payMethod === \"string\") {\n      // Update check number on payment method\n      if (iniPayMethod.parent && iniPayMethod.parent.id === CHECK_ID) {\n        return {\n          paymentMethod: null,\n          paymentMethodAdd: null,\n          paymentMethodUpdate: {\n            id: iniPayMethod.id,\n            fields: {\n              active: null,\n              refId: payMethod,\n              name: payMethod,\n            },\n          },\n        };\n\n        // Add new check number payment method\n      } else {\n        return {\n          paymentMethod: null,\n          paymentMethodAdd: {\n            parent: parent.id,\n            refId: payMethod,\n            name: payMethod,\n            active: false,\n          },\n          paymentMethodUpdate: null,\n        };\n      }\n      // Update payment method\n    } else if (payMethod.id !== iniPayMethod.id) {\n      return {\n        paymentMethod: payMethod.id,\n        paymentMethodAdd: null,\n        paymentMethodUpdate: null,\n      };\n    }\n\n    return {\n      paymentMethod: null,\n      paymentMethodAdd: null,\n      paymentMethodUpdate: null,\n    };\n  })();\n\n  // Source\n  const { source, personAdd, businessAdd } = (() => {\n    const srcType = values.source.value[0] as JournalEntrySourceType;\n    const src = values.source.value[\n      values.source.value.length - 1\n    ] as SourceValue;\n\n    const iniSrcType = iniValues.source.value[0] as JournalEntrySourceType;\n    const iniSrc = iniValues.source.value[\n      iniValues.source.value.length - 1\n    ] as Exclude<SourceValue, string>;\n\n    if (typeof src === \"string\") {\n      if (srcType === JournalEntrySourceType.Person) {\n        const parsedName = parseName(src);\n\n        return {\n          source: {\n            sourceType: JournalEntrySourceType.Person,\n            id: \"\",\n          },\n          businessAdd: null,\n          personAdd: {\n            name: {\n              first: parsedName.firstName,\n              last: parsedName.lastName,\n            },\n          },\n        };\n      } else {\n        return {\n          source: {\n            sourceType: JournalEntrySourceType.Business,\n            id: \"\",\n          },\n          businessAdd: {\n            name: src,\n          },\n          personAdd: null,\n        };\n      }\n    } else if (srcType === iniSrcType && src.id === iniSrc.id) {\n      // No Updates\n      return {\n        source: null,\n        businessAdd: null,\n        personAdd: null,\n      };\n    }\n\n    return {\n      source: {\n        sourceType: (() => {\n          switch (src.__typename) {\n            case \"Business\":\n              return JournalEntrySourceType.Business;\n            case \"Department\":\n              return JournalEntrySourceType.Department;\n            case \"Person\":\n              return JournalEntrySourceType.Person;\n          }\n        })(),\n        id: src.id,\n      },\n      personAdd: null,\n      businessAdd: null,\n    };\n  })();\n\n  const variables: O.Required<\n    UpdateEntryVars,\n    keyof UpdateEntryVars,\n    \"deep\"\n  > = {\n    id,\n    fields: {\n      category,\n      date,\n      department,\n      description,\n      total,\n      type,\n      source,\n      reconciled,\n      paymentMethod,\n    },\n    paymentMethodAdd,\n    paymentMethodUpdate,\n    personAdd,\n    businessAdd,\n  };\n\n  console.log(variables);\n\n  await client.mutate<UpdateEntry, UpdateEntryVars>({\n    mutation: UPDATE_ENTRY,\n    variables,\n  });\n};\n\nexport default submitUpdate;\n","import React, { useMemo, useCallback } from \"react\";\nimport gql from \"graphql-tag\";\nimport { Formik, FormikConfig, FormikProps, useFormikContext } from \"formik\";\nimport { useQuery, useApolloClient } from \"@apollo/react-hooks\";\nimport {\n  Dialog,\n  DialogTitle,\n  Box,\n  DialogContent,\n  DialogContentText,\n  PaperProps,\n  Grid,\n  DialogActions,\n  Button,\n  useTheme,\n  GridProps,\n} from \"@material-ui/core\";\nimport { Add as AddIcon, Cancel as CancelIcon } from \"@material-ui/icons\";\n\nimport {\n  UpdateEntryIniStateQuery as UpdateEntryIniState,\n  UpdateEntryIniStateQueryVariables as UpdateEntryIniStateVars,\n  JournalEntrySourceType,\n  SrcEntryDeptOptFragment,\n  SrcEntryBizOptFragment,\n} from \"../../../../apollo/graphTypes\";\nimport {\n  FormikStatus,\n  FormikStatusType,\n  useFormikStatus,\n} from \"../../../../formik/utils\";\nimport submitUpdate, { UpdateValues, IniUpdateValues } from \"./submitUpdate\";\nimport {\n  PAY_METHOD_ENTRY_OPT_FRAGMENT,\n  DEPT_ENTRY_OPT_FRAGMENT,\n  CAT_ENTRY_OPT_FRAGMENT,\n  SRC_ENTRY_PERSON_OPT_FRAGMENT,\n  SRC_ENTRY_BIZ_OPT_FRAGMENT,\n  SRC_ENTRY_DEPT_OPT_FRAGMENT,\n} from \"../upsertEntry.gql\";\nimport { min } from \"date-fns/esm\";\n\nimport OverlayLoading from \"../../../Utils/OverlayLoading\";\nimport Overlay from \"../../../Utils/Overlay\";\nimport DateEntry from \"../EntryFields/DateEntry\";\nimport Description from \"../EntryFields/Description\";\nimport Total from \"../EntryFields/Total\";\nimport Reconcile from \"../EntryFields/Reconcile\";\nimport PaymentMethod from \"../EntryFields/PaymentMethod\";\nimport Category from \"../EntryFields/Category\";\nimport Department from \"../EntryFields/Department\";\nimport Source from \"../EntryFields/Source\";\nimport Type from \"../EntryFields/Type\";\n\nexport interface UpdateEntryProps {\n  entryId: string | null;\n  open: boolean;\n  onClose: () => void;\n  onExited: () => void;\n}\n\nconst UPDATE_ENTRY_INI_STATE = gql`\n  query UpdateEntryIniState($id: ID!) {\n    journalEntry(id: $id) {\n      id\n      __typename\n      type\n      date\n      department {\n        ...DeptEntryOptFragment\n      }\n      category {\n        ...CatEntryOptFragment\n        ancestors {\n          ...CatEntryOptFragment\n        }\n      }\n      source {\n        ...SrcEntryPersonOptFragment\n        ...SrcEntryBizOptFragment\n        ...SrcEntryDeptOptFragment\n        ... on Department {\n          ancestors {\n            ...SrcEntryDeptOptFragment\n            ...SrcEntryBizOptFragment\n          }\n        }\n      }\n      paymentMethod {\n        ...PayMethodEntryOptFragment\n        ancestors {\n          ...PayMethodEntryOptFragment\n        }\n      }\n      description\n      total {\n        num\n        den\n      }\n      refunds {\n        id\n        __typename\n        deleted\n        date\n        total {\n          num\n          den\n        }\n      }\n      reconciled\n    }\n  }\n  ${DEPT_ENTRY_OPT_FRAGMENT}\n  ${CAT_ENTRY_OPT_FRAGMENT}\n  ${SRC_ENTRY_PERSON_OPT_FRAGMENT}\n  ${SRC_ENTRY_BIZ_OPT_FRAGMENT}\n  ${SRC_ENTRY_DEPT_OPT_FRAGMENT}\n  ${PAY_METHOD_ENTRY_OPT_FRAGMENT}\n`;\n\nconst MAX_DATE = new Date(8640000000000000);\n\nconst gridEntryResponsiveProps: GridProps = {\n  item: true,\n  lg: 4,\n  sm: 6,\n  xs: 12,\n} as const;\n\nconst UpdateEntryDialog = (\n  props: Omit<UpdateEntryProps, \"entryId\"> & {\n    journalEntry: NonNullable<UpdateEntryIniState[\"journalEntry\"]> | null;\n    loading: boolean;\n    handleSubmit: FormikProps<UpdateValues>[\"handleSubmit\"];\n  }\n) => {\n  const {\n    open,\n    onClose,\n    onExited: onExitedCb,\n    journalEntry,\n    loading,\n    handleSubmit,\n  } = props;\n\n  const { resetForm, isSubmitting, isValid } = useFormikContext<UpdateValues>();\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const refunds = journalEntry?.refunds || [];\n\n  // Updates to total cannot be less than current refunds.\n  const [minTotal, maxDate] = useMemo(\n    () =>\n      refunds.reduce(\n        ([minTotal, maxDate], { id, deleted, total, date }) => [\n          deleted ? minTotal : minTotal + total.num / total.den,\n          deleted ? maxDate : min([maxDate, new Date(date)]),\n        ],\n        [0, MAX_DATE]\n      ),\n    [refunds]\n  );\n\n  const onExited = useCallback(() => {\n    onExitedCb();\n    resetForm();\n    setFormikStatus(null);\n  }, [resetForm, onExitedCb, setFormikStatus]);\n\n  const [generalError, fatalError] = useMemo<\n    [string | null, boolean | null]\n  >(() => {\n    if (\n      formikStatus &&\n      (formikStatus.type === FormikStatusType.FATAL_ERROR ||\n        formikStatus.type === FormikStatusType.ERROR)\n    ) {\n      return [\n        formikStatus.msg,\n        formikStatus.type === FormikStatusType.FATAL_ERROR,\n      ];\n    }\n    return [null, null];\n  }, [formikStatus]);\n\n  const title = useMemo(() => {\n    const title = \"Entry Update\";\n\n    if (fatalError) {\n      return \"Fatal Error\";\n    } else if (loading) {\n      return `Loading ${title}...`;\n    } else if (isSubmitting) {\n      return `Submitting ${title}`;\n    }\n    return title;\n  }, [loading, fatalError, isSubmitting]);\n\n  const theme = useTheme();\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      onExited={onExited}\n      fullWidth\n      disableBackdropClick={isSubmitting}\n      disableEscapeKeyDown={isSubmitting}\n      maxWidth=\"lg\"\n      PaperProps={\n        {\n          component: \"form\",\n          onSubmit: handleSubmit,\n        } as PaperProps & {\n          onSubmit: FormikProps<UpdateValues>[\"handleSubmit\"];\n        }\n      }\n    >\n      <DialogTitle\n        style={generalError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {(isSubmitting || loading) && !generalError && (\n          <OverlayLoading zIndex=\"modal\" />\n        )}\n        {!!generalError && fatalError && (\n          <Overlay opacity={0.78} zIndex=\"modal\" padding={2}>\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          </Overlay>\n        )}\n        <DialogContent dividers>\n          {!!generalError && !fatalError && (\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          )}\n          <Grid container spacing={2}>\n            <Grid {...gridEntryResponsiveProps} justify=\"center\" container>\n              <Type\n                style={{ margin: theme.spacing(1) }}\n                label=\"start\"\n                disabled={isSubmitting || loading || !!fatalError}\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <DateEntry\n                disabled={isSubmitting || loading || !!fatalError}\n                maxDate={maxDate === MAX_DATE ? undefined : maxDate}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Source\n                disabled={isSubmitting || loading || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Category\n                disabled={isSubmitting || loading || !!fatalError}\n                fullWidth\n                required\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Department\n                disabled={isSubmitting || loading || !!fatalError}\n                fullWidth\n                required\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Description\n                disabled={isSubmitting || loading || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <PaymentMethod\n                disabled={isSubmitting || loading || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Total\n                disabled={isSubmitting || loading || !!fatalError}\n                minTotal={minTotal}\n                fullWidth\n              />\n            </Grid>\n            <Grid\n              container\n              justify=\"center\"\n              alignItems=\"flex-start\"\n              {...gridEntryResponsiveProps}\n            >\n              <Reconcile\n                disabled={isSubmitting || loading || !!fatalError}\n                label\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!fatalError && (\n          <Button\n            disabled={isSubmitting || !isValid || loading}\n            type=\"submit\"\n            startIcon={<AddIcon />}\n            color=\"primary\"\n            variant=\"contained\"\n          >\n            Update\n          </Button>\n        )}\n        <Button\n          disabled={isSubmitting}\n          color={fatalError ? \"primary\" : \"default\"}\n          startIcon={!fatalError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {fatalError ? \"Ok\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst UpdateEntry = (props: UpdateEntryProps) => {\n  const { entryId, open, onClose, onExited } = props;\n\n  const { loading, error, data } = useQuery<\n    UpdateEntryIniState,\n    UpdateEntryIniStateVars\n  >(UPDATE_ENTRY_INI_STATE, {\n    skip: !entryId,\n    variables: {\n      id: entryId as string,\n    },\n  });\n\n  if (error) {\n    console.log(entryId, UPDATE_ENTRY_INI_STATE);\n    console.error(error);\n  }\n\n  const initialStatus = useMemo(\n    () =>\n      error\n        ? ({\n            msg: error.message,\n            type: FormikStatusType.FATAL_ERROR,\n          } as FormikStatus)\n        : null,\n    [error]\n  );\n\n  const journalEntry = data?.journalEntry;\n  const initialValues = useMemo<IniUpdateValues>(() => {\n    if (!journalEntry) {\n      return {} as any;\n    }\n\n    const date = {\n      inputValue: new Date(journalEntry.date),\n      value: journalEntry.date,\n    };\n\n    const category = (() => {\n      const { ancestors, ...category } = journalEntry.category;\n\n      // Array.prototype.sort mutates the array, create copy.\n      const value = [...ancestors].sort((a, b) => {\n        // a is the parent of b\n        if (a.id === b.parent?.id) {\n          return -1;\n          // b is the parent of a\n        } else if (b.id === a.parent?.id) {\n          return 1;\n        }\n        return 0;\n      });\n\n      value.push(category);\n\n      return {\n        inputValue: \"\",\n        value,\n      };\n    })();\n\n    const paymentMethod = (() => {\n      const { ancestors, ...paymentMethod } = journalEntry.paymentMethod;\n\n      // Array.prototype.sort mutates the array, create copy.\n      const value = [...ancestors].sort((a, b) => {\n        // a is the parent of b\n        if (a.id === b.parent?.id) {\n          return -1;\n          // b is the parent of a\n        } else if (b.id === a.parent?.id) {\n          return 1;\n        }\n        return 0;\n      });\n\n      value.push(paymentMethod);\n\n      return {\n        inputValue: \"\",\n        value,\n      };\n    })();\n\n    const total = {\n      inputValue: (journalEntry.total.num / journalEntry.total.den).toFixed(2),\n      value: journalEntry.total,\n    };\n\n    const department = journalEntry.department;\n\n    const reconciled = journalEntry.reconciled;\n\n    const description = journalEntry.description ?? null;\n\n    const type = journalEntry.type;\n\n    const source = (() => {\n      const value: IniUpdateValues[\"source\"][\"value\"] = [];\n\n      const src = journalEntry?.source;\n\n      switch (src?.__typename) {\n        case \"Person\":\n          value.push(JournalEntrySourceType.Person, src);\n          break;\n        case \"Business\":\n          value.push(JournalEntrySourceType.Business, src);\n          break;\n        case \"Department\":\n          // The source type is the root, for Dept is always a business.\n          value.push(JournalEntrySourceType.Business);\n          const ancestorDeptQueue: string[] = [];\n          for (const ancestor of src.ancestors) {\n            if (ancestor.__typename === \"Business\") {\n              value.push(ancestor);\n            } else {\n              ancestorDeptQueue.push(ancestor.id);\n            }\n          }\n\n          const bizAncestor = value[1] as SrcEntryBizOptFragment;\n\n          if (ancestorDeptQueue.length > 0) {\n            const ancestorDepts: SrcEntryDeptOptFragment[] = [];\n            for (const dept of bizAncestor.departments) {\n              const index = ancestorDeptQueue.indexOf(dept.id);\n\n              if (index === -1) {\n                continue;\n              }\n\n              // Be lazy about finding depts\n              if (ancestorDepts.push(dept) === ancestorDeptQueue.length) {\n                break;\n              }\n            }\n\n            // Ensure order\n            ancestorDepts.sort((a, b) => {\n              if (a.id === b.parent.id || bizAncestor.id || a.parent.id) {\n                return -1;\n              } else if (b.id === a.parent.id) {\n                return 1;\n              } else {\n                return 0;\n              }\n            });\n\n            value.push(...ancestorDepts);\n          }\n      }\n\n      return {\n        inputValue: \"\",\n        value,\n      };\n    })();\n\n    const iniUpdateValues: IniUpdateValues = {\n      date,\n      category,\n      paymentMethod,\n      department,\n      total,\n      reconciled,\n      description,\n      type,\n      source,\n    };\n\n    return iniUpdateValues;\n  }, [journalEntry]);\n\n  const client = useApolloClient();\n  const onSubmit = useCallback<FormikConfig<UpdateValues>[\"onSubmit\"]>(\n    async (values, formikHelpers) => {\n      try {\n        formikHelpers.setStatus(null);\n        await submitUpdate(\n          client,\n          initialValues,\n          entryId as string,\n          values,\n          formikHelpers\n        );\n        onClose();\n      } catch (error) {\n        console.error(error);\n        formikHelpers.setStatus({\n          msg: error.message ?? `${error}`,\n          type: FormikStatusType.ERROR,\n        } as FormikStatus);\n      }\n    },\n    [client, initialValues, entryId, onClose]\n  );\n\n  const children = useCallback(\n    (props: FormikProps<UpdateValues>) => (\n      <UpdateEntryDialog\n        open={open}\n        onClose={onClose}\n        onExited={onExited}\n        loading={loading}\n        journalEntry={journalEntry ?? null}\n        handleSubmit={props.handleSubmit}\n      />\n    ),\n    [open, onClose, onExited, loading, journalEntry]\n  );\n\n  return (\n    <Formik\n      initialValues={initialValues as UpdateValues}\n      initialStatus={initialStatus}\n      journalEntry={data?.journalEntry ?? null}\n      loading={loading}\n      onSubmit={onSubmit}\n      enableReinitialize={true}\n      children={children}\n    />\n  );\n};\n\nexport default UpdateEntry;\n","import React, { useCallback, useMemo } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  Button,\n  Box,\n  useTheme,\n} from \"@material-ui/core\";\nimport { Delete as DeleteIcon, Cancel as CancelIcon } from \"@material-ui/icons\";\nimport gql from \"graphql-tag\";\nimport { useMutation } from \"@apollo/react-hooks\";\n\nimport { JOURNAL_ENTRY_FRAGMENT } from \"../../Table/JournalEntries.gql\";\nimport {\n  DeleteEntryMutation,\n  DeleteEntryMutationVariables as DeleteEntryVars,\n} from \"../../../../apollo/graphTypes\";\nimport OverlayLoading from \"../../../Utils/OverlayLoading\";\n\nconst DELETE_ENTRY = gql`\n  mutation DeleteEntry($id: ID!) {\n    journalEntryDelete(id: $id) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst DeleteEntry = (props: {\n  entryId: string | null;\n  onClose: () => void;\n}) => {\n  const { entryId, onClose } = props;\n\n  const [deleteEntry, { loading, error }] = useMutation<\n    DeleteEntryMutation,\n    DeleteEntryVars\n  >(DELETE_ENTRY);\n\n  const hasError = !!error;\n\n  const onDelete = useCallback(\n    (event) => {\n      deleteEntry({ variables: { id: entryId as string } }).then(() =>\n        onClose()\n      );\n    },\n    [entryId, deleteEntry, onClose]\n  );\n\n  const title = useMemo(() => {\n    if (hasError) {\n      return \"Error\";\n    } else if (loading) {\n      return \"Deleting Entry...\";\n    }\n    return \"Delete Entry\";\n  }, [hasError, loading]);\n\n  const theme = useTheme();\n\n  return (\n    <Dialog\n      open={!!entryId}\n      maxWidth=\"sm\"\n      fullWidth\n      disableBackdropClick={loading}\n      disableEscapeKeyDown={loading}\n      onClose={onClose}\n    >\n      <DialogTitle\n        style={hasError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {loading && <OverlayLoading zIndex=\"modal\" />}\n        <DialogContent>\n          {hasError && (\n            <DialogContentText color=\"error\">\n              {error?.message as string}\n            </DialogContentText>\n          )}\n          {!hasError && (\n            <DialogContentText>\n              Are you sure you want to delete this entry?\n            </DialogContentText>\n          )}\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!hasError && (\n          <Button\n            disabled={loading}\n            onClick={onDelete}\n            startIcon={<DeleteIcon />}\n            color=\"primary\"\n            variant=\"contained\"\n          >\n            Delete\n          </Button>\n        )}\n        <Button\n          disabled={loading}\n          startIcon={!hasError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {hasError ? \"Close\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default DeleteEntry;\n","import React, { useCallback, useMemo } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  Button,\n  Box,\n  useTheme,\n} from \"@material-ui/core\";\nimport { Delete as DeleteIcon, Cancel as CancelIcon } from \"@material-ui/icons\";\nimport gql from \"graphql-tag\";\nimport { useMutation } from \"@apollo/react-hooks\";\n\nimport { JOURNAL_ENTRY_FRAGMENT } from \"../../Table/JournalEntries.gql\";\nimport {\n  DeleteRefundMutation,\n  DeleteRefundMutationVariables as DeleteRefundVars,\n} from \"../../../../apollo/graphTypes\";\nimport OverlayLoading from \"../../../Utils/OverlayLoading\";\n\nconst DELETE_REFUND = gql`\n  mutation DeleteRefund($id: ID!) {\n    journalEntryDeleteRefund(id: $id) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst DeleteRefund = (props: {\n  refundId: string | null;\n  onClose: () => void;\n}) => {\n  const { refundId, onClose } = props;\n\n  const [deleteRefund, { loading, error }] = useMutation<\n    DeleteRefundMutation,\n    DeleteRefundVars\n  >(DELETE_REFUND);\n  const hasError = !!error;\n\n  const onDelete = useCallback(\n    (event) => {\n      deleteRefund({ variables: { id: refundId as string } }).then(() =>\n        onClose()\n      );\n    },\n    [refundId, deleteRefund, onClose]\n  );\n\n  const title = useMemo(() => {\n    if (hasError) {\n      return \"Error\";\n    } else if (loading) {\n      return \"Deleting Refund...\";\n    }\n    return \"Delete Refund\";\n  }, [hasError, loading]);\n\n  const theme = useTheme();\n\n  return (\n    <Dialog\n      open={!!refundId}\n      maxWidth=\"sm\"\n      fullWidth\n      disableBackdropClick={loading}\n      disableEscapeKeyDown={loading}\n      onClose={onClose}\n    >\n      <DialogTitle\n        style={hasError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {loading && <OverlayLoading zIndex=\"modal\" />}\n        <DialogContent>\n          {hasError && (\n            <DialogContentText color=\"error\">\n              {error?.message as string}\n            </DialogContentText>\n          )}\n          {!hasError && (\n            <DialogContentText>\n              Are you sure you want to delete this refund?\n            </DialogContentText>\n          )}\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!hasError && (\n          <Button\n            disabled={loading}\n            onClick={onDelete}\n            startIcon={<DeleteIcon />}\n            color=\"primary\"\n            variant=\"contained\"\n          >\n            Delete\n          </Button>\n        )}\n        <Button\n          disabled={loading}\n          startIcon={!hasError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {hasError ? \"Close\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default DeleteRefund;\n","import { O } from \"ts-toolbelt\";\nimport { FormikConfig } from \"formik\";\nimport gql from \"graphql-tag\";\nimport ApolloClient from \"apollo-client\";\n\nimport {\n  JournalEntryAddItemFields,\n  DeptEntryOptFragment,\n  CatEntryOptFragment,\n  AddEntryItemMutation as AddItem,\n  AddEntryItemMutationVariables as AddItemVars,\n} from \"../../../../apollo/graphTypes\";\nimport { TransmutationValue } from \"../../../../formik/utils\";\nimport { JOURNAL_ENTRY_FRAGMENT } from \"../../Table/JournalEntries.gql\";\n\nexport type AddValues = O.Overwrite<\n  O.Required<\n    JournalEntryAddItemFields,\n    keyof JournalEntryAddItemFields,\n    \"deep\"\n  >,\n  {\n    total: TransmutationValue<string, JournalEntryAddItemFields[\"total\"]>;\n    category: TransmutationValue<string, CatEntryOptFragment[]> | null;\n    department: DeptEntryOptFragment | null;\n  }\n>;\n\nconst ADD_ENTRY_ITEM = gql`\n  mutation AddEntryItem($id: ID!, $fields: JournalEntryAddItemFields!) {\n    journalEntryAddItem(id: $id, fields: $fields) {\n      journalEntry {\n        ...JournalEntry_1Fragment\n      }\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst submitAdd: (\n  client: ApolloClient<any>,\n  id: string,\n  ...rest: Parameters<FormikConfig<AddValues>[\"onSubmit\"]>\n) => ReturnType<FormikConfig<AddValues>[\"onSubmit\"]> = async (\n  client,\n  id,\n  values\n) => {\n  const category = (() => {\n    const value = values.category?.value || [];\n\n    return value[value.length - 1]?.id ?? null;\n  })();\n\n  const department = (() => {\n    return values.department?.id || null;\n  })();\n\n  const variables: O.Required<AddItemVars, keyof AddItemVars, \"deep\"> = {\n    id,\n    fields: {\n      category,\n      department,\n      description: values.description?.trim() || null,\n      total: values.total.value,\n    },\n  };\n\n  await client.mutate<AddItem, AddItemVars>({\n    mutation: ADD_ENTRY_ITEM,\n    variables,\n  });\n};\n\nexport default submitAdd;\n","import gql from \"graphql-tag\";\n\nexport const JOURNAL_FRAGMENT = gql`\n  fragment JournalEntry_3Fragment on JournalEntry {\n    __typename\n    id\n    type\n    total {\n      num\n      den\n    }\n    items {\n      id\n      __typename\n      deleted\n      total {\n        num\n        den\n      }\n    }\n  }\n`;\n","import React, { useCallback, useMemo } from \"react\";\nimport { Formik, FormikConfig, useFormikContext, FormikProps } from \"formik\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  PaperProps,\n  Grid,\n  DialogContentText,\n  useTheme,\n  Box,\n  GridProps,\n} from \"@material-ui/core\";\nimport {\n  useApolloClient,\n  useQuery,\n  QueryHookOptions,\n} from \"@apollo/react-hooks\";\nimport {\n  Add as AddIcon,\n  Cancel as CancelIcon,\n  Queue as QueueIcon,\n} from \"@material-ui/icons\";\nimport gql from \"graphql-tag\";\n\nimport submitAdd, { AddValues } from \"./submitAdd\";\nimport {\n  GetEntryItemState_1Query as GetEntryItemState,\n  GetEntryItemState_1QueryVariables as GetEntryItemStateVars,\n} from \"../../../../apollo/graphTypes\";\nimport Description from \"../EntryFields/Description\";\nimport Total from \"../EntryFields/Total\";\nimport Category from \"../EntryFields/Category\";\nimport Department from \"../EntryFields/Department\";\nimport {\n  FormikStatusType,\n  useFormikStatus,\n  FormikStatus,\n} from \"../../../../formik/utils\";\nimport OverlayLoading from \"../../../Utils/OverlayLoading\";\nimport Overlay from \"../../../Utils/Overlay\";\nimport { JOURNAL_FRAGMENT } from \"./items.gql\";\nimport {\n  addRational,\n  subRational,\n  rationalToDecimal,\n} from \"../../../../utils/transmutations\";\n\nconst ENTRY_ITEM_STATE = gql`\n  query GetEntryItemState_1($id: ID!) {\n    journalEntry(id: $id) {\n      ...JournalEntry_3Fragment\n    }\n  }\n  ${JOURNAL_FRAGMENT}\n`;\n\nexport interface AddItemProps {\n  entryId: string | null;\n  open: boolean;\n  onClose: () => void;\n  onExited: () => void;\n}\n\nconst gridEntryResponsiveProps: GridProps = {\n  item: true,\n  lg: 4,\n  sm: 6,\n  xs: 12,\n} as const;\n\n// Must be in separate component to access FormikContext.\nconst AddItemDialog = (\n  props: AddItemProps & {\n    handleSubmit: FormikProps<AddValues>[\"handleSubmit\"];\n  }\n) => {\n  const { entryId, open, onClose, onExited: onExitedCb } = props;\n\n  const { resetForm, isSubmitting, isValid, submitForm } = useFormikContext<\n    AddValues\n  >();\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const onError = useCallback<\n    NonNullable<\n      QueryHookOptions<GetEntryItemState, GetEntryItemStateVars>[\"onError\"]\n    >\n  >(\n    (error) =>\n      setFormikStatus({\n        msg: error.message,\n        type: FormikStatusType.FATAL_ERROR,\n      }),\n    [setFormikStatus]\n  );\n\n  const { loading, data } = useQuery<GetEntryItemState, GetEntryItemStateVars>(\n    ENTRY_ITEM_STATE,\n    {\n      skip: !entryId,\n      variables: { id: entryId as string },\n      onError,\n    }\n  );\n\n  const type = data?.journalEntry?.type ?? null;\n\n  const total = data?.journalEntry?.total;\n  const items = data?.journalEntry?.items || [];\n  const maxTotal = useMemo(() => {\n    if (total) {\n      const totalItems = items.reduce(\n        (totalItems, { deleted, total }) => {\n          return deleted ? totalItems : addRational(totalItems, total);\n        },\n        { num: 0, den: 1 }\n      );\n      return rationalToDecimal(subRational(total, totalItems));\n    }\n    return Number.MAX_SAFE_INTEGER;\n  }, [total, items]);\n\n  const onExited = useCallback(() => {\n    onExitedCb();\n    resetForm();\n    setFormikStatus(null);\n  }, [resetForm, onExitedCb, setFormikStatus]);\n\n  const [generalError, fatalError] = useMemo<\n    [string | null, boolean | null]\n  >(() => {\n    if (\n      formikStatus &&\n      (formikStatus.type === FormikStatusType.FATAL_ERROR ||\n        formikStatus.type === FormikStatusType.ERROR)\n    ) {\n      return [\n        formikStatus.msg,\n        formikStatus.type === FormikStatusType.FATAL_ERROR,\n      ];\n    }\n    return [null, null];\n  }, [formikStatus]);\n\n  const title = useMemo(() => {\n    const title = \"Add Item\";\n\n    if (fatalError) {\n      return \"Fatal Error\";\n    } else if (loading) {\n      return `Loading ${title}...`;\n    } else if (isSubmitting) {\n      return `Submitting ${title}`;\n    }\n    return title;\n  }, [loading, fatalError, isSubmitting]);\n\n  const theme = useTheme();\n\n  const onClickAdd = useCallback(async () => {\n    try {\n      setFormikStatus(null);\n      await submitForm();\n      onClose();\n    } catch (error) {\n      setFormikStatus({\n        msg: error.message ?? `${error}`,\n        type: FormikStatusType.ERROR,\n      } as FormikStatus);\n    }\n  }, [submitForm, onClose, setFormikStatus]);\n\n  const onClickAddAndNew = useCallback(async () => {\n    try {\n      setFormikStatus(null);\n      await submitForm();\n      resetForm();\n    } catch (error) {\n      setFormikStatus({\n        msg: error.message ?? `${error}`,\n        type: FormikStatusType.ERROR,\n      } as FormikStatus);\n    }\n  }, [submitForm, resetForm, setFormikStatus]);\n\n  const handleSubmit = useCallback(\n    (event: React.FormEvent<HTMLFormElement>) => event.preventDefault(),\n    []\n  );\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      onExited={onExited}\n      disableBackdropClick={isSubmitting}\n      disableEscapeKeyDown={isSubmitting}\n      fullWidth\n      maxWidth=\"lg\"\n      PaperProps={\n        {\n          component: \"form\",\n          onSubmit: handleSubmit,\n        } as PaperProps & { onSubmit: FormikProps<AddValues>[\"handleSubmit\"] }\n      }\n    >\n      <DialogTitle\n        style={generalError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {(loading || isSubmitting) && !generalError && (\n          <OverlayLoading zIndex=\"modal\" />\n        )}\n        {!!generalError && fatalError && (\n          <Overlay opacity={0.78} zIndex=\"modal\" padding={2}>\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          </Overlay>\n        )}\n        <DialogContent dividers>\n          {!!generalError && !fatalError && (\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          )}\n          <Grid container spacing={2}>\n            <Grid {...gridEntryResponsiveProps}>\n              <Total\n                disabled={loading || isSubmitting}\n                fullWidth\n                maxTotal={maxTotal}\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Description disabled={loading || isSubmitting} fullWidth />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Category\n                disabled={loading || isSubmitting || !!fatalError}\n                entryType={type}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Department\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!fatalError && (\n          <React.Fragment>\n            <Button\n              onClick={onClickAdd}\n              disabled={loading || isSubmitting || !isValid}\n              type=\"submit\"\n              startIcon={<AddIcon />}\n              color=\"primary\"\n              variant=\"contained\"\n            >\n              Add\n            </Button>\n            <Button\n              onClick={onClickAddAndNew}\n              disabled={loading || isSubmitting || !isValid}\n              type=\"submit\"\n              startIcon={<QueueIcon />}\n              variant=\"outlined\"\n            >\n              Add & New\n            </Button>\n          </React.Fragment>\n        )}\n        <Button\n          disabled={loading || isSubmitting}\n          color={fatalError ? \"primary\" : \"default\"}\n          startIcon={!fatalError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {fatalError ? \"Ok\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst AddItem = (props: AddItemProps) => {\n  const { entryId, open, onClose, onExited } = props;\n\n  const initialValues = useMemo<Partial<AddValues>>(() => ({}), []);\n\n  const client = useApolloClient();\n  const onSubmit = useCallback<FormikConfig<AddValues>[\"onSubmit\"]>(\n    (values, formikHelpers) =>\n      submitAdd(client, entryId || \"\", values, formikHelpers),\n    [client, entryId]\n  );\n\n  const children = useCallback(\n    (props: FormikProps<AddValues>) => (\n      <AddItemDialog\n        entryId={entryId}\n        open={open}\n        onClose={onClose}\n        onExited={onExited}\n        handleSubmit={props.handleSubmit}\n      />\n    ),\n    [entryId, open, onClose, onExited]\n  );\n\n  return (\n    <Formik\n      initialValues={initialValues as AddValues}\n      initialStatus={null}\n      enableReinitialize={true}\n      onSubmit={onSubmit}\n      children={children}\n    />\n  );\n};\n\nexport default AddItem;\n","import { O } from \"ts-toolbelt\";\nimport { FormikConfig } from \"formik\";\nimport gql from \"graphql-tag\";\nimport ApolloClient from \"apollo-client\";\n\nimport {\n  JournalEntryUpdateItemFields,\n  DeptEntryOptFragment,\n  CatEntryOptFragment,\n  UpdateEntryItemMutation as UpdateItem,\n  UpdateEntryItemMutationVariables as UpdateItemVars,\n} from \"../../../../apollo/graphTypes\";\nimport { TransmutationValue } from \"../../../../formik/utils\";\nimport { JOURNAL_ENTRY_ITEM } from \"../../Table/JournalEntries.gql\";\n\nexport type UpdateValues = O.NonNullable<\n  O.Overwrite<\n    O.Required<JournalEntryUpdateItemFields>,\n    {\n      total: TransmutationValue<\n        string,\n        NonNullable<JournalEntryUpdateItemFields[\"total\"]>\n      >;\n      category: TransmutationValue<string, CatEntryOptFragment[]>;\n      department: DeptEntryOptFragment | null;\n    }\n  >,\n  keyof Pick<JournalEntryUpdateItemFields, \"total\">,\n  \"deep\"\n>;\n\nconst UPDATE_ITEM = gql`\n  mutation UpdateEntryItem($id: ID!, $fields: JournalEntryUpdateItemFields!) {\n    journalEntryUpdateItem(id: $id, fields: $fields) {\n      journalEntryItem {\n        ...JournalEntryItem_1Fragment\n      }\n    }\n  }\n  ${JOURNAL_ENTRY_ITEM}\n`;\n\nconst submitUpdate: (\n  client: ApolloClient<any>,\n  iniValues: UpdateValues,\n  id: string,\n  ...rest: Parameters<FormikConfig<UpdateValues>[\"onSubmit\"]>\n) => ReturnType<FormikConfig<UpdateValues>[\"onSubmit\"]> = async (\n  client,\n  iniValues,\n  id,\n  values\n) => {\n  // Description\n  const description =\n    values.description !== iniValues.description\n      ? values.description?.trim() || null\n      : null;\n\n  // Department\n  const department =\n    values.department?.id === iniValues.department?.id\n      ? null\n      : values.department?.id ?? null;\n\n  // Category\n  const category = (() => {\n    const category =\n      values.category.value[values.category.value.length - 1]?.id ?? null;\n\n    return category ===\n      (iniValues.category.value[iniValues.category.value.length - 1]?.id ??\n        null)\n      ? null\n      : category;\n  })();\n\n  // Total\n  const total =\n    values.total.value.num / values.total.value.den ===\n    iniValues.total.value.num / iniValues.total.value.den\n      ? null\n      : values.total.value;\n\n  const variables: O.Required<UpdateItemVars, keyof UpdateItemVars, \"deep\"> = {\n    id,\n    fields: {\n      description,\n      department,\n      category,\n      total,\n    },\n  };\n\n  await client.mutate<UpdateItem, UpdateItemVars>({\n    mutation: UPDATE_ITEM,\n    variables,\n  });\n};\n\nexport default submitUpdate;\n","import React, { useMemo, useCallback } from \"react\";\nimport { useQuery, useApolloClient } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\nimport { Formik, FormikConfig, FormikProps, useFormikContext } from \"formik\";\nimport {\n  useTheme,\n  Dialog,\n  DialogTitle,\n  PaperProps,\n  Box,\n  DialogContent,\n  DialogContentText,\n  Grid,\n  DialogActions,\n  Button,\n  GridProps,\n} from \"@material-ui/core\";\nimport { Add as AddIcon, Cancel as CancelIcon } from \"@material-ui/icons\";\n\nimport {\n  UpdateItemIniStateQuery as UpdateItemIniState,\n  UpdateItemIniStateQueryVariables as UpdateItemIniStateVars,\n  JournalEntry_3Fragment as JournalEntryFragment,\n} from \"../../../../apollo/graphTypes\";\nimport submitUpdate, { UpdateValues } from \"./submitUpdate\";\nimport { JOURNAL_FRAGMENT } from \"./items.gql\";\nimport {\n  DEPT_ENTRY_OPT_FRAGMENT,\n  CAT_ENTRY_OPT_FRAGMENT,\n} from \"../upsertEntry.gql\";\nimport {\n  FormikStatus,\n  FormikStatusType,\n  useFormikStatus,\n} from \"../../../../formik/utils\";\nimport OverlayLoading from \"../../../Utils/OverlayLoading\";\nimport Overlay from \"../../../Utils/Overlay\";\nimport Description from \"../EntryFields/Description\";\nimport Department from \"../EntryFields/Department\";\nimport Total from \"../EntryFields/Total\";\nimport Category from \"../EntryFields/Category\";\n\nexport interface UpdateItemProps {\n  entryId: string | null;\n  itemId: string | null;\n  open: boolean;\n  onClose: () => void;\n  onExited: () => void;\n}\n\nconst UPDATE_ITEM_INI_STATE = gql`\n  query UpdateItemIniState($entryId: ID!, $itemId: ID!) {\n    journalEntry(id: $entryId) {\n      ...JournalEntry_3Fragment\n    }\n    journalEntryItem(id: $itemId) {\n      __typename\n      id\n      department {\n        ...DeptEntryOptFragment\n      }\n      category {\n        ...CatEntryOptFragment\n        ancestors {\n          ...CatEntryOptFragment\n        }\n      }\n      description\n      total {\n        num\n        den\n      }\n    }\n  }\n  ${JOURNAL_FRAGMENT}\n  ${DEPT_ENTRY_OPT_FRAGMENT}\n  ${CAT_ENTRY_OPT_FRAGMENT}\n`;\n\nconst gridEntryResponsiveProps: GridProps = {\n  item: true,\n  lg: 4,\n  sm: 6,\n  xs: 12,\n} as const;\n\nconst UpdateItemDialog = (\n  props: UpdateItemProps & {\n    journalEntry: JournalEntryFragment | null;\n    loading: boolean;\n    handleSubmit: FormikProps<UpdateValues>[\"handleSubmit\"];\n  }\n) => {\n  const {\n    itemId,\n    open,\n    onClose,\n    onExited: onExitedCb,\n    journalEntry,\n    loading,\n    handleSubmit,\n  } = props;\n\n  const { resetForm, isSubmitting, isValid } = useFormikContext<UpdateValues>();\n\n  const [formikStatus, setFormikStatus] = useFormikStatus();\n\n  const type = journalEntry?.type ?? null;\n\n  const total = journalEntry?.total;\n  const items = journalEntry?.items || [];\n  const maxTotal = useMemo(() => {\n    if (total) {\n      const totalItems = items.reduce(\n        (totalItems, { id, deleted, total }) =>\n          // Do NOT include item being updated in max total calculation\n          deleted || id === itemId\n            ? totalItems\n            : totalItems + total.num / total.den,\n        0\n      );\n      return total.num / total.den - totalItems;\n    }\n    return Number.MAX_SAFE_INTEGER;\n  }, [total, items, itemId]);\n\n  const onExited = useCallback(() => {\n    onExitedCb();\n    resetForm();\n    setFormikStatus(null);\n  }, [resetForm, onExitedCb, setFormikStatus]);\n\n  const [generalError, fatalError] = useMemo<\n    [string | null, boolean | null]\n  >(() => {\n    if (\n      formikStatus &&\n      (formikStatus.type === FormikStatusType.FATAL_ERROR ||\n        formikStatus.type === FormikStatusType.ERROR)\n    ) {\n      return [\n        formikStatus.msg,\n        formikStatus.type === FormikStatusType.FATAL_ERROR,\n      ];\n    }\n    return [null, null];\n  }, [formikStatus]);\n\n  const title = useMemo(() => {\n    const title = \"Item Update\";\n\n    if (fatalError) {\n      return \"Fatal Error\";\n    } else if (loading) {\n      return `Loading ${title}...`;\n    } else if (isSubmitting) {\n      return `Submitting ${title}`;\n    }\n    return title;\n  }, [loading, fatalError, isSubmitting]);\n\n  const theme = useTheme();\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      onExited={onExited}\n      disableBackdropClick={isSubmitting}\n      disableEscapeKeyDown={isSubmitting}\n      fullWidth\n      maxWidth=\"lg\"\n      PaperProps={\n        {\n          component: \"form\",\n          onSubmit: handleSubmit,\n        } as PaperProps & {\n          onSubmit: FormikProps<UpdateValues>[\"handleSubmit\"];\n        }\n      }\n    >\n      <DialogTitle\n        style={generalError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {(loading || isSubmitting) && !generalError && (\n          <OverlayLoading zIndex=\"modal\" />\n        )}\n        {!!generalError && fatalError && (\n          <Overlay opacity={0.78} zIndex=\"modal\" padding={2}>\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          </Overlay>\n        )}\n        <DialogContent dividers>\n          {!!generalError && !fatalError && (\n            <DialogContentText color=\"error\">{generalError}</DialogContentText>\n          )}\n          <Grid container spacing={2}>\n            <Grid {...gridEntryResponsiveProps}>\n              <Total\n                disabled={loading || isSubmitting}\n                fullWidth\n                maxTotal={maxTotal}\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Description disabled={loading || isSubmitting} fullWidth />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Category\n                disabled={loading || isSubmitting || !!fatalError}\n                entryType={type}\n                fullWidth\n              />\n            </Grid>\n            <Grid {...gridEntryResponsiveProps}>\n              <Department\n                disabled={loading || isSubmitting || !!fatalError}\n                fullWidth\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!fatalError && (\n          <Button\n            disabled={loading || isSubmitting || !isValid}\n            type=\"submit\"\n            startIcon={<AddIcon />}\n            color=\"primary\"\n            variant=\"contained\"\n          >\n            Update\n          </Button>\n        )}\n        <Button\n          disabled={loading || isSubmitting || !!fatalError}\n          color={fatalError ? \"primary\" : \"default\"}\n          startIcon={!fatalError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {fatalError ? \"Ok\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst UpdateItem = (props: UpdateItemProps) => {\n  const { entryId, itemId, open, onClose, onExited } = props;\n\n  const { loading, error, data } = useQuery<\n    UpdateItemIniState,\n    UpdateItemIniStateVars\n  >(UPDATE_ITEM_INI_STATE, {\n    skip: !entryId,\n    variables: {\n      entryId: entryId as string,\n      itemId: itemId as string,\n    },\n  });\n\n  const initialStatus = useMemo(\n    () =>\n      error\n        ? ({\n            msg: error.message,\n            type: FormikStatusType.FATAL_ERROR,\n          } as FormikStatus)\n        : null,\n    [error]\n  );\n\n  const journalEntryItem = data?.journalEntryItem;\n  const initialValues = useMemo<UpdateValues>(() => {\n    if (!journalEntryItem) {\n      return {} as any;\n    }\n\n    const total = {\n      inputValue: (\n        journalEntryItem.total.num / journalEntryItem.total.den\n      ).toFixed(2),\n      value: journalEntryItem.total,\n    };\n\n    const category = (() => {\n      if (!journalEntryItem.category) {\n        return {\n          inputValue: \"\",\n          value: [],\n        };\n      }\n\n      const { ancestors, ...category } = journalEntryItem.category;\n\n      // Array.prototype.sort mutates the array, create copy.\n      const value = [...ancestors].sort((a, b) => {\n        // a is the parent of b\n        if (a.id === b.parent?.id) {\n          return -1;\n          // b is the parent of a\n        } else if (b.id === a.parent?.id) {\n          return 1;\n        }\n        return 0;\n      });\n\n      value.push(category);\n\n      return {\n        inputValue: \"\",\n        value,\n      };\n    })();\n\n    const department = journalEntryItem.department ?? null;\n\n    const description = journalEntryItem.description ?? null;\n\n    return {\n      total,\n      category,\n      department,\n      description,\n    };\n  }, [journalEntryItem]);\n\n  const client = useApolloClient();\n  const onSubmit = useCallback<FormikConfig<UpdateValues>[\"onSubmit\"]>(\n    async (values, formikHelpers) => {\n      if (!initialValues) {\n        formikHelpers.setStatus({\n          msg: `Failed to load initial values for item \"${itemId}\".`,\n          type: FormikStatusType.FATAL_ERROR,\n        } as FormikStatus);\n        return;\n      } else if (!itemId) {\n        formikHelpers.setStatus({\n          msg: `No item ID.`,\n          type: FormikStatusType.FATAL_ERROR,\n        } as FormikStatus);\n        return;\n      }\n\n      try {\n        formikHelpers.setStatus(null);\n        await submitUpdate(\n          client,\n          initialValues,\n          itemId,\n          values,\n          formikHelpers\n        );\n        onClose();\n      } catch (error) {\n        formikHelpers.setStatus({\n          msg: error?.message ?? `${error}`,\n          type: FormikStatusType.FATAL_ERROR,\n        } as FormikStatus);\n      }\n    },\n    [client, initialValues, onClose, itemId]\n  );\n\n  const children = useCallback(\n    (props: FormikProps<UpdateValues>) => {\n      return (\n        <UpdateItemDialog\n          entryId={entryId}\n          itemId={itemId}\n          open={open}\n          onClose={onClose}\n          onExited={onExited}\n          journalEntry={data?.journalEntry ?? null}\n          loading={loading}\n          handleSubmit={props.handleSubmit}\n        />\n      );\n    },\n    [data, entryId, loading, onClose, onExited, open, itemId]\n  );\n\n  return (\n    <Formik\n      initialValues={(initialValues ?? {}) as UpdateValues}\n      initialStatus={initialStatus}\n      enableReinitialize={true}\n      onSubmit={onSubmit}\n      children={children}\n    />\n  );\n};\n\nexport default UpdateItem;\n","import React, { useCallback, useMemo } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  Button,\n  Box,\n  useTheme,\n} from \"@material-ui/core\";\nimport { Delete as DeleteIcon, Cancel as CancelIcon } from \"@material-ui/icons\";\nimport gql from \"graphql-tag\";\nimport { useMutation } from \"@apollo/react-hooks\";\n\nimport {\n  DeleteItemMutation,\n  DeleteItemMutationVariables as DeleteItemVars,\n} from \"../../../../apollo/graphTypes\";\nimport OverlayLoading from \"../../../Utils/OverlayLoading\";\n\nconst DELETE_ITEM = gql`\n  mutation DeleteItem($id: ID!) {\n    journalEntryDeleteItem(id: $id) {\n      journalEntryItem {\n        id\n        __typename\n        deleted\n      }\n    }\n  }\n`;\n\nconst DeleteItem = (props: { itemId: string | null; onClose: () => void }) => {\n  const { itemId, onClose } = props;\n\n  const [deleteItem, { loading, error }] = useMutation<\n    DeleteItemMutation,\n    DeleteItemVars\n  >(DELETE_ITEM);\n  const hasError = !!error;\n\n  const onDelete = useCallback(\n    (event) => {\n      deleteItem({ variables: { id: itemId as string } }).then(() => onClose());\n    },\n    [itemId, deleteItem, onClose]\n  );\n\n  const title = useMemo(() => {\n    if (hasError) {\n      return \"Error\";\n    } else if (loading) {\n      return \"Deleting Item...\";\n    }\n    return \"Delete Item\";\n  }, [hasError, loading]);\n\n  const theme = useTheme();\n\n  return (\n    <Dialog\n      open={!!itemId}\n      maxWidth=\"sm\"\n      fullWidth\n      disableBackdropClick={loading}\n      disableEscapeKeyDown={loading}\n      onClose={onClose}\n    >\n      <DialogTitle\n        style={hasError ? { color: theme.palette.error.main } : undefined}\n      >\n        {title}\n      </DialogTitle>\n      <Box position=\"relative\">\n        {loading && <OverlayLoading zIndex=\"modal\" />}\n        <DialogContent>\n          {hasError && (\n            <DialogContentText color=\"error\">\n              {error?.message as string}\n            </DialogContentText>\n          )}\n          {!hasError && (\n            <DialogContentText>\n              Are you sure you want to delete this item?\n            </DialogContentText>\n          )}\n        </DialogContent>\n      </Box>\n      <DialogActions>\n        {!hasError && (\n          <Button\n            disabled={loading}\n            onClick={onDelete}\n            startIcon={<DeleteIcon />}\n            color=\"primary\"\n            variant=\"contained\"\n          >\n            Delete\n          </Button>\n        )}\n        <Button\n          disabled={loading}\n          startIcon={!hasError && <CancelIcon />}\n          onClick={onClose}\n        >\n          {hasError ? \"Close\" : \"Cancel\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default DeleteItem;\n","import React, {\n  useMemo,\n  forwardRef,\n  useState,\n  useCallback,\n  useEffect,\n  useRef,\n} from \"react\";\nimport MaterialTable, {\n  Column,\n  Options,\n  Localization,\n  MaterialTableProps,\n  Components,\n  MTableBody,\n  MTableBodyRow,\n} from \"material-table\";\nimport { useQuery, useMutation } from \"@apollo/react-hooks\";\nimport numeral from \"numeral\";\nimport { capitalCase } from \"change-case\";\nimport Fuse from \"fuse.js\";\nimport {\n  Done as DoneIcon,\n  Delete as DeleteIcon,\n  AddCircle as AddCircleIcon,\n  CheckCircle as CheckCircleIcon,\n} from \"@material-ui/icons\";\nimport {\n  AddBox,\n  ArrowDownward,\n  Check,\n  ChevronLeft,\n  ChevronRight,\n  Clear,\n  DeleteOutline,\n  Edit,\n  FilterList,\n  FirstPage,\n  LastPage,\n  Remove,\n  SaveAlt,\n  Search,\n  ViewColumn,\n} from \"@material-ui/icons\";\nimport {\n  Box,\n  TableBody,\n  TableRow,\n  TableCell,\n  Typography,\n} from \"@material-ui/core\";\nimport { green, red, amber, cyan } from \"@material-ui/core/colors\";\nimport {\n  BankTransferIn as BankTransferInIcon,\n  BankTransferOut as BankTransferOutIcon,\n  FileTree as FileTreeIcon,\n} from \"mdi-material-ui\";\nimport gql from \"graphql-tag\";\nimport { format } from \"date-fns\";\n\nimport {\n  JournalEntries_1Query as JournalEntriesQuery,\n  JournalEntries_1QueryVariables as JournalEntriesQueryVars,\n  JournalEntry_1Fragment as JournalEntryFragment,\n  JournalEntryRefund_1Fragment as JournalEntryRefundFragment,\n  JournalEntryItem_1Fragment as JournalEntryItemFragment,\n  JournalEntryType,\n  OnEntryUpsert_1Subscription as OnEntryUpsert,\n  ReconcileEntryMutation as ReconcileEntry,\n  ReconcileEntryMutationVariables as ReconcileEntryVars,\n  ReconcileRefundMutation as ReconcileRefund,\n  ReconcileRefundMutationVariables as ReconcileRefundVars,\n} from \"../../../apollo/graphTypes\";\nimport { JOURNAL_ENTRIES, JOURNAL_ENTRY_FRAGMENT } from \"./JournalEntries.gql\";\nimport { CHECK_ID } from \"../constants\";\nimport AddRefund from \"../Upsert/Refunds/AddRefund\";\nimport UpdateRefund from \"../Upsert/Refunds/UpdateRefund\";\nimport AddEntry from \"../Upsert/Entries/AddEntry\";\nimport UpdateEntry from \"../Upsert/Entries/UpdateEntry\";\nimport DeleteEntry from \"../Upsert/Entries/DeleteEntry\";\nimport DeleteRefund from \"../Upsert/Refunds/DeleteRefund\";\nimport AddItem from \"../Upsert/Items/AddItem\";\nimport UpdateItem from \"../Upsert/Items/UpdateItem\";\nimport DeleteItem from \"../Upsert/Items/DeleteItem\";\n\nexport enum JournalMode {\n  View,\n  Reconcile,\n}\n\nconst tableIcons = {\n  Add: forwardRef<SVGSVGElement>((props, ref) => (\n    <AddBox {...props} ref={ref} />\n  )),\n  Check: forwardRef<SVGSVGElement>((props, ref) => (\n    <Check {...props} ref={ref} />\n  )),\n  Clear: forwardRef<SVGSVGElement>((props, ref) => (\n    <Clear {...props} ref={ref} />\n  )),\n  Delete: forwardRef<SVGSVGElement>((props, ref) => (\n    <DeleteOutline {...props} ref={ref} />\n  )),\n  DetailPanel: forwardRef<SVGSVGElement>((props, ref) => (\n    <ChevronRight {...props} ref={ref} />\n  )),\n  Edit: forwardRef<SVGSVGElement>((props, ref) => (\n    <Edit {...props} ref={ref} />\n  )),\n  Export: forwardRef<SVGSVGElement>((props, ref) => (\n    <SaveAlt {...props} ref={ref} />\n  )),\n  Filter: forwardRef<SVGSVGElement>((props, ref) => (\n    <FilterList {...props} ref={ref} />\n  )),\n  FirstPage: forwardRef<SVGSVGElement>((props, ref) => (\n    <FirstPage {...props} ref={ref} />\n  )),\n  LastPage: forwardRef<SVGSVGElement>((props, ref) => (\n    <LastPage {...props} ref={ref} />\n  )),\n  NextPage: forwardRef<SVGSVGElement>((props, ref) => (\n    <ChevronRight {...props} ref={ref} />\n  )),\n  PreviousPage: forwardRef<SVGSVGElement>((props, ref) => (\n    <ChevronLeft {...props} ref={ref} />\n  )),\n  ResetSearch: forwardRef<SVGSVGElement>((props, ref) => (\n    <Clear {...props} ref={ref} />\n  )),\n  Search: forwardRef<SVGSVGElement>((props, ref) => (\n    <Search {...props} ref={ref} />\n  )),\n  SortArrow: forwardRef<SVGSVGElement>((props, ref) => (\n    <ArrowDownward {...props} ref={ref} />\n  )),\n  ThirdStateCheck: forwardRef<SVGSVGElement>((props, ref) => (\n    <Remove {...props} ref={ref} />\n  )),\n  ViewColumn: forwardRef<SVGSVGElement>((props, ref) => (\n    <ViewColumn {...props} ref={ref} />\n  )),\n} as const;\n\nexport type Entry =\n  | JournalEntryFragment\n  | (Omit<JournalEntryFragment, \"__typename\" | \"refunds\"> &\n      JournalEntryRefundFragment & { refunds: string })\n  | (Omit<JournalEntryFragment, \"__typename\" | \"items\"> &\n      JournalEntryItemFragment & { items: string });\n\nconst entriesGen = function* (\n  entry: JournalEntryFragment,\n  mode: JournalMode\n): IterableIterator<Entry> {\n  yield entry;\n  const refundType =\n    entry.type === JournalEntryType.Credit\n      ? JournalEntryType.Debit\n      : JournalEntryType.Credit;\n  for (const refund of entry.refunds) {\n    yield {\n      ...entry,\n      ...refund,\n      type: refundType,\n      description: refund.description || entry.description,\n      refunds: entry.id,\n    };\n  }\n  if (mode === JournalMode.Reconcile) {\n    return;\n  }\n  for (const item of entry.items) {\n    yield {\n      ...entry,\n      ...item,\n      category: item.category || entry.category,\n      department: item.department || entry.department,\n      description: item.description || entry.description,\n      items: entry.id,\n    };\n  }\n};\n\nconst ON_ENTRY_UPSERT = gql`\n  subscription OnEntryUpsert_1 {\n    journalEntryUpserted {\n      ...JournalEntry_1Fragment\n      department {\n        ancestors {\n          ... on Department {\n            __typename\n            id\n          }\n        }\n      }\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst RECONCILE_ENTRY = gql`\n  mutation ReconcileEntry($id: ID!) {\n    journalEntryUpdate(id: $id, fields: { reconciled: true }) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst RECONCILE_REFUND = gql`\n  mutation ReconcileRefund($id: ID!) {\n    journalEntryUpdateRefund(id: $id, fields: { reconciled: true }) {\n      ...JournalEntry_1Fragment\n    }\n  }\n  ${JOURNAL_ENTRY_FRAGMENT}\n`;\n\nconst Journal = (props: {\n  journalTitle?: string;\n  deptId?: string;\n  mode: JournalMode;\n}) => {\n  const { deptId = null, journalTitle = null, mode } = props;\n\n  // Add Entry\n  const [addEntryOpen, setAddEntryOpen] = useState<boolean>(false);\n  const addEntryOnClose = useCallback(() => void setAddEntryOpen(false), [\n    setAddEntryOpen,\n  ]);\n\n  // Update Entry\n  const [updateEntryOpen, setUpdateEntryOpen] = useState<boolean>(false);\n  const [updateEntry, setUpdateEntry] = useState<string | null>(null);\n\n  const updateEntryOnClose = useCallback(() => void setUpdateEntryOpen(false), [\n    setUpdateEntryOpen,\n  ]);\n  const updateEntryOnExited = useCallback(() => void setUpdateEntry(null), [\n    setUpdateEntry,\n  ]);\n\n  // Delete Entry\n  const [deleteEntry, setDeleteEntry] = useState<string | null>(null);\n  const deleteEntryOnClose = useCallback(() => void setDeleteEntry(null), [\n    setDeleteEntry,\n  ]);\n\n  // Add Refund\n  const [addRefundOpen, setAddRefundOpen] = useState<boolean>(false);\n  const [addRefundToEntry, setAddRefundToEntry] = useState<string | null>(null);\n\n  const addRefundOnClose = useCallback(() => void setAddRefundOpen(false), [\n    setAddRefundOpen,\n  ]);\n  const addRefundOnExited = useCallback(() => void setAddRefundToEntry(null), [\n    setAddRefundToEntry,\n  ]);\n\n  // Update Refund\n  const [updateRefundOpen, setUpdateRefundOpen] = useState<boolean>(false);\n  const [updateRefund, setUpdateRefund] = useState<{\n    entryId: string;\n    refundId: string;\n  } | null>(null);\n\n  const updateRefundOnClose = useCallback(\n    () => void setUpdateRefundOpen(false),\n    [setUpdateRefundOpen]\n  );\n  const updateRefundOnExited = useCallback(() => void setUpdateRefund(null), [\n    setUpdateRefund,\n  ]);\n\n  // Delete Refund\n  const [deleteRefund, setDeleteRefund] = useState<string | null>(null);\n  const deleteRefundOnClose = useCallback(() => void setDeleteRefund(null), [\n    setDeleteRefund,\n  ]);\n\n  // Add Item\n  const [addItemOpen, setAddItemOpen] = useState<boolean>(false);\n  const [addItemToEntry, setAddItemToEntry] = useState<string | null>(null);\n\n  const addItemOnClose = useCallback(() => void setAddItemOpen(false), [\n    setAddItemOpen,\n  ]);\n  const addItemOnExited = useCallback(() => void setAddItemToEntry(null), [\n    setAddItemToEntry,\n  ]);\n\n  // Update Item\n  const [updateItemOpen, setUpdateItemOpen] = useState<boolean>(false);\n  const [updateItem, setUpdateItem] = useState<{\n    entryId: string;\n    itemId: string;\n  } | null>(null);\n\n  // Delete Item\n  const [deleteItem, setDeleteItem] = useState<string | null>(null);\n  const deleteItemOnClose = useCallback(() => void setDeleteItem(null), [\n    setDeleteItem,\n  ]);\n\n  const updateItemOnClose = useCallback(() => void setUpdateItemOpen(false), [\n    setUpdateItemOpen,\n  ]);\n  const updateItemOnExited = useCallback(() => void setUpdateItem(null), [\n    setUpdateItem,\n  ]);\n\n  // Reconcile Entry\n  const [reconcileEntry, { loading: reconcilingEntry }] = useMutation<\n    ReconcileEntry,\n    ReconcileEntryVars\n  >(RECONCILE_ENTRY);\n  // Reconcile Refund\n  const [reconcileRefund, { loading: reconcilingRefund }] = useMutation<\n    ReconcileRefund,\n    ReconcileRefundVars\n  >(RECONCILE_REFUND);\n\n  const variables = useMemo<JournalEntriesQueryVars | undefined>(() => {\n    return deptId\n      ? {\n          where: { department: { eq: deptId, matchDecedentTree: true } },\n        }\n      : undefined;\n  }, [deptId]);\n\n  const { loading, error, data, subscribeToMore } = useQuery<\n    JournalEntriesQuery,\n    JournalEntriesQueryVars\n  >(JOURNAL_ENTRIES, {\n    variables,\n    fetchPolicy: \"cache-and-network\",\n  });\n\n  const isLoading = loading && !data?.journalEntries;\n\n  // Subscribe to updates\n  useEffect(() => {\n    return subscribeToMore<OnEntryUpsert>({\n      document: ON_ENTRY_UPSERT,\n      updateQuery: (prev, { subscriptionData }) => {\n        if (!subscriptionData.data) {\n          return prev;\n        }\n\n        const upsertEntry = subscriptionData.data.journalEntryUpserted;\n\n        const ancestors = upsertEntry.department.ancestors;\n\n        if (\n          deptId &&\n          upsertEntry.department.id !== deptId &&\n          ancestors.every((dept) => (dept as any).id !== deptId)\n        ) {\n          // Filter entry out of query results if department changes.\n          const journalEntriesFiltered = prev.journalEntries.filter(\n            (entry) => entry.id !== upsertEntry.id\n          );\n\n          if (journalEntriesFiltered.length === prev.journalEntries.length) {\n            return prev;\n          }\n\n          return Object.assign({}, prev, {\n            journalEntries: journalEntriesFiltered,\n          });\n        }\n\n        // Apollo will take care of updating if entry already exists in cache.\n        if (prev.journalEntries.some((entry) => entry.id === upsertEntry.id)) {\n          return prev;\n        }\n\n        return Object.assign({}, prev, {\n          journalEntries: [upsertEntry, ...prev.journalEntries],\n        });\n      },\n    });\n  }, [deptId, subscribeToMore]);\n\n  const columns = useMemo<Column<Entry>[]>(() => {\n    return [\n      {\n        field: \"reconciled\",\n        title: \"Reconciled\",\n        render: ({ reconciled }) => (reconciled ? <DoneIcon /> : null),\n        sorting: true,\n        searchable: true,\n        customSort: (\n          { reconciled: reconciledA },\n          { reconciled: reconciledB }\n        ) => {\n          return +reconciledA - +reconciledB;\n        },\n        customFilterAndSearch: (filter, { reconciled }) => {\n          if (reconciled) {\n            return (\n              ((filter as string) || \"\").trim().toLowerCase() === \"reconciled\"\n            );\n          }\n          return (\n            ((filter as string) || \"\").trim().toLowerCase() === \"!reconciled\"\n          );\n        },\n        hidden: mode === JournalMode.Reconcile,\n        filtering: false,\n      },\n      {\n        field: \"total\",\n        title: \"Total\",\n        render: ({ total: { num, den } }) =>\n          numeral(num / den).format(\"$0,0.00\"),\n        searchable: true,\n        filtering: false,\n        sorting: true,\n        customSort: ({ total: totalA }, { total: totalB }) => {\n          return totalA.num / totalA.den - totalB.num / totalB.den;\n        },\n        customFilterAndSearch: (filter, { total: { num, den } }) => {\n          return (\n            new Fuse(\n              [\n                {\n                  total: [\n                    numeral(num / den).format(\"$0,0.00\"),\n                    (num / den).toFixed(2),\n                  ],\n                },\n              ],\n              {\n                threshold: 0.4,\n                useExtendedSearch: true,\n                keys: [\"total\"],\n              }\n            ).search(filter).length > 0\n          );\n        },\n      },\n      {\n        field: \"date\",\n        title: \"Date\",\n        render: ({ date }) => format(new Date(date), \"MMM dd, yyyy\"),\n        searchable: true,\n        filtering: false,\n        sorting: true,\n        defaultSort: \"desc\",\n        customSort: ({ date: dateA }, { date: dateB }) => {\n          return new Date(dateA).getTime() - new Date(dateB).getTime();\n        },\n        customFilterAndSearch: (filter, { date: dateStr }) => {\n          const date = new Date(dateStr);\n\n          return (\n            new Fuse(\n              [\n                {\n                  date: [\n                    dateStr,\n                    format(date, \"M/d/yy\"),\n                    format(date, \"MM/d/yy\"),\n                    format(date, \"M/d/yyyy\"),\n                    format(date, \"MM/d/yyyy\"),\n                    format(date, \"MMM dd, yyyy\"),\n                  ],\n                },\n              ],\n              {\n                threshold: 0.4,\n                useExtendedSearch: true,\n                keys: [\"date\"],\n              }\n            ).search(filter).length > 0\n          );\n        },\n      },\n      {\n        field: \"category\",\n        title: \"Category\",\n        render: (data, type) => {\n          const name =\n            type === \"group\"\n              ? ((data as any) as JournalEntryFragment[\"category\"]).name\n              : data.category.name;\n          return capitalCase(name);\n        },\n        searchable: true,\n        filtering: false,\n        sorting: true,\n        customSort: (dataA, dataB) => {\n          const { category: categoryA } = dataA;\n          const { category: categoryB } = dataB;\n\n          const nameA = categoryA.name.toUpperCase(); // ignore upper and lowercase\n          const nameB = categoryB.name.toUpperCase(); // ignore upper and lowercase\n          if (nameA < nameB) {\n            return -1;\n          }\n          if (nameA > nameB) {\n            return 1;\n          }\n\n          // names must be equal\n          return 0;\n        },\n        customFilterAndSearch: (filter, { category: { name } }) => {\n          return (\n            new Fuse(\n              [\n                {\n                  category: [name],\n                },\n              ],\n              {\n                threshold: 0.4,\n                useExtendedSearch: true,\n                keys: [\"category\"],\n              }\n            ).search(filter).length > 0\n          );\n        },\n      },\n      {\n        field: \"source\",\n        title: \"Source\",\n        render: ({ source }) => {\n          switch (source.__typename) {\n            case \"Person\":\n              return `${source.name.first} ${source.name.last}`;\n            case \"Business\":\n              return source.bizName;\n            case \"Department\":\n              return source.deptName;\n          }\n        },\n        searchable: true,\n        filtering: false,\n        sorting: true,\n        customSort: ({ source: sourceA }, { source: sourceB }) => {\n          const nameA = (() => {\n            switch (sourceA.__typename) {\n              case \"Person\":\n                return sourceA.name.last.toUpperCase();\n              case \"Business\":\n                return sourceA.bizName.toUpperCase();\n              case \"Department\":\n                return sourceA.deptName.toUpperCase();\n            }\n          })();\n\n          const nameB = (() => {\n            switch (sourceB.__typename) {\n              case \"Person\":\n                return sourceB.name.last.toUpperCase();\n              case \"Business\":\n                return sourceB.bizName.toUpperCase();\n              case \"Department\":\n                return sourceB.deptName.toUpperCase();\n            }\n          })();\n          if (nameA < nameB) {\n            return -1;\n          }\n          if (nameA > nameB) {\n            return 1;\n          }\n\n          // names must be equal\n          return 0;\n        },\n        customFilterAndSearch: (filter, { source }) => {\n          return (\n            new Fuse(\n              [\n                {\n                  source: [\n                    (() => {\n                      switch (source.__typename) {\n                        case \"Person\":\n                          return `${source.name.first} ${source.name.last}`;\n                        case \"Business\":\n                          return source.bizName;\n                        case \"Department\":\n                          return source.deptName;\n                      }\n                    })(),\n                  ],\n                },\n              ],\n              {\n                threshold: 0.4,\n                useExtendedSearch: true,\n                keys: [\"source\"],\n              }\n            ).search(filter).length > 0\n          );\n        },\n      },\n      {\n        field: \"paymentMethod\",\n        title: \"Payment Method\",\n        render: ({ paymentMethod }) =>\n          paymentMethod.parent?.id === CHECK_ID\n            ? `CK-${paymentMethod.name}`\n            : paymentMethod.name,\n        searchable: true,\n        filtering: false,\n        sorting: true,\n        customSort: (\n          { paymentMethod: paymentMethodA },\n          { paymentMethod: paymentMethodB }\n        ) => {\n          const nameA = (() => {\n            return (paymentMethodA.parent?.id === CHECK_ID\n              ? `CK-${paymentMethodA.name}`\n              : paymentMethodA.name\n            ).toUpperCase();\n          })();\n\n          const nameB = (() => {\n            return (paymentMethodB.parent?.id === CHECK_ID\n              ? `CK-${paymentMethodB.name}`\n              : paymentMethodB.name\n            ).toUpperCase();\n          })();\n          if (nameA < nameB) {\n            return -1;\n          }\n          if (nameA > nameB) {\n            return 1;\n          }\n\n          // names must be equal\n          return 0;\n        },\n        customFilterAndSearch: (filter, { paymentMethod }) => {\n          return (\n            new Fuse(\n              [\n                {\n                  paymentMethod: [\n                    paymentMethod.parent?.id === CHECK_ID\n                      ? `CK-${paymentMethod.name}`\n                      : paymentMethod.name,\n                  ],\n                },\n              ],\n              {\n                threshold: 0.4,\n                useExtendedSearch: true,\n                keys: [\"paymentMethod\"],\n              }\n            ).search(filter).length > 0\n          );\n        },\n      },\n      {\n        field: \"description\",\n        title: \"Description\",\n        render: ({ description }) => description,\n        searchable: true,\n        filtering: false,\n        sorting: false,\n        customFilterAndSearch: (filter, { description }) => {\n          return (\n            new Fuse(\n              [\n                {\n                  description: [description?.trim() || \"\"],\n                },\n              ],\n              {\n                threshold: 0.4,\n                useExtendedSearch: true,\n                keys: [\"description\"],\n              }\n            ).search(filter).length > 0\n          );\n        },\n      },\n      {\n        field: \"department\",\n        title: \"Department\",\n        render: ({ department }) => capitalCase(department.name),\n        searchable: true,\n        filtering: false,\n        sorting: true,\n        customSort: (\n          { department: departmentA },\n          { department: departmentB }\n        ) => {\n          const nameA = departmentA.name.toUpperCase();\n          const nameB = departmentB.name.toUpperCase();\n\n          if (nameA < nameB) {\n            return -1;\n          }\n          if (nameA > nameB) {\n            return 1;\n          }\n\n          // names must be equal\n          return 0;\n        },\n        customFilterAndSearch: (filter, { department }) => {\n          return (\n            new Fuse(\n              [\n                {\n                  department: [department.name],\n                },\n              ],\n              {\n                threshold: 0.4,\n                useExtendedSearch: true,\n                keys: [\"department\"],\n              }\n            ).search(filter).length > 0\n          );\n        },\n      },\n    ];\n  }, [mode]);\n\n  const localization = useMemo<Localization>(\n    () => ({\n      toolbar: {\n        searchTooltip: (\n          <Box fontSize={12} component=\"span\">\n            [abc] | [efg] = \"abc\" OR \"efg\"\n            <br />\n            '[abc] = EXACTLY \"abc\"\n            <br />\n            ![abc] = NOT \"abc\"\n            <br />\n            ^[abc] = STARTS WITH \"abc\"\n            <br />\n            !^[abc] = DOES NOT START WITH \"abc\"\n            <br />\n            [abc]$ = ENDS WITH \"abc\"\n            <br />\n            ![abc]$ = DOES NOT END WITH \"abc\"\n          </Box>\n        ) as any,\n        nRowsSelected: \"Reconcile {0} Entry(s)\",\n      },\n    }),\n    []\n  );\n\n  const parentChildData = useCallback<\n    NonNullable<MaterialTableProps<Entry>[\"parentChildData\"]>\n  >(\n    (child, parents) =>\n      child.__typename === \"JournalEntryItem\"\n        ? parents.find((parent) => parent.id === child.items)\n        : undefined,\n    []\n  );\n\n  const [expandedItems, setExpandedItems] = useState<Set<string>>(new Set());\n\n  const onTreeExpandChange = useCallback<\n    NonNullable<MaterialTableProps<Entry>[\"onTreeExpandChange\"]>\n  >(\n    (entry: Entry, isExpanded) => {\n      if (isExpanded) {\n        expandedItems.add(entry.id);\n      } else {\n        expandedItems.delete(entry.id);\n      }\n      setExpandedItems(new Set(expandedItems));\n    },\n    [expandedItems, setExpandedItems]\n  );\n\n  const options = useMemo<Options>(\n    () => ({\n      rowStyle: (data: Entry) => {\n        const style = {} as React.CSSProperties;\n\n        style.color =\n          data.type === JournalEntryType.Credit ? green[900] : red[900];\n\n        if (\n          data.__typename === \"JournalEntry\" &&\n          data.items.filter((item) => !item.deleted).length > 0 &&\n          expandedItems.has(data.id)\n        ) {\n          style.backgroundColor = cyan[100];\n        }\n\n        if (data.__typename === \"JournalEntryItem\") {\n          style.backgroundColor = amber[100];\n        }\n\n        return style;\n      },\n      maxBodyHeight: \"calc(100vh - 53px - 64px)\",\n      headerStyle: { position: \"sticky\", top: 0 },\n      pageSize: 25,\n      pageSizeOptions: [25, 50, 100],\n      showTitle: !!journalTitle,\n      selection: mode === JournalMode.Reconcile,\n      showSelectAllCheckbox: false,\n      debounceInterval: 500,\n      emptyRowsWhenPaging: false,\n      columnsButton: true,\n    }),\n    [expandedItems, journalTitle, mode]\n  );\n\n  const actions = useMemo<MaterialTableProps<Entry>[\"actions\"]>(() => {\n    if (mode === JournalMode.Reconcile) {\n      return [\n        {\n          icon: ((props) => <CheckCircleIcon {...props} />) as any,\n          tooltip: \"Reconcile Selected\",\n          position: \"toolbarOnSelect\",\n          iconProps: {\n            color: \"secondary\",\n            fontSize: \"large\",\n          },\n          onClick: async (event, rowData) => {\n            await Promise.all(\n              (Array.isArray(rowData) ? rowData : [rowData]).map(\n                async (entry) => {\n                  if (entry.reconciled) {\n                    return;\n                  }\n\n                  try {\n                    if (entry.__typename === \"JournalEntryRefund\") {\n                      await reconcileRefund({ variables: { id: entry.id } });\n                    } else {\n                      await reconcileEntry({ variables: { id: entry.id } });\n                    }\n                  } catch (error) {\n                    console.error(error);\n                  }\n                }\n              )\n            );\n          },\n        },\n      ];\n    }\n\n    return [\n      (rowData) => {\n        const { tooltip, onClick } = (() => {\n          switch (rowData.__typename) {\n            case \"JournalEntry\":\n              return {\n                tooltip: \"Delete Entry\",\n                onClick: (event, rowData) => setDeleteEntry(rowData.id),\n              };\n            case \"JournalEntryItem\":\n              return {\n                tooltip: \"Delete Item\",\n                onClick: (event, rowData) => setDeleteItem(rowData.id),\n              };\n            case \"JournalEntryRefund\":\n              return {\n                tooltip: \"Delete Refund\",\n                onClick: (event, rowData) => setDeleteRefund(rowData.id),\n              };\n          }\n        })();\n\n        return {\n          icon: DeleteIcon as any,\n          tooltip,\n          onClick,\n        };\n      },\n      (rowData) => {\n        const { tooltip, onClick } = (() => {\n          switch (rowData.__typename) {\n            case \"JournalEntry\":\n              return {\n                tooltip: \"Edit Entry\",\n                onClick: (event, rowData) => {\n                  setUpdateEntryOpen(true);\n                  setUpdateEntry((rowData as Entry).id);\n                },\n              };\n            case \"JournalEntryItem\":\n              return {\n                tooltip: \"Edit Item\",\n                onClick: (event, rowData) => {\n                  setUpdateItemOpen(true);\n                  setUpdateItem({\n                    entryId: (rowData as Entry).items as string,\n                    itemId: (rowData as Entry).id,\n                  });\n                },\n              };\n            case \"JournalEntryRefund\":\n              return {\n                tooltip: \"Edit Refund\",\n                onClick: (event, rowData) => {\n                  setUpdateRefundOpen(true);\n                  setUpdateRefund({\n                    entryId: (rowData as Entry).refunds as string,\n                    refundId: (rowData as Entry).id,\n                  });\n                },\n              };\n          }\n        })();\n\n        return {\n          icon: Edit as any,\n          tooltip,\n          onClick,\n        };\n      },\n      (rowData) => {\n        if (rowData.__typename !== \"JournalEntry\") {\n          return null as any;\n        }\n\n        const isCredit = rowData.type === JournalEntryType.Credit;\n\n        return {\n          icon: ((props) =>\n            isCredit ? (\n              <BankTransferOutIcon {...props} />\n            ) : (\n              <BankTransferInIcon {...props} />\n            )) as any,\n          tooltip: isCredit ? \"Give Refund\" : \"Add Refund\",\n          iconProps: {\n            style: { color: isCredit ? red[900] : green[900] },\n            // color: \"secondary\",\n            // fontSize: \"large\",\n          } as any,\n          onClick: (event, rowData) => {\n            setAddRefundOpen(true);\n            setAddRefundToEntry((rowData as JournalEntryFragment).id);\n          },\n        };\n      },\n      (rowData) => {\n        if (rowData.__typename !== \"JournalEntry\") {\n          return null;\n        }\n\n        return {\n          icon: FileTreeIcon,\n          tooltip: \"Itemize\",\n          onClick: (event, rowData) => {\n            setAddItemOpen(true);\n            setAddItemToEntry((rowData as JournalEntryFragment).id);\n          },\n        };\n      },\n      {\n        icon: ((props) => <AddCircleIcon {...props} />) as any,\n        iconProps: {\n          color: \"secondary\",\n          fontSize: \"large\",\n        },\n        tooltip: \"Add Entry\",\n        isFreeAction: true,\n        onClick: () => {\n          setAddEntryOpen(true);\n        },\n      },\n    ];\n  }, [mode, reconcileRefund, reconcileEntry, setDeleteRefund, setDeleteEntry]);\n\n  const components = useMemo<Components>(\n    () => ({\n      Body: error\n        ? (props) => (\n            <TableBody {...props}>\n              <TableRow>\n                <TableCell\n                  colSpan={\n                    columns.length +\n                    (Array.isArray(actions) && actions.length > 0 ? 1 : 0)\n                  }\n                  align=\"left\"\n                >\n                  <Typography align=\"center\" color=\"error\" variant=\"h4\">\n                    Error Loading Entries\n                  </Typography>\n                  <Typography variant=\"body1\">{error.message}</Typography>\n                </TableCell>\n              </TableRow>\n            </TableBody>\n          )\n        : (props) => <MTableBody {...props} />,\n      Row: (props) => {\n        const entry = props?.data as Entry & {\n          tableData?: { isTreeExpanded?: boolean };\n        };\n        if (\n          entry &&\n          entry.__typename === \"JournalEntry\" &&\n          expandedItems.has(entry.id) &&\n          entry.items.length > 0 &&\n          entry?.tableData?.isTreeExpanded !== true\n        ) {\n          props = {\n            ...props,\n            data: {\n              ...entry,\n              tableData: {\n                ...(entry.tableData || {}),\n                isTreeExpanded: true,\n              },\n            },\n          };\n        }\n        return <MTableBodyRow {...props} />;\n      },\n    }),\n    [error, columns.length, actions, expandedItems]\n  );\n\n  const journalEntries = data?.journalEntries || [];\n  const entries = useMemo(() => {\n    const filters =\n      mode === JournalMode.Reconcile\n        ? [(entry: Entry) => !entry.reconciled && !entry.deleted]\n        : [(entry: Entry) => !entry.deleted];\n\n    return journalEntries\n      .reduce((entries: Entry[], journalEntry) => {\n        for (const entry of entriesGen(journalEntry, mode)) {\n          if (filters.every((filter) => filter(entry))) {\n            entries.push(entry);\n          }\n        }\n\n        return entries;\n      }, [])\n      .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\n  }, [journalEntries, mode]);\n\n  return (\n    <React.Fragment>\n      <MaterialTable\n        icons={tableIcons}\n        isLoading={isLoading || reconcilingEntry || reconcilingRefund}\n        columns={columns}\n        data={entries}\n        options={options}\n        localization={localization}\n        actions={actions}\n        components={components}\n        title={journalTitle ?? undefined}\n        parentChildData={parentChildData}\n        onTreeExpandChange={onTreeExpandChange}\n      />\n      <AddEntry deptId={deptId} open={addEntryOpen} onClose={addEntryOnClose} />\n      <UpdateEntry\n        entryId={updateEntry}\n        open={updateEntryOpen}\n        onClose={updateEntryOnClose}\n        onExited={updateEntryOnExited}\n      />\n      <DeleteEntry entryId={deleteEntry} onClose={deleteEntryOnClose} />\n      <AddRefund\n        entryId={addRefundToEntry}\n        open={addRefundOpen}\n        onClose={addRefundOnClose}\n        onExited={addRefundOnExited}\n      />\n      <UpdateRefund\n        entryId={updateRefund?.entryId ?? null}\n        refundId={updateRefund?.refundId ?? null}\n        open={updateRefundOpen}\n        onClose={updateRefundOnClose}\n        onExited={updateRefundOnExited}\n      />\n      <DeleteRefund refundId={deleteRefund} onClose={deleteRefundOnClose} />\n      <AddItem\n        entryId={addItemToEntry}\n        open={addItemOpen}\n        onClose={addItemOnClose}\n        onExited={addItemOnExited}\n      />\n      <UpdateItem\n        entryId={updateItem?.entryId ?? null}\n        itemId={updateItem?.itemId ?? null}\n        open={updateItemOpen}\n        onClose={updateItemOnClose}\n        onExited={updateItemOnExited}\n      />\n      <DeleteItem itemId={deleteItem} onClose={deleteItemOnClose} />\n    </React.Fragment>\n  );\n};\n\nexport default Journal;\n","import gql from \"graphql-tag\";\n\nexport const GET_REPORT_DATA_DEPT_FRAGMENT = gql`\n  fragment GetReportDataDept_1Fragment on Department {\n    __typename\n    id\n    name\n    budget {\n      id\n      __typename\n      amount {\n        num\n        den\n      }\n    }\n  }\n`;\n\nexport const GET_REPORT_DATA_ENTRY_FRAGMENT = gql`\n  fragment GetReportDataEntry_1Fragment on JournalEntry {\n    id\n    __typename\n    category {\n      __typename\n      id\n      name\n    }\n    type\n    total {\n      num\n      den\n    }\n    department {\n      __typename\n      id\n      ancestors {\n        __typename\n        ... on Business {\n          id\n        }\n        ... on Department {\n          id\n        }\n      }\n    }\n    refunds {\n      __typename\n      id\n      total {\n        num\n        den\n      }\n      deleted\n      lastUpdate\n    }\n    lastUpdate\n    deleted\n  }\n`;\n\nexport const GET_REPORT_DATA = gql`\n  query GetReportData($deptId:ID!, $where:JournalEntiresWhereInput!) {\n    department(id:$deptId) {\n      ...GetReportDataDept_1Fragment\n      descendants {\n        ...GetReportDataDept_1Fragment\n      }\n    }\n    journalEntries(where:$where) {\n      ...GetReportDataEntry_1Fragment\n    }\n  }\n  ${GET_REPORT_DATA_DEPT_FRAGMENT},\n  ${GET_REPORT_DATA_ENTRY_FRAGMENT}\n`;\n\nexport const JOURNAL_ENTRY_ADDED_SUB = gql`\n  subscription JournalEntryAdded_2 {\n    journalEntryAdded {\n      ...GetReportDataEntry_1Fragment\n    }\n  }\n  ${GET_REPORT_DATA_ENTRY_FRAGMENT}\n`;\n\nexport const JOURNAL_ENTRY_UPDATED_SUB = gql`\n  subscription JournalEntryUpdated_2 {\n    journalEntryUpdated {\n      ...GetReportDataEntry_1Fragment\n    }\n  }\n  ${GET_REPORT_DATA_ENTRY_FRAGMENT}\n`;\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { useQuery } from \"@apollo/react-hooks\";\nimport { Link } from \"react-router-dom\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Container from \"@material-ui/core/Container\";\nimport Box from \"@material-ui/core/Box\";\nimport Button from \"@material-ui/core/Button\";\nimport Typography from \"@material-ui/core/Typography\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport DoneAllIcon from \"@material-ui/icons/DoneAll\";\nimport TableChartIcon from \"@material-ui/icons/TableChart\";\nimport AssessmentIcon from \"@material-ui/icons/Assessment\";\nimport Card from \"@material-ui/core/Card\";\nimport CardHeader from \"@material-ui/core/CardHeader\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport numeral from \"numeral\";\nimport { red, green, orange, grey } from \"@material-ui/core/colors\";\nimport gql from \"graphql-tag\";\n\nimport {\n  GetReportDataQuery,\n  GetReportDataQueryVariables,\n  JournalEntryType,\n  OnEntryUpsert_2Subscription as OnEntryUpsert,\n} from \"../../apollo/graphTypes\";\nimport {\n  GET_REPORT_DATA,\n  GET_REPORT_DATA_ENTRY_FRAGMENT,\n} from \"./ReportData.gql\";\nimport { DEPT_ENTRY_OPT_FRAGMENT } from \"../Journal/Upsert/upsertEntry.gql\";\nimport AddEntry from \"../Journal/Upsert/Entries/AddEntry\";\n\nconst colorMeter = (percentSpent: number, shade = 800) => {\n  if (percentSpent < 0.75) {\n    return green[shade];\n  } else if (percentSpent < 0.9) {\n    return orange[shade];\n  } else {\n    return red[shade];\n  }\n};\n\nconst BudgetMeter = (props: { spentPercentage: number; height: number }) => {\n  const { spentPercentage, height } = props;\n\n  return (\n    <Box\n      height={height}\n      bgcolor={colorMeter(spentPercentage)}\n      display=\"flex\"\n      justifyContent=\"flex-start\"\n    >\n      <Box\n        height=\"100%\"\n        width={`${100 * spentPercentage}%`}\n        bgcolor={grey[400]}\n      />\n    </Box>\n  );\n};\n\ninterface DeptReportObj {\n  name: string;\n  spent: number;\n  budget: number | null;\n}\n\nexport const DEPT_FOR_UPSERT_ADD = gql`\n  query DeptForUpsertAdd($id: ID!) {\n    department(id: $id) {\n      ...DeptEntryOptFragment\n    }\n  }\n  ${DEPT_ENTRY_OPT_FRAGMENT}\n`;\n\nconst ON_ENTRY_UPSERT = gql`\n  subscription OnEntryUpsert_2 {\n    journalEntryUpserted {\n      ...GetReportDataEntry_1Fragment\n      department {\n        ancestors {\n          ... on Department {\n            __typename\n            id\n          }\n        }\n      }\n    }\n  }\n  ${GET_REPORT_DATA_ENTRY_FRAGMENT}\n`;\n\nconst Dashboard = function (props: { deptId: string }) {\n  const { deptId } = props;\n\n  const [addEntryOpen, setAddEntryOpen] = useState<boolean>(false);\n  const addEntryOnClose = useCallback(() => void setAddEntryOpen(false), [\n    setAddEntryOpen,\n  ]);\n\n  const variables = useMemo(\n    () => ({\n      deptId,\n      where: {\n        department: { eq: deptId, matchDecedentTree: true },\n        deleted: false,\n      },\n    }),\n    [deptId]\n  );\n\n  const { loading, error, data, subscribeToMore } = useQuery<\n    GetReportDataQuery,\n    GetReportDataQueryVariables\n  >(GET_REPORT_DATA, {\n    variables,\n    fetchPolicy: \"cache-and-network\",\n  });\n\n  const isLoading = loading && !data?.journalEntries;\n\n  // Subscribe to updates\n  useEffect(() => {\n    return subscribeToMore<OnEntryUpsert>({\n      document: ON_ENTRY_UPSERT,\n      updateQuery: (prev, { subscriptionData }) => {\n        if (!subscriptionData.data) {\n          return prev;\n        }\n\n        const upsertEntry = subscriptionData.data.journalEntryUpserted;\n\n        const ancestors = upsertEntry.department.ancestors;\n\n        if (\n          deptId &&\n          upsertEntry.department.id !== deptId &&\n          ancestors.every((dept) => (dept as any).id !== deptId)\n        ) {\n          // Filter entry out of query results if department changes.\n          const journalEntriesFiltered = prev.journalEntries.filter(\n            (entry) => entry.id !== upsertEntry.id\n          );\n\n          if (journalEntriesFiltered.length === prev.journalEntries.length) {\n            return prev;\n          }\n\n          return Object.assign({}, prev, {\n            journalEntries: journalEntriesFiltered,\n          });\n        }\n\n        // Apollo will take care of updating if entry already exists in cache.\n        if (prev.journalEntries.some((entry) => entry.id === upsertEntry.id)) {\n          return prev;\n        }\n\n        return Object.assign({}, prev, {\n          journalEntries: [upsertEntry, ...prev.journalEntries],\n        });\n      },\n    });\n  }, [deptId, subscribeToMore]);\n\n  const entries = useMemo(() => {\n    return (data?.journalEntries || []).filter((entry) => !entry.deleted);\n  }, [data]);\n  const deptName = data?.department?.name || \"\";\n\n  useEffect(() => {\n    document.title = deptName;\n  }, [deptName]);\n\n  const department = data?.department || null;\n\n  const {\n    totalRemaining,\n    budget,\n    spentToBudgetRatio,\n    deptReport,\n  } = useMemo(() => {\n    // Generate department report objects\n    const deptReport = new Map<string, DeptReportObj>();\n    let subDeptBudgetAg = 0;\n\n    if (department) {\n      const budget = (() => {\n        if (department.budget) {\n          const { num, den } = department.budget.amount;\n          return num / den;\n        }\n        return null;\n      })();\n\n      deptReport.set(department.id, {\n        name: department.name,\n        spent: 0,\n        budget,\n      });\n\n      for (const subDept of department.descendants) {\n        let budget: null | number = null;\n\n        if (subDept.budget) {\n          const { num, den } = subDept.budget.amount;\n          const subBudgetDec = num / den;\n          subDeptBudgetAg += subBudgetDec;\n          budget = subBudgetDec;\n        }\n\n        deptReport.set(subDept.id, {\n          name: subDept.name,\n          spent: 0,\n          budget,\n        });\n      }\n    }\n\n    // Calculating aggregate depts and credits\n    let spent = 0;\n    for (const entry of entries) {\n      if (entry.deleted) {\n        continue;\n      }\n      const deptReportObj = deptReport.get(\n        entry.department.id\n      ) as DeptReportObj;\n\n      let entryTotal = entry.total.num / entry.total.den;\n\n      // Aggregate refunds\n      for (const refund of entry.refunds) {\n        if (refund.deleted) {\n          continue;\n        }\n        entryTotal -= refund.total.num / refund.total.den;\n      }\n\n      if (entry.type === JournalEntryType.Credit) {\n        spent -= entryTotal;\n        deptReportObj.spent -= entryTotal;\n      } else {\n        spent += entryTotal;\n\n        deptReportObj.spent += entryTotal;\n      }\n    }\n\n    // Format values\n    const budgetDec = (() => {\n      if (department?.budget) {\n        const { num, den } = department?.budget?.amount || { num: 0, den: 1 };\n        return num / den;\n      }\n\n      return subDeptBudgetAg;\n    })();\n\n    const totalRemaining = numeral(budgetDec - spent).format(\"$0,0.00\");\n    const budget = numeral(budgetDec).format(\"$0,0.00\");\n    const spentToBudgetRatio = spent / budgetDec;\n\n    return {\n      totalRemaining,\n      budget,\n      spentToBudgetRatio,\n      deptReport,\n    };\n  }, [entries, department]);\n\n  const subDeptCards = useMemo(() => {\n    const subDeptCards: JSX.Element[] = [];\n\n    for (const [id, { budget, spent, name }] of deptReport) {\n      // Do not include root department\n      if (id === department?.id) {\n        continue;\n      }\n\n      const card = (\n        <Grid key={id} item xs={12} md={4} lg={3}>\n          <Card>\n            <CardHeader\n              titleTypographyProps={{\n                noWrap: true,\n              }}\n              title={name}\n            />\n            <CardContent>\n              {(() => {\n                if (budget === null) {\n                  return (\n                    <Box color={spent > 0 ? red[900] : green[900]} clone>\n                      <Typography variant=\"h6\">\n                        {`Spent: ${numeral(Math.abs(spent)).format(\"$0,0.00\")}`}\n                      </Typography>\n                    </Box>\n                  );\n                }\n\n                const totalRemaining = budget - spent;\n\n                return (\n                  <React.Fragment>\n                    <Box color={colorMeter(spent / budget, 900)} clone>\n                      <Typography variant=\"h6\">{`${numeral(\n                        totalRemaining\n                      ).format(\"$0,0.00\")} Remaining`}</Typography>\n                    </Box>\n                    <Typography variant=\"body1\">{`of ${numeral(budget).format(\n                      \"$0,0.00\"\n                    )}`}</Typography>\n                    <BudgetMeter spentPercentage={spent / budget} height={5} />\n                  </React.Fragment>\n                );\n              })()}\n            </CardContent>\n          </Card>\n        </Grid>\n      );\n\n      subDeptCards.push(card);\n    }\n\n    return subDeptCards;\n  }, [deptReport, department]);\n\n  const onClickAddEntry = useCallback((event?) => setAddEntryOpen(true), [\n    setAddEntryOpen,\n  ]);\n\n  if (isLoading) {\n    return <p>Loading...</p>;\n  } else if (error) {\n    console.error(error);\n    return <p>{error.message}</p>;\n  }\n\n  return (\n    <Box display=\"flex\" flexDirection=\"column\" overflow=\"hidden\" clone>\n      <Container>\n        <Box padding={8}>\n          <Grid container alignItems=\"center\" justify=\"center\" spacing={4}>\n            <Grid item>\n              <Button\n                variant=\"contained\"\n                color=\"secondary\"\n                startIcon={<AddIcon />}\n                children={\"New Entry\"}\n                onClick={onClickAddEntry}\n              />\n            </Grid>\n            <Grid item>\n              <Button\n                component={Link}\n                to={`/journal/${deptId}/reconcile`}\n                variant=\"contained\"\n                startIcon={<DoneAllIcon />}\n                children={\"Reconcile\"}\n              />\n            </Grid>\n            <Grid item>\n              <Button\n                variant=\"contained\"\n                startIcon={<AssessmentIcon />}\n                children={\"Reports\"}\n              />\n            </Grid>\n            <Grid item>\n              <Button\n                component={Link}\n                to={`/journal/${deptId}`}\n                variant=\"contained\"\n                startIcon={<TableChartIcon />}\n                children={\"Journal\"}\n              />\n            </Grid>\n          </Grid>\n        </Box>\n        <Box flexGrow={1} overflow=\"auto\">\n          <Grid justify=\"center\" container spacing={2}>\n            <Grid item xs={12}>\n              <Typography align=\"center\" variant=\"h3\">\n                {deptName}\n              </Typography>\n              <Box color={colorMeter(spentToBudgetRatio)}>\n                <Typography align=\"center\" variant=\"h4\">\n                  {`${totalRemaining} Remaining`}\n                </Typography>\n              </Box>\n              <Typography align=\"center\" variant=\"subtitle1\">\n                {`of ${budget}`}\n              </Typography>\n              <BudgetMeter spentPercentage={spentToBudgetRatio} height={10} />\n            </Grid>\n            {subDeptCards}\n          </Grid>\n        </Box>\n        <AddEntry\n          deptId={deptId}\n          open={addEntryOpen}\n          onClose={addEntryOnClose}\n        />\n      </Container>\n    </Box>\n  );\n};\n\nexport default Dashboard;\n","import React, {useCallback, useEffect, useState, useMemo} from \"react\";\nimport {useQuery} from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Container from \"@material-ui/core/Container\";\nimport Box from \"@material-ui/core/Box\";\nimport {Link} from \"react-router-dom\";\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\n\nimport {DeptsForNav_1Query as DeptsForNavQuery} from \"../apollo/graphTypes\";\n\nconst DEPTS_FOR_NAV = gql`\n  query DeptsForNav_1 {\n    departments {\n      __typename\n      id\n      name\n      parent {\n        __typename\n        ...on Business {\n          id\n        }\n        ...on Department {\n          id\n        }\n      }\n      virtualRoot\n    }\n  }\n`;\n\nconst TopNav = function(props) {\n\n  const {loading, error, data} = useQuery<DeptsForNavQuery>(DEPTS_FOR_NAV);\n\n  const [value, setValue] = useState<string | null>(null);\n\n  const depts = (data?.departments || []);\n\n  type Department = typeof depts[0];\n\n  const {rootDepts, virtualRoots} = useMemo(() => {\n    \n    const rootDepts:Department[] = [];\n    const virtualRoots = new Set<string>();\n\n    for(const dept of depts) {\n      \n      if(dept.parent.__typename === \"Business\") {\n        rootDepts.push(dept);\n      }\n\n      if(dept.virtualRoot) {\n        virtualRoots.add(dept.id);\n      }\n\n    }\n\n    return {rootDepts, virtualRoots};\n\n  },[depts]);\n\n  const subDepts =  useMemo(() => {\n\n    const subDepts:Department[] = [];\n\n    if(value && virtualRoots.has(value)) {\n      \n      for(const dept of depts) {\n  \n        if(dept.parent.id === value) {\n  \n          subDepts.push(dept);\n  \n        }\n  \n      }\n\n    }\n\n    return subDepts;\n\n  }, [virtualRoots, value, depts]);\n\n  useEffect(() => { document.title = \"Select Department\"; });\n\n  const onChange = useCallback((event?) => {\n    setValue(event?.target?.value || null);\n  },[setValue]);\n  \n  if(loading) {\n    return <p>Loading...</p>;\n  } else if(error) {\n    return <p>{error.message}</p>;\n  }\n\n\n  const showSubDepts = subDepts.length > 0;\n\n  return <Box\n    flexGrow={1}\n    display=\"flex\"\n    justifyContent=\"center\"\n    alignItems=\"center\"\n    flexDirection=\"column\"\n    clone\n  >\n    <Container>\n      <Box padding={4} clone>\n        <Typography align=\"center\" color=\"primary\" variant=\"h3\">\n          Select Department\n        </Typography>\n      </Box>\n      <Box minWidth=\"250px !important\" clone>\n        <FormControl variant=\"filled\">\n          <InputLabel>Department</InputLabel>\n          <Select\n            value={value} \n            onChange={onChange}\n            autoWidth\n          >{rootDepts.map((dept) => {\n            \n            const props = {\n              component:Link,\n              to:`/department/${dept.id}`,\n              key:dept.id,\n              value:dept.id,\n              children:dept.name\n            }  as any;\n\n            if(dept.virtualRoot) {\n              delete props.component;\n              delete props.to;\n            }\n\n            return <MenuItem {...props}/>;\n          \n          })}</Select>\n        </FormControl>\n      </Box>\n      {showSubDepts &&\n        <Box pt={2}>\n          <Box pt={2} minWidth=\"250px !important\" clone>\n            <FormControl variant=\"filled\">\n              <InputLabel>Sub Department</InputLabel>\n              <Select autoWidth>{subDepts.map((dept) => {\n                  const props = {\n                    component:Link,\n                    to:`/department/${dept.id}`,\n                    key:dept.id,\n                    value:dept.id,\n                    children:dept.name\n                  }  as any;\n      \n                  return <MenuItem {...props}/>;\n              })}</Select>\n            </FormControl>\n        </Box>\n      </Box>}\n        \n    </Container>\n   </Box>;\n\n}\n\nexport default TopNav;","import React from \"react\";\nimport { Route, Switch, useParams } from \"react-router-dom\";\n\n// import Journal from \"./components/Journal/Table/Journal\";\nimport Journal from \"./components/Journal/Table/Journal\";\nimport { JournalMode } from \"./components/Journal/Table/Journal\";\nimport Dashboard from \"./components/Dashboard/Dashboard\";\nimport TopNav from \"./components/TopNav\";\nimport { useQuery } from \"@apollo/react-hooks\";\nimport { DepartmentName_1Query as DepartmentName } from \"./apollo/graphTypes\";\nimport gql from \"graphql-tag\";\n\nconst DashBoardRender = (props) => {\n  const { id } = useParams();\n  return id ? <Dashboard deptId={id} /> : <div>Error: No Dept ID!</div>;\n};\n\nconst DEPARTMENT_NAME = gql`\n  query DepartmentName_1($id: ID!) {\n    department(id: $id) {\n      id\n      __typename\n      name\n    }\n  }\n`;\n\nconst JournalViewRender = (props) => {\n  const { id } = useParams();\n  const { loading, error, data } = useQuery<DepartmentName>(DEPARTMENT_NAME, {\n    variables: { id },\n  });\n  const journalTitle = data?.department?.name\n    ? data.department.name\n    : undefined;\n  return (\n    <Journal mode={JournalMode.View} deptId={id} journalTitle={journalTitle} />\n  );\n};\n\nconst JournalReconcileRender = (props) => {\n  const { id } = useParams();\n  const { loading, error, data } = useQuery<DepartmentName>(DEPARTMENT_NAME, {\n    variables: { id },\n  });\n  const journalTitle = data?.department?.name\n    ? `Reconcile ${data.department.name}`\n    : \"Reconcile\";\n  return (\n    <Journal\n      mode={JournalMode.Reconcile}\n      deptId={id}\n      journalTitle={journalTitle}\n    />\n  );\n};\n\nconst Routes = (props) => {\n  return (\n    <Switch>\n      <Route exact path=\"/\" component={TopNav} />\n      <Route exact path=\"/department/:id\" component={DashBoardRender} />\n      <Route exact path=\"/journal\" component={Journal} />\n      <Route exact path=\"/journal/:id\" component={JournalViewRender} />\n      <Route\n        exact\n        path=\"/journal/:id/reconcile\"\n        component={JournalReconcileRender}\n      />\n    </Switch>\n  );\n};\n\nexport default Routes;\n","import {combineReducers} from \"redux\";\nimport * as _ from  \"lodash\"; \nimport isEqual from \"lodash.isequal\";\n\nimport {JournalEntrySourceType, JournalEntrySourceInput, RationalInput,\n  JournalEntryType\n} from \"../../apollo/graphTypes\";\nimport {\n  \n  Create, CREATE, Cancel, CANCEL, Clear, CLEAR,\n\n  SET_SUBMIT_STATUS, SetSubmitStatus, SET_SUBMIT_ERROR, SetSubmitError, \n  CLEAR_SUBMIT_ERROR, ClearSubmitError,\n\n  SET_TYPE_VALUE, SetTypeValue, SET_TYPE_ERROR,SetTypeError,\n  CLEAR_TYPE_ERROR, ClearTypeError,\n  \n  SetDateInput, SET_DATE_INPUT, ClearDateInput, CLEAR_DATE_INPUT,\n  SetDateValue, SET_DATE_VALUE, ClearDateValue, CLEAR_DATE_VALUE,\n  SetDateError, SET_DATE_ERROR, ClearDateError, CLEAR_DATE_ERROR,\n  \n  SetDeptInput, SET_DEPT_INPUT, ClearDeptInput, CLEAR_DEPT_INPUT,\n  SetDeptValue, SET_DEPT_VALUE, ClearDeptValue, CLEAR_DEPT_VALUE,\n  SetDeptError, SET_DEPT_ERROR, ClearDeptError, CLEAR_DEPT_ERROR,\n  SetDeptOpen , SET_DEPT_OPEN,\n\n  SET_CAT_INPUT, SetCatInput, CLEAR_CAT_INPUT, ClearCatInput, SET_CAT_VALUE,\n  SetCatValue, CLEAR_CAT_VALUE, ClearCatValue, SET_CAT_ERROR, SetCatError,\n  CLEAR_CAT_ERROR, ClearCatError, SET_CAT_OPEN, SetCatOpen,\n  \n  SetSrcType, SET_SRC_TYPE,\n  SetSrcInput, SET_SRC_INPUT, ClearSrcInput, CLEAR_SRC_INPUT,\n  SetSrcValue, SET_SRC_VALUE, ClearSrcValue, CLEAR_SRC_VALUE,\n  SetSrcError, SET_SRC_ERROR, ClearSrcError, CLEAR_SRC_ERROR,\n  SetSrcOpen , SET_SRC_OPEN,\n\n  SetPayMethodValue, SET_PAY_METHOD_VALUE, ClearPayMethodValue, \n  CLEAR_PAY_METHOD_VALUE, SET_PAY_METHOD_ERROR, SetPayMethodError,\n  CLEAR_PAY_METHOD_ERROR, ClearPayMethodError,\n\n  SET_DSCRPT_VALUE, SetDscrptValue, CLEAR_DSCRPT_VALUE, ClearDscrptValue,\n\n  SET_TOTAL_INPUT, SetTotalInput, CLEAR_TOTAL_INPUT, ClearTotalInput,\n  SET_TOTAL_VALUE, SetTotalValue, CLEAR_TOTAL_VALUE, ClearTotalValue,\n  SET_TOTAL_ERROR, SetTotalError, CLEAR_TOTAL_ERROR, ClearTotalError,\n\n  SET_RECONCILED_VALUE, SetReconciledValue,\n  CLEAR_RECONCILED_VALUE, ClearReconciledValue\n\n} from \"../actionTypes/journalEntryUpsert\";\nimport {InputValue, reduceOneById} from \"./utils\";\n\ntype Actions = Create | Cancel | Clear |\n  SetSrcInput | SetDateInput |  ClearDateInput | SetDateValue | ClearDateValue |\n  SetDateError | ClearDateError | SetSrcInput | ClearSrcInput | SetSrcValue |\n  ClearSrcValue | SetSrcError | ClearSrcError | SetSrcOpen | SetDeptInput |\n  ClearDeptInput | SetDeptValue | ClearDeptValue | SetDeptError |\n  ClearDeptError | SetDeptOpen | SetPayMethodValue | ClearPayMethodValue |\n  SetTotalInput | ClearTotalInput | SetTotalValue | ClearTotalValue |\n  SetTotalError | ClearTotalError | SetSubmitStatus | SetSubmitError | \n  ClearSubmitError | SetSrcType | SetPayMethodError | ClearPayMethodError |\n  SetDscrptValue | ClearDscrptValue | SetReconciledValue |\n  ClearReconciledValue | SetCatInput | ClearCatInput | SetCatValue |\n  ClearCatValue | SetCatError | ClearCatError | SetCatOpen | SetTypeValue |\n  SetTypeError | ClearTypeError;\n\n\nconst type = (state = new InputValue<JournalEntryType, null>(null)\n  , action:Actions):InputValue<JournalEntryType, null>  =>\n{\n\n  switch(action.type) {\n    case SET_TYPE_VALUE:\n      return state.value === action.payload.type ?\n        state : {...state, value:action.payload.type};\n    case SET_TYPE_ERROR:\n      return state.error?.message === action.payload.error.message ?\n        state : {...state, error:action.payload.error};\n    case CLEAR_TYPE_ERROR:\n      return state.error === null ? state : {...state, error:null};\n    default:\n      return state;\n  }\n\n}\n\nconst date = (state = new InputValue<Date, null>(null), action:Actions)\n  :InputValue<Date, null> => \n{\n\n  switch(action.type) {\n    case SET_DATE_INPUT:{\n      const input = action.payload.input.trimStart();\n      return state.input === input ? state : {...state, input};\n    }\n    case CLEAR_DATE_INPUT:\n      return state.input === \"\" ? state : {...state, input:\"\"};\n    case SET_DATE_VALUE:\n      return state.value?.getTime() === action.payload.value.getTime() ?\n        state : {...state, value:action.payload.value};\n    case CLEAR_DATE_VALUE:\n      return state.value ? {...state, value:null} : state;\n    case SET_DATE_ERROR:\n      return state.error?.message === action.payload.error.message ?\n        state : {...state, error:action.payload.error};\n    case CLEAR_DATE_ERROR:\n      return state.error ? {...state, error:null} : state;\n    default:\n      return state;\n  }\n\n}\n\nconst department = (state = Object.assign(new InputValue<string, null>(null),\n  {open:false}), action:Actions):InputValue<string, null> & {open:boolean} =>\n{\n\n  switch(action.type) {\n    case CREATE:\n      if(action.payload.fromDept) {\n        return {...state, value:action.payload.fromDept};\n      }\n      return state;\n    case SET_DEPT_INPUT:{\n      const input = action.payload.input.trimStart();\n      return state.input === input ? state : {...state, input};\n    }\n    case CLEAR_DEPT_INPUT:\n      return state.input === \"\" ? state : {...state, input:\"\"};\n    case SET_DEPT_VALUE:\n      return state.value === action.payload.value ?\n        state : {...state, value:action.payload.value};\n    case CLEAR_DEPT_VALUE:\n      return state.value ? {...state, value:null} : state;\n    case SET_DEPT_ERROR:\n      return state.error?.message === action.payload.error.message ?\n        state : {...state, error:action.payload.error};\n    case CLEAR_DEPT_ERROR:\n      return state.error ? {...state, error:null} : state;\n    case SET_DEPT_OPEN:{\n      const open = action.payload.open;\n      return open === state.open ? state : {...state, open};\n    }\n    default:\n      return state;\n  }\n      \n}\n\nconst category = (state = Object.assign(new InputValue<string, null>(null),\n  {open:false}), action:Actions):InputValue<string, null> & {open:boolean} =>\n{\n\n  switch(action.type) {\n    case SET_CAT_INPUT:{\n      const input = action.payload.input.trimStart();\n      return state.input === input ? state : {...state, input};\n    }\n    case CLEAR_CAT_INPUT:\n      return state.input === \"\" ? state : {...state, input:\"\"};\n    case SET_CAT_VALUE:\n      return state.value === action.payload.value ?\n        state : {...state, value:action.payload.value};\n    case CLEAR_CAT_VALUE:\n      return state.value ? {...state, value:null} : state;\n    case SET_CAT_ERROR:\n      return state.error?.message === action.payload.error.message ?\n        state : {...state, error:action.payload.error};\n    case CLEAR_CAT_ERROR:\n      return state.error ? {...state, error:null} : state;\n    case SET_CAT_OPEN:{\n      const open = action.payload.open;\n      return open === state.open ? state : {...state, open};\n    }\n    default:\n      return state;\n  }\n      \n}\nconst source = (state = Object.assign(\n  new InputValue<JournalEntrySourceInput, null>(null),{open:false}),\n  action:Actions):InputValue<JournalEntrySourceInput, null> & {open:boolean} => \n{\n\n  switch(action.type) {\n    case SET_SRC_INPUT:{\n      const input = action.payload.input.trimStart();\n      return state.input === input ? state : {...state, input};\n    }\n    case CLEAR_SRC_INPUT:\n      return state.input === \"\" ? state : {...state, input:\"\"};\n    case SET_SRC_VALUE:\n      return isEqual(state.value, action.payload.value) ?\n        state : {...state, value:action.payload.value};\n    case CLEAR_SRC_VALUE:\n      return state.value ? {...state, value:null} : state;\n    case SET_SRC_ERROR:\n      return state.error?.message === action.payload.error.message ?\n        state : {...state, error:action.payload.error};\n    case CLEAR_SRC_ERROR:\n      return state.error ? {...state, error:null} : state;\n    case SET_SRC_OPEN:{\n      const open = action.payload.open;\n      return open === state.open ? state : {...state, open};\n    }\n    default:\n      return state;\n  }\n\n}\n\nconst paymentMethod = (state = Object.assign(new InputValue<string, null>(null),\n  {open:false}), action:Actions):InputValue<string, null> & {open:boolean} =>\n{\n\n  switch(action.type) {\n    case SET_PAY_METHOD_VALUE:\n      return action.payload.value && state.value !== action.payload.value ?\n        {...state, value:action.payload.value} : state;\n    case CLEAR_PAY_METHOD_VALUE:\n      return state.value === null ? state : {...state, value:null};\n    case SET_PAY_METHOD_ERROR:\n      return state.error?.message === action.payload.error.message ?\n        state : {...state, error:action.payload.error};\n    case CLEAR_PAY_METHOD_ERROR:\n        return state.error === null ? state : {...state, error:null};\n    default:\n      return state;\n  }\n  \n}\n\nconst description = (state = new InputValue<string, null>(null), \n  action:Actions ):InputValue<string, null> => \n{\n\n  switch(action.type) {\n    case SET_DSCRPT_VALUE:{\n      const value = action.payload.value.trimStart();\n      return !value || state.value === value ? state : {...state, value};\n    }\n    case CLEAR_DSCRPT_VALUE:\n      return state.value === null ? state : {...state, value:null};\n    default:\n      return state;\n  }\n  \n}\n\nconst total = (state = new InputValue<RationalInput, null>(null), \n  action:Actions ):InputValue<RationalInput, null> => \n{\n\n  switch(action.type) {\n    case SET_TOTAL_INPUT:\n      return state.input === action.payload.input ?\n        state : {...state, input:action.payload.input};\n    case CLEAR_TOTAL_INPUT:\n      return state.input === \"\" ? state : {...state, input:\"\"};\n    case SET_TOTAL_VALUE:\n      return isEqual(state.value, action.payload.value) ?\n        state : {...state, value:action.payload.value};\n    case CLEAR_TOTAL_VALUE:\n      return state.value === null ? state : {...state, value:null};\n    case SET_TOTAL_ERROR:\n      return state.error?.message === action.payload.error.message ?\n        state : {...state, error:action.payload.error};\n    case CLEAR_TOTAL_ERROR:\n      return state.error === null ? state : {...state, error:null};\n    default:\n      return state;\n  }\n  \n}\n\nconst reconciled = (state = new InputValue<boolean, false>(false), \n  action:Actions ):InputValue<boolean, false> => \n{\n\n  switch(action.type) {\n    case SET_RECONCILED_VALUE:\n      return state.value === action.payload.value ?\n        state : {...state, value:action.payload.value};\n    case CLEAR_RECONCILED_VALUE:\n      return state.value === false ? state : {...state, value:false};\n    default:\n      return state;\n  }\n  \n}\n\nconst values = combineReducers({\n  id:(state:string | null = null, action:Actions) => action.type === CREATE ?\n    (action.payload.entryId || null) : state,\n  type,\n  date,\n  department,\n  category,\n  srcType:(state:JournalEntrySourceType | null = null, action:Actions) => \n    action.type === SET_SRC_TYPE ? action.payload.srcType : state,\n  source,\n  paymentMethod,\n  description,\n  total,\n  reconciled\n});\n\nexport enum SubmitStatus {\n  NotSubmitted,\n  Submitting,\n  Submitted,\n}\n\nconst submit = (state = {\n    status:SubmitStatus.NotSubmitted,\n    error:null as null | Error,\n  }, action:Actions) => \n{\n\n  switch(action.type) {\n    case SET_SUBMIT_STATUS:\n      return state.status === action.payload.status \n        ? state : {...state, status:action.payload.status};\n    case SET_SUBMIT_ERROR:\n      return state.error?.message === action.payload.error.message ?\n        state : {...state, error:action.payload.error};\n    case CLEAR_SUBMIT_ERROR:\n      return state.error === null ? state : {...state, error:null};\n    default:\n      return state;\n  }\n\n}\n\n\nconst journalEntryUpsert = combineReducers({\n  id:(state:string = \"\", action:Actions) => \n    action.type === CREATE ? action.payload.upsertId : state,\n  values,\n  fromDept:(state:string = \"\", action:Actions):string => {\n    if(action.type === CREATE && action.payload.fromDept) {\n      return action.payload.fromDept;\n    }\n    return state;\n  },\n  submit\n});\n\nexport type JournalEntryUpsert = ReturnType<typeof journalEntryUpsert>;\n\nexport const journalEntryUpserts = (state:JournalEntryUpsert[] = [],\n  action:Actions):JournalEntryUpsert[] => \n{\n\n  switch(action.type) {\n    \n    case CREATE:\n      return [...state, journalEntryUpsert(undefined, action)];\n    case CANCEL:\n    case CLEAR:{\n      const id = action.payload.upsertId;\n      for(let i = 0, len = state.length; i < len; i++){\n        if(state[i].id === id){\n          return [\n            ...state.slice(0, i),\n            ...state.slice(i + 1)\n          ];\n        }\n      }\n      return state;\n    }\n    \n    case SET_TYPE_VALUE:\n    case SET_TYPE_ERROR:\n    case CLEAR_TYPE_ERROR:\n    case SET_DATE_INPUT:\n    case CLEAR_DATE_INPUT:\n    case SET_DATE_VALUE:\n    case CLEAR_DATE_VALUE:\n    case SET_DATE_ERROR:\n    case CLEAR_DATE_ERROR:\n    case SET_DEPT_INPUT:\n    case SET_DEPT_VALUE:\n    case SET_DEPT_ERROR:\n    case SET_DEPT_OPEN:\n    case CLEAR_DEPT_INPUT:\n    case CLEAR_DEPT_VALUE:\n    case CLEAR_DEPT_ERROR:\n    case SET_CAT_INPUT:\n    case CLEAR_CAT_INPUT:\n    case SET_CAT_VALUE:\n    case CLEAR_CAT_VALUE:\n    case SET_CAT_ERROR:\n    case CLEAR_CAT_ERROR:\n    case SET_CAT_OPEN:\n    case SET_SRC_TYPE:\n    case SET_SRC_INPUT:\n    case CLEAR_SRC_INPUT:\n    case SET_SRC_VALUE:\n    case CLEAR_SRC_VALUE:\n    case SET_SRC_ERROR:\n    case CLEAR_SRC_ERROR:\n    case SET_SRC_OPEN:\n    case SET_PAY_METHOD_VALUE:\n    case CLEAR_PAY_METHOD_VALUE:\n    case SET_DSCRPT_VALUE:\n    case CLEAR_DSCRPT_VALUE:\n    case SET_TOTAL_INPUT:\n    case CLEAR_TOTAL_INPUT:\n    case SET_TOTAL_VALUE:\n    case CLEAR_TOTAL_VALUE:\n    case SET_TOTAL_ERROR:\n    case CLEAR_TOTAL_ERROR:\n    case SET_SUBMIT_STATUS:\n    case SET_SUBMIT_ERROR:\n    case CLEAR_SUBMIT_ERROR:\n    case SET_PAY_METHOD_ERROR:\n    case CLEAR_PAY_METHOD_ERROR:\n    case SET_RECONCILED_VALUE:\n    case CLEAR_RECONCILED_VALUE:\n      return reduceOneById(state, action, \n        action.payload.upsertId, \"id\", journalEntryUpsert);\n    default:\n      return state;\n  }\n\n}","import {Action} from \"./types\";\nimport {JournalEntrySourceInput, JournalEntrySourceType, RationalInput,\n  JournalEntryType\n} from \"../../apollo/graphTypes\";\nimport {SubmitStatus} from \"../reducers/journalEntryUpserts\";\n\ntype SetInputAction<A> = Action<A, {upsertId:string, input:string}>;\ntype SetValueAction<A, T> = Action<A, {upsertId:string, value:T}>;\ntype SetErrorAction<A> = Action<A, {upsertId:string, error:Error}>;\ntype ClearAction<A> = Action<A, {upsertId:string}>;\n\n// Upsert Life cycle\nexport const CREATE = \"journalEntryUpsert/CREATE\";\nexport type Create = Action<typeof CREATE, {upsertId:string, entryId?:string,\n  fromDept?:string}>;\n\nexport const CANCEL = \"journalEntryUpsert/CANCEL\";\nexport type Cancel = Action<typeof CANCEL, {upsertId:string}>;\n\nexport const CLEAR = \"journalEntryUpsert/CLEAR\";\nexport type Clear = ClearAction<typeof CLEAR>;\n\n// Submit\nexport const SET_SUBMIT_STATUS = \"journalEntryUpsert/SUBMIT\";\nexport type SetSubmitStatus = \n  Action<typeof SET_SUBMIT_STATUS, {upsertId:string, status:SubmitStatus}>;\n\nexport const SET_SUBMIT_ERROR = \"journalEntryUpsert/SET_SUBMIT_ERROR\";\nexport type SetSubmitError = \n  Action<typeof SET_SUBMIT_ERROR, {upsertId:string, error:Error}>;\n\nexport const CLEAR_SUBMIT_ERROR = \"journalEntryUpsert/CLEAR_SUBMIT_ERROR\";\nexport type ClearSubmitError = \n  Action<typeof CLEAR_SUBMIT_ERROR, {upsertId:string}>;\n\n// Date\nexport const SET_DATE_INPUT = \"journalEntryUpsert/SET_DATE_INPUT\";\nexport type SetDateInput = SetInputAction<typeof SET_DATE_INPUT>;\n\nexport const CLEAR_DATE_INPUT = \"journalEntryUpsert/CLEAR_DATE_INPUT\";\nexport type ClearDateInput = ClearAction<typeof CLEAR_DATE_INPUT>;\n\nexport const SET_DATE_VALUE = \"journalEntryUpsert/SET_DATE_VALUE\";\nexport type SetDateValue = SetValueAction<typeof SET_DATE_VALUE, Date>;\n\nexport const CLEAR_DATE_VALUE = \"journalEntryUpsert/CLEAR_DATE_VALUE\";\nexport type ClearDateValue = ClearAction<typeof CLEAR_DATE_VALUE>;\n\nexport const SET_DATE_ERROR = \"journalEntryUpsert/SET_DATE_ERROR\";\nexport type SetDateError = SetErrorAction<typeof SET_DATE_ERROR>;\n\nexport const CLEAR_DATE_ERROR = \"journalEntryUpsert/CLEAR_DATE_ERROR\";\nexport type ClearDateError = ClearAction<typeof CLEAR_DATE_ERROR>;\n\n// Department\nexport const SET_DEPT_INPUT = \"journalEntryUpsert/SET_DEPT_INPUT\";\nexport type SetDeptInput = SetInputAction<typeof SET_DEPT_INPUT>;\n\nexport const CLEAR_DEPT_INPUT = \"journalEntryUpsert/CLEAR_DEPT_INPUT\";\nexport type ClearDeptInput = ClearAction<typeof CLEAR_DEPT_INPUT>;\n\nexport const SET_DEPT_VALUE = \"journalEntryUpsert/SET_DEPT_VALUE\";\nexport type SetDeptValue = SetValueAction<typeof SET_DEPT_VALUE, string>;\n\nexport const CLEAR_DEPT_VALUE = \"journalEntryUpsert/CLEAR_DEPT_VALUE\";\nexport type ClearDeptValue = ClearAction<typeof CLEAR_DEPT_VALUE>;\n\nexport const SET_DEPT_ERROR = \"journalEntryUpsert/SET_DEPT_ERROR\";\nexport type SetDeptError = SetErrorAction<typeof SET_DEPT_ERROR>;\n\nexport const CLEAR_DEPT_ERROR = \"journalEntryUpsert/CLEAR_DEPT_ERROR\";\nexport type ClearDeptError = ClearAction<typeof CLEAR_DEPT_ERROR>;\n\nexport const SET_DEPT_OPEN = \"journalEntryUpsert/SET_DEPT_OPEN\";\nexport type SetDeptOpen = \n  Action<typeof SET_DEPT_OPEN, {upsertId:string, open:boolean}>;\n\n// Type\nexport const SET_TYPE_VALUE = \"journalEntryUpsert/SET_TYPE_VALUE\";\nexport type SetTypeValue = Action<typeof SET_TYPE_VALUE,{upsertId:string,\n  type:JournalEntryType}>;\n\nexport const SET_TYPE_ERROR = \"journalEntryUpsert/SET_TYPE_ERROR\";\nexport type SetTypeError = SetErrorAction<typeof SET_TYPE_ERROR>;\n\nexport const CLEAR_TYPE_ERROR = \"journalEntryUpsert/CLEAR_TYPE_ERROR\";\nexport type ClearTypeError = ClearAction<typeof CLEAR_TYPE_ERROR>;\n\n// Category\nexport const SET_CAT_INPUT = \"journalEntryUpsert/SET_CAT_INPUT\";\nexport type SetCatInput = SetInputAction<typeof SET_CAT_INPUT>;\n\nexport const CLEAR_CAT_INPUT = \"journalEntryUpsert/CLEAR_CAT_INPUT\";\nexport type ClearCatInput = ClearAction<typeof CLEAR_CAT_INPUT>;\n\nexport const SET_CAT_VALUE = \"journalEntryUpsert/SET_CAT_VALUE\";\nexport type SetCatValue = SetValueAction<typeof SET_CAT_VALUE, string>;\n\nexport const CLEAR_CAT_VALUE = \"journalEntryUpsert/CLEAR_CAT_VALUE\";\nexport type ClearCatValue = ClearAction<typeof CLEAR_CAT_VALUE>;\n\nexport const SET_CAT_ERROR = \"journalEntryUpsert/SET_CAT_ERROR\";\nexport type SetCatError = SetErrorAction<typeof SET_CAT_ERROR>;\n\nexport const CLEAR_CAT_ERROR = \"journalEntryUpsert/CLEAR_CAT_ERROR\";\nexport type ClearCatError = ClearAction<typeof CLEAR_CAT_ERROR>;\n\nexport const SET_CAT_OPEN = \"journalEntryUpsert/SET_CAT_OPEN\";\nexport type SetCatOpen = \n  Action<typeof SET_CAT_OPEN, {upsertId:string, open:boolean}>;\n\n// Source\nexport const SET_SRC_TYPE = \"journalEntryUpsert/SET_SRC_TYPE\";\nexport type SetSrcType =\n  Action<typeof SET_SRC_TYPE,{upsertId:string, srcType:JournalEntrySourceType}>;\nexport const CLEAR_SRC_TYPE = \"journalEntryUpsert/CLEAR_SRC_TYPE\";\nexport type ClearSrcType = Action<typeof CLEAR_SRC_TYPE,{upsertId:string}>;\n\nexport const SET_SRC_INPUT = \"journalEntryUpsert/SET_SRC_INPUT\";\nexport type SetSrcInput = SetInputAction<typeof SET_SRC_INPUT>;\n\nexport const CLEAR_SRC_INPUT = \"journalEntryUpsert/CLEAR_SRC_INPUT\";\nexport type ClearSrcInput = ClearAction<typeof CLEAR_SRC_INPUT>;\n\nexport const SET_SRC_VALUE = \"journalEntryUpsert/SET_SRC_VALUE\";\nexport type SetSrcValue = SetValueAction<typeof SET_SRC_VALUE, \n  JournalEntrySourceInput>;\n\nexport const CLEAR_SRC_VALUE = \"journalEntryUpsert/CLEAR_SRC_VALUE\";\nexport type ClearSrcValue = ClearAction<typeof CLEAR_SRC_VALUE>;\n\nexport const SET_SRC_ERROR = \"journalEntryUpsert/SET_SRC_ERROR\";\nexport type SetSrcError = SetErrorAction<typeof SET_SRC_ERROR>;\n\nexport const CLEAR_SRC_ERROR = \"journalEntryUpsert/CLEAR_SRC_ERROR\";\nexport type ClearSrcError = ClearAction<typeof CLEAR_SRC_ERROR>;\n\nexport const SET_SRC_OPEN = \"journalEntryUpsert/SET_SRC_OPEN\";\nexport type SetSrcOpen = \n  Action<typeof SET_SRC_OPEN, {upsertId:string, open:boolean}>;\n\n// Payment Method\nexport const SET_PAY_METHOD_VALUE = \"journalEntryUpsert/SET_PAY_METHOD_VALUE\";\nexport type SetPayMethodValue = \n  SetValueAction<typeof SET_PAY_METHOD_VALUE, string>;\nexport const CLEAR_PAY_METHOD_VALUE = \n  \"journalEntryUpsert/CLEAR_PAY_METHOD_VALUE\";\nexport type ClearPayMethodValue = ClearAction<typeof CLEAR_PAY_METHOD_VALUE>;\n\nexport const SET_PAY_METHOD_ERROR = \"journalEntryUpsert/SET_PAY_METHOD_ERROR\";\nexport type SetPayMethodError = SetErrorAction<typeof SET_PAY_METHOD_ERROR>;\nexport const CLEAR_PAY_METHOD_ERROR \n  = \"journalEntryUpsert/CLEAR_PAY_METHOD_ERROR\";\nexport type ClearPayMethodError = ClearAction<typeof CLEAR_PAY_METHOD_ERROR>;\n\n// Description\nexport const SET_DSCRPT_VALUE = \"journalEntryUpsert/SET_DSCRPT_VALUE\";\nexport type SetDscrptValue = SetValueAction<typeof SET_DSCRPT_VALUE, \n  string>;\n\nexport const CLEAR_DSCRPT_VALUE = \"journalEntryUpsert/CLEAR_DSCRPT_VALUE\";\nexport type ClearDscrptValue = ClearAction<typeof CLEAR_DSCRPT_VALUE>;\n\n// Total\nexport const SET_TOTAL_INPUT = \"journalEntryUpsert/SET_TOTAL_INPUT\";\nexport type SetTotalInput = SetInputAction<typeof SET_TOTAL_INPUT>;\n\nexport const CLEAR_TOTAL_INPUT = \"journalEntryUpsert/CLEAR_TOTAL_INPUT\";\nexport type ClearTotalInput = ClearAction<typeof CLEAR_TOTAL_INPUT>;\n\nexport const SET_TOTAL_VALUE = \"journalEntryUpsert/SET_TOTAL_VALUE\";\nexport type SetTotalValue = SetValueAction<typeof SET_TOTAL_VALUE, \n  RationalInput>;\n\nexport const CLEAR_TOTAL_VALUE = \"journalEntryUpsert/CLEAR_TOTAL_VALUE\";\nexport type ClearTotalValue = ClearAction<typeof CLEAR_TOTAL_VALUE>;\n\nexport const SET_TOTAL_ERROR = \"journalEntryUpsert/SET_TOTAL_ERROR\";\nexport type SetTotalError = SetErrorAction<typeof SET_TOTAL_ERROR>;\n\nexport const CLEAR_TOTAL_ERROR = \"journalEntryUpsert/CLEAR_TOTAL_ERROR\";\nexport type ClearTotalError = ClearAction<typeof CLEAR_TOTAL_ERROR>;\n\n// Reconciled\nexport const SET_RECONCILED_VALUE = \"journalEntryUpsert/SET_RECONCILED_VALUE\";\nexport type SetReconciledValue =\n  SetValueAction<typeof SET_RECONCILED_VALUE, boolean>;\n\nexport const CLEAR_RECONCILED_VALUE = \n  \"journalEntryUpsert/CLEAR_RECONCILED_VALUE\";\nexport type ClearReconciledValue = ClearAction<typeof CLEAR_RECONCILED_VALUE>;","\nexport class InputValue<T, Tnull> {\n  input = \"\";\n  value:T | Tnull;\n  error:Error | null = null;\n  constructor(nullValue:Tnull) {\n    this.value = nullValue;\n  }\n}\n\nexport const reduceOneById = <T, A>(state:T[], action:A, id:string,\n  idKey:keyof T, reducer:(state:T, action:A) => T):T[] =>\n{ \n  for(let i = 0, len = state.length; i < len; i++){\n    const entry = state[i];\n    if(entry[idKey as string] === id) {\n      const newEntry = reducer(entry, action);\n      if(newEntry !== entry) {\n        return [\n          ...state.slice(0, i),\n          newEntry,\n          ...state.slice(i + 1)\n        ];\n      } else {\n        return state;\n      }\n    }\n  }\n  return state;\n}","import {Action} from \"./types\";\nimport {TableCellIni} from \"../reducers/tableRows\";\n\nexport const CREATE = \"tableCells/CREATE\";\nexport type Create = Action<typeof CREATE, TableCellIni>;\n\nexport const SET_INDEX = \"tableCells/SET_INDEX\";\nexport type SetIndex =\n  Action<typeof SET_INDEX, {id:string, rowId:string, index:number}>;\nexport const SET_DEFAULT_INDEX = \"tableCells/SET_DEFAULT_INDEX\";\nexport type SetDefaultIndex =\n  Action<typeof SET_DEFAULT_INDEX, {id:string, rowId:string}>;\n\nexport const SET_NAME = \"tableCells/SET_NAME\";\nexport type SetName =\n  Action<typeof SET_NAME, {id:string, rowId:string, name:string}>;\nexport const SET_DEFAULT_NAME = \"tableCells/SET_DEFAULT_NAME\";\nexport type SetDefaultName =\n  Action<typeof SET_DEFAULT_NAME, {id:string, rowId:string}>;\n\nexport const SET_WIDTH = \"tableCells/SET_WIDTH\";\nexport type SetWidth =\n  Action<typeof SET_WIDTH, {id:string, rowId:string, width:number}>;\nexport const SET_DEFAULT_WIDTH = \"tableCells/SET_DEFAULT_WIDTH\";\nexport type SetDefaultWidth =\n  Action<typeof SET_DEFAULT_WIDTH, {id:string, rowId:string}>;\n\nexport const COLLAPSE = \"tableCells/COLLAPSE\";\nexport type Collapse = Action<typeof COLLAPSE, {id:string, rowId:string}>;\nexport const EXPAND = \"tableCells/EXPAND\";\nexport type Expand = Action<typeof EXPAND, {id:string, rowId:string}>;\n\nexport const HIDE = \"tableCells/HIDE\";\nexport type Hide = Action<typeof HIDE, {id:string, rowId:string}>;\nexport const SHOW = \"tableCells/SHOW\";\nexport type Show = Action<typeof SHOW, {id:string, rowId:string}>;\n\nexport const RESTORE_DEFAULTS = \"tableCells/RESTORE_DEFAULTS\";\nexport type RestoreDefaults =\n  Action<typeof RESTORE_DEFAULTS, {id:string, rowId:string}>;","import isEqual from \"lodash.isequal\";\n\nimport {CREATE, Create, SET_INDEX, SetIndex, SET_DEFAULT_INDEX, SetDefaultIndex,\n SET_NAME, SetName, SET_DEFAULT_NAME, SetDefaultName, SET_WIDTH, SetWidth,\n SET_DEFAULT_WIDTH, SetDefaultWidth, COLLAPSE, Collapse, EXPAND, Expand,\n HIDE, Hide, SHOW, Show, RESTORE_DEFAULTS,\n RestoreDefaults,\n} from \"../actionTypes/tableRow\";\nimport { TableRow } from \"@material-ui/core\";\n\ntype Actions = Create | SetIndex | SetDefaultIndex | SetName | SetDefaultName |\n  SetWidth | SetDefaultWidth | Collapse | Expand | Hide | Show |\n  RestoreDefaults;\n\nexport interface TableCellIni {\n  rowId:string;\n  id:string;\n  index:number;\n  name:string;\n  width:number;\n  collapsed?:boolean;\n  hidden?:boolean;\n}\nexport class TableCell {\n  \n  readonly ini:Readonly<TableCellIni>;\n  readonly rowId:string;\n  readonly id:string;\n  index:number;\n  name:string;\n  width:number;\n  collapsed:boolean;\n  hidden:boolean;\n  \n  constructor(ini:TableCellIni) {\n    this.ini = {...ini} as const;\n    this.rowId = ini.rowId\n    this.id = ini.id;\n    this.index = ini.index;\n    this.name = ini.name;\n    this.width = ini.width;\n    this.collapsed = ini?.collapsed ?? false;\n    this.hidden = ini?.hidden ?? false;\n  }\n\n}\n\nexport const tableCell = (state:TableCell, action:Actions):TableCell => {\n  \n  switch(action.type) {\n    case SET_INDEX:\n      return state.index === action.payload.index ?\n        state : {...state, index:action.payload.index};\n    case SET_DEFAULT_INDEX:\n      return state.index === state.ini.index ?\n        state : {...state, index:state.ini.index};\n    case SET_NAME:\n      return state.name === action.payload.name ?\n        state : {...state, name:action.payload.name};\n    case SET_DEFAULT_NAME:\n      return state.name === state.ini.name ?\n        state : {...state, name:state.ini.name};\n    case SET_WIDTH:\n      return state.width === action.payload.width ?\n        state : {...state, width:action.payload.width};\n    case SET_DEFAULT_WIDTH:\n      return state.width === state.ini.width ?\n        state : {...state, width:state.ini.width};\n    case COLLAPSE:\n      return state.collapsed === true ? state : {...state, collapsed:true};\n    case EXPAND:\n      return state.collapsed === false ? state : {...state, collapsed:false};\n    case HIDE:\n      return state.hidden === true ? state : {...state, hidden:true};\n    case SHOW:\n      return state.hidden === false ? state : {...state, hidden:false};\n    case RESTORE_DEFAULTS:{\n      const defaultState = new TableCell(state.ini);\n      return isEqual(state, defaultState) ? state : defaultState;\n    }\n    default:\n      return state;\n  }\n  \n}\n\ninterface TableRow {\n  [cellId:string]:TableCell;\n}\n\n\nexport const iterateCellByIndex = function*(row:TableRow) {\n\n  const unIndexedCells:TableCell[] = [];\n  const indexedCells = new Map<number, TableCell>();\n\n  let nextIndex = 0;\n  for(const key in row) {\n    \n    if(row.hasOwnProperty(key)) {\n      \n      const cell = row[key];\n      const {index = null} = cell;\n      \n      if(index === null) {\n      \n        continue;\n      \n      } else if(nextIndex === index) {\n        \n        yield cell;\n        \n        while(indexedCells.has(++nextIndex)) {\n        \n          yield indexedCells.get(nextIndex) as TableCell;\n        \n        }\n      \n      } else if(index > 0) {\n      \n        indexedCells.set(index, cell);\n      \n      } else {\n\n        unIndexedCells.push(cell);\n\n      }\n\n    }\n  \n  }\n\n  return unIndexedCells;\n\n}\n\nexport const tableRow = (state:TableRow = {}, action:Actions):TableRow =>\n{\n  switch(action.type) {\n    case CREATE:\n      return action.payload.id in state \n        ? state : {...state, [action.payload.id]:new TableCell(action.payload)};\n    case SET_INDEX:{\n      \n      const curIndex = state[action.payload.id].index;\n      const newIndex = action.payload.index;\n      \n      if(curIndex === newIndex) {\n      \n        return state;\n      \n      } else if(curIndex < newIndex) {\n        \n        const newState = {} as TableRow;\n        \n        for(const row of iterateCellByIndex(state)) {\n\n          if(row.index > newIndex) {\n            break;\n          } else if(row.index < curIndex) {\n            continue;\n          } else if(row.index === curIndex) {\n            newState[row.id] =  tableCell(row, {...action, payload:{\n              ...action.payload, index:newIndex}});\n          } else {\n            newState[row.id] =  tableCell(row, {...action, payload:{\n              ...action.payload, index:row.index - 1}});\n          }\n\n        }\n\n        return {...state, ...newState};\n\n      } else {\n        \n        const newState = {} as TableRow;\n        \n        for(const row of iterateCellByIndex(state)) {\n\n          if(row.index > curIndex) {\n            break;\n          } else if(row.index < newIndex) {\n            continue;\n          } else if(row.index === curIndex) {\n            newState[row.id] =  tableCell(row, {...action, payload:{\n              ...action.payload, index:newIndex}});\n          } else {\n            newState[row.id] = tableCell(row, {...action, payload:{\n              ...action.payload, index:row.index + 1}});\n          }\n\n        }\n\n        return {...state, ...newState};\n\n      }\n\n    }\n    case SET_DEFAULT_INDEX:{\n\n      const newState = {} as TableRow;\n\n      for(const row of iterateCellByIndex(state)) {\n\n        newState[row.id] = tableCell(row, action);\n\n      }\n\n      return {...state, ...newState};\n\n    }\n    case SET_NAME:\n    case SET_DEFAULT_NAME:\n    case SET_WIDTH:\n    case SET_DEFAULT_WIDTH:\n    case COLLAPSE:\n    case EXPAND:\n    case HIDE:\n    case SHOW:\n    case RESTORE_DEFAULTS:\n      if(action.payload.id in state) {\n        const curCell = state[action.payload.id];\n        const newCell = tableCell(curCell, action);\n        return newCell === curCell ? \n          state : {...state, [action.payload.id]:newCell};\n      }\n      return state;\n    default:\n      return state;\n  }\n}\n\ninterface TableRows {\n  [rowId:string]:TableRow;\n}\n\nexport const tableRows = (state:TableRows = {}, action:Actions)\n  :TableRows =>\n{\n\n  switch(action.type) {\n    case CREATE:{\n      const {rowId} = action.payload;\n      if(rowId in state) {\n        const curRow = state[rowId];\n        const newRow = tableRow(curRow, action);\n        return curRow === newRow ? state : {...state, [rowId]:newRow};\n      }\n      return {...state, [rowId]:tableRow(undefined, action)};\n    }\n    case SET_INDEX:\n    case SET_DEFAULT_INDEX:\n    case SET_NAME:\n    case SET_DEFAULT_NAME:\n    case SET_WIDTH:\n    case SET_DEFAULT_WIDTH:\n    case COLLAPSE:\n    case EXPAND:\n    case HIDE:\n    case SHOW:\n    case RESTORE_DEFAULTS:{\n      const {rowId} = action.payload;\n      if(rowId in state) {\n        const curRow = state[rowId];\n        const newRow = tableRow(curRow, action);\n        return curRow === newRow ? state : {...state, [rowId]:newRow};\n      }\n      return state;\n    }\n    default:\n      return state;\n  }\n\n}","import {Action} from \"./types\";\n\nexport const CREATE_PAB = \"journal/CREATE_PAB\";\nexport type CreatePAB = Action<typeof CREATE_PAB, {pabId:string}>;\n\nexport const OPEN_PAB = \"journal/OPEN_PAB\";\nexport type OpenPAB = Action<typeof OPEN_PAB, {pabId:string}>;\n\nexport const CLOSE_PAB = \"journal/CLOSE_PAB\";\nexport type ClosePAB = Action<typeof CLOSE_PAB, {pabId:string}>;","import {combineReducers} from \"redux\";\n\nimport {CREATE_PAB, CreatePAB, OPEN_PAB, OpenPAB, CLOSE_PAB, ClosePAB\n} from \"../actionTypes/journal\";\n\ntype Actions = CreatePAB | OpenPAB | ClosePAB;\n\nconst pab = (state = {open:false}, action:Actions) => {\n\n  switch(action.type) {\n    case OPEN_PAB:\n      return state.open === true ? state : {...state, open:true};\n    case CLOSE_PAB:\n      return state.open === false ? state : {...state, open:false};\n    default:\n    return state;\n  }\n\n}\n\nexport type PAB = ReturnType<typeof pab>;\n\ninterface PABs {\n  [key:string]:PAB\n}\n\nexport const pabs = (state:PABs = {}, action:Actions) => {\n\n  switch(action.type) {\n    case CREATE_PAB:\n      // Create ONLY once\n      if(action.payload.pabId in state) {\n        return state;\n      }\n      return {...state, [action.payload.pabId]:pab(undefined, action)}\n    case OPEN_PAB:\n    case CLOSE_PAB:\n      if(action.payload.pabId in state) {\n        const {pabId} = action.payload;\n        const curPAB = state[pabId];\n        const newPAB = pab(curPAB, action);\n        return curPAB === newPAB ? state : {...state, [pabId]:newPAB}\n      }\n      return state;\n    default:\n      return state;\n\n  }\n\n}\n\nexport const journal = combineReducers({\n  pabs\n});\n\nexport type Journal = typeof journal;","import {combineReducers} from \"redux\";\n\nimport {journalEntryUpserts} from \"./journalEntryUpserts\";\nimport {tableRows} from \"./tableRows\";\nimport {journal} from \"./journal\";\n\nconst root = combineReducers({\n  journal,\n  journalEntryUpserts,\n  tableRows\n});\nexport default root;\n\nexport type Root = ReturnType<typeof root>;","import { configureStore } from \"@reduxjs/toolkit\";\n// import { createStore, applyMiddleware } from \"redux\";\n// import { composeWithDevTools } from \"redux-devtools-extension\";\n// import thunk from \"redux-thunk\";\n\nimport root from \"./reducers/root\";\n\n// const store = createStore(root, composeWithDevTools(\n//   applyMiddleware(thunk)\n// ));\n\nconst store = configureStore({\n  reducer: root,\n});\n\nexport type AppDispatch = typeof store.dispatch;\nexport default store;\n","import React, { Fragment } from \"react\";\nimport { Provider } from \"react-redux\";\nimport { ApolloProvider } from \"@apollo/react-hooks\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport Box from \"@material-ui/core/Box\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\n\nimport client from \"./apollo/apollo\";\nimport Routes from \"./Routes\";\nimport store from \"./redux/store\";\n\nexport default function App() {\n  return (\n    <Fragment>\n      <CssBaseline />\n      <Provider store={store}>\n        <ApolloProvider client={client}>\n          <Router>\n            {/* <Box\n            position=\"fixed\"\n            top={0}\n            left={0}\n            height=\"100vh\"\n            width=\"100vw\"\n            overflow=\"hidden\"\n            display=\"flex\"\n            flexDirection=\"column\"\n            justifyContent=\"flex-start\"\n            alignItems=\"center\"\n          >\n            <Routes/>\n          </Box> */}\n            <Routes />\n          </Router>\n        </ApolloProvider>\n      </Provider>\n    </Fragment>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\n    \nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n\n"],"sourceRoot":""}